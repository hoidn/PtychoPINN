2025-10-19 23:21:15,564 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-19 23:21:15,740 - DEBUG - Creating converter from 7 to 5
2025-10-19 23:21:15,740 - DEBUG - Creating converter from 5 to 7
2025-10-19 23:21:15,740 - DEBUG - Creating converter from 7 to 5
2025-10-19 23:21:15,740 - DEBUG - Creating converter from 5 to 7
2025-10-19 23:21:16,355 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-19 23:21:16,362 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-19 23:21:16,363 - DEBUG - interactive is False
2025-10-19 23:21:16,363 - DEBUG - platform is linux
2025-10-19 23:21:16,392 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-19 23:21:16,393 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-19 23:21:17,402 - DEBUG - Field: train_data_file
2025-10-19 23:21:17,402 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 23:21:17,402 - DEBUG - Field default: None
2025-10-19 23:21:17,403 - DEBUG - Field: test_data_file
2025-10-19 23:21:17,403 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 23:21:17,403 - DEBUG - Field default: None
2025-10-19 23:21:17,403 - DEBUG - Field: output_dir
2025-10-19 23:21:17,403 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-19 23:21:17,403 - DEBUG - Field default: training_outputs
2025-10-19 23:21:17,403 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-19 23:21:17,403 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-19 23:21:17,403 - DEBUG - Converting path value: /tmp/tmpdzsh084n/training_outputs
2025-10-19 23:21:17,403 - DEBUG - YAML config: {}
2025-10-19 23:21:17,403 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpdzsh084n/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 23:21:17,403 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpdzsh084n/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 23:21:17,403 - INFO - Configuration setup complete
2025-10-19 23:21:17,403 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpdzsh084n/training_outputs'), sequential_sampling=False, backend='tensorflow')
2025-10-19 23:21:17,403 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-19 23:21:17,403 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-19 23:21:17,403 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-19 23:21:17,420 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-19 23:21:17,420 - INFO - Randomly subsampled 64 images
2025-10-19 23:21:17,438 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-19 23:21:17,454 - INFO - Using full dataset of 1087 images
2025-10-19 23:21:17,468 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-19 23:21:17,469 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-19 23:21:17,469 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 23:21:17,469 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-19 23:21:17,469 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 23:21:17,469 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 23:21:17,469 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 23:21:17,469 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 23:21:17,469 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-19 23:21:17,469 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-19 23:21:17,469 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-19 23:21:17,469 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-19 23:21:17,469 - INFO - Using all 64 points as seeds
2025-10-19 23:21:17,469 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 23:21:17,469 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-19 23:21:17,469 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-19 23:21:17,469 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-19 23:21:17,469 - INFO - Generated 64 groups efficiently
2025-10-19 23:21:18,429 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-19 23:21:18,429 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 23:21:18,429 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-19 23:21:18,429 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 23:21:18,429 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 23:21:18,429 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 23:21:18,429 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 23:21:18,430 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-19 23:21:18,430 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-19 23:21:18,430 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-19 23:21:18,430 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-19 23:21:18,430 - INFO - Sampled 64 seed points from 1087 total points
2025-10-19 23:21:18,430 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 23:21:18,430 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-19 23:21:18,430 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-19 23:21:18,430 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-19 23:21:18,430 - INFO - Generated 64 groups efficiently
2025-10-19 23:21:19,663 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 23:21:21,526 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 23:21:25,370 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 23:21:28,153 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-19 23:21:28,370 - DEBUG - Creating converter from 5 to 3
2025-10-19 23:21:29,479 - INFO - Outputs saved to /tmp/tmpdzsh084n/training_outputs
2025-10-19 23:21:49,148 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-19 23:21:49,325 - DEBUG - Creating converter from 7 to 5
2025-10-19 23:21:49,325 - DEBUG - Creating converter from 5 to 7
2025-10-19 23:21:49,325 - DEBUG - Creating converter from 7 to 5
2025-10-19 23:21:49,325 - DEBUG - Creating converter from 5 to 7
2025-10-19 23:21:49,938 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-19 23:21:49,945 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-19 23:21:49,946 - DEBUG - interactive is False
2025-10-19 23:21:49,946 - DEBUG - platform is linux
2025-10-19 23:21:49,975 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-19 23:21:49,976 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-19 23:21:50,978 - DEBUG - Field: train_data_file
2025-10-19 23:21:50,978 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 23:21:50,978 - DEBUG - Field default: None
2025-10-19 23:21:50,978 - DEBUG - Field: test_data_file
2025-10-19 23:21:50,978 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 23:21:50,978 - DEBUG - Field default: None
2025-10-19 23:21:50,978 - DEBUG - Field: output_dir
2025-10-19 23:21:50,978 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-19 23:21:50,978 - DEBUG - Field default: training_outputs
2025-10-19 23:21:50,978 - DEBUG - Converting path value: /tmp/tmp62h8r61a/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-19 23:21:50,978 - DEBUG - Converting path value: /tmp/tmp62h8r61a/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-19 23:21:50,978 - DEBUG - Converting path value: /tmp/tmp62h8r61a/training/training_nphotons_500000.0_e2e
2025-10-19 23:21:50,978 - DEBUG - YAML config: {}
2025-10-19 23:21:50,978 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp62h8r61a/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmp62h8r61a/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp62h8r61a/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 23:21:50,979 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp62h8r61a/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmp62h8r61a/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp62h8r61a/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 23:21:50,979 - INFO - Configuration setup complete
2025-10-19 23:21:50,979 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp62h8r61a/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmp62h8r61a/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp62h8r61a/training/training_nphotons_500000.0_e2e'), sequential_sampling=False, backend='tensorflow')
2025-10-19 23:21:50,979 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-19 23:21:50,979 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-19 23:21:50,979 - INFO - Loading data from /tmp/tmp62h8r61a/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-19 23:21:50,985 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-19 23:21:50,986 - INFO - Randomly subsampled 50 images
2025-10-19 23:21:50,997 - DEBUG - Loaded metadata from /tmp/tmp62h8r61a/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-19 23:21:50,997 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-19 23:21:50,997 - INFO - Loading data from /tmp/tmp62h8r61a/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-19 23:21:51,002 - INFO - Using full dataset of 100 images
2025-10-19 23:21:51,003 - INFO - Loaded test data from /tmp/tmp62h8r61a/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-19 23:21:51,003 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-19 23:21:51,003 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 23:21:51,003 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-19 23:21:51,003 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 23:21:51,003 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 23:21:51,003 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 23:21:51,003 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 23:21:51,003 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 23:21:51,003 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-19 23:21:51,003 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-19 23:21:51,003 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-19 23:21:51,003 - INFO - Using all 50 points as seeds
2025-10-19 23:21:51,003 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 23:21:51,003 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 23:21:51,004 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 23:21:51,004 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 23:21:51,004 - INFO - Generated 50 groups efficiently
2025-10-19 23:21:51,917 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-19 23:21:51,917 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 23:21:51,917 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-19 23:21:51,917 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 23:21:51,917 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 23:21:51,917 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 23:21:51,917 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 23:21:51,917 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 23:21:51,917 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-19 23:21:51,917 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-19 23:21:51,917 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-19 23:21:51,917 - INFO - Sampled 50 seed points from 100 total points
2025-10-19 23:21:51,917 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 23:21:51,917 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 23:21:51,918 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 23:21:51,918 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 23:21:51,918 - INFO - Generated 50 groups efficiently
2025-10-19 23:21:53,097 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 23:21:54,944 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 23:21:58,466 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 23:22:01,725 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-19 23:22:01,741 - DEBUG - Creating converter from 5 to 3
2025-10-19 23:22:02,858 - INFO - Outputs saved to /tmp/tmp62h8r61a/training/training_nphotons_500000.0_e2e
2025-10-19 23:22:17,338 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-19 23:22:17,515 - DEBUG - Creating converter from 7 to 5
2025-10-19 23:22:17,515 - DEBUG - Creating converter from 5 to 7
2025-10-19 23:22:17,515 - DEBUG - Creating converter from 7 to 5
2025-10-19 23:22:17,515 - DEBUG - Creating converter from 5 to 7
2025-10-19 23:22:18,131 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-19 23:22:18,138 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-19 23:22:18,139 - DEBUG - interactive is False
2025-10-19 23:22:18,139 - DEBUG - platform is linux
2025-10-19 23:22:18,168 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-19 23:22:18,169 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-19 23:22:19,170 - DEBUG - Field: train_data_file
2025-10-19 23:22:19,170 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 23:22:19,170 - DEBUG - Field default: None
2025-10-19 23:22:19,170 - DEBUG - Field: test_data_file
2025-10-19 23:22:19,170 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 23:22:19,170 - DEBUG - Field default: None
2025-10-19 23:22:19,170 - DEBUG - Field: output_dir
2025-10-19 23:22:19,170 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-19 23:22:19,170 - DEBUG - Field default: training_outputs
2025-10-19 23:22:19,171 - DEBUG - Converting path value: /tmp/tmpgn2ckll4/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-19 23:22:19,171 - DEBUG - Converting path value: /tmp/tmpgn2ckll4/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-19 23:22:19,171 - DEBUG - Converting path value: /tmp/tmpgn2ckll4/training/training_nphotons_1000000.0_single
2025-10-19 23:22:19,171 - DEBUG - YAML config: {}
2025-10-19 23:22:19,171 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpgn2ckll4/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpgn2ckll4/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpgn2ckll4/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 23:22:19,171 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpgn2ckll4/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpgn2ckll4/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpgn2ckll4/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 23:22:19,171 - INFO - Configuration setup complete
2025-10-19 23:22:19,171 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpgn2ckll4/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmpgn2ckll4/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpgn2ckll4/training/training_nphotons_1000000.0_single'), sequential_sampling=False, backend='tensorflow')
2025-10-19 23:22:19,171 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-19 23:22:19,171 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-19 23:22:19,171 - INFO - Loading data from /tmp/tmpgn2ckll4/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-19 23:22:19,178 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-19 23:22:19,178 - INFO - Randomly subsampled 50 images
2025-10-19 23:22:19,189 - DEBUG - Loaded metadata from /tmp/tmpgn2ckll4/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-19 23:22:19,189 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-19 23:22:19,189 - INFO - Loading data from /tmp/tmpgn2ckll4/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-19 23:22:19,195 - INFO - Using full dataset of 100 images
2025-10-19 23:22:19,195 - INFO - Loaded test data from /tmp/tmpgn2ckll4/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-19 23:22:19,196 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-19 23:22:19,196 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 23:22:19,196 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-19 23:22:19,196 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 23:22:19,196 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 23:22:19,196 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 23:22:19,196 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 23:22:19,196 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 23:22:19,196 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-19 23:22:19,196 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-19 23:22:19,196 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-19 23:22:19,196 - INFO - Using all 50 points as seeds
2025-10-19 23:22:19,196 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 23:22:19,196 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 23:22:19,196 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 23:22:19,196 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 23:22:19,196 - INFO - Generated 50 groups efficiently
2025-10-19 23:22:20,111 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-19 23:22:20,111 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 23:22:20,111 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-19 23:22:20,111 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 23:22:20,111 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 23:22:20,111 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 23:22:20,111 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 23:22:20,111 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 23:22:20,111 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-19 23:22:20,111 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-19 23:22:20,112 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-19 23:22:20,112 - INFO - Sampled 50 seed points from 100 total points
2025-10-19 23:22:20,112 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 23:22:20,112 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 23:22:20,112 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 23:22:20,112 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 23:22:20,112 - INFO - Generated 50 groups efficiently
2025-10-19 23:22:21,283 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 23:22:23,136 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 23:22:26,715 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 23:22:29,944 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-19 23:22:29,960 - DEBUG - Creating converter from 5 to 3
2025-10-19 23:22:31,080 - INFO - Outputs saved to /tmp/tmpgn2ckll4/training/training_nphotons_1000000.0_single
2025-10-19 23:23:00,724 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-19 23:23:00,900 - DEBUG - Creating converter from 7 to 5
2025-10-19 23:23:00,900 - DEBUG - Creating converter from 5 to 7
2025-10-19 23:23:00,900 - DEBUG - Creating converter from 7 to 5
2025-10-19 23:23:00,900 - DEBUG - Creating converter from 5 to 7
2025-10-19 23:23:01,510 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-19 23:23:01,517 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-19 23:23:01,517 - DEBUG - interactive is False
2025-10-19 23:23:01,517 - DEBUG - platform is linux
2025-10-19 23:23:01,546 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-19 23:23:01,548 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-19 23:23:02,556 - DEBUG - Field: train_data_file
2025-10-19 23:23:02,556 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 23:23:02,556 - DEBUG - Field default: None
2025-10-19 23:23:02,556 - DEBUG - Field: test_data_file
2025-10-19 23:23:02,556 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 23:23:02,556 - DEBUG - Field default: None
2025-10-19 23:23:02,556 - DEBUG - Field: output_dir
2025-10-19 23:23:02,556 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-19 23:23:02,556 - DEBUG - Field default: training_outputs
2025-10-19 23:23:02,556 - DEBUG - Converting path value: /tmp/tmp6jl5z67n/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-19 23:23:02,556 - DEBUG - Converting path value: /tmp/tmp6jl5z67n/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-19 23:23:02,556 - DEBUG - Converting path value: /tmp/tmp6jl5z67n/training/training_mismatch_test
2025-10-19 23:23:02,557 - DEBUG - YAML config: {}
2025-10-19 23:23:02,557 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp6jl5z67n/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmp6jl5z67n/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp6jl5z67n/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 23:23:02,557 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp6jl5z67n/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmp6jl5z67n/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp6jl5z67n/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 23:23:02,557 - INFO - Configuration setup complete
2025-10-19 23:23:02,557 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp6jl5z67n/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmp6jl5z67n/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp6jl5z67n/training/training_mismatch_test'), sequential_sampling=False, backend='tensorflow')
2025-10-19 23:23:02,557 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-19 23:23:02,557 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-19 23:23:02,557 - INFO - Loading data from /tmp/tmp6jl5z67n/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-19 23:23:02,562 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-19 23:23:02,562 - INFO - Randomly subsampled 50 images
2025-10-19 23:23:02,573 - DEBUG - Loaded metadata from /tmp/tmp6jl5z67n/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-19 23:23:02,573 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-19 23:23:02,573 - INFO - Loading data from /tmp/tmp6jl5z67n/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-19 23:23:02,577 - INFO - Using full dataset of 100 images
2025-10-19 23:23:02,578 - INFO - Loaded test data from /tmp/tmp6jl5z67n/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-19 23:23:02,578 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-19 23:23:02,578 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 23:23:02,578 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-19 23:23:02,578 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 23:23:02,578 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 23:23:02,578 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 23:23:02,578 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 23:23:02,578 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 23:23:02,578 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-19 23:23:02,578 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-19 23:23:02,578 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-19 23:23:02,578 - INFO - Using all 50 points as seeds
2025-10-19 23:23:02,578 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 23:23:02,578 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 23:23:02,578 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 23:23:02,578 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 23:23:02,578 - INFO - Generated 50 groups efficiently
2025-10-19 23:23:03,490 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-19 23:23:03,490 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 23:23:03,490 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-19 23:23:03,490 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 23:23:03,490 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 23:23:03,490 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 23:23:03,490 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 23:23:03,490 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 23:23:03,490 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-19 23:23:03,490 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-19 23:23:03,490 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-19 23:23:03,490 - INFO - Sampled 50 seed points from 100 total points
2025-10-19 23:23:03,490 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 23:23:03,491 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 23:23:03,491 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 23:23:03,491 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 23:23:03,491 - INFO - Generated 50 groups efficiently
2025-10-19 23:23:04,662 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 23:23:06,510 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 23:23:10,065 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 23:23:13,266 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-19 23:23:13,281 - DEBUG - Creating converter from 5 to 3
2025-10-19 23:23:14,381 - INFO - Outputs saved to /tmp/tmp6jl5z67n/training/training_mismatch_test
2025-10-19 23:57:21,699 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-19 23:57:21,874 - DEBUG - Creating converter from 7 to 5
2025-10-19 23:57:21,874 - DEBUG - Creating converter from 5 to 7
2025-10-19 23:57:21,874 - DEBUG - Creating converter from 7 to 5
2025-10-19 23:57:21,874 - DEBUG - Creating converter from 5 to 7
2025-10-19 23:57:22,493 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-19 23:57:22,500 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-19 23:57:22,501 - DEBUG - interactive is False
2025-10-19 23:57:22,501 - DEBUG - platform is linux
2025-10-19 23:57:22,530 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-19 23:57:22,531 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-19 23:57:23,534 - DEBUG - Field: train_data_file
2025-10-19 23:57:23,534 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 23:57:23,534 - DEBUG - Field default: None
2025-10-19 23:57:23,534 - DEBUG - Field: test_data_file
2025-10-19 23:57:23,534 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 23:57:23,534 - DEBUG - Field default: None
2025-10-19 23:57:23,534 - DEBUG - Field: output_dir
2025-10-19 23:57:23,534 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-19 23:57:23,534 - DEBUG - Field default: training_outputs
2025-10-19 23:57:23,535 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-19 23:57:23,535 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-19 23:57:23,535 - DEBUG - Converting path value: /tmp/tmpxd5kepn4/training_outputs
2025-10-19 23:57:23,535 - DEBUG - YAML config: {}
2025-10-19 23:57:23,535 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpxd5kepn4/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 23:57:23,535 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpxd5kepn4/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 23:57:23,535 - INFO - Configuration setup complete
2025-10-19 23:57:23,535 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpxd5kepn4/training_outputs'), sequential_sampling=False, backend='tensorflow')
2025-10-19 23:57:23,535 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-19 23:57:23,535 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-19 23:57:23,535 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-19 23:57:23,551 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-19 23:57:23,551 - INFO - Randomly subsampled 64 images
2025-10-19 23:57:23,569 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-19 23:57:23,584 - INFO - Using full dataset of 1087 images
2025-10-19 23:57:23,599 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-19 23:57:23,600 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-19 23:57:23,600 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 23:57:23,600 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-19 23:57:23,600 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 23:57:23,600 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 23:57:23,600 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 23:57:23,600 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 23:57:23,600 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-19 23:57:23,600 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-19 23:57:23,600 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-19 23:57:23,600 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-19 23:57:23,600 - INFO - Using all 64 points as seeds
2025-10-19 23:57:23,600 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 23:57:23,600 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-19 23:57:23,600 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-19 23:57:23,600 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-19 23:57:23,600 - INFO - Generated 64 groups efficiently
2025-10-19 23:57:24,565 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-19 23:57:24,565 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 23:57:24,565 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-19 23:57:24,565 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 23:57:24,565 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 23:57:24,565 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 23:57:24,565 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 23:57:24,565 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-19 23:57:24,565 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-19 23:57:24,565 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-19 23:57:24,565 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-19 23:57:24,565 - INFO - Sampled 64 seed points from 1087 total points
2025-10-19 23:57:24,566 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 23:57:24,566 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-19 23:57:24,566 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-19 23:57:24,566 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-19 23:57:24,566 - INFO - Generated 64 groups efficiently
2025-10-19 23:57:25,795 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 23:57:27,636 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 23:57:31,466 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 23:57:34,238 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-19 23:57:34,453 - DEBUG - Creating converter from 5 to 3
2025-10-19 23:57:35,567 - INFO - Outputs saved to /tmp/tmpxd5kepn4/training_outputs
2025-10-19 23:57:55,120 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-19 23:57:55,298 - DEBUG - Creating converter from 7 to 5
2025-10-19 23:57:55,298 - DEBUG - Creating converter from 5 to 7
2025-10-19 23:57:55,298 - DEBUG - Creating converter from 7 to 5
2025-10-19 23:57:55,299 - DEBUG - Creating converter from 5 to 7
2025-10-19 23:57:55,922 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-19 23:57:55,929 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-19 23:57:55,930 - DEBUG - interactive is False
2025-10-19 23:57:55,930 - DEBUG - platform is linux
2025-10-19 23:57:55,959 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-19 23:57:55,960 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-19 23:57:56,962 - DEBUG - Field: train_data_file
2025-10-19 23:57:56,962 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 23:57:56,962 - DEBUG - Field default: None
2025-10-19 23:57:56,962 - DEBUG - Field: test_data_file
2025-10-19 23:57:56,962 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 23:57:56,962 - DEBUG - Field default: None
2025-10-19 23:57:56,962 - DEBUG - Field: output_dir
2025-10-19 23:57:56,962 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-19 23:57:56,962 - DEBUG - Field default: training_outputs
2025-10-19 23:57:56,962 - DEBUG - Converting path value: /tmp/tmpzjucn9uq/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-19 23:57:56,962 - DEBUG - Converting path value: /tmp/tmpzjucn9uq/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-19 23:57:56,962 - DEBUG - Converting path value: /tmp/tmpzjucn9uq/training/training_nphotons_500000.0_e2e
2025-10-19 23:57:56,962 - DEBUG - YAML config: {}
2025-10-19 23:57:56,962 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpzjucn9uq/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpzjucn9uq/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpzjucn9uq/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 23:57:56,962 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpzjucn9uq/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpzjucn9uq/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpzjucn9uq/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 23:57:56,963 - INFO - Configuration setup complete
2025-10-19 23:57:56,963 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpzjucn9uq/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmpzjucn9uq/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpzjucn9uq/training/training_nphotons_500000.0_e2e'), sequential_sampling=False, backend='tensorflow')
2025-10-19 23:57:56,963 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-19 23:57:56,963 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-19 23:57:56,963 - INFO - Loading data from /tmp/tmpzjucn9uq/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-19 23:57:56,969 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-19 23:57:56,969 - INFO - Randomly subsampled 50 images
2025-10-19 23:57:56,980 - DEBUG - Loaded metadata from /tmp/tmpzjucn9uq/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-19 23:57:56,981 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-19 23:57:56,981 - INFO - Loading data from /tmp/tmpzjucn9uq/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-19 23:57:56,986 - INFO - Using full dataset of 100 images
2025-10-19 23:57:56,987 - INFO - Loaded test data from /tmp/tmpzjucn9uq/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-19 23:57:56,987 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-19 23:57:56,987 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 23:57:56,987 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-19 23:57:56,987 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 23:57:56,987 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 23:57:56,987 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 23:57:56,987 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 23:57:56,987 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 23:57:56,987 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-19 23:57:56,987 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-19 23:57:56,987 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-19 23:57:56,987 - INFO - Using all 50 points as seeds
2025-10-19 23:57:56,987 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 23:57:56,987 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 23:57:56,987 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 23:57:56,987 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 23:57:56,987 - INFO - Generated 50 groups efficiently
2025-10-19 23:57:57,895 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-19 23:57:57,895 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 23:57:57,895 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-19 23:57:57,895 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 23:57:57,895 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 23:57:57,895 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 23:57:57,895 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 23:57:57,895 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 23:57:57,895 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-19 23:57:57,895 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-19 23:57:57,895 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-19 23:57:57,895 - INFO - Sampled 50 seed points from 100 total points
2025-10-19 23:57:57,895 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 23:57:57,895 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 23:57:57,895 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 23:57:57,895 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 23:57:57,895 - INFO - Generated 50 groups efficiently
2025-10-19 23:57:59,074 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 23:58:00,932 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 23:58:04,510 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 23:58:07,716 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-19 23:58:07,731 - DEBUG - Creating converter from 5 to 3
2025-10-19 23:58:08,843 - INFO - Outputs saved to /tmp/tmpzjucn9uq/training/training_nphotons_500000.0_e2e
2025-10-19 23:58:23,254 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-19 23:58:23,431 - DEBUG - Creating converter from 7 to 5
2025-10-19 23:58:23,431 - DEBUG - Creating converter from 5 to 7
2025-10-19 23:58:23,431 - DEBUG - Creating converter from 7 to 5
2025-10-19 23:58:23,431 - DEBUG - Creating converter from 5 to 7
2025-10-19 23:58:24,046 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-19 23:58:24,053 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-19 23:58:24,054 - DEBUG - interactive is False
2025-10-19 23:58:24,054 - DEBUG - platform is linux
2025-10-19 23:58:24,083 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-19 23:58:24,085 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-19 23:58:25,091 - DEBUG - Field: train_data_file
2025-10-19 23:58:25,091 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 23:58:25,091 - DEBUG - Field default: None
2025-10-19 23:58:25,091 - DEBUG - Field: test_data_file
2025-10-19 23:58:25,091 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 23:58:25,091 - DEBUG - Field default: None
2025-10-19 23:58:25,091 - DEBUG - Field: output_dir
2025-10-19 23:58:25,091 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-19 23:58:25,091 - DEBUG - Field default: training_outputs
2025-10-19 23:58:25,092 - DEBUG - Converting path value: /tmp/tmp3pjeovm2/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-19 23:58:25,092 - DEBUG - Converting path value: /tmp/tmp3pjeovm2/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-19 23:58:25,092 - DEBUG - Converting path value: /tmp/tmp3pjeovm2/training/training_nphotons_1000000.0_single
2025-10-19 23:58:25,092 - DEBUG - YAML config: {}
2025-10-19 23:58:25,092 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp3pjeovm2/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmp3pjeovm2/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp3pjeovm2/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 23:58:25,092 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp3pjeovm2/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmp3pjeovm2/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp3pjeovm2/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 23:58:25,092 - INFO - Configuration setup complete
2025-10-19 23:58:25,092 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp3pjeovm2/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmp3pjeovm2/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp3pjeovm2/training/training_nphotons_1000000.0_single'), sequential_sampling=False, backend='tensorflow')
2025-10-19 23:58:25,092 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-19 23:58:25,092 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-19 23:58:25,092 - INFO - Loading data from /tmp/tmp3pjeovm2/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-19 23:58:25,099 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-19 23:58:25,099 - INFO - Randomly subsampled 50 images
2025-10-19 23:58:25,110 - DEBUG - Loaded metadata from /tmp/tmp3pjeovm2/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-19 23:58:25,110 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-19 23:58:25,110 - INFO - Loading data from /tmp/tmp3pjeovm2/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-19 23:58:25,116 - INFO - Using full dataset of 100 images
2025-10-19 23:58:25,116 - INFO - Loaded test data from /tmp/tmp3pjeovm2/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-19 23:58:25,116 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-19 23:58:25,116 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 23:58:25,116 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-19 23:58:25,116 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 23:58:25,116 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 23:58:25,116 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 23:58:25,117 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 23:58:25,117 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 23:58:25,117 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-19 23:58:25,117 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-19 23:58:25,117 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-19 23:58:25,117 - INFO - Using all 50 points as seeds
2025-10-19 23:58:25,117 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 23:58:25,117 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 23:58:25,117 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 23:58:25,117 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 23:58:25,117 - INFO - Generated 50 groups efficiently
2025-10-19 23:58:26,019 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-19 23:58:26,019 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 23:58:26,019 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-19 23:58:26,019 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 23:58:26,019 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 23:58:26,019 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 23:58:26,019 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 23:58:26,019 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 23:58:26,019 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-19 23:58:26,019 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-19 23:58:26,019 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-19 23:58:26,019 - INFO - Sampled 50 seed points from 100 total points
2025-10-19 23:58:26,019 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 23:58:26,019 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 23:58:26,019 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 23:58:26,019 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 23:58:26,019 - INFO - Generated 50 groups efficiently
2025-10-19 23:58:27,183 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 23:58:29,033 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 23:58:32,543 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 23:58:35,701 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-19 23:58:35,718 - DEBUG - Creating converter from 5 to 3
2025-10-19 23:58:36,830 - INFO - Outputs saved to /tmp/tmp3pjeovm2/training/training_nphotons_1000000.0_single
2025-10-19 23:59:06,520 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-19 23:59:06,692 - DEBUG - Creating converter from 7 to 5
2025-10-19 23:59:06,692 - DEBUG - Creating converter from 5 to 7
2025-10-19 23:59:06,692 - DEBUG - Creating converter from 7 to 5
2025-10-19 23:59:06,693 - DEBUG - Creating converter from 5 to 7
2025-10-19 23:59:07,303 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-19 23:59:07,311 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-19 23:59:07,311 - DEBUG - interactive is False
2025-10-19 23:59:07,311 - DEBUG - platform is linux
2025-10-19 23:59:07,340 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-19 23:59:07,341 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-19 23:59:08,332 - DEBUG - Field: train_data_file
2025-10-19 23:59:08,332 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 23:59:08,332 - DEBUG - Field default: None
2025-10-19 23:59:08,332 - DEBUG - Field: test_data_file
2025-10-19 23:59:08,332 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 23:59:08,332 - DEBUG - Field default: None
2025-10-19 23:59:08,332 - DEBUG - Field: output_dir
2025-10-19 23:59:08,332 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-19 23:59:08,332 - DEBUG - Field default: training_outputs
2025-10-19 23:59:08,332 - DEBUG - Converting path value: /tmp/tmp75ks0m4t/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-19 23:59:08,332 - DEBUG - Converting path value: /tmp/tmp75ks0m4t/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-19 23:59:08,332 - DEBUG - Converting path value: /tmp/tmp75ks0m4t/training/training_mismatch_test
2025-10-19 23:59:08,332 - DEBUG - YAML config: {}
2025-10-19 23:59:08,332 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp75ks0m4t/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmp75ks0m4t/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp75ks0m4t/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 23:59:08,332 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp75ks0m4t/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmp75ks0m4t/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp75ks0m4t/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 23:59:08,333 - INFO - Configuration setup complete
2025-10-19 23:59:08,333 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp75ks0m4t/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmp75ks0m4t/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp75ks0m4t/training/training_mismatch_test'), sequential_sampling=False, backend='tensorflow')
2025-10-19 23:59:08,333 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-19 23:59:08,333 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-19 23:59:08,333 - INFO - Loading data from /tmp/tmp75ks0m4t/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-19 23:59:08,338 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-19 23:59:08,338 - INFO - Randomly subsampled 50 images
2025-10-19 23:59:08,348 - DEBUG - Loaded metadata from /tmp/tmp75ks0m4t/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-19 23:59:08,348 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-19 23:59:08,348 - INFO - Loading data from /tmp/tmp75ks0m4t/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-19 23:59:08,353 - INFO - Using full dataset of 100 images
2025-10-19 23:59:08,353 - INFO - Loaded test data from /tmp/tmp75ks0m4t/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-19 23:59:08,354 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-19 23:59:08,354 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 23:59:08,354 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-19 23:59:08,354 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 23:59:08,354 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 23:59:08,354 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 23:59:08,354 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 23:59:08,354 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 23:59:08,354 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-19 23:59:08,354 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-19 23:59:08,354 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-19 23:59:08,354 - INFO - Using all 50 points as seeds
2025-10-19 23:59:08,354 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 23:59:08,354 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 23:59:08,354 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 23:59:08,354 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 23:59:08,354 - INFO - Generated 50 groups efficiently
2025-10-19 23:59:09,290 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-19 23:59:09,290 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 23:59:09,290 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-19 23:59:09,290 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 23:59:09,290 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 23:59:09,290 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 23:59:09,290 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 23:59:09,290 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 23:59:09,290 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-19 23:59:09,290 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-19 23:59:09,290 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-19 23:59:09,291 - INFO - Sampled 50 seed points from 100 total points
2025-10-19 23:59:09,291 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 23:59:09,291 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 23:59:09,291 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 23:59:09,291 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 23:59:09,291 - INFO - Generated 50 groups efficiently
2025-10-19 23:59:10,466 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 23:59:12,316 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 23:59:15,870 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 23:59:19,065 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-19 23:59:19,081 - DEBUG - Creating converter from 5 to 3
2025-10-19 23:59:20,192 - INFO - Outputs saved to /tmp/tmp75ks0m4t/training/training_mismatch_test
