2025-10-17 04:01:14,886 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 04:01:15,061 - DEBUG - Creating converter from 7 to 5
2025-10-17 04:01:15,061 - DEBUG - Creating converter from 5 to 7
2025-10-17 04:01:15,061 - DEBUG - Creating converter from 7 to 5
2025-10-17 04:01:15,061 - DEBUG - Creating converter from 5 to 7
2025-10-17 04:01:15,678 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 04:01:15,685 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 04:01:15,685 - DEBUG - interactive is False
2025-10-17 04:01:15,685 - DEBUG - platform is linux
2025-10-17 04:01:15,714 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 04:01:15,715 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 04:01:16,745 - DEBUG - Field: train_data_file
2025-10-17 04:01:16,745 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 04:01:16,745 - DEBUG - Field default: None
2025-10-17 04:01:16,745 - DEBUG - Field: test_data_file
2025-10-17 04:01:16,745 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 04:01:16,745 - DEBUG - Field default: None
2025-10-17 04:01:16,746 - DEBUG - Field: output_dir
2025-10-17 04:01:16,746 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 04:01:16,746 - DEBUG - Field default: training_outputs
2025-10-17 04:01:16,746 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 04:01:16,746 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 04:01:16,746 - DEBUG - Converting path value: /tmp/tmpuugay_so/training_outputs
2025-10-17 04:01:16,746 - DEBUG - YAML config: {}
2025-10-17 04:01:16,746 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpuugay_so/training_outputs'), 'sequential_sampling': False}
2025-10-17 04:01:16,746 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpuugay_so/training_outputs'), 'sequential_sampling': False}
2025-10-17 04:01:16,746 - INFO - Configuration setup complete
2025-10-17 04:01:16,746 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpuugay_so/training_outputs'), sequential_sampling=False)
2025-10-17 04:01:16,746 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-17 04:01:16,746 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-17 04:01:16,746 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-17 04:01:16,762 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-17 04:01:16,763 - INFO - Randomly subsampled 64 images
2025-10-17 04:01:16,780 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-17 04:01:16,796 - INFO - Using full dataset of 1087 images
2025-10-17 04:01:16,810 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 04:01:16,811 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-17 04:01:16,811 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 04:01:16,811 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-17 04:01:16,811 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 04:01:16,811 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 04:01:16,811 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 04:01:16,811 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 04:01:16,811 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-17 04:01:16,811 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-17 04:01:16,811 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-17 04:01:16,811 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-17 04:01:16,811 - INFO - Using all 64 points as seeds
2025-10-17 04:01:16,811 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 04:01:16,811 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-17 04:01:16,811 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-17 04:01:16,811 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-17 04:01:16,811 - INFO - Generated 64 groups efficiently
2025-10-17 04:01:18,374 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-17 04:01:18,374 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 04:01:18,374 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-17 04:01:18,374 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 04:01:18,374 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 04:01:18,374 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 04:01:18,374 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 04:01:18,374 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-17 04:01:18,374 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-17 04:01:18,374 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-17 04:01:18,374 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-17 04:01:18,374 - INFO - Sampled 64 seed points from 1087 total points
2025-10-17 04:01:18,374 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 04:01:18,374 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-17 04:01:18,374 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-17 04:01:18,374 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-17 04:01:18,374 - INFO - Generated 64 groups efficiently
2025-10-17 04:01:20,401 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 04:01:22,275 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 04:01:29,473 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 04:01:31,404 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 04:01:31,619 - DEBUG - Creating converter from 5 to 3
2025-10-17 04:01:32,752 - INFO - Outputs saved to /tmp/tmpuugay_so/training_outputs
2025-10-17 04:01:56,872 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 04:01:57,042 - DEBUG - Creating converter from 7 to 5
2025-10-17 04:01:57,042 - DEBUG - Creating converter from 5 to 7
2025-10-17 04:01:57,042 - DEBUG - Creating converter from 7 to 5
2025-10-17 04:01:57,042 - DEBUG - Creating converter from 5 to 7
2025-10-17 04:01:57,650 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 04:01:57,657 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 04:01:57,658 - DEBUG - interactive is False
2025-10-17 04:01:57,658 - DEBUG - platform is linux
2025-10-17 04:01:57,687 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 04:01:57,688 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 04:01:58,718 - DEBUG - Field: train_data_file
2025-10-17 04:01:58,718 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 04:01:58,718 - DEBUG - Field default: None
2025-10-17 04:01:58,718 - DEBUG - Field: test_data_file
2025-10-17 04:01:58,718 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 04:01:58,718 - DEBUG - Field default: None
2025-10-17 04:01:58,718 - DEBUG - Field: output_dir
2025-10-17 04:01:58,718 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 04:01:58,718 - DEBUG - Field default: training_outputs
2025-10-17 04:01:58,718 - DEBUG - Converting path value: /tmp/tmp1fbjnzc7/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 04:01:58,718 - DEBUG - Converting path value: /tmp/tmp1fbjnzc7/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 04:01:58,718 - DEBUG - Converting path value: /tmp/tmp1fbjnzc7/training/training_nphotons_500000.0_e2e
2025-10-17 04:01:58,718 - DEBUG - YAML config: {}
2025-10-17 04:01:58,718 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp1fbjnzc7/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmp1fbjnzc7/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp1fbjnzc7/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-17 04:01:58,719 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp1fbjnzc7/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmp1fbjnzc7/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp1fbjnzc7/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-17 04:01:58,719 - INFO - Configuration setup complete
2025-10-17 04:01:58,719 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp1fbjnzc7/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmp1fbjnzc7/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp1fbjnzc7/training/training_nphotons_500000.0_e2e'), sequential_sampling=False)
2025-10-17 04:01:58,719 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 04:01:58,719 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 04:01:58,719 - INFO - Loading data from /tmp/tmp1fbjnzc7/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-17 04:01:58,725 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 04:01:58,725 - INFO - Randomly subsampled 50 images
2025-10-17 04:01:58,737 - DEBUG - Loaded metadata from /tmp/tmp1fbjnzc7/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 04:01:58,737 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-17 04:01:58,737 - INFO - Loading data from /tmp/tmp1fbjnzc7/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-17 04:01:58,742 - INFO - Using full dataset of 100 images
2025-10-17 04:01:58,742 - INFO - Loaded test data from /tmp/tmp1fbjnzc7/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 04:01:58,743 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 04:01:58,743 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 04:01:58,743 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 04:01:58,743 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 04:01:58,743 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 04:01:58,743 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 04:01:58,743 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 04:01:58,743 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 04:01:58,743 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 04:01:58,743 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 04:01:58,743 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 04:01:58,743 - INFO - Using all 50 points as seeds
2025-10-17 04:01:58,743 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 04:01:58,743 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 04:01:58,743 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 04:01:58,743 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 04:01:58,743 - INFO - Generated 50 groups efficiently
2025-10-17 04:02:00,276 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 04:02:00,276 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 04:02:00,276 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 04:02:00,276 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 04:02:00,276 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 04:02:00,276 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 04:02:00,276 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 04:02:00,276 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 04:02:00,276 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 04:02:00,276 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 04:02:00,276 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 04:02:00,276 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 04:02:00,276 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 04:02:00,276 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 04:02:00,276 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 04:02:00,276 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 04:02:00,276 - INFO - Generated 50 groups efficiently
2025-10-17 04:02:02,273 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 04:02:04,144 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 04:02:11,471 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 04:02:14,611 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 04:02:14,629 - DEBUG - Creating converter from 5 to 3
2025-10-17 04:02:15,789 - INFO - Outputs saved to /tmp/tmp1fbjnzc7/training/training_nphotons_500000.0_e2e
2025-10-17 04:02:34,017 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 04:02:34,192 - DEBUG - Creating converter from 7 to 5
2025-10-17 04:02:34,192 - DEBUG - Creating converter from 5 to 7
2025-10-17 04:02:34,192 - DEBUG - Creating converter from 7 to 5
2025-10-17 04:02:34,192 - DEBUG - Creating converter from 5 to 7
2025-10-17 04:02:34,805 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 04:02:34,812 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 04:02:34,813 - DEBUG - interactive is False
2025-10-17 04:02:34,813 - DEBUG - platform is linux
2025-10-17 04:02:34,842 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 04:02:34,843 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 04:02:35,891 - DEBUG - Field: train_data_file
2025-10-17 04:02:35,891 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 04:02:35,891 - DEBUG - Field default: None
2025-10-17 04:02:35,891 - DEBUG - Field: test_data_file
2025-10-17 04:02:35,891 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 04:02:35,891 - DEBUG - Field default: None
2025-10-17 04:02:35,891 - DEBUG - Field: output_dir
2025-10-17 04:02:35,891 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 04:02:35,891 - DEBUG - Field default: training_outputs
2025-10-17 04:02:35,891 - DEBUG - Converting path value: /tmp/tmpfhc23vce/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 04:02:35,891 - DEBUG - Converting path value: /tmp/tmpfhc23vce/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 04:02:35,891 - DEBUG - Converting path value: /tmp/tmpfhc23vce/training/training_nphotons_1000000.0_single
2025-10-17 04:02:35,891 - DEBUG - YAML config: {}
2025-10-17 04:02:35,891 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpfhc23vce/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpfhc23vce/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpfhc23vce/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-17 04:02:35,891 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpfhc23vce/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpfhc23vce/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpfhc23vce/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-17 04:02:35,891 - INFO - Configuration setup complete
2025-10-17 04:02:35,892 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpfhc23vce/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmpfhc23vce/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpfhc23vce/training/training_nphotons_1000000.0_single'), sequential_sampling=False)
2025-10-17 04:02:35,892 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 04:02:35,892 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 04:02:35,892 - INFO - Loading data from /tmp/tmpfhc23vce/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-17 04:02:35,898 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 04:02:35,898 - INFO - Randomly subsampled 50 images
2025-10-17 04:02:35,909 - DEBUG - Loaded metadata from /tmp/tmpfhc23vce/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 04:02:35,909 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-17 04:02:35,909 - INFO - Loading data from /tmp/tmpfhc23vce/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-17 04:02:35,915 - INFO - Using full dataset of 100 images
2025-10-17 04:02:35,915 - INFO - Loaded test data from /tmp/tmpfhc23vce/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 04:02:35,915 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 04:02:35,915 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 04:02:35,915 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 04:02:35,915 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 04:02:35,915 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 04:02:35,915 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 04:02:35,915 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 04:02:35,915 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 04:02:35,915 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 04:02:35,916 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 04:02:35,916 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 04:02:35,916 - INFO - Using all 50 points as seeds
2025-10-17 04:02:35,916 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 04:02:35,916 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 04:02:35,916 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 04:02:35,916 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 04:02:35,916 - INFO - Generated 50 groups efficiently
2025-10-17 04:02:37,477 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 04:02:37,477 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 04:02:37,477 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 04:02:37,477 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 04:02:37,477 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 04:02:37,477 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 04:02:37,477 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 04:02:37,477 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 04:02:37,477 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 04:02:37,477 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 04:02:37,478 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 04:02:37,478 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 04:02:37,478 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 04:02:37,478 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 04:02:37,478 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 04:02:37,478 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 04:02:37,478 - INFO - Generated 50 groups efficiently
2025-10-17 04:02:39,477 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 04:02:41,355 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 04:02:48,706 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 04:02:51,907 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 04:02:51,923 - DEBUG - Creating converter from 5 to 3
2025-10-17 04:02:53,061 - INFO - Outputs saved to /tmp/tmpfhc23vce/training/training_nphotons_1000000.0_single
2025-10-17 04:03:28,941 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 04:03:29,114 - DEBUG - Creating converter from 7 to 5
2025-10-17 04:03:29,114 - DEBUG - Creating converter from 5 to 7
2025-10-17 04:03:29,114 - DEBUG - Creating converter from 7 to 5
2025-10-17 04:03:29,114 - DEBUG - Creating converter from 5 to 7
2025-10-17 04:03:29,718 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 04:03:29,725 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 04:03:29,725 - DEBUG - interactive is False
2025-10-17 04:03:29,725 - DEBUG - platform is linux
2025-10-17 04:03:29,754 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 04:03:29,755 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 04:03:30,807 - DEBUG - Field: train_data_file
2025-10-17 04:03:30,807 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 04:03:30,807 - DEBUG - Field default: None
2025-10-17 04:03:30,807 - DEBUG - Field: test_data_file
2025-10-17 04:03:30,807 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 04:03:30,807 - DEBUG - Field default: None
2025-10-17 04:03:30,807 - DEBUG - Field: output_dir
2025-10-17 04:03:30,807 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 04:03:30,807 - DEBUG - Field default: training_outputs
2025-10-17 04:03:30,807 - DEBUG - Converting path value: /tmp/tmp7k5fjaul/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 04:03:30,807 - DEBUG - Converting path value: /tmp/tmp7k5fjaul/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 04:03:30,807 - DEBUG - Converting path value: /tmp/tmp7k5fjaul/training/training_mismatch_test
2025-10-17 04:03:30,807 - DEBUG - YAML config: {}
2025-10-17 04:03:30,807 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp7k5fjaul/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmp7k5fjaul/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp7k5fjaul/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-17 04:03:30,807 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp7k5fjaul/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmp7k5fjaul/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp7k5fjaul/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-17 04:03:30,808 - INFO - Configuration setup complete
2025-10-17 04:03:30,808 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp7k5fjaul/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmp7k5fjaul/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp7k5fjaul/training/training_mismatch_test'), sequential_sampling=False)
2025-10-17 04:03:30,808 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 04:03:30,808 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 04:03:30,808 - INFO - Loading data from /tmp/tmp7k5fjaul/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-17 04:03:30,813 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 04:03:30,813 - INFO - Randomly subsampled 50 images
2025-10-17 04:03:30,823 - DEBUG - Loaded metadata from /tmp/tmp7k5fjaul/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 04:03:30,823 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-17 04:03:30,823 - INFO - Loading data from /tmp/tmp7k5fjaul/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-17 04:03:30,828 - INFO - Using full dataset of 100 images
2025-10-17 04:03:30,828 - INFO - Loaded test data from /tmp/tmp7k5fjaul/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 04:03:30,828 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 04:03:30,829 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 04:03:30,829 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 04:03:30,829 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 04:03:30,829 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 04:03:30,829 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 04:03:30,829 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 04:03:30,829 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 04:03:30,829 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 04:03:30,829 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 04:03:30,829 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 04:03:30,829 - INFO - Using all 50 points as seeds
2025-10-17 04:03:30,829 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 04:03:30,829 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 04:03:30,829 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 04:03:30,829 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 04:03:30,829 - INFO - Generated 50 groups efficiently
2025-10-17 04:03:32,369 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 04:03:32,369 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 04:03:32,369 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 04:03:32,369 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 04:03:32,369 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 04:03:32,369 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 04:03:32,369 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 04:03:32,369 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 04:03:32,369 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 04:03:32,369 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 04:03:32,369 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 04:03:32,369 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 04:03:32,369 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 04:03:32,369 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 04:03:32,369 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 04:03:32,369 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 04:03:32,369 - INFO - Generated 50 groups efficiently
2025-10-17 04:03:34,362 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 04:03:36,233 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 04:03:43,543 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 04:03:46,717 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 04:03:46,733 - DEBUG - Creating converter from 5 to 3
2025-10-17 04:03:47,859 - INFO - Outputs saved to /tmp/tmp7k5fjaul/training/training_mismatch_test
2025-10-17 10:08:09,056 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 10:08:09,232 - DEBUG - Creating converter from 7 to 5
2025-10-17 10:08:09,232 - DEBUG - Creating converter from 5 to 7
2025-10-17 10:08:09,232 - DEBUG - Creating converter from 7 to 5
2025-10-17 10:08:09,232 - DEBUG - Creating converter from 5 to 7
2025-10-17 10:08:09,847 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 10:08:09,855 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 10:08:09,855 - DEBUG - interactive is False
2025-10-17 10:08:09,855 - DEBUG - platform is linux
2025-10-17 10:08:09,885 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 10:08:09,886 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 10:08:10,890 - DEBUG - Field: train_data_file
2025-10-17 10:08:10,890 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 10:08:10,890 - DEBUG - Field default: None
2025-10-17 10:08:10,890 - DEBUG - Field: test_data_file
2025-10-17 10:08:10,890 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 10:08:10,890 - DEBUG - Field default: None
2025-10-17 10:08:10,890 - DEBUG - Field: output_dir
2025-10-17 10:08:10,890 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 10:08:10,890 - DEBUG - Field default: training_outputs
2025-10-17 10:08:10,890 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 10:08:10,890 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 10:08:10,890 - DEBUG - Converting path value: /tmp/tmpuhvjcq2f/training_outputs
2025-10-17 10:08:10,890 - DEBUG - YAML config: {}
2025-10-17 10:08:10,890 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpuhvjcq2f/training_outputs'), 'sequential_sampling': False}
2025-10-17 10:08:10,890 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpuhvjcq2f/training_outputs'), 'sequential_sampling': False}
2025-10-17 10:08:10,890 - INFO - Configuration setup complete
2025-10-17 10:08:10,890 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpuhvjcq2f/training_outputs'), sequential_sampling=False)
2025-10-17 10:08:10,890 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-17 10:08:10,891 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-17 10:08:10,891 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-17 10:08:10,907 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-17 10:08:10,907 - INFO - Randomly subsampled 64 images
2025-10-17 10:08:10,924 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-17 10:08:10,940 - INFO - Using full dataset of 1087 images
2025-10-17 10:08:10,954 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 10:08:10,955 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-17 10:08:10,955 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 10:08:10,955 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-17 10:08:10,955 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 10:08:10,955 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 10:08:10,955 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 10:08:10,955 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 10:08:10,955 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-17 10:08:10,955 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-17 10:08:10,955 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-17 10:08:10,955 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-17 10:08:10,955 - INFO - Using all 64 points as seeds
2025-10-17 10:08:10,955 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 10:08:10,955 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-17 10:08:10,955 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-17 10:08:10,955 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-17 10:08:10,955 - INFO - Generated 64 groups efficiently
2025-10-17 10:08:11,926 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-17 10:08:11,926 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 10:08:11,926 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-17 10:08:11,926 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 10:08:11,926 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 10:08:11,926 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 10:08:11,926 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 10:08:11,926 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-17 10:08:11,926 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-17 10:08:11,926 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-17 10:08:11,926 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-17 10:08:11,926 - INFO - Sampled 64 seed points from 1087 total points
2025-10-17 10:08:11,926 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 10:08:11,926 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-17 10:08:11,926 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-17 10:08:11,926 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-17 10:08:11,926 - INFO - Generated 64 groups efficiently
2025-10-17 10:08:13,159 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:08:15,008 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:08:18,887 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:08:21,650 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 10:08:21,861 - DEBUG - Creating converter from 5 to 3
2025-10-17 10:08:22,962 - INFO - Outputs saved to /tmp/tmpuhvjcq2f/training_outputs
2025-10-17 10:08:42,253 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 10:08:42,425 - DEBUG - Creating converter from 7 to 5
2025-10-17 10:08:42,425 - DEBUG - Creating converter from 5 to 7
2025-10-17 10:08:42,425 - DEBUG - Creating converter from 7 to 5
2025-10-17 10:08:42,425 - DEBUG - Creating converter from 5 to 7
2025-10-17 10:08:43,034 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 10:08:43,042 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 10:08:43,042 - DEBUG - interactive is False
2025-10-17 10:08:43,042 - DEBUG - platform is linux
2025-10-17 10:08:43,072 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 10:08:43,073 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 10:08:44,068 - DEBUG - Field: train_data_file
2025-10-17 10:08:44,068 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 10:08:44,068 - DEBUG - Field default: None
2025-10-17 10:08:44,068 - DEBUG - Field: test_data_file
2025-10-17 10:08:44,068 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 10:08:44,068 - DEBUG - Field default: None
2025-10-17 10:08:44,069 - DEBUG - Field: output_dir
2025-10-17 10:08:44,069 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 10:08:44,069 - DEBUG - Field default: training_outputs
2025-10-17 10:08:44,069 - DEBUG - Converting path value: /tmp/tmpu86td9pi/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 10:08:44,069 - DEBUG - Converting path value: /tmp/tmpu86td9pi/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 10:08:44,069 - DEBUG - Converting path value: /tmp/tmpu86td9pi/training/training_nphotons_500000.0_e2e
2025-10-17 10:08:44,069 - DEBUG - YAML config: {}
2025-10-17 10:08:44,069 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpu86td9pi/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpu86td9pi/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpu86td9pi/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-17 10:08:44,069 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpu86td9pi/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpu86td9pi/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpu86td9pi/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-17 10:08:44,069 - INFO - Configuration setup complete
2025-10-17 10:08:44,069 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpu86td9pi/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmpu86td9pi/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpu86td9pi/training/training_nphotons_500000.0_e2e'), sequential_sampling=False)
2025-10-17 10:08:44,069 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 10:08:44,069 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 10:08:44,069 - INFO - Loading data from /tmp/tmpu86td9pi/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-17 10:08:44,076 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 10:08:44,076 - INFO - Randomly subsampled 50 images
2025-10-17 10:08:44,087 - DEBUG - Loaded metadata from /tmp/tmpu86td9pi/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 10:08:44,087 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-17 10:08:44,087 - INFO - Loading data from /tmp/tmpu86td9pi/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-17 10:08:44,092 - INFO - Using full dataset of 100 images
2025-10-17 10:08:44,093 - INFO - Loaded test data from /tmp/tmpu86td9pi/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 10:08:44,093 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 10:08:44,093 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 10:08:44,093 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 10:08:44,093 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 10:08:44,093 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 10:08:44,093 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 10:08:44,093 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 10:08:44,093 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 10:08:44,093 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 10:08:44,093 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 10:08:44,093 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 10:08:44,093 - INFO - Using all 50 points as seeds
2025-10-17 10:08:44,093 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 10:08:44,093 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 10:08:44,093 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 10:08:44,093 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 10:08:44,093 - INFO - Generated 50 groups efficiently
2025-10-17 10:08:45,000 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 10:08:45,000 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 10:08:45,000 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 10:08:45,000 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 10:08:45,000 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 10:08:45,000 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 10:08:45,000 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 10:08:45,000 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 10:08:45,000 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 10:08:45,000 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 10:08:45,000 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 10:08:45,000 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 10:08:45,000 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 10:08:45,000 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 10:08:45,000 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 10:08:45,000 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 10:08:45,000 - INFO - Generated 50 groups efficiently
2025-10-17 10:08:46,184 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:08:48,056 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:08:51,529 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:08:54,730 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 10:08:54,746 - DEBUG - Creating converter from 5 to 3
2025-10-17 10:08:55,851 - INFO - Outputs saved to /tmp/tmpu86td9pi/training/training_nphotons_500000.0_e2e
2025-10-17 10:09:10,300 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 10:09:10,474 - DEBUG - Creating converter from 7 to 5
2025-10-17 10:09:10,474 - DEBUG - Creating converter from 5 to 7
2025-10-17 10:09:10,474 - DEBUG - Creating converter from 7 to 5
2025-10-17 10:09:10,474 - DEBUG - Creating converter from 5 to 7
2025-10-17 10:09:11,091 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 10:09:11,098 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 10:09:11,098 - DEBUG - interactive is False
2025-10-17 10:09:11,098 - DEBUG - platform is linux
2025-10-17 10:09:11,128 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 10:09:11,129 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 10:09:12,130 - DEBUG - Field: train_data_file
2025-10-17 10:09:12,130 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 10:09:12,130 - DEBUG - Field default: None
2025-10-17 10:09:12,130 - DEBUG - Field: test_data_file
2025-10-17 10:09:12,130 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 10:09:12,130 - DEBUG - Field default: None
2025-10-17 10:09:12,130 - DEBUG - Field: output_dir
2025-10-17 10:09:12,130 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 10:09:12,130 - DEBUG - Field default: training_outputs
2025-10-17 10:09:12,130 - DEBUG - Converting path value: /tmp/tmpnrk45gd7/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 10:09:12,130 - DEBUG - Converting path value: /tmp/tmpnrk45gd7/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 10:09:12,130 - DEBUG - Converting path value: /tmp/tmpnrk45gd7/training/training_nphotons_1000000.0_single
2025-10-17 10:09:12,130 - DEBUG - YAML config: {}
2025-10-17 10:09:12,130 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpnrk45gd7/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpnrk45gd7/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpnrk45gd7/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-17 10:09:12,130 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpnrk45gd7/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpnrk45gd7/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpnrk45gd7/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-17 10:09:12,130 - INFO - Configuration setup complete
2025-10-17 10:09:12,130 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpnrk45gd7/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmpnrk45gd7/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpnrk45gd7/training/training_nphotons_1000000.0_single'), sequential_sampling=False)
2025-10-17 10:09:12,130 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 10:09:12,131 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 10:09:12,131 - INFO - Loading data from /tmp/tmpnrk45gd7/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-17 10:09:12,137 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 10:09:12,137 - INFO - Randomly subsampled 50 images
2025-10-17 10:09:12,148 - DEBUG - Loaded metadata from /tmp/tmpnrk45gd7/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 10:09:12,148 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-17 10:09:12,148 - INFO - Loading data from /tmp/tmpnrk45gd7/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-17 10:09:12,154 - INFO - Using full dataset of 100 images
2025-10-17 10:09:12,154 - INFO - Loaded test data from /tmp/tmpnrk45gd7/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 10:09:12,155 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 10:09:12,155 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 10:09:12,155 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 10:09:12,155 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 10:09:12,155 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 10:09:12,155 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 10:09:12,155 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 10:09:12,155 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 10:09:12,155 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 10:09:12,155 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 10:09:12,155 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 10:09:12,155 - INFO - Using all 50 points as seeds
2025-10-17 10:09:12,155 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 10:09:12,155 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 10:09:12,155 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 10:09:12,155 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 10:09:12,155 - INFO - Generated 50 groups efficiently
2025-10-17 10:09:13,067 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 10:09:13,067 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 10:09:13,067 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 10:09:13,067 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 10:09:13,067 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 10:09:13,067 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 10:09:13,067 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 10:09:13,067 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 10:09:13,067 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 10:09:13,067 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 10:09:13,067 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 10:09:13,067 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 10:09:13,067 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 10:09:13,067 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 10:09:13,067 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 10:09:13,067 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 10:09:13,067 - INFO - Generated 50 groups efficiently
2025-10-17 10:09:14,247 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:09:16,095 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:09:19,618 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:09:22,796 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 10:09:22,813 - DEBUG - Creating converter from 5 to 3
2025-10-17 10:09:23,915 - INFO - Outputs saved to /tmp/tmpnrk45gd7/training/training_nphotons_1000000.0_single
2025-10-17 10:09:53,561 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 10:09:53,735 - DEBUG - Creating converter from 7 to 5
2025-10-17 10:09:53,735 - DEBUG - Creating converter from 5 to 7
2025-10-17 10:09:53,735 - DEBUG - Creating converter from 7 to 5
2025-10-17 10:09:53,735 - DEBUG - Creating converter from 5 to 7
2025-10-17 10:09:54,347 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 10:09:54,354 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 10:09:54,354 - DEBUG - interactive is False
2025-10-17 10:09:54,355 - DEBUG - platform is linux
2025-10-17 10:09:54,384 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 10:09:54,385 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 10:09:55,381 - DEBUG - Field: train_data_file
2025-10-17 10:09:55,382 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 10:09:55,382 - DEBUG - Field default: None
2025-10-17 10:09:55,382 - DEBUG - Field: test_data_file
2025-10-17 10:09:55,382 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 10:09:55,382 - DEBUG - Field default: None
2025-10-17 10:09:55,382 - DEBUG - Field: output_dir
2025-10-17 10:09:55,382 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 10:09:55,382 - DEBUG - Field default: training_outputs
2025-10-17 10:09:55,382 - DEBUG - Converting path value: /tmp/tmprru5dk4g/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 10:09:55,382 - DEBUG - Converting path value: /tmp/tmprru5dk4g/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 10:09:55,382 - DEBUG - Converting path value: /tmp/tmprru5dk4g/training/training_mismatch_test
2025-10-17 10:09:55,382 - DEBUG - YAML config: {}
2025-10-17 10:09:55,382 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmprru5dk4g/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmprru5dk4g/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmprru5dk4g/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-17 10:09:55,382 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmprru5dk4g/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmprru5dk4g/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmprru5dk4g/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-17 10:09:55,382 - INFO - Configuration setup complete
2025-10-17 10:09:55,382 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmprru5dk4g/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmprru5dk4g/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmprru5dk4g/training/training_mismatch_test'), sequential_sampling=False)
2025-10-17 10:09:55,382 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 10:09:55,383 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 10:09:55,383 - INFO - Loading data from /tmp/tmprru5dk4g/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-17 10:09:55,388 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 10:09:55,388 - INFO - Randomly subsampled 50 images
2025-10-17 10:09:55,398 - DEBUG - Loaded metadata from /tmp/tmprru5dk4g/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 10:09:55,398 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-17 10:09:55,398 - INFO - Loading data from /tmp/tmprru5dk4g/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-17 10:09:55,403 - INFO - Using full dataset of 100 images
2025-10-17 10:09:55,403 - INFO - Loaded test data from /tmp/tmprru5dk4g/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 10:09:55,403 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 10:09:55,404 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 10:09:55,404 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 10:09:55,404 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 10:09:55,404 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 10:09:55,404 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 10:09:55,404 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 10:09:55,404 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 10:09:55,404 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 10:09:55,404 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 10:09:55,404 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 10:09:55,404 - INFO - Using all 50 points as seeds
2025-10-17 10:09:55,404 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 10:09:55,404 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 10:09:55,404 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 10:09:55,404 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 10:09:55,404 - INFO - Generated 50 groups efficiently
2025-10-17 10:09:56,313 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 10:09:56,313 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 10:09:56,313 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 10:09:56,313 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 10:09:56,313 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 10:09:56,313 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 10:09:56,313 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 10:09:56,313 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 10:09:56,313 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 10:09:56,313 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 10:09:56,314 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 10:09:56,314 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 10:09:56,314 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 10:09:56,314 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 10:09:56,314 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 10:09:56,314 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 10:09:56,314 - INFO - Generated 50 groups efficiently
2025-10-17 10:09:57,485 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:09:59,338 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:10:02,858 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:10:06,084 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 10:10:06,099 - DEBUG - Creating converter from 5 to 3
2025-10-17 10:10:07,197 - INFO - Outputs saved to /tmp/tmprru5dk4g/training/training_mismatch_test
2025-10-17 10:23:45,550 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 10:23:45,721 - DEBUG - Creating converter from 7 to 5
2025-10-17 10:23:45,721 - DEBUG - Creating converter from 5 to 7
2025-10-17 10:23:45,721 - DEBUG - Creating converter from 7 to 5
2025-10-17 10:23:45,721 - DEBUG - Creating converter from 5 to 7
2025-10-17 10:23:46,326 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 10:23:46,334 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 10:23:46,334 - DEBUG - interactive is False
2025-10-17 10:23:46,335 - DEBUG - platform is linux
2025-10-17 10:23:46,364 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 10:23:46,365 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 10:23:47,403 - DEBUG - Field: train_data_file
2025-10-17 10:23:47,404 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 10:23:47,404 - DEBUG - Field default: None
2025-10-17 10:23:47,404 - DEBUG - Field: test_data_file
2025-10-17 10:23:47,404 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 10:23:47,404 - DEBUG - Field default: None
2025-10-17 10:23:47,404 - DEBUG - Field: output_dir
2025-10-17 10:23:47,404 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 10:23:47,404 - DEBUG - Field default: training_outputs
2025-10-17 10:23:47,404 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 10:23:47,404 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 10:23:47,404 - DEBUG - Converting path value: /tmp/tmp0wpfghff/training_outputs
2025-10-17 10:23:47,404 - DEBUG - YAML config: {}
2025-10-17 10:23:47,404 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp0wpfghff/training_outputs'), 'sequential_sampling': False}
2025-10-17 10:23:47,404 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp0wpfghff/training_outputs'), 'sequential_sampling': False}
2025-10-17 10:23:47,404 - INFO - Configuration setup complete
2025-10-17 10:23:47,404 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp0wpfghff/training_outputs'), sequential_sampling=False)
2025-10-17 10:23:47,404 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-17 10:23:47,405 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-17 10:23:47,405 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-17 10:23:47,420 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-17 10:23:47,420 - INFO - Randomly subsampled 64 images
2025-10-17 10:23:47,437 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-17 10:23:47,452 - INFO - Using full dataset of 1087 images
2025-10-17 10:23:47,467 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 10:23:47,467 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-17 10:23:47,467 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 10:23:47,467 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-17 10:23:47,468 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 10:23:47,468 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 10:23:47,468 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 10:23:47,468 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 10:23:47,468 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-17 10:23:47,468 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-17 10:23:47,468 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-17 10:23:47,468 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-17 10:23:47,468 - INFO - Using all 64 points as seeds
2025-10-17 10:23:47,468 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 10:23:47,468 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-17 10:23:47,468 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-17 10:23:47,468 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-17 10:23:47,468 - INFO - Generated 64 groups efficiently
2025-10-17 10:23:49,081 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-17 10:23:49,081 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 10:23:49,081 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-17 10:23:49,081 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 10:23:49,081 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 10:23:49,081 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 10:23:49,081 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 10:23:49,081 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-17 10:23:49,081 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-17 10:23:49,081 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-17 10:23:49,082 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-17 10:23:49,082 - INFO - Sampled 64 seed points from 1087 total points
2025-10-17 10:23:49,082 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 10:23:49,082 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-17 10:23:49,082 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-17 10:23:49,082 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-17 10:23:49,082 - INFO - Generated 64 groups efficiently
2025-10-17 10:23:51,134 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:23:52,985 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:24:00,222 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:24:02,207 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 10:24:02,422 - DEBUG - Creating converter from 5 to 3
2025-10-17 10:24:03,556 - INFO - Outputs saved to /tmp/tmp0wpfghff/training_outputs
2025-10-17 10:24:27,813 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 10:24:27,987 - DEBUG - Creating converter from 7 to 5
2025-10-17 10:24:27,987 - DEBUG - Creating converter from 5 to 7
2025-10-17 10:24:27,987 - DEBUG - Creating converter from 7 to 5
2025-10-17 10:24:27,987 - DEBUG - Creating converter from 5 to 7
2025-10-17 10:24:28,599 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 10:24:28,606 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 10:24:28,607 - DEBUG - interactive is False
2025-10-17 10:24:28,607 - DEBUG - platform is linux
2025-10-17 10:24:28,636 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 10:24:28,637 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 10:24:29,693 - DEBUG - Field: train_data_file
2025-10-17 10:24:29,693 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 10:24:29,693 - DEBUG - Field default: None
2025-10-17 10:24:29,693 - DEBUG - Field: test_data_file
2025-10-17 10:24:29,693 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 10:24:29,693 - DEBUG - Field default: None
2025-10-17 10:24:29,693 - DEBUG - Field: output_dir
2025-10-17 10:24:29,693 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 10:24:29,693 - DEBUG - Field default: training_outputs
2025-10-17 10:24:29,693 - DEBUG - Converting path value: /tmp/tmppj09oany/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 10:24:29,693 - DEBUG - Converting path value: /tmp/tmppj09oany/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 10:24:29,693 - DEBUG - Converting path value: /tmp/tmppj09oany/training/training_nphotons_500000.0_e2e
2025-10-17 10:24:29,694 - DEBUG - YAML config: {}
2025-10-17 10:24:29,694 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmppj09oany/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmppj09oany/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmppj09oany/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-17 10:24:29,694 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmppj09oany/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmppj09oany/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmppj09oany/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-17 10:24:29,694 - INFO - Configuration setup complete
2025-10-17 10:24:29,694 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmppj09oany/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmppj09oany/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmppj09oany/training/training_nphotons_500000.0_e2e'), sequential_sampling=False)
2025-10-17 10:24:29,694 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 10:24:29,694 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 10:24:29,694 - INFO - Loading data from /tmp/tmppj09oany/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-17 10:24:29,700 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 10:24:29,700 - INFO - Randomly subsampled 50 images
2025-10-17 10:24:29,712 - DEBUG - Loaded metadata from /tmp/tmppj09oany/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 10:24:29,712 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-17 10:24:29,712 - INFO - Loading data from /tmp/tmppj09oany/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-17 10:24:29,717 - INFO - Using full dataset of 100 images
2025-10-17 10:24:29,717 - INFO - Loaded test data from /tmp/tmppj09oany/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 10:24:29,718 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 10:24:29,718 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 10:24:29,718 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 10:24:29,718 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 10:24:29,718 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 10:24:29,718 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 10:24:29,718 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 10:24:29,718 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 10:24:29,718 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 10:24:29,718 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 10:24:29,718 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 10:24:29,718 - INFO - Using all 50 points as seeds
2025-10-17 10:24:29,718 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 10:24:29,718 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 10:24:29,718 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 10:24:29,718 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 10:24:29,718 - INFO - Generated 50 groups efficiently
2025-10-17 10:24:31,239 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 10:24:31,240 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 10:24:31,240 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 10:24:31,240 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 10:24:31,240 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 10:24:31,240 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 10:24:31,240 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 10:24:31,240 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 10:24:31,240 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 10:24:31,240 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 10:24:31,240 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 10:24:31,240 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 10:24:31,240 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 10:24:31,240 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 10:24:31,240 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 10:24:31,240 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 10:24:31,240 - INFO - Generated 50 groups efficiently
2025-10-17 10:24:33,223 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:24:35,069 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:24:42,371 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:24:45,470 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 10:24:45,486 - DEBUG - Creating converter from 5 to 3
2025-10-17 10:24:46,627 - INFO - Outputs saved to /tmp/tmppj09oany/training/training_nphotons_500000.0_e2e
2025-10-17 10:25:04,880 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 10:25:05,054 - DEBUG - Creating converter from 7 to 5
2025-10-17 10:25:05,054 - DEBUG - Creating converter from 5 to 7
2025-10-17 10:25:05,055 - DEBUG - Creating converter from 7 to 5
2025-10-17 10:25:05,055 - DEBUG - Creating converter from 5 to 7
2025-10-17 10:25:05,663 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 10:25:05,670 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 10:25:05,671 - DEBUG - interactive is False
2025-10-17 10:25:05,671 - DEBUG - platform is linux
2025-10-17 10:25:05,699 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 10:25:05,701 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 10:25:06,761 - DEBUG - Field: train_data_file
2025-10-17 10:25:06,761 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 10:25:06,761 - DEBUG - Field default: None
2025-10-17 10:25:06,761 - DEBUG - Field: test_data_file
2025-10-17 10:25:06,761 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 10:25:06,761 - DEBUG - Field default: None
2025-10-17 10:25:06,761 - DEBUG - Field: output_dir
2025-10-17 10:25:06,761 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 10:25:06,761 - DEBUG - Field default: training_outputs
2025-10-17 10:25:06,761 - DEBUG - Converting path value: /tmp/tmp3lo1g457/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 10:25:06,761 - DEBUG - Converting path value: /tmp/tmp3lo1g457/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 10:25:06,761 - DEBUG - Converting path value: /tmp/tmp3lo1g457/training/training_nphotons_1000000.0_single
2025-10-17 10:25:06,762 - DEBUG - YAML config: {}
2025-10-17 10:25:06,762 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp3lo1g457/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmp3lo1g457/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp3lo1g457/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-17 10:25:06,762 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp3lo1g457/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmp3lo1g457/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp3lo1g457/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-17 10:25:06,762 - INFO - Configuration setup complete
2025-10-17 10:25:06,762 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp3lo1g457/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmp3lo1g457/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp3lo1g457/training/training_nphotons_1000000.0_single'), sequential_sampling=False)
2025-10-17 10:25:06,762 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 10:25:06,762 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 10:25:06,762 - INFO - Loading data from /tmp/tmp3lo1g457/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-17 10:25:06,768 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 10:25:06,769 - INFO - Randomly subsampled 50 images
2025-10-17 10:25:06,780 - DEBUG - Loaded metadata from /tmp/tmp3lo1g457/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 10:25:06,780 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-17 10:25:06,780 - INFO - Loading data from /tmp/tmp3lo1g457/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-17 10:25:06,786 - INFO - Using full dataset of 100 images
2025-10-17 10:25:06,786 - INFO - Loaded test data from /tmp/tmp3lo1g457/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 10:25:06,786 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 10:25:06,786 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 10:25:06,786 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 10:25:06,786 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 10:25:06,786 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 10:25:06,786 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 10:25:06,786 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 10:25:06,787 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 10:25:06,787 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 10:25:06,787 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 10:25:06,787 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 10:25:06,787 - INFO - Using all 50 points as seeds
2025-10-17 10:25:06,787 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 10:25:06,787 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 10:25:06,787 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 10:25:06,787 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 10:25:06,787 - INFO - Generated 50 groups efficiently
2025-10-17 10:25:08,348 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 10:25:08,349 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 10:25:08,349 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 10:25:08,349 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 10:25:08,349 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 10:25:08,349 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 10:25:08,349 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 10:25:08,349 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 10:25:08,349 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 10:25:08,349 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 10:25:08,349 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 10:25:08,349 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 10:25:08,349 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 10:25:08,349 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 10:25:08,349 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 10:25:08,349 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 10:25:08,349 - INFO - Generated 50 groups efficiently
2025-10-17 10:25:10,327 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:25:12,189 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:25:19,476 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:25:22,673 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 10:25:22,689 - DEBUG - Creating converter from 5 to 3
2025-10-17 10:25:23,825 - INFO - Outputs saved to /tmp/tmp3lo1g457/training/training_nphotons_1000000.0_single
2025-10-17 10:25:59,686 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 10:25:59,862 - DEBUG - Creating converter from 7 to 5
2025-10-17 10:25:59,862 - DEBUG - Creating converter from 5 to 7
2025-10-17 10:25:59,862 - DEBUG - Creating converter from 7 to 5
2025-10-17 10:25:59,862 - DEBUG - Creating converter from 5 to 7
2025-10-17 10:26:00,467 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 10:26:00,474 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 10:26:00,475 - DEBUG - interactive is False
2025-10-17 10:26:00,475 - DEBUG - platform is linux
2025-10-17 10:26:00,504 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 10:26:00,505 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 10:26:01,566 - DEBUG - Field: train_data_file
2025-10-17 10:26:01,566 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 10:26:01,566 - DEBUG - Field default: None
2025-10-17 10:26:01,566 - DEBUG - Field: test_data_file
2025-10-17 10:26:01,566 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 10:26:01,566 - DEBUG - Field default: None
2025-10-17 10:26:01,567 - DEBUG - Field: output_dir
2025-10-17 10:26:01,567 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 10:26:01,567 - DEBUG - Field default: training_outputs
2025-10-17 10:26:01,567 - DEBUG - Converting path value: /tmp/tmpo8p0sera/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 10:26:01,567 - DEBUG - Converting path value: /tmp/tmpo8p0sera/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 10:26:01,567 - DEBUG - Converting path value: /tmp/tmpo8p0sera/training/training_mismatch_test
2025-10-17 10:26:01,567 - DEBUG - YAML config: {}
2025-10-17 10:26:01,567 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpo8p0sera/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpo8p0sera/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpo8p0sera/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-17 10:26:01,567 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpo8p0sera/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpo8p0sera/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpo8p0sera/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-17 10:26:01,567 - INFO - Configuration setup complete
2025-10-17 10:26:01,567 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpo8p0sera/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmpo8p0sera/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpo8p0sera/training/training_mismatch_test'), sequential_sampling=False)
2025-10-17 10:26:01,567 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 10:26:01,567 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 10:26:01,567 - INFO - Loading data from /tmp/tmpo8p0sera/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-17 10:26:01,573 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 10:26:01,573 - INFO - Randomly subsampled 50 images
2025-10-17 10:26:01,583 - DEBUG - Loaded metadata from /tmp/tmpo8p0sera/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 10:26:01,583 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-17 10:26:01,583 - INFO - Loading data from /tmp/tmpo8p0sera/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-17 10:26:01,587 - INFO - Using full dataset of 100 images
2025-10-17 10:26:01,588 - INFO - Loaded test data from /tmp/tmpo8p0sera/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 10:26:01,588 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 10:26:01,588 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 10:26:01,588 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 10:26:01,588 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 10:26:01,588 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 10:26:01,588 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 10:26:01,588 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 10:26:01,588 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 10:26:01,588 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 10:26:01,588 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 10:26:01,588 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 10:26:01,588 - INFO - Using all 50 points as seeds
2025-10-17 10:26:01,588 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 10:26:01,588 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 10:26:01,588 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 10:26:01,588 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 10:26:01,588 - INFO - Generated 50 groups efficiently
2025-10-17 10:26:03,174 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 10:26:03,174 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 10:26:03,174 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 10:26:03,174 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 10:26:03,174 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 10:26:03,174 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 10:26:03,174 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 10:26:03,174 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 10:26:03,174 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 10:26:03,174 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 10:26:03,174 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 10:26:03,174 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 10:26:03,174 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 10:26:03,174 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 10:26:03,174 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 10:26:03,174 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 10:26:03,174 - INFO - Generated 50 groups efficiently
2025-10-17 10:26:05,151 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:26:07,022 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:26:14,233 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:26:17,381 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 10:26:17,399 - DEBUG - Creating converter from 5 to 3
2025-10-17 10:26:18,521 - INFO - Outputs saved to /tmp/tmpo8p0sera/training/training_mismatch_test
2025-10-17 10:53:05,774 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 10:53:05,948 - DEBUG - Creating converter from 7 to 5
2025-10-17 10:53:05,948 - DEBUG - Creating converter from 5 to 7
2025-10-17 10:53:05,948 - DEBUG - Creating converter from 7 to 5
2025-10-17 10:53:05,948 - DEBUG - Creating converter from 5 to 7
2025-10-17 10:53:06,546 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 10:53:06,554 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 10:53:06,554 - DEBUG - interactive is False
2025-10-17 10:53:06,554 - DEBUG - platform is linux
2025-10-17 10:53:06,583 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 10:53:06,585 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 10:53:07,606 - DEBUG - Field: train_data_file
2025-10-17 10:53:07,606 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 10:53:07,606 - DEBUG - Field default: None
2025-10-17 10:53:07,606 - DEBUG - Field: test_data_file
2025-10-17 10:53:07,606 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 10:53:07,606 - DEBUG - Field default: None
2025-10-17 10:53:07,606 - DEBUG - Field: output_dir
2025-10-17 10:53:07,606 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 10:53:07,606 - DEBUG - Field default: training_outputs
2025-10-17 10:53:07,606 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 10:53:07,606 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 10:53:07,606 - DEBUG - Converting path value: /tmp/tmpmdn3o0bx/training_outputs
2025-10-17 10:53:07,606 - DEBUG - YAML config: {}
2025-10-17 10:53:07,606 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpmdn3o0bx/training_outputs'), 'sequential_sampling': False}
2025-10-17 10:53:07,606 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpmdn3o0bx/training_outputs'), 'sequential_sampling': False}
2025-10-17 10:53:07,607 - INFO - Configuration setup complete
2025-10-17 10:53:07,607 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpmdn3o0bx/training_outputs'), sequential_sampling=False)
2025-10-17 10:53:07,607 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-17 10:53:07,607 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-17 10:53:07,607 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-17 10:53:07,622 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-17 10:53:07,622 - INFO - Randomly subsampled 64 images
2025-10-17 10:53:07,642 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-17 10:53:07,657 - INFO - Using full dataset of 1087 images
2025-10-17 10:53:07,672 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 10:53:07,672 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-17 10:53:07,672 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 10:53:07,672 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-17 10:53:07,673 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 10:53:07,673 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 10:53:07,673 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 10:53:07,673 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 10:53:07,673 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-17 10:53:07,673 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-17 10:53:07,673 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-17 10:53:07,673 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-17 10:53:07,673 - INFO - Using all 64 points as seeds
2025-10-17 10:53:07,673 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 10:53:07,673 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-17 10:53:07,673 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-17 10:53:07,673 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-17 10:53:07,673 - INFO - Generated 64 groups efficiently
2025-10-17 10:53:09,256 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-17 10:53:09,256 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 10:53:09,256 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-17 10:53:09,256 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 10:53:09,256 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 10:53:09,256 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 10:53:09,256 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 10:53:09,256 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-17 10:53:09,256 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-17 10:53:09,256 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-17 10:53:09,256 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-17 10:53:09,256 - INFO - Sampled 64 seed points from 1087 total points
2025-10-17 10:53:09,256 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 10:53:09,256 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-17 10:53:09,256 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-17 10:53:09,256 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-17 10:53:09,256 - INFO - Generated 64 groups efficiently
2025-10-17 10:53:11,303 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:53:13,160 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:53:20,213 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:53:22,182 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 10:53:22,397 - DEBUG - Creating converter from 5 to 3
2025-10-17 10:53:23,533 - INFO - Outputs saved to /tmp/tmpmdn3o0bx/training_outputs
2025-10-17 10:53:47,683 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 10:53:47,859 - DEBUG - Creating converter from 7 to 5
2025-10-17 10:53:47,859 - DEBUG - Creating converter from 5 to 7
2025-10-17 10:53:47,859 - DEBUG - Creating converter from 7 to 5
2025-10-17 10:53:47,859 - DEBUG - Creating converter from 5 to 7
2025-10-17 10:53:48,463 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 10:53:48,471 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 10:53:48,471 - DEBUG - interactive is False
2025-10-17 10:53:48,471 - DEBUG - platform is linux
2025-10-17 10:53:48,502 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 10:53:48,503 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 10:53:49,603 - DEBUG - Field: train_data_file
2025-10-17 10:53:49,603 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 10:53:49,603 - DEBUG - Field default: None
2025-10-17 10:53:49,603 - DEBUG - Field: test_data_file
2025-10-17 10:53:49,603 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 10:53:49,603 - DEBUG - Field default: None
2025-10-17 10:53:49,603 - DEBUG - Field: output_dir
2025-10-17 10:53:49,603 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 10:53:49,603 - DEBUG - Field default: training_outputs
2025-10-17 10:53:49,603 - DEBUG - Converting path value: /tmp/tmpcnsot1hk/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 10:53:49,603 - DEBUG - Converting path value: /tmp/tmpcnsot1hk/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 10:53:49,603 - DEBUG - Converting path value: /tmp/tmpcnsot1hk/training/training_nphotons_500000.0_e2e
2025-10-17 10:53:49,603 - DEBUG - YAML config: {}
2025-10-17 10:53:49,603 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpcnsot1hk/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpcnsot1hk/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpcnsot1hk/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-17 10:53:49,603 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpcnsot1hk/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpcnsot1hk/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpcnsot1hk/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-17 10:53:49,603 - INFO - Configuration setup complete
2025-10-17 10:53:49,603 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpcnsot1hk/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmpcnsot1hk/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpcnsot1hk/training/training_nphotons_500000.0_e2e'), sequential_sampling=False)
2025-10-17 10:53:49,603 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 10:53:49,604 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 10:53:49,604 - INFO - Loading data from /tmp/tmpcnsot1hk/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-17 10:53:49,610 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 10:53:49,610 - INFO - Randomly subsampled 50 images
2025-10-17 10:53:49,621 - DEBUG - Loaded metadata from /tmp/tmpcnsot1hk/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 10:53:49,621 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-17 10:53:49,621 - INFO - Loading data from /tmp/tmpcnsot1hk/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-17 10:53:49,626 - INFO - Using full dataset of 100 images
2025-10-17 10:53:49,627 - INFO - Loaded test data from /tmp/tmpcnsot1hk/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 10:53:49,627 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 10:53:49,627 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 10:53:49,627 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 10:53:49,627 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 10:53:49,627 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 10:53:49,627 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 10:53:49,627 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 10:53:49,627 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 10:53:49,627 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 10:53:49,627 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 10:53:49,627 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 10:53:49,627 - INFO - Using all 50 points as seeds
2025-10-17 10:53:49,627 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 10:53:49,627 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 10:53:49,627 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 10:53:49,627 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 10:53:49,627 - INFO - Generated 50 groups efficiently
2025-10-17 10:53:51,193 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 10:53:51,193 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 10:53:51,193 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 10:53:51,193 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 10:53:51,193 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 10:53:51,193 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 10:53:51,193 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 10:53:51,193 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 10:53:51,193 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 10:53:51,193 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 10:53:51,194 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 10:53:51,194 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 10:53:51,194 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 10:53:51,194 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 10:53:51,194 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 10:53:51,194 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 10:53:51,194 - INFO - Generated 50 groups efficiently
2025-10-17 10:53:53,167 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:53:55,022 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:54:02,355 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:54:05,533 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 10:54:05,551 - DEBUG - Creating converter from 5 to 3
2025-10-17 10:54:06,684 - INFO - Outputs saved to /tmp/tmpcnsot1hk/training/training_nphotons_500000.0_e2e
2025-10-17 10:54:25,068 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 10:54:25,246 - DEBUG - Creating converter from 7 to 5
2025-10-17 10:54:25,246 - DEBUG - Creating converter from 5 to 7
2025-10-17 10:54:25,247 - DEBUG - Creating converter from 7 to 5
2025-10-17 10:54:25,247 - DEBUG - Creating converter from 5 to 7
2025-10-17 10:54:25,867 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 10:54:25,874 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 10:54:25,874 - DEBUG - interactive is False
2025-10-17 10:54:25,874 - DEBUG - platform is linux
2025-10-17 10:54:25,903 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 10:54:25,905 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 10:54:26,967 - DEBUG - Field: train_data_file
2025-10-17 10:54:26,967 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 10:54:26,967 - DEBUG - Field default: None
2025-10-17 10:54:26,967 - DEBUG - Field: test_data_file
2025-10-17 10:54:26,967 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 10:54:26,967 - DEBUG - Field default: None
2025-10-17 10:54:26,967 - DEBUG - Field: output_dir
2025-10-17 10:54:26,967 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 10:54:26,967 - DEBUG - Field default: training_outputs
2025-10-17 10:54:26,967 - DEBUG - Converting path value: /tmp/tmpqz_jvo0m/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 10:54:26,967 - DEBUG - Converting path value: /tmp/tmpqz_jvo0m/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 10:54:26,967 - DEBUG - Converting path value: /tmp/tmpqz_jvo0m/training/training_nphotons_1000000.0_single
2025-10-17 10:54:26,967 - DEBUG - YAML config: {}
2025-10-17 10:54:26,967 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpqz_jvo0m/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpqz_jvo0m/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpqz_jvo0m/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-17 10:54:26,967 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpqz_jvo0m/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpqz_jvo0m/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpqz_jvo0m/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-17 10:54:26,967 - INFO - Configuration setup complete
2025-10-17 10:54:26,967 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpqz_jvo0m/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmpqz_jvo0m/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpqz_jvo0m/training/training_nphotons_1000000.0_single'), sequential_sampling=False)
2025-10-17 10:54:26,967 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 10:54:26,968 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 10:54:26,968 - INFO - Loading data from /tmp/tmpqz_jvo0m/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-17 10:54:26,974 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 10:54:26,974 - INFO - Randomly subsampled 50 images
2025-10-17 10:54:26,986 - DEBUG - Loaded metadata from /tmp/tmpqz_jvo0m/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 10:54:26,986 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-17 10:54:26,986 - INFO - Loading data from /tmp/tmpqz_jvo0m/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-17 10:54:26,991 - INFO - Using full dataset of 100 images
2025-10-17 10:54:26,992 - INFO - Loaded test data from /tmp/tmpqz_jvo0m/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 10:54:26,992 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 10:54:26,992 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 10:54:26,992 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 10:54:26,992 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 10:54:26,992 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 10:54:26,992 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 10:54:26,992 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 10:54:26,992 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 10:54:26,992 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 10:54:26,992 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 10:54:26,992 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 10:54:26,992 - INFO - Using all 50 points as seeds
2025-10-17 10:54:26,992 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 10:54:26,992 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 10:54:26,992 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 10:54:26,992 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 10:54:26,992 - INFO - Generated 50 groups efficiently
2025-10-17 10:54:28,574 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 10:54:28,574 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 10:54:28,574 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 10:54:28,575 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 10:54:28,575 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 10:54:28,575 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 10:54:28,575 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 10:54:28,575 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 10:54:28,575 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 10:54:28,575 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 10:54:28,575 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 10:54:28,575 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 10:54:28,575 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 10:54:28,575 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 10:54:28,575 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 10:54:28,575 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 10:54:28,575 - INFO - Generated 50 groups efficiently
2025-10-17 10:54:30,575 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:54:32,461 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:54:39,776 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:54:42,893 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 10:54:42,911 - DEBUG - Creating converter from 5 to 3
2025-10-17 10:54:44,054 - INFO - Outputs saved to /tmp/tmpqz_jvo0m/training/training_nphotons_1000000.0_single
2025-10-17 10:55:19,919 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 10:55:20,095 - DEBUG - Creating converter from 7 to 5
2025-10-17 10:55:20,095 - DEBUG - Creating converter from 5 to 7
2025-10-17 10:55:20,095 - DEBUG - Creating converter from 7 to 5
2025-10-17 10:55:20,095 - DEBUG - Creating converter from 5 to 7
2025-10-17 10:55:20,712 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 10:55:20,719 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 10:55:20,719 - DEBUG - interactive is False
2025-10-17 10:55:20,719 - DEBUG - platform is linux
2025-10-17 10:55:20,748 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 10:55:20,750 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 10:55:21,819 - DEBUG - Field: train_data_file
2025-10-17 10:55:21,819 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 10:55:21,819 - DEBUG - Field default: None
2025-10-17 10:55:21,819 - DEBUG - Field: test_data_file
2025-10-17 10:55:21,819 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 10:55:21,819 - DEBUG - Field default: None
2025-10-17 10:55:21,820 - DEBUG - Field: output_dir
2025-10-17 10:55:21,820 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 10:55:21,820 - DEBUG - Field default: training_outputs
2025-10-17 10:55:21,820 - DEBUG - Converting path value: /tmp/tmpzwfq7whb/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 10:55:21,820 - DEBUG - Converting path value: /tmp/tmpzwfq7whb/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 10:55:21,820 - DEBUG - Converting path value: /tmp/tmpzwfq7whb/training/training_mismatch_test
2025-10-17 10:55:21,820 - DEBUG - YAML config: {}
2025-10-17 10:55:21,820 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpzwfq7whb/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpzwfq7whb/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpzwfq7whb/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-17 10:55:21,820 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpzwfq7whb/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpzwfq7whb/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpzwfq7whb/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-17 10:55:21,820 - INFO - Configuration setup complete
2025-10-17 10:55:21,820 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpzwfq7whb/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmpzwfq7whb/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpzwfq7whb/training/training_mismatch_test'), sequential_sampling=False)
2025-10-17 10:55:21,820 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 10:55:21,820 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 10:55:21,820 - INFO - Loading data from /tmp/tmpzwfq7whb/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-17 10:55:21,826 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 10:55:21,826 - INFO - Randomly subsampled 50 images
2025-10-17 10:55:21,836 - DEBUG - Loaded metadata from /tmp/tmpzwfq7whb/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 10:55:21,836 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-17 10:55:21,836 - INFO - Loading data from /tmp/tmpzwfq7whb/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-17 10:55:21,840 - INFO - Using full dataset of 100 images
2025-10-17 10:55:21,841 - INFO - Loaded test data from /tmp/tmpzwfq7whb/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 10:55:21,841 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 10:55:21,841 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 10:55:21,841 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 10:55:21,841 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 10:55:21,841 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 10:55:21,841 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 10:55:21,841 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 10:55:21,841 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 10:55:21,841 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 10:55:21,841 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 10:55:21,841 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 10:55:21,841 - INFO - Using all 50 points as seeds
2025-10-17 10:55:21,841 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 10:55:21,841 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 10:55:21,841 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 10:55:21,841 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 10:55:21,841 - INFO - Generated 50 groups efficiently
2025-10-17 10:55:23,383 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 10:55:23,383 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 10:55:23,383 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 10:55:23,383 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 10:55:23,383 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 10:55:23,383 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 10:55:23,383 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 10:55:23,383 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 10:55:23,383 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 10:55:23,383 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 10:55:23,383 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 10:55:23,383 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 10:55:23,383 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 10:55:23,383 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 10:55:23,383 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 10:55:23,383 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 10:55:23,383 - INFO - Generated 50 groups efficiently
2025-10-17 10:55:25,365 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:55:27,225 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:55:34,379 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 10:55:37,507 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 10:55:37,523 - DEBUG - Creating converter from 5 to 3
2025-10-17 10:55:38,649 - INFO - Outputs saved to /tmp/tmpzwfq7whb/training/training_mismatch_test
