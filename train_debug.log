2025-11-04 00:35:54,574 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-11-04 00:35:54,755 - DEBUG - Creating converter from 7 to 5
2025-11-04 00:35:54,756 - DEBUG - Creating converter from 5 to 7
2025-11-04 00:35:54,756 - DEBUG - Creating converter from 7 to 5
2025-11-04 00:35:54,756 - DEBUG - Creating converter from 5 to 7
2025-11-04 00:35:55,385 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-11-04 00:35:55,392 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-11-04 00:35:55,393 - DEBUG - interactive is False
2025-11-04 00:35:55,393 - DEBUG - platform is linux
2025-11-04 00:35:55,422 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-11-04 00:35:55,423 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-11-04 00:35:56,472 - DEBUG - Field: train_data_file
2025-11-04 00:35:56,472 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 00:35:56,472 - DEBUG - Field default: None
2025-11-04 00:35:56,472 - DEBUG - Field: test_data_file
2025-11-04 00:35:56,472 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 00:35:56,472 - DEBUG - Field default: None
2025-11-04 00:35:56,472 - DEBUG - Field: output_dir
2025-11-04 00:35:56,472 - DEBUG - Field type: <class 'pathlib.Path'>
2025-11-04 00:35:56,472 - DEBUG - Field default: training_outputs
2025-11-04 00:35:56,472 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-11-04 00:35:56,472 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-11-04 00:35:56,472 - DEBUG - Converting path value: /tmp/tmp952gj4ev/training_outputs
2025-11-04 00:35:56,473 - DEBUG - YAML config: {}
2025-11-04 00:35:56,473 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp952gj4ev/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 00:35:56,473 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp952gj4ev/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 00:35:56,473 - INFO - Configuration setup complete
2025-11-04 00:35:56,473 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp952gj4ev/training_outputs'), sequential_sampling=False, backend='tensorflow')
2025-11-04 00:35:56,473 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-11-04 00:35:56,473 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-11-04 00:35:56,473 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-11-04 00:35:56,490 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-11-04 00:35:56,490 - INFO - Randomly subsampled 64 images
2025-11-04 00:35:56,508 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-11-04 00:35:56,523 - INFO - Using full dataset of 1087 images
2025-11-04 00:35:56,538 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-11-04 00:35:56,539 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-11-04 00:35:56,539 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 00:35:56,539 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-11-04 00:35:56,539 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 00:35:56,539 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 00:35:56,539 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 00:35:56,539 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 00:35:56,539 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-11-04 00:35:56,539 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-11-04 00:35:56,539 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-11-04 00:35:56,539 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-11-04 00:35:56,539 - INFO - Using all 64 points as seeds
2025-11-04 00:35:56,539 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 00:35:56,539 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-11-04 00:35:56,539 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-11-04 00:35:56,539 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-11-04 00:35:56,539 - INFO - Generated 64 groups efficiently
2025-11-04 00:35:58,119 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-11-04 00:35:58,119 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 00:35:58,119 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-11-04 00:35:58,119 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 00:35:58,119 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 00:35:58,119 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 00:35:58,119 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 00:35:58,119 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-11-04 00:35:58,119 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-11-04 00:35:58,119 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-11-04 00:35:58,120 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-11-04 00:35:58,120 - INFO - Sampled 64 seed points from 1087 total points
2025-11-04 00:35:58,120 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 00:35:58,120 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-11-04 00:35:58,120 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-11-04 00:35:58,120 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-11-04 00:35:58,120 - INFO - Generated 64 groups efficiently
2025-11-04 00:36:00,177 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 00:36:02,038 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 00:36:09,387 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 00:36:11,356 - INFO - Skipping image stitching (disabled or no test data available)
2025-11-04 00:36:11,573 - DEBUG - Creating converter from 5 to 3
2025-11-04 00:36:12,709 - INFO - Outputs saved to /tmp/tmp952gj4ev/training_outputs
2025-11-04 00:36:37,189 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-11-04 00:36:37,360 - DEBUG - Creating converter from 7 to 5
2025-11-04 00:36:37,360 - DEBUG - Creating converter from 5 to 7
2025-11-04 00:36:37,360 - DEBUG - Creating converter from 7 to 5
2025-11-04 00:36:37,360 - DEBUG - Creating converter from 5 to 7
2025-11-04 00:36:37,968 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-11-04 00:36:37,976 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-11-04 00:36:37,977 - DEBUG - interactive is False
2025-11-04 00:36:37,977 - DEBUG - platform is linux
2025-11-04 00:36:38,008 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-11-04 00:36:38,009 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-11-04 00:36:39,069 - DEBUG - Field: train_data_file
2025-11-04 00:36:39,069 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 00:36:39,069 - DEBUG - Field default: None
2025-11-04 00:36:39,069 - DEBUG - Field: test_data_file
2025-11-04 00:36:39,069 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 00:36:39,069 - DEBUG - Field default: None
2025-11-04 00:36:39,070 - DEBUG - Field: output_dir
2025-11-04 00:36:39,070 - DEBUG - Field type: <class 'pathlib.Path'>
2025-11-04 00:36:39,070 - DEBUG - Field default: training_outputs
2025-11-04 00:36:39,070 - DEBUG - Converting path value: /tmp/tmpg8ceze2b/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-11-04 00:36:39,070 - DEBUG - Converting path value: /tmp/tmpg8ceze2b/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-11-04 00:36:39,070 - DEBUG - Converting path value: /tmp/tmpg8ceze2b/training/training_nphotons_500000.0_e2e
2025-11-04 00:36:39,070 - DEBUG - YAML config: {}
2025-11-04 00:36:39,070 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpg8ceze2b/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpg8ceze2b/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpg8ceze2b/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 00:36:39,070 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpg8ceze2b/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpg8ceze2b/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpg8ceze2b/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 00:36:39,070 - INFO - Configuration setup complete
2025-11-04 00:36:39,070 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpg8ceze2b/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmpg8ceze2b/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpg8ceze2b/training/training_nphotons_500000.0_e2e'), sequential_sampling=False, backend='tensorflow')
2025-11-04 00:36:39,070 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-11-04 00:36:39,070 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-11-04 00:36:39,070 - INFO - Loading data from /tmp/tmpg8ceze2b/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-11-04 00:36:39,077 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-11-04 00:36:39,077 - INFO - Randomly subsampled 50 images
2025-11-04 00:36:39,088 - DEBUG - Loaded metadata from /tmp/tmpg8ceze2b/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-11-04 00:36:39,088 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-11-04 00:36:39,088 - INFO - Loading data from /tmp/tmpg8ceze2b/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-11-04 00:36:39,094 - INFO - Using full dataset of 100 images
2025-11-04 00:36:39,094 - INFO - Loaded test data from /tmp/tmpg8ceze2b/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-11-04 00:36:39,095 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-11-04 00:36:39,095 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 00:36:39,095 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-11-04 00:36:39,095 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 00:36:39,095 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 00:36:39,095 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 00:36:39,095 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 00:36:39,095 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-11-04 00:36:39,095 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-11-04 00:36:39,095 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-11-04 00:36:39,095 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-11-04 00:36:39,095 - INFO - Using all 50 points as seeds
2025-11-04 00:36:39,095 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 00:36:39,095 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-11-04 00:36:39,095 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-11-04 00:36:39,095 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-11-04 00:36:39,095 - INFO - Generated 50 groups efficiently
2025-11-04 00:36:40,659 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-11-04 00:36:40,659 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 00:36:40,659 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-11-04 00:36:40,659 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 00:36:40,659 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 00:36:40,660 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 00:36:40,660 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 00:36:40,660 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-11-04 00:36:40,660 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-11-04 00:36:40,660 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-11-04 00:36:40,660 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-11-04 00:36:40,660 - INFO - Sampled 50 seed points from 100 total points
2025-11-04 00:36:40,660 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 00:36:40,660 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-11-04 00:36:40,660 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-11-04 00:36:40,660 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-11-04 00:36:40,660 - INFO - Generated 50 groups efficiently
2025-11-04 00:36:42,648 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 00:36:44,510 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 00:36:51,781 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 00:36:54,967 - INFO - Skipping image stitching (disabled or no test data available)
2025-11-04 00:36:54,983 - DEBUG - Creating converter from 5 to 3
2025-11-04 00:36:56,113 - INFO - Outputs saved to /tmp/tmpg8ceze2b/training/training_nphotons_500000.0_e2e
2025-11-04 00:37:14,521 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-11-04 00:37:14,691 - DEBUG - Creating converter from 7 to 5
2025-11-04 00:37:14,691 - DEBUG - Creating converter from 5 to 7
2025-11-04 00:37:14,692 - DEBUG - Creating converter from 7 to 5
2025-11-04 00:37:14,692 - DEBUG - Creating converter from 5 to 7
2025-11-04 00:37:15,306 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-11-04 00:37:15,313 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-11-04 00:37:15,314 - DEBUG - interactive is False
2025-11-04 00:37:15,314 - DEBUG - platform is linux
2025-11-04 00:37:15,343 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-11-04 00:37:15,344 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-11-04 00:37:16,404 - DEBUG - Field: train_data_file
2025-11-04 00:37:16,405 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 00:37:16,405 - DEBUG - Field default: None
2025-11-04 00:37:16,405 - DEBUG - Field: test_data_file
2025-11-04 00:37:16,405 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 00:37:16,405 - DEBUG - Field default: None
2025-11-04 00:37:16,405 - DEBUG - Field: output_dir
2025-11-04 00:37:16,405 - DEBUG - Field type: <class 'pathlib.Path'>
2025-11-04 00:37:16,405 - DEBUG - Field default: training_outputs
2025-11-04 00:37:16,405 - DEBUG - Converting path value: /tmp/tmp90rshayv/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-11-04 00:37:16,405 - DEBUG - Converting path value: /tmp/tmp90rshayv/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-11-04 00:37:16,405 - DEBUG - Converting path value: /tmp/tmp90rshayv/training/training_nphotons_1000000.0_single
2025-11-04 00:37:16,405 - DEBUG - YAML config: {}
2025-11-04 00:37:16,405 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp90rshayv/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmp90rshayv/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp90rshayv/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 00:37:16,405 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp90rshayv/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmp90rshayv/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp90rshayv/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 00:37:16,405 - INFO - Configuration setup complete
2025-11-04 00:37:16,405 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp90rshayv/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmp90rshayv/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp90rshayv/training/training_nphotons_1000000.0_single'), sequential_sampling=False, backend='tensorflow')
2025-11-04 00:37:16,405 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-11-04 00:37:16,405 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-11-04 00:37:16,405 - INFO - Loading data from /tmp/tmp90rshayv/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-11-04 00:37:16,412 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-11-04 00:37:16,412 - INFO - Randomly subsampled 50 images
2025-11-04 00:37:16,424 - DEBUG - Loaded metadata from /tmp/tmp90rshayv/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-11-04 00:37:16,424 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-11-04 00:37:16,424 - INFO - Loading data from /tmp/tmp90rshayv/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-11-04 00:37:16,429 - INFO - Using full dataset of 100 images
2025-11-04 00:37:16,430 - INFO - Loaded test data from /tmp/tmp90rshayv/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-11-04 00:37:16,430 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-11-04 00:37:16,430 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 00:37:16,430 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-11-04 00:37:16,430 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 00:37:16,430 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 00:37:16,431 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 00:37:16,431 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 00:37:16,431 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-11-04 00:37:16,431 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-11-04 00:37:16,431 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-11-04 00:37:16,431 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-11-04 00:37:16,431 - INFO - Using all 50 points as seeds
2025-11-04 00:37:16,431 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 00:37:16,431 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-11-04 00:37:16,431 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-11-04 00:37:16,431 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-11-04 00:37:16,431 - INFO - Generated 50 groups efficiently
2025-11-04 00:37:17,988 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-11-04 00:37:17,988 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 00:37:17,988 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-11-04 00:37:17,988 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 00:37:17,988 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 00:37:17,988 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 00:37:17,988 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 00:37:17,988 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-11-04 00:37:17,988 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-11-04 00:37:17,988 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-11-04 00:37:17,988 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-11-04 00:37:17,988 - INFO - Sampled 50 seed points from 100 total points
2025-11-04 00:37:17,988 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 00:37:17,988 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-11-04 00:37:17,988 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-11-04 00:37:17,988 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-11-04 00:37:17,988 - INFO - Generated 50 groups efficiently
2025-11-04 00:37:20,025 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 00:37:21,879 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 00:37:29,138 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 00:37:32,281 - INFO - Skipping image stitching (disabled or no test data available)
2025-11-04 00:37:32,297 - DEBUG - Creating converter from 5 to 3
2025-11-04 00:37:33,433 - INFO - Outputs saved to /tmp/tmp90rshayv/training/training_nphotons_1000000.0_single
2025-11-04 00:38:09,524 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-11-04 00:38:09,704 - DEBUG - Creating converter from 7 to 5
2025-11-04 00:38:09,704 - DEBUG - Creating converter from 5 to 7
2025-11-04 00:38:09,704 - DEBUG - Creating converter from 7 to 5
2025-11-04 00:38:09,704 - DEBUG - Creating converter from 5 to 7
2025-11-04 00:38:10,336 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-11-04 00:38:10,344 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-11-04 00:38:10,344 - DEBUG - interactive is False
2025-11-04 00:38:10,344 - DEBUG - platform is linux
2025-11-04 00:38:10,374 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-11-04 00:38:10,375 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-11-04 00:38:11,441 - DEBUG - Field: train_data_file
2025-11-04 00:38:11,441 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 00:38:11,441 - DEBUG - Field default: None
2025-11-04 00:38:11,441 - DEBUG - Field: test_data_file
2025-11-04 00:38:11,441 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 00:38:11,441 - DEBUG - Field default: None
2025-11-04 00:38:11,441 - DEBUG - Field: output_dir
2025-11-04 00:38:11,441 - DEBUG - Field type: <class 'pathlib.Path'>
2025-11-04 00:38:11,441 - DEBUG - Field default: training_outputs
2025-11-04 00:38:11,441 - DEBUG - Converting path value: /tmp/tmp1ax5swjs/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-11-04 00:38:11,442 - DEBUG - Converting path value: /tmp/tmp1ax5swjs/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-11-04 00:38:11,442 - DEBUG - Converting path value: /tmp/tmp1ax5swjs/training/training_mismatch_test
2025-11-04 00:38:11,442 - DEBUG - YAML config: {}
2025-11-04 00:38:11,442 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp1ax5swjs/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmp1ax5swjs/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp1ax5swjs/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 00:38:11,442 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp1ax5swjs/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmp1ax5swjs/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp1ax5swjs/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 00:38:11,442 - INFO - Configuration setup complete
2025-11-04 00:38:11,442 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp1ax5swjs/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmp1ax5swjs/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp1ax5swjs/training/training_mismatch_test'), sequential_sampling=False, backend='tensorflow')
2025-11-04 00:38:11,442 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-11-04 00:38:11,442 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-11-04 00:38:11,442 - INFO - Loading data from /tmp/tmp1ax5swjs/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-11-04 00:38:11,448 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-11-04 00:38:11,448 - INFO - Randomly subsampled 50 images
2025-11-04 00:38:11,458 - DEBUG - Loaded metadata from /tmp/tmp1ax5swjs/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-11-04 00:38:11,458 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-11-04 00:38:11,458 - INFO - Loading data from /tmp/tmp1ax5swjs/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-11-04 00:38:11,463 - INFO - Using full dataset of 100 images
2025-11-04 00:38:11,463 - INFO - Loaded test data from /tmp/tmp1ax5swjs/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-11-04 00:38:11,463 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-11-04 00:38:11,463 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 00:38:11,463 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-11-04 00:38:11,463 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 00:38:11,463 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 00:38:11,463 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 00:38:11,463 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 00:38:11,463 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-11-04 00:38:11,463 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-11-04 00:38:11,463 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-11-04 00:38:11,463 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-11-04 00:38:11,463 - INFO - Using all 50 points as seeds
2025-11-04 00:38:11,464 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 00:38:11,464 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-11-04 00:38:11,464 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-11-04 00:38:11,464 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-11-04 00:38:11,464 - INFO - Generated 50 groups efficiently
2025-11-04 00:38:12,999 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-11-04 00:38:12,999 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 00:38:12,999 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-11-04 00:38:12,999 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 00:38:12,999 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 00:38:12,999 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 00:38:12,999 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 00:38:12,999 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-11-04 00:38:12,999 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-11-04 00:38:12,999 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-11-04 00:38:12,999 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-11-04 00:38:12,999 - INFO - Sampled 50 seed points from 100 total points
2025-11-04 00:38:12,999 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 00:38:12,999 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-11-04 00:38:12,999 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-11-04 00:38:12,999 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-11-04 00:38:12,999 - INFO - Generated 50 groups efficiently
2025-11-04 00:38:14,983 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 00:38:16,847 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 00:38:24,076 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 00:38:27,244 - INFO - Skipping image stitching (disabled or no test data available)
2025-11-04 00:38:27,259 - DEBUG - Creating converter from 5 to 3
2025-11-04 00:38:28,381 - INFO - Outputs saved to /tmp/tmp1ax5swjs/training/training_mismatch_test
2025-11-04 00:39:30,035 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-11-04 00:39:30,214 - DEBUG - Creating converter from 7 to 5
2025-11-04 00:39:30,214 - DEBUG - Creating converter from 5 to 7
2025-11-04 00:39:30,214 - DEBUG - Creating converter from 7 to 5
2025-11-04 00:39:30,214 - DEBUG - Creating converter from 5 to 7
2025-11-04 00:39:30,829 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-11-04 00:39:30,837 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-11-04 00:39:30,837 - DEBUG - interactive is False
2025-11-04 00:39:30,837 - DEBUG - platform is linux
2025-11-04 00:39:30,866 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-11-04 00:39:30,868 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-11-04 00:39:31,924 - DEBUG - Field: train_data_file
2025-11-04 00:39:31,924 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 00:39:31,924 - DEBUG - Field default: None
2025-11-04 00:39:31,924 - DEBUG - Field: test_data_file
2025-11-04 00:39:31,924 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 00:39:31,924 - DEBUG - Field default: None
2025-11-04 00:39:31,924 - DEBUG - Field: output_dir
2025-11-04 00:39:31,924 - DEBUG - Field type: <class 'pathlib.Path'>
2025-11-04 00:39:31,924 - DEBUG - Field default: training_outputs
2025-11-04 00:39:31,924 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-11-04 00:39:31,924 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-11-04 00:39:31,924 - DEBUG - Converting path value: /tmp/tmpsgoeedye/training_outputs
2025-11-04 00:39:31,924 - DEBUG - YAML config: {}
2025-11-04 00:39:31,924 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpsgoeedye/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 00:39:31,924 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpsgoeedye/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 00:39:31,924 - INFO - Configuration setup complete
2025-11-04 00:39:31,924 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpsgoeedye/training_outputs'), sequential_sampling=False, backend='tensorflow')
2025-11-04 00:39:31,925 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-11-04 00:39:31,925 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-11-04 00:39:31,925 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-11-04 00:39:31,942 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-11-04 00:39:31,942 - INFO - Randomly subsampled 64 images
2025-11-04 00:39:31,961 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-11-04 00:39:31,977 - INFO - Using full dataset of 1087 images
2025-11-04 00:39:31,992 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-11-04 00:39:31,993 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-11-04 00:39:31,993 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 00:39:31,993 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-11-04 00:39:31,993 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 00:39:31,993 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 00:39:31,993 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 00:39:31,993 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 00:39:31,993 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-11-04 00:39:31,993 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-11-04 00:39:31,993 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-11-04 00:39:31,993 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-11-04 00:39:31,993 - INFO - Using all 64 points as seeds
2025-11-04 00:39:31,993 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 00:39:31,993 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-11-04 00:39:31,993 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-11-04 00:39:31,993 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-11-04 00:39:31,993 - INFO - Generated 64 groups efficiently
2025-11-04 00:39:33,565 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-11-04 00:39:33,565 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 00:39:33,565 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-11-04 00:39:33,565 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 00:39:33,565 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 00:39:33,565 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 00:39:33,565 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 00:39:33,565 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-11-04 00:39:33,565 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-11-04 00:39:33,565 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-11-04 00:39:33,565 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-11-04 00:39:33,565 - INFO - Sampled 64 seed points from 1087 total points
2025-11-04 00:39:33,565 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 00:39:33,566 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-11-04 00:39:33,566 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-11-04 00:39:33,566 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-11-04 00:39:33,566 - INFO - Generated 64 groups efficiently
2025-11-04 00:39:35,623 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 00:39:37,501 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 00:39:44,739 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 00:39:46,719 - INFO - Skipping image stitching (disabled or no test data available)
2025-11-04 00:39:46,936 - DEBUG - Creating converter from 5 to 3
2025-11-04 00:39:48,077 - INFO - Outputs saved to /tmp/tmpsgoeedye/training_outputs
2025-11-04 00:40:12,389 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-11-04 00:40:12,567 - DEBUG - Creating converter from 7 to 5
2025-11-04 00:40:12,567 - DEBUG - Creating converter from 5 to 7
2025-11-04 00:40:12,567 - DEBUG - Creating converter from 7 to 5
2025-11-04 00:40:12,567 - DEBUG - Creating converter from 5 to 7
2025-11-04 00:40:13,193 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-11-04 00:40:13,201 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-11-04 00:40:13,201 - DEBUG - interactive is False
2025-11-04 00:40:13,201 - DEBUG - platform is linux
2025-11-04 00:40:13,231 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-11-04 00:40:13,232 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-11-04 00:40:14,311 - DEBUG - Field: train_data_file
2025-11-04 00:40:14,311 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 00:40:14,311 - DEBUG - Field default: None
2025-11-04 00:40:14,312 - DEBUG - Field: test_data_file
2025-11-04 00:40:14,312 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 00:40:14,312 - DEBUG - Field default: None
2025-11-04 00:40:14,312 - DEBUG - Field: output_dir
2025-11-04 00:40:14,312 - DEBUG - Field type: <class 'pathlib.Path'>
2025-11-04 00:40:14,312 - DEBUG - Field default: training_outputs
2025-11-04 00:40:14,312 - DEBUG - Converting path value: /tmp/tmpr4yht7jx/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-11-04 00:40:14,312 - DEBUG - Converting path value: /tmp/tmpr4yht7jx/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-11-04 00:40:14,312 - DEBUG - Converting path value: /tmp/tmpr4yht7jx/training/training_nphotons_500000.0_e2e
2025-11-04 00:40:14,312 - DEBUG - YAML config: {}
2025-11-04 00:40:14,312 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpr4yht7jx/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpr4yht7jx/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpr4yht7jx/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 00:40:14,312 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpr4yht7jx/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpr4yht7jx/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpr4yht7jx/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 00:40:14,312 - INFO - Configuration setup complete
2025-11-04 00:40:14,312 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpr4yht7jx/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmpr4yht7jx/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpr4yht7jx/training/training_nphotons_500000.0_e2e'), sequential_sampling=False, backend='tensorflow')
2025-11-04 00:40:14,312 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-11-04 00:40:14,312 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-11-04 00:40:14,312 - INFO - Loading data from /tmp/tmpr4yht7jx/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-11-04 00:40:14,319 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-11-04 00:40:14,319 - INFO - Randomly subsampled 50 images
2025-11-04 00:40:14,330 - DEBUG - Loaded metadata from /tmp/tmpr4yht7jx/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-11-04 00:40:14,330 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-11-04 00:40:14,331 - INFO - Loading data from /tmp/tmpr4yht7jx/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-11-04 00:40:14,336 - INFO - Using full dataset of 100 images
2025-11-04 00:40:14,337 - INFO - Loaded test data from /tmp/tmpr4yht7jx/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-11-04 00:40:14,337 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-11-04 00:40:14,337 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 00:40:14,337 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-11-04 00:40:14,337 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 00:40:14,337 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 00:40:14,337 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 00:40:14,337 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 00:40:14,337 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-11-04 00:40:14,337 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-11-04 00:40:14,337 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-11-04 00:40:14,337 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-11-04 00:40:14,337 - INFO - Using all 50 points as seeds
2025-11-04 00:40:14,337 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 00:40:14,337 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-11-04 00:40:14,337 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-11-04 00:40:14,337 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-11-04 00:40:14,337 - INFO - Generated 50 groups efficiently
2025-11-04 00:40:15,866 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-11-04 00:40:15,866 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 00:40:15,866 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-11-04 00:40:15,867 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 00:40:15,867 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 00:40:15,867 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 00:40:15,867 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 00:40:15,867 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-11-04 00:40:15,867 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-11-04 00:40:15,867 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-11-04 00:40:15,867 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-11-04 00:40:15,867 - INFO - Sampled 50 seed points from 100 total points
2025-11-04 00:40:15,867 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 00:40:15,867 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-11-04 00:40:15,867 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-11-04 00:40:15,867 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-11-04 00:40:15,867 - INFO - Generated 50 groups efficiently
2025-11-04 00:40:17,881 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 00:40:19,736 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 00:40:27,059 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 00:40:30,246 - INFO - Skipping image stitching (disabled or no test data available)
2025-11-04 00:40:30,263 - DEBUG - Creating converter from 5 to 3
2025-11-04 00:40:31,395 - INFO - Outputs saved to /tmp/tmpr4yht7jx/training/training_nphotons_500000.0_e2e
2025-11-04 00:40:49,707 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-11-04 00:40:49,884 - DEBUG - Creating converter from 7 to 5
2025-11-04 00:40:49,884 - DEBUG - Creating converter from 5 to 7
2025-11-04 00:40:49,884 - DEBUG - Creating converter from 7 to 5
2025-11-04 00:40:49,884 - DEBUG - Creating converter from 5 to 7
2025-11-04 00:40:50,511 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-11-04 00:40:50,518 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-11-04 00:40:50,519 - DEBUG - interactive is False
2025-11-04 00:40:50,519 - DEBUG - platform is linux
2025-11-04 00:40:50,550 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-11-04 00:40:50,552 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-11-04 00:40:51,612 - DEBUG - Field: train_data_file
2025-11-04 00:40:51,612 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 00:40:51,612 - DEBUG - Field default: None
2025-11-04 00:40:51,612 - DEBUG - Field: test_data_file
2025-11-04 00:40:51,612 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 00:40:51,612 - DEBUG - Field default: None
2025-11-04 00:40:51,612 - DEBUG - Field: output_dir
2025-11-04 00:40:51,612 - DEBUG - Field type: <class 'pathlib.Path'>
2025-11-04 00:40:51,612 - DEBUG - Field default: training_outputs
2025-11-04 00:40:51,613 - DEBUG - Converting path value: /tmp/tmpger6g9ml/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-11-04 00:40:51,613 - DEBUG - Converting path value: /tmp/tmpger6g9ml/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-11-04 00:40:51,613 - DEBUG - Converting path value: /tmp/tmpger6g9ml/training/training_nphotons_1000000.0_single
2025-11-04 00:40:51,613 - DEBUG - YAML config: {}
2025-11-04 00:40:51,613 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpger6g9ml/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpger6g9ml/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpger6g9ml/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 00:40:51,613 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpger6g9ml/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpger6g9ml/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpger6g9ml/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 00:40:51,613 - INFO - Configuration setup complete
2025-11-04 00:40:51,613 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpger6g9ml/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmpger6g9ml/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpger6g9ml/training/training_nphotons_1000000.0_single'), sequential_sampling=False, backend='tensorflow')
2025-11-04 00:40:51,613 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-11-04 00:40:51,613 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-11-04 00:40:51,613 - INFO - Loading data from /tmp/tmpger6g9ml/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-11-04 00:40:51,620 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-11-04 00:40:51,620 - INFO - Randomly subsampled 50 images
2025-11-04 00:40:51,632 - DEBUG - Loaded metadata from /tmp/tmpger6g9ml/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-11-04 00:40:51,632 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-11-04 00:40:51,632 - INFO - Loading data from /tmp/tmpger6g9ml/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-11-04 00:40:51,637 - INFO - Using full dataset of 100 images
2025-11-04 00:40:51,638 - INFO - Loaded test data from /tmp/tmpger6g9ml/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-11-04 00:40:51,638 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-11-04 00:40:51,638 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 00:40:51,638 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-11-04 00:40:51,638 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 00:40:51,638 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 00:40:51,638 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 00:40:51,638 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 00:40:51,638 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-11-04 00:40:51,638 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-11-04 00:40:51,638 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-11-04 00:40:51,638 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-11-04 00:40:51,638 - INFO - Using all 50 points as seeds
2025-11-04 00:40:51,639 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 00:40:51,639 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-11-04 00:40:51,639 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-11-04 00:40:51,639 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-11-04 00:40:51,639 - INFO - Generated 50 groups efficiently
2025-11-04 00:40:53,198 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-11-04 00:40:53,198 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 00:40:53,198 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-11-04 00:40:53,198 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 00:40:53,198 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 00:40:53,198 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 00:40:53,198 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 00:40:53,198 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-11-04 00:40:53,198 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-11-04 00:40:53,198 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-11-04 00:40:53,198 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-11-04 00:40:53,198 - INFO - Sampled 50 seed points from 100 total points
2025-11-04 00:40:53,198 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 00:40:53,198 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-11-04 00:40:53,198 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-11-04 00:40:53,198 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-11-04 00:40:53,198 - INFO - Generated 50 groups efficiently
2025-11-04 00:40:55,226 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 00:40:57,117 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 00:41:04,406 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 00:41:07,572 - INFO - Skipping image stitching (disabled or no test data available)
2025-11-04 00:41:07,591 - DEBUG - Creating converter from 5 to 3
2025-11-04 00:41:08,734 - INFO - Outputs saved to /tmp/tmpger6g9ml/training/training_nphotons_1000000.0_single
2025-11-04 00:41:44,697 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-11-04 00:41:44,871 - DEBUG - Creating converter from 7 to 5
2025-11-04 00:41:44,871 - DEBUG - Creating converter from 5 to 7
2025-11-04 00:41:44,871 - DEBUG - Creating converter from 7 to 5
2025-11-04 00:41:44,871 - DEBUG - Creating converter from 5 to 7
2025-11-04 00:41:45,478 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-11-04 00:41:45,485 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-11-04 00:41:45,486 - DEBUG - interactive is False
2025-11-04 00:41:45,486 - DEBUG - platform is linux
2025-11-04 00:41:45,515 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-11-04 00:41:45,516 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-11-04 00:41:46,561 - DEBUG - Field: train_data_file
2025-11-04 00:41:46,561 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 00:41:46,561 - DEBUG - Field default: None
2025-11-04 00:41:46,561 - DEBUG - Field: test_data_file
2025-11-04 00:41:46,561 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 00:41:46,561 - DEBUG - Field default: None
2025-11-04 00:41:46,561 - DEBUG - Field: output_dir
2025-11-04 00:41:46,562 - DEBUG - Field type: <class 'pathlib.Path'>
2025-11-04 00:41:46,562 - DEBUG - Field default: training_outputs
2025-11-04 00:41:46,562 - DEBUG - Converting path value: /tmp/tmpbuk0utuq/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-11-04 00:41:46,562 - DEBUG - Converting path value: /tmp/tmpbuk0utuq/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-11-04 00:41:46,562 - DEBUG - Converting path value: /tmp/tmpbuk0utuq/training/training_mismatch_test
2025-11-04 00:41:46,562 - DEBUG - YAML config: {}
2025-11-04 00:41:46,562 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpbuk0utuq/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpbuk0utuq/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpbuk0utuq/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 00:41:46,562 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpbuk0utuq/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpbuk0utuq/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpbuk0utuq/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 00:41:46,562 - INFO - Configuration setup complete
2025-11-04 00:41:46,562 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpbuk0utuq/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmpbuk0utuq/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpbuk0utuq/training/training_mismatch_test'), sequential_sampling=False, backend='tensorflow')
2025-11-04 00:41:46,562 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-11-04 00:41:46,562 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-11-04 00:41:46,562 - INFO - Loading data from /tmp/tmpbuk0utuq/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-11-04 00:41:46,568 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-11-04 00:41:46,568 - INFO - Randomly subsampled 50 images
2025-11-04 00:41:46,578 - DEBUG - Loaded metadata from /tmp/tmpbuk0utuq/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-11-04 00:41:46,578 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-11-04 00:41:46,578 - INFO - Loading data from /tmp/tmpbuk0utuq/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-11-04 00:41:46,582 - INFO - Using full dataset of 100 images
2025-11-04 00:41:46,582 - INFO - Loaded test data from /tmp/tmpbuk0utuq/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-11-04 00:41:46,583 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-11-04 00:41:46,583 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 00:41:46,583 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-11-04 00:41:46,583 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 00:41:46,583 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 00:41:46,583 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 00:41:46,583 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 00:41:46,583 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-11-04 00:41:46,583 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-11-04 00:41:46,583 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-11-04 00:41:46,583 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-11-04 00:41:46,583 - INFO - Using all 50 points as seeds
2025-11-04 00:41:46,583 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 00:41:46,583 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-11-04 00:41:46,583 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-11-04 00:41:46,583 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-11-04 00:41:46,583 - INFO - Generated 50 groups efficiently
2025-11-04 00:41:48,123 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-11-04 00:41:48,123 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 00:41:48,123 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-11-04 00:41:48,123 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 00:41:48,123 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 00:41:48,123 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 00:41:48,123 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 00:41:48,123 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-11-04 00:41:48,123 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-11-04 00:41:48,123 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-11-04 00:41:48,123 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-11-04 00:41:48,124 - INFO - Sampled 50 seed points from 100 total points
2025-11-04 00:41:48,124 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 00:41:48,124 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-11-04 00:41:48,124 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-11-04 00:41:48,124 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-11-04 00:41:48,124 - INFO - Generated 50 groups efficiently
2025-11-04 00:41:50,149 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 00:41:52,036 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 00:41:59,392 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 00:42:02,708 - INFO - Skipping image stitching (disabled or no test data available)
2025-11-04 00:42:02,725 - DEBUG - Creating converter from 5 to 3
2025-11-04 00:42:03,916 - INFO - Outputs saved to /tmp/tmpbuk0utuq/training/training_mismatch_test
2025-11-04 01:36:41,829 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-11-04 01:36:41,998 - DEBUG - Creating converter from 7 to 5
2025-11-04 01:36:41,998 - DEBUG - Creating converter from 5 to 7
2025-11-04 01:36:41,998 - DEBUG - Creating converter from 7 to 5
2025-11-04 01:36:41,998 - DEBUG - Creating converter from 5 to 7
2025-11-04 01:36:42,601 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-11-04 01:36:42,608 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-11-04 01:36:42,609 - DEBUG - interactive is False
2025-11-04 01:36:42,609 - DEBUG - platform is linux
2025-11-04 01:36:42,637 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-11-04 01:36:42,639 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-11-04 01:36:43,668 - DEBUG - Field: train_data_file
2025-11-04 01:36:43,668 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 01:36:43,668 - DEBUG - Field default: None
2025-11-04 01:36:43,668 - DEBUG - Field: test_data_file
2025-11-04 01:36:43,668 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 01:36:43,668 - DEBUG - Field default: None
2025-11-04 01:36:43,668 - DEBUG - Field: output_dir
2025-11-04 01:36:43,668 - DEBUG - Field type: <class 'pathlib.Path'>
2025-11-04 01:36:43,668 - DEBUG - Field default: training_outputs
2025-11-04 01:36:43,669 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-11-04 01:36:43,669 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-11-04 01:36:43,669 - DEBUG - Converting path value: /tmp/tmplw62z09t/training_outputs
2025-11-04 01:36:43,669 - DEBUG - YAML config: {}
2025-11-04 01:36:43,669 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmplw62z09t/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 01:36:43,669 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmplw62z09t/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 01:36:43,669 - INFO - Configuration setup complete
2025-11-04 01:36:43,669 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmplw62z09t/training_outputs'), sequential_sampling=False, backend='tensorflow')
2025-11-04 01:36:43,669 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-11-04 01:36:43,669 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-11-04 01:36:43,669 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-11-04 01:36:43,686 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-11-04 01:36:43,686 - INFO - Randomly subsampled 64 images
2025-11-04 01:36:43,703 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-11-04 01:36:43,719 - INFO - Using full dataset of 1087 images
2025-11-04 01:36:43,733 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-11-04 01:36:43,733 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-11-04 01:36:43,734 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 01:36:43,734 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-11-04 01:36:43,734 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 01:36:43,734 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 01:36:43,734 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 01:36:43,734 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 01:36:43,734 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-11-04 01:36:43,734 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-11-04 01:36:43,734 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-11-04 01:36:43,734 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-11-04 01:36:43,734 - INFO - Using all 64 points as seeds
2025-11-04 01:36:43,734 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 01:36:43,734 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-11-04 01:36:43,734 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-11-04 01:36:43,734 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-11-04 01:36:43,734 - INFO - Generated 64 groups efficiently
2025-11-04 01:36:45,299 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-11-04 01:36:45,299 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 01:36:45,299 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-11-04 01:36:45,299 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 01:36:45,299 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 01:36:45,299 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 01:36:45,299 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 01:36:45,299 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-11-04 01:36:45,299 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-11-04 01:36:45,299 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-11-04 01:36:45,299 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-11-04 01:36:45,299 - INFO - Sampled 64 seed points from 1087 total points
2025-11-04 01:36:45,299 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 01:36:45,299 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-11-04 01:36:45,299 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-11-04 01:36:45,299 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-11-04 01:36:45,299 - INFO - Generated 64 groups efficiently
2025-11-04 01:36:47,372 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 01:36:49,220 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 01:36:56,658 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 01:36:58,707 - INFO - Skipping image stitching (disabled or no test data available)
2025-11-04 01:36:58,941 - DEBUG - Creating converter from 5 to 3
2025-11-04 01:37:00,100 - INFO - Outputs saved to /tmp/tmplw62z09t/training_outputs
2025-11-04 01:37:26,315 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-11-04 01:37:26,487 - DEBUG - Creating converter from 7 to 5
2025-11-04 01:37:26,487 - DEBUG - Creating converter from 5 to 7
2025-11-04 01:37:26,487 - DEBUG - Creating converter from 7 to 5
2025-11-04 01:37:26,487 - DEBUG - Creating converter from 5 to 7
2025-11-04 01:37:27,102 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-11-04 01:37:27,110 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-11-04 01:37:27,110 - DEBUG - interactive is False
2025-11-04 01:37:27,110 - DEBUG - platform is linux
2025-11-04 01:37:27,139 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-11-04 01:37:27,141 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-11-04 01:37:28,197 - DEBUG - Field: train_data_file
2025-11-04 01:37:28,197 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 01:37:28,197 - DEBUG - Field default: None
2025-11-04 01:37:28,197 - DEBUG - Field: test_data_file
2025-11-04 01:37:28,197 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 01:37:28,197 - DEBUG - Field default: None
2025-11-04 01:37:28,197 - DEBUG - Field: output_dir
2025-11-04 01:37:28,197 - DEBUG - Field type: <class 'pathlib.Path'>
2025-11-04 01:37:28,197 - DEBUG - Field default: training_outputs
2025-11-04 01:37:28,197 - DEBUG - Converting path value: /tmp/tmprhh9dgi_/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-11-04 01:37:28,197 - DEBUG - Converting path value: /tmp/tmprhh9dgi_/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-11-04 01:37:28,197 - DEBUG - Converting path value: /tmp/tmprhh9dgi_/training/training_nphotons_500000.0_e2e
2025-11-04 01:37:28,197 - DEBUG - YAML config: {}
2025-11-04 01:37:28,197 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmprhh9dgi_/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmprhh9dgi_/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmprhh9dgi_/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 01:37:28,197 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmprhh9dgi_/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmprhh9dgi_/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmprhh9dgi_/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 01:37:28,198 - INFO - Configuration setup complete
2025-11-04 01:37:28,198 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmprhh9dgi_/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmprhh9dgi_/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmprhh9dgi_/training/training_nphotons_500000.0_e2e'), sequential_sampling=False, backend='tensorflow')
2025-11-04 01:37:28,198 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-11-04 01:37:28,198 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-11-04 01:37:28,198 - INFO - Loading data from /tmp/tmprhh9dgi_/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-11-04 01:37:28,204 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-11-04 01:37:28,204 - INFO - Randomly subsampled 50 images
2025-11-04 01:37:28,216 - DEBUG - Loaded metadata from /tmp/tmprhh9dgi_/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-11-04 01:37:28,216 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-11-04 01:37:28,216 - INFO - Loading data from /tmp/tmprhh9dgi_/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-11-04 01:37:28,221 - INFO - Using full dataset of 100 images
2025-11-04 01:37:28,222 - INFO - Loaded test data from /tmp/tmprhh9dgi_/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-11-04 01:37:28,222 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-11-04 01:37:28,222 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 01:37:28,222 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-11-04 01:37:28,222 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 01:37:28,222 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 01:37:28,222 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 01:37:28,222 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 01:37:28,222 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-11-04 01:37:28,222 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-11-04 01:37:28,222 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-11-04 01:37:28,222 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-11-04 01:37:28,222 - INFO - Using all 50 points as seeds
2025-11-04 01:37:28,222 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 01:37:28,222 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-11-04 01:37:28,222 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-11-04 01:37:28,222 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-11-04 01:37:28,222 - INFO - Generated 50 groups efficiently
2025-11-04 01:37:29,771 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-11-04 01:37:29,771 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 01:37:29,771 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-11-04 01:37:29,771 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 01:37:29,772 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 01:37:29,772 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 01:37:29,772 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 01:37:29,772 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-11-04 01:37:29,772 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-11-04 01:37:29,772 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-11-04 01:37:29,772 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-11-04 01:37:29,772 - INFO - Sampled 50 seed points from 100 total points
2025-11-04 01:37:29,772 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 01:37:29,772 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-11-04 01:37:29,772 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-11-04 01:37:29,772 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-11-04 01:37:29,772 - INFO - Generated 50 groups efficiently
2025-11-04 01:37:31,759 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 01:37:33,602 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 01:37:40,899 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 01:37:44,067 - INFO - Skipping image stitching (disabled or no test data available)
2025-11-04 01:37:44,084 - DEBUG - Creating converter from 5 to 3
2025-11-04 01:37:45,264 - INFO - Outputs saved to /tmp/tmprhh9dgi_/training/training_nphotons_500000.0_e2e
2025-11-04 01:38:06,191 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-11-04 01:38:06,366 - DEBUG - Creating converter from 7 to 5
2025-11-04 01:38:06,366 - DEBUG - Creating converter from 5 to 7
2025-11-04 01:38:06,366 - DEBUG - Creating converter from 7 to 5
2025-11-04 01:38:06,366 - DEBUG - Creating converter from 5 to 7
2025-11-04 01:38:06,980 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-11-04 01:38:06,987 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-11-04 01:38:06,988 - DEBUG - interactive is False
2025-11-04 01:38:06,988 - DEBUG - platform is linux
2025-11-04 01:38:07,017 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-11-04 01:38:07,018 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-11-04 01:38:08,074 - DEBUG - Field: train_data_file
2025-11-04 01:38:08,074 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 01:38:08,074 - DEBUG - Field default: None
2025-11-04 01:38:08,074 - DEBUG - Field: test_data_file
2025-11-04 01:38:08,074 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 01:38:08,074 - DEBUG - Field default: None
2025-11-04 01:38:08,074 - DEBUG - Field: output_dir
2025-11-04 01:38:08,074 - DEBUG - Field type: <class 'pathlib.Path'>
2025-11-04 01:38:08,074 - DEBUG - Field default: training_outputs
2025-11-04 01:38:08,074 - DEBUG - Converting path value: /tmp/tmp_2bci3we/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-11-04 01:38:08,074 - DEBUG - Converting path value: /tmp/tmp_2bci3we/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-11-04 01:38:08,074 - DEBUG - Converting path value: /tmp/tmp_2bci3we/training/training_nphotons_1000000.0_single
2025-11-04 01:38:08,075 - DEBUG - YAML config: {}
2025-11-04 01:38:08,075 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp_2bci3we/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmp_2bci3we/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp_2bci3we/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 01:38:08,075 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp_2bci3we/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmp_2bci3we/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp_2bci3we/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 01:38:08,075 - INFO - Configuration setup complete
2025-11-04 01:38:08,075 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp_2bci3we/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmp_2bci3we/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp_2bci3we/training/training_nphotons_1000000.0_single'), sequential_sampling=False, backend='tensorflow')
2025-11-04 01:38:08,075 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-11-04 01:38:08,075 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-11-04 01:38:08,075 - INFO - Loading data from /tmp/tmp_2bci3we/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-11-04 01:38:08,082 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-11-04 01:38:08,082 - INFO - Randomly subsampled 50 images
2025-11-04 01:38:08,094 - DEBUG - Loaded metadata from /tmp/tmp_2bci3we/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-11-04 01:38:08,094 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-11-04 01:38:08,094 - INFO - Loading data from /tmp/tmp_2bci3we/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-11-04 01:38:08,099 - INFO - Using full dataset of 100 images
2025-11-04 01:38:08,100 - INFO - Loaded test data from /tmp/tmp_2bci3we/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-11-04 01:38:08,100 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-11-04 01:38:08,100 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 01:38:08,100 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-11-04 01:38:08,100 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 01:38:08,100 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 01:38:08,100 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 01:38:08,100 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 01:38:08,100 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-11-04 01:38:08,100 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-11-04 01:38:08,100 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-11-04 01:38:08,100 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-11-04 01:38:08,100 - INFO - Using all 50 points as seeds
2025-11-04 01:38:08,100 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 01:38:08,100 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-11-04 01:38:08,100 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-11-04 01:38:08,100 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-11-04 01:38:08,100 - INFO - Generated 50 groups efficiently
2025-11-04 01:38:09,664 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-11-04 01:38:09,664 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 01:38:09,664 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-11-04 01:38:09,664 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 01:38:09,664 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 01:38:09,664 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 01:38:09,664 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 01:38:09,664 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-11-04 01:38:09,664 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-11-04 01:38:09,664 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-11-04 01:38:09,664 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-11-04 01:38:09,664 - INFO - Sampled 50 seed points from 100 total points
2025-11-04 01:38:09,664 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 01:38:09,664 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-11-04 01:38:09,664 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-11-04 01:38:09,664 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-11-04 01:38:09,664 - INFO - Generated 50 groups efficiently
2025-11-04 01:38:11,647 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 01:38:13,503 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 01:38:20,843 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 01:38:23,958 - INFO - Skipping image stitching (disabled or no test data available)
2025-11-04 01:38:23,974 - DEBUG - Creating converter from 5 to 3
2025-11-04 01:38:25,102 - INFO - Outputs saved to /tmp/tmp_2bci3we/training/training_nphotons_1000000.0_single
2025-11-04 01:39:01,085 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-11-04 01:39:01,262 - DEBUG - Creating converter from 7 to 5
2025-11-04 01:39:01,262 - DEBUG - Creating converter from 5 to 7
2025-11-04 01:39:01,262 - DEBUG - Creating converter from 7 to 5
2025-11-04 01:39:01,262 - DEBUG - Creating converter from 5 to 7
2025-11-04 01:39:01,887 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-11-04 01:39:01,895 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-11-04 01:39:01,895 - DEBUG - interactive is False
2025-11-04 01:39:01,895 - DEBUG - platform is linux
2025-11-04 01:39:01,924 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-11-04 01:39:01,926 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-11-04 01:39:02,994 - DEBUG - Field: train_data_file
2025-11-04 01:39:02,994 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 01:39:02,994 - DEBUG - Field default: None
2025-11-04 01:39:02,994 - DEBUG - Field: test_data_file
2025-11-04 01:39:02,994 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 01:39:02,994 - DEBUG - Field default: None
2025-11-04 01:39:02,994 - DEBUG - Field: output_dir
2025-11-04 01:39:02,994 - DEBUG - Field type: <class 'pathlib.Path'>
2025-11-04 01:39:02,994 - DEBUG - Field default: training_outputs
2025-11-04 01:39:02,994 - DEBUG - Converting path value: /tmp/tmppndsvvr6/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-11-04 01:39:02,994 - DEBUG - Converting path value: /tmp/tmppndsvvr6/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-11-04 01:39:02,995 - DEBUG - Converting path value: /tmp/tmppndsvvr6/training/training_mismatch_test
2025-11-04 01:39:02,995 - DEBUG - YAML config: {}
2025-11-04 01:39:02,995 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmppndsvvr6/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmppndsvvr6/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmppndsvvr6/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 01:39:02,995 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmppndsvvr6/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmppndsvvr6/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmppndsvvr6/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 01:39:02,995 - INFO - Configuration setup complete
2025-11-04 01:39:02,995 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmppndsvvr6/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmppndsvvr6/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmppndsvvr6/training/training_mismatch_test'), sequential_sampling=False, backend='tensorflow')
2025-11-04 01:39:02,995 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-11-04 01:39:02,995 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-11-04 01:39:02,995 - INFO - Loading data from /tmp/tmppndsvvr6/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-11-04 01:39:03,000 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-11-04 01:39:03,001 - INFO - Randomly subsampled 50 images
2025-11-04 01:39:03,011 - DEBUG - Loaded metadata from /tmp/tmppndsvvr6/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-11-04 01:39:03,011 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-11-04 01:39:03,011 - INFO - Loading data from /tmp/tmppndsvvr6/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-11-04 01:39:03,015 - INFO - Using full dataset of 100 images
2025-11-04 01:39:03,016 - INFO - Loaded test data from /tmp/tmppndsvvr6/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-11-04 01:39:03,016 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-11-04 01:39:03,016 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 01:39:03,016 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-11-04 01:39:03,016 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 01:39:03,016 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 01:39:03,016 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 01:39:03,016 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 01:39:03,016 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-11-04 01:39:03,016 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-11-04 01:39:03,016 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-11-04 01:39:03,016 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-11-04 01:39:03,016 - INFO - Using all 50 points as seeds
2025-11-04 01:39:03,016 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 01:39:03,016 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-11-04 01:39:03,016 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-11-04 01:39:03,016 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-11-04 01:39:03,016 - INFO - Generated 50 groups efficiently
2025-11-04 01:39:04,593 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-11-04 01:39:04,593 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 01:39:04,593 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-11-04 01:39:04,593 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 01:39:04,593 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 01:39:04,593 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 01:39:04,593 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 01:39:04,593 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-11-04 01:39:04,593 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-11-04 01:39:04,593 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-11-04 01:39:04,593 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-11-04 01:39:04,593 - INFO - Sampled 50 seed points from 100 total points
2025-11-04 01:39:04,593 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 01:39:04,593 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-11-04 01:39:04,593 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-11-04 01:39:04,593 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-11-04 01:39:04,593 - INFO - Generated 50 groups efficiently
2025-11-04 01:39:06,610 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 01:39:08,479 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 01:39:15,674 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 01:39:18,889 - INFO - Skipping image stitching (disabled or no test data available)
2025-11-04 01:39:18,904 - DEBUG - Creating converter from 5 to 3
2025-11-04 01:39:20,018 - INFO - Outputs saved to /tmp/tmppndsvvr6/training/training_mismatch_test
2025-11-04 01:56:06,900 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-11-04 01:56:07,072 - DEBUG - Creating converter from 7 to 5
2025-11-04 01:56:07,072 - DEBUG - Creating converter from 5 to 7
2025-11-04 01:56:07,072 - DEBUG - Creating converter from 7 to 5
2025-11-04 01:56:07,072 - DEBUG - Creating converter from 5 to 7
2025-11-04 01:56:07,678 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-11-04 01:56:07,686 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-11-04 01:56:07,686 - DEBUG - interactive is False
2025-11-04 01:56:07,686 - DEBUG - platform is linux
2025-11-04 01:56:07,715 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-11-04 01:56:07,716 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-11-04 01:56:08,744 - DEBUG - Field: train_data_file
2025-11-04 01:56:08,744 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 01:56:08,744 - DEBUG - Field default: None
2025-11-04 01:56:08,744 - DEBUG - Field: test_data_file
2025-11-04 01:56:08,744 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 01:56:08,744 - DEBUG - Field default: None
2025-11-04 01:56:08,745 - DEBUG - Field: output_dir
2025-11-04 01:56:08,745 - DEBUG - Field type: <class 'pathlib.Path'>
2025-11-04 01:56:08,745 - DEBUG - Field default: training_outputs
2025-11-04 01:56:08,745 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-11-04 01:56:08,745 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-11-04 01:56:08,745 - DEBUG - Converting path value: /tmp/tmpa75yswy8/training_outputs
2025-11-04 01:56:08,745 - DEBUG - YAML config: {}
2025-11-04 01:56:08,745 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpa75yswy8/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 01:56:08,745 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpa75yswy8/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 01:56:08,745 - INFO - Configuration setup complete
2025-11-04 01:56:08,745 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpa75yswy8/training_outputs'), sequential_sampling=False, backend='tensorflow')
2025-11-04 01:56:08,745 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-11-04 01:56:08,745 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-11-04 01:56:08,745 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-11-04 01:56:08,763 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-11-04 01:56:08,763 - INFO - Randomly subsampled 64 images
2025-11-04 01:56:08,780 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-11-04 01:56:08,796 - INFO - Using full dataset of 1087 images
2025-11-04 01:56:08,810 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-11-04 01:56:08,811 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-11-04 01:56:08,811 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 01:56:08,811 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-11-04 01:56:08,811 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 01:56:08,812 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 01:56:08,812 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 01:56:08,812 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 01:56:08,812 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-11-04 01:56:08,812 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-11-04 01:56:08,812 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-11-04 01:56:08,812 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-11-04 01:56:08,812 - INFO - Using all 64 points as seeds
2025-11-04 01:56:08,812 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 01:56:08,812 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-11-04 01:56:08,812 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-11-04 01:56:08,812 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-11-04 01:56:08,812 - INFO - Generated 64 groups efficiently
2025-11-04 01:56:10,408 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-11-04 01:56:10,408 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 01:56:10,408 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-11-04 01:56:10,408 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 01:56:10,408 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 01:56:10,408 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 01:56:10,408 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 01:56:10,408 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-11-04 01:56:10,408 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-11-04 01:56:10,408 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-11-04 01:56:10,408 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-11-04 01:56:10,408 - INFO - Sampled 64 seed points from 1087 total points
2025-11-04 01:56:10,408 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 01:56:10,408 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-11-04 01:56:10,408 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-11-04 01:56:10,408 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-11-04 01:56:10,408 - INFO - Generated 64 groups efficiently
2025-11-04 01:56:12,485 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 01:56:14,328 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 01:56:21,605 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 01:56:23,554 - INFO - Skipping image stitching (disabled or no test data available)
2025-11-04 01:56:23,779 - DEBUG - Creating converter from 5 to 3
2025-11-04 01:56:24,900 - INFO - Outputs saved to /tmp/tmpa75yswy8/training_outputs
2025-11-04 01:56:48,991 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-11-04 01:56:49,164 - DEBUG - Creating converter from 7 to 5
2025-11-04 01:56:49,164 - DEBUG - Creating converter from 5 to 7
2025-11-04 01:56:49,164 - DEBUG - Creating converter from 7 to 5
2025-11-04 01:56:49,164 - DEBUG - Creating converter from 5 to 7
2025-11-04 01:56:49,782 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-11-04 01:56:49,789 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-11-04 01:56:49,789 - DEBUG - interactive is False
2025-11-04 01:56:49,789 - DEBUG - platform is linux
2025-11-04 01:56:49,818 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-11-04 01:56:49,820 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-11-04 01:56:50,867 - DEBUG - Field: train_data_file
2025-11-04 01:56:50,868 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 01:56:50,868 - DEBUG - Field default: None
2025-11-04 01:56:50,868 - DEBUG - Field: test_data_file
2025-11-04 01:56:50,868 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 01:56:50,868 - DEBUG - Field default: None
2025-11-04 01:56:50,868 - DEBUG - Field: output_dir
2025-11-04 01:56:50,868 - DEBUG - Field type: <class 'pathlib.Path'>
2025-11-04 01:56:50,868 - DEBUG - Field default: training_outputs
2025-11-04 01:56:50,868 - DEBUG - Converting path value: /tmp/tmpqcmu4jxk/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-11-04 01:56:50,868 - DEBUG - Converting path value: /tmp/tmpqcmu4jxk/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-11-04 01:56:50,868 - DEBUG - Converting path value: /tmp/tmpqcmu4jxk/training/training_nphotons_500000.0_e2e
2025-11-04 01:56:50,868 - DEBUG - YAML config: {}
2025-11-04 01:56:50,868 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpqcmu4jxk/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpqcmu4jxk/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpqcmu4jxk/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 01:56:50,868 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpqcmu4jxk/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpqcmu4jxk/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpqcmu4jxk/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 01:56:50,868 - INFO - Configuration setup complete
2025-11-04 01:56:50,868 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpqcmu4jxk/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmpqcmu4jxk/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpqcmu4jxk/training/training_nphotons_500000.0_e2e'), sequential_sampling=False, backend='tensorflow')
2025-11-04 01:56:50,868 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-11-04 01:56:50,868 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-11-04 01:56:50,868 - INFO - Loading data from /tmp/tmpqcmu4jxk/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-11-04 01:56:50,875 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-11-04 01:56:50,875 - INFO - Randomly subsampled 50 images
2025-11-04 01:56:50,886 - DEBUG - Loaded metadata from /tmp/tmpqcmu4jxk/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-11-04 01:56:50,886 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-11-04 01:56:50,886 - INFO - Loading data from /tmp/tmpqcmu4jxk/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-11-04 01:56:50,891 - INFO - Using full dataset of 100 images
2025-11-04 01:56:50,892 - INFO - Loaded test data from /tmp/tmpqcmu4jxk/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-11-04 01:56:50,892 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-11-04 01:56:50,892 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 01:56:50,892 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-11-04 01:56:50,892 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 01:56:50,892 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 01:56:50,893 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 01:56:50,893 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 01:56:50,893 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-11-04 01:56:50,893 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-11-04 01:56:50,893 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-11-04 01:56:50,893 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-11-04 01:56:50,893 - INFO - Using all 50 points as seeds
2025-11-04 01:56:50,893 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 01:56:50,893 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-11-04 01:56:50,893 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-11-04 01:56:50,893 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-11-04 01:56:50,893 - INFO - Generated 50 groups efficiently
2025-11-04 01:56:52,457 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-11-04 01:56:52,457 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 01:56:52,458 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-11-04 01:56:52,458 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 01:56:52,458 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 01:56:52,458 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 01:56:52,458 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 01:56:52,458 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-11-04 01:56:52,458 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-11-04 01:56:52,458 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-11-04 01:56:52,458 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-11-04 01:56:52,458 - INFO - Sampled 50 seed points from 100 total points
2025-11-04 01:56:52,458 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 01:56:52,458 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-11-04 01:56:52,458 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-11-04 01:56:52,458 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-11-04 01:56:52,458 - INFO - Generated 50 groups efficiently
2025-11-04 01:56:54,437 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 01:56:56,305 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 01:57:03,589 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 01:57:06,775 - INFO - Skipping image stitching (disabled or no test data available)
2025-11-04 01:57:06,793 - DEBUG - Creating converter from 5 to 3
2025-11-04 01:57:07,926 - INFO - Outputs saved to /tmp/tmpqcmu4jxk/training/training_nphotons_500000.0_e2e
2025-11-04 01:57:26,101 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-11-04 01:57:26,277 - DEBUG - Creating converter from 7 to 5
2025-11-04 01:57:26,277 - DEBUG - Creating converter from 5 to 7
2025-11-04 01:57:26,277 - DEBUG - Creating converter from 7 to 5
2025-11-04 01:57:26,278 - DEBUG - Creating converter from 5 to 7
2025-11-04 01:57:26,899 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-11-04 01:57:26,906 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-11-04 01:57:26,906 - DEBUG - interactive is False
2025-11-04 01:57:26,907 - DEBUG - platform is linux
2025-11-04 01:57:26,936 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-11-04 01:57:26,937 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-11-04 01:57:27,992 - DEBUG - Field: train_data_file
2025-11-04 01:57:27,992 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 01:57:27,992 - DEBUG - Field default: None
2025-11-04 01:57:27,992 - DEBUG - Field: test_data_file
2025-11-04 01:57:27,992 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 01:57:27,992 - DEBUG - Field default: None
2025-11-04 01:57:27,992 - DEBUG - Field: output_dir
2025-11-04 01:57:27,992 - DEBUG - Field type: <class 'pathlib.Path'>
2025-11-04 01:57:27,992 - DEBUG - Field default: training_outputs
2025-11-04 01:57:27,992 - DEBUG - Converting path value: /tmp/tmpokqyfsxf/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-11-04 01:57:27,993 - DEBUG - Converting path value: /tmp/tmpokqyfsxf/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-11-04 01:57:27,993 - DEBUG - Converting path value: /tmp/tmpokqyfsxf/training/training_nphotons_1000000.0_single
2025-11-04 01:57:27,993 - DEBUG - YAML config: {}
2025-11-04 01:57:27,993 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpokqyfsxf/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpokqyfsxf/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpokqyfsxf/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 01:57:27,993 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpokqyfsxf/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpokqyfsxf/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpokqyfsxf/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 01:57:27,993 - INFO - Configuration setup complete
2025-11-04 01:57:27,993 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpokqyfsxf/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmpokqyfsxf/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpokqyfsxf/training/training_nphotons_1000000.0_single'), sequential_sampling=False, backend='tensorflow')
2025-11-04 01:57:27,993 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-11-04 01:57:27,993 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-11-04 01:57:27,993 - INFO - Loading data from /tmp/tmpokqyfsxf/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-11-04 01:57:28,000 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-11-04 01:57:28,000 - INFO - Randomly subsampled 50 images
2025-11-04 01:57:28,011 - DEBUG - Loaded metadata from /tmp/tmpokqyfsxf/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-11-04 01:57:28,011 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-11-04 01:57:28,012 - INFO - Loading data from /tmp/tmpokqyfsxf/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-11-04 01:57:28,017 - INFO - Using full dataset of 100 images
2025-11-04 01:57:28,018 - INFO - Loaded test data from /tmp/tmpokqyfsxf/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-11-04 01:57:28,018 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-11-04 01:57:28,018 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 01:57:28,018 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-11-04 01:57:28,018 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 01:57:28,018 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 01:57:28,018 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 01:57:28,018 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 01:57:28,018 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-11-04 01:57:28,018 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-11-04 01:57:28,018 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-11-04 01:57:28,018 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-11-04 01:57:28,018 - INFO - Using all 50 points as seeds
2025-11-04 01:57:28,018 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 01:57:28,018 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-11-04 01:57:28,018 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-11-04 01:57:28,018 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-11-04 01:57:28,018 - INFO - Generated 50 groups efficiently
2025-11-04 01:57:29,542 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-11-04 01:57:29,542 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 01:57:29,542 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-11-04 01:57:29,542 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 01:57:29,542 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 01:57:29,543 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 01:57:29,543 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 01:57:29,543 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-11-04 01:57:29,543 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-11-04 01:57:29,543 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-11-04 01:57:29,543 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-11-04 01:57:29,543 - INFO - Sampled 50 seed points from 100 total points
2025-11-04 01:57:29,543 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 01:57:29,543 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-11-04 01:57:29,543 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-11-04 01:57:29,543 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-11-04 01:57:29,543 - INFO - Generated 50 groups efficiently
2025-11-04 01:57:31,523 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 01:57:33,385 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 01:57:40,579 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 01:57:43,764 - INFO - Skipping image stitching (disabled or no test data available)
2025-11-04 01:57:43,779 - DEBUG - Creating converter from 5 to 3
2025-11-04 01:57:44,919 - INFO - Outputs saved to /tmp/tmpokqyfsxf/training/training_nphotons_1000000.0_single
2025-11-04 01:58:20,777 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-11-04 01:58:20,951 - DEBUG - Creating converter from 7 to 5
2025-11-04 01:58:20,951 - DEBUG - Creating converter from 5 to 7
2025-11-04 01:58:20,951 - DEBUG - Creating converter from 7 to 5
2025-11-04 01:58:20,951 - DEBUG - Creating converter from 5 to 7
2025-11-04 01:58:21,558 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-11-04 01:58:21,566 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-11-04 01:58:21,566 - DEBUG - interactive is False
2025-11-04 01:58:21,566 - DEBUG - platform is linux
2025-11-04 01:58:21,595 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-11-04 01:58:21,596 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-11-04 01:58:22,646 - DEBUG - Field: train_data_file
2025-11-04 01:58:22,646 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 01:58:22,646 - DEBUG - Field default: None
2025-11-04 01:58:22,646 - DEBUG - Field: test_data_file
2025-11-04 01:58:22,646 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-11-04 01:58:22,646 - DEBUG - Field default: None
2025-11-04 01:58:22,646 - DEBUG - Field: output_dir
2025-11-04 01:58:22,646 - DEBUG - Field type: <class 'pathlib.Path'>
2025-11-04 01:58:22,646 - DEBUG - Field default: training_outputs
2025-11-04 01:58:22,647 - DEBUG - Converting path value: /tmp/tmpjngyny7r/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-11-04 01:58:22,647 - DEBUG - Converting path value: /tmp/tmpjngyny7r/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-11-04 01:58:22,647 - DEBUG - Converting path value: /tmp/tmpjngyny7r/training/training_mismatch_test
2025-11-04 01:58:22,647 - DEBUG - YAML config: {}
2025-11-04 01:58:22,647 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpjngyny7r/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpjngyny7r/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpjngyny7r/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 01:58:22,647 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpjngyny7r/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpjngyny7r/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpjngyny7r/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-11-04 01:58:22,647 - INFO - Configuration setup complete
2025-11-04 01:58:22,647 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpjngyny7r/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmpjngyny7r/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpjngyny7r/training/training_mismatch_test'), sequential_sampling=False, backend='tensorflow')
2025-11-04 01:58:22,647 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-11-04 01:58:22,647 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-11-04 01:58:22,647 - INFO - Loading data from /tmp/tmpjngyny7r/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-11-04 01:58:22,653 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-11-04 01:58:22,653 - INFO - Randomly subsampled 50 images
2025-11-04 01:58:22,663 - DEBUG - Loaded metadata from /tmp/tmpjngyny7r/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-11-04 01:58:22,663 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-11-04 01:58:22,663 - INFO - Loading data from /tmp/tmpjngyny7r/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-11-04 01:58:22,668 - INFO - Using full dataset of 100 images
2025-11-04 01:58:22,668 - INFO - Loaded test data from /tmp/tmpjngyny7r/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-11-04 01:58:22,668 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-11-04 01:58:22,668 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 01:58:22,668 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-11-04 01:58:22,668 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 01:58:22,668 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 01:58:22,668 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 01:58:22,668 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 01:58:22,668 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-11-04 01:58:22,668 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-11-04 01:58:22,668 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-11-04 01:58:22,668 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-11-04 01:58:22,668 - INFO - Using all 50 points as seeds
2025-11-04 01:58:22,669 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 01:58:22,669 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-11-04 01:58:22,669 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-11-04 01:58:22,669 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-11-04 01:58:22,669 - INFO - Generated 50 groups efficiently
2025-11-04 01:58:24,196 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-11-04 01:58:24,196 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-11-04 01:58:24,196 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-11-04 01:58:24,196 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-11-04 01:58:24,196 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-04 01:58:24,196 - INFO - Using efficient random sampling strategy for gridsize=1
2025-11-04 01:58:24,196 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-04 01:58:24,196 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-11-04 01:58:24,196 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-11-04 01:58:24,196 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-11-04 01:58:24,196 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-11-04 01:58:24,196 - INFO - Sampled 50 seed points from 100 total points
2025-11-04 01:58:24,196 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-11-04 01:58:24,196 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-11-04 01:58:24,196 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-11-04 01:58:24,196 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-11-04 01:58:24,196 - INFO - Generated 50 groups efficiently
2025-11-04 01:58:26,200 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 01:58:28,039 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 01:58:35,457 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-04 01:58:38,627 - INFO - Skipping image stitching (disabled or no test data available)
2025-11-04 01:58:38,644 - DEBUG - Creating converter from 5 to 3
2025-11-04 01:58:39,763 - INFO - Outputs saved to /tmp/tmpjngyny7r/training/training_mismatch_test
