2025-10-19 21:07:17,251 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-19 21:07:17,429 - DEBUG - Creating converter from 7 to 5
2025-10-19 21:07:17,429 - DEBUG - Creating converter from 5 to 7
2025-10-19 21:07:17,429 - DEBUG - Creating converter from 7 to 5
2025-10-19 21:07:17,429 - DEBUG - Creating converter from 5 to 7
2025-10-19 21:07:18,048 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-19 21:07:18,057 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-19 21:07:18,057 - DEBUG - interactive is False
2025-10-19 21:07:18,057 - DEBUG - platform is linux
2025-10-19 21:07:18,086 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-19 21:07:18,087 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-19 21:07:19,087 - DEBUG - Field: train_data_file
2025-10-19 21:07:19,087 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 21:07:19,088 - DEBUG - Field default: None
2025-10-19 21:07:19,088 - DEBUG - Field: test_data_file
2025-10-19 21:07:19,088 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 21:07:19,088 - DEBUG - Field default: None
2025-10-19 21:07:19,088 - DEBUG - Field: output_dir
2025-10-19 21:07:19,088 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-19 21:07:19,088 - DEBUG - Field default: training_outputs
2025-10-19 21:07:19,088 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-19 21:07:19,088 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-19 21:07:19,088 - DEBUG - Converting path value: /tmp/tmp_g4vsm7c/training_outputs
2025-10-19 21:07:19,088 - DEBUG - YAML config: {}
2025-10-19 21:07:19,088 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp_g4vsm7c/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 21:07:19,088 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp_g4vsm7c/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 21:07:19,088 - INFO - Configuration setup complete
2025-10-19 21:07:19,088 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp_g4vsm7c/training_outputs'), sequential_sampling=False, backend='tensorflow')
2025-10-19 21:07:19,088 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-19 21:07:19,088 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-19 21:07:19,088 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-19 21:07:19,105 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-19 21:07:19,106 - INFO - Randomly subsampled 64 images
2025-10-19 21:07:19,124 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-19 21:07:19,140 - INFO - Using full dataset of 1087 images
2025-10-19 21:07:19,155 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-19 21:07:19,156 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-19 21:07:19,156 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 21:07:19,156 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-19 21:07:19,156 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 21:07:19,156 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 21:07:19,156 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 21:07:19,156 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 21:07:19,156 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-19 21:07:19,156 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-19 21:07:19,156 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-19 21:07:19,156 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-19 21:07:19,156 - INFO - Using all 64 points as seeds
2025-10-19 21:07:19,156 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 21:07:19,156 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-19 21:07:19,156 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-19 21:07:19,156 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-19 21:07:19,156 - INFO - Generated 64 groups efficiently
2025-10-19 21:07:20,124 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-19 21:07:20,124 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 21:07:20,124 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-19 21:07:20,124 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 21:07:20,124 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 21:07:20,124 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 21:07:20,124 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 21:07:20,125 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-19 21:07:20,125 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-19 21:07:20,125 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-19 21:07:20,125 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-19 21:07:20,125 - INFO - Sampled 64 seed points from 1087 total points
2025-10-19 21:07:20,125 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 21:07:20,125 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-19 21:07:20,125 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-19 21:07:20,125 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-19 21:07:20,125 - INFO - Generated 64 groups efficiently
2025-10-19 21:07:21,362 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:07:23,205 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:07:27,040 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:07:29,816 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-19 21:07:30,033 - DEBUG - Creating converter from 5 to 3
2025-10-19 21:07:31,152 - INFO - Outputs saved to /tmp/tmp_g4vsm7c/training_outputs
2025-10-19 21:07:50,711 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-19 21:07:50,883 - DEBUG - Creating converter from 7 to 5
2025-10-19 21:07:50,883 - DEBUG - Creating converter from 5 to 7
2025-10-19 21:07:50,883 - DEBUG - Creating converter from 7 to 5
2025-10-19 21:07:50,884 - DEBUG - Creating converter from 5 to 7
2025-10-19 21:07:51,492 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-19 21:07:51,499 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-19 21:07:51,500 - DEBUG - interactive is False
2025-10-19 21:07:51,500 - DEBUG - platform is linux
2025-10-19 21:07:51,528 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-19 21:07:51,530 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-19 21:07:52,521 - DEBUG - Field: train_data_file
2025-10-19 21:07:52,522 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 21:07:52,522 - DEBUG - Field default: None
2025-10-19 21:07:52,522 - DEBUG - Field: test_data_file
2025-10-19 21:07:52,522 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 21:07:52,522 - DEBUG - Field default: None
2025-10-19 21:07:52,522 - DEBUG - Field: output_dir
2025-10-19 21:07:52,522 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-19 21:07:52,522 - DEBUG - Field default: training_outputs
2025-10-19 21:07:52,522 - DEBUG - Converting path value: /tmp/tmpnmbot9mq/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-19 21:07:52,522 - DEBUG - Converting path value: /tmp/tmpnmbot9mq/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-19 21:07:52,522 - DEBUG - Converting path value: /tmp/tmpnmbot9mq/training/training_nphotons_500000.0_e2e
2025-10-19 21:07:52,522 - DEBUG - YAML config: {}
2025-10-19 21:07:52,522 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpnmbot9mq/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpnmbot9mq/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpnmbot9mq/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 21:07:52,522 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpnmbot9mq/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpnmbot9mq/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpnmbot9mq/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 21:07:52,522 - INFO - Configuration setup complete
2025-10-19 21:07:52,522 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpnmbot9mq/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmpnmbot9mq/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpnmbot9mq/training/training_nphotons_500000.0_e2e'), sequential_sampling=False, backend='tensorflow')
2025-10-19 21:07:52,522 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-19 21:07:52,522 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-19 21:07:52,523 - INFO - Loading data from /tmp/tmpnmbot9mq/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-19 21:07:52,529 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-19 21:07:52,529 - INFO - Randomly subsampled 50 images
2025-10-19 21:07:52,540 - DEBUG - Loaded metadata from /tmp/tmpnmbot9mq/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-19 21:07:52,540 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-19 21:07:52,540 - INFO - Loading data from /tmp/tmpnmbot9mq/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-19 21:07:52,545 - INFO - Using full dataset of 100 images
2025-10-19 21:07:52,546 - INFO - Loaded test data from /tmp/tmpnmbot9mq/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-19 21:07:52,546 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-19 21:07:52,546 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 21:07:52,546 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-19 21:07:52,546 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 21:07:52,546 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 21:07:52,546 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 21:07:52,546 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 21:07:52,546 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 21:07:52,546 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-19 21:07:52,546 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-19 21:07:52,546 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-19 21:07:52,546 - INFO - Using all 50 points as seeds
2025-10-19 21:07:52,546 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 21:07:52,546 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 21:07:52,547 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 21:07:52,547 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 21:07:52,547 - INFO - Generated 50 groups efficiently
2025-10-19 21:07:53,459 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-19 21:07:53,459 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 21:07:53,459 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-19 21:07:53,459 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 21:07:53,459 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 21:07:53,459 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 21:07:53,459 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 21:07:53,459 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 21:07:53,459 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-19 21:07:53,459 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-19 21:07:53,459 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-19 21:07:53,459 - INFO - Sampled 50 seed points from 100 total points
2025-10-19 21:07:53,459 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 21:07:53,459 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 21:07:53,459 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 21:07:53,459 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 21:07:53,459 - INFO - Generated 50 groups efficiently
2025-10-19 21:07:54,634 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:07:56,491 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:08:00,002 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:08:03,164 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-19 21:08:03,180 - DEBUG - Creating converter from 5 to 3
2025-10-19 21:08:04,306 - INFO - Outputs saved to /tmp/tmpnmbot9mq/training/training_nphotons_500000.0_e2e
2025-10-19 21:08:18,836 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-19 21:08:19,012 - DEBUG - Creating converter from 7 to 5
2025-10-19 21:08:19,012 - DEBUG - Creating converter from 5 to 7
2025-10-19 21:08:19,012 - DEBUG - Creating converter from 7 to 5
2025-10-19 21:08:19,012 - DEBUG - Creating converter from 5 to 7
2025-10-19 21:08:19,626 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-19 21:08:19,634 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-19 21:08:19,634 - DEBUG - interactive is False
2025-10-19 21:08:19,634 - DEBUG - platform is linux
2025-10-19 21:08:19,663 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-19 21:08:19,664 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-19 21:08:20,669 - DEBUG - Field: train_data_file
2025-10-19 21:08:20,669 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 21:08:20,669 - DEBUG - Field default: None
2025-10-19 21:08:20,669 - DEBUG - Field: test_data_file
2025-10-19 21:08:20,669 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 21:08:20,669 - DEBUG - Field default: None
2025-10-19 21:08:20,670 - DEBUG - Field: output_dir
2025-10-19 21:08:20,670 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-19 21:08:20,670 - DEBUG - Field default: training_outputs
2025-10-19 21:08:20,670 - DEBUG - Converting path value: /tmp/tmpn9yve412/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-19 21:08:20,670 - DEBUG - Converting path value: /tmp/tmpn9yve412/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-19 21:08:20,670 - DEBUG - Converting path value: /tmp/tmpn9yve412/training/training_nphotons_1000000.0_single
2025-10-19 21:08:20,670 - DEBUG - YAML config: {}
2025-10-19 21:08:20,670 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpn9yve412/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpn9yve412/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpn9yve412/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 21:08:20,670 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpn9yve412/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpn9yve412/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpn9yve412/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 21:08:20,670 - INFO - Configuration setup complete
2025-10-19 21:08:20,670 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpn9yve412/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmpn9yve412/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpn9yve412/training/training_nphotons_1000000.0_single'), sequential_sampling=False, backend='tensorflow')
2025-10-19 21:08:20,670 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-19 21:08:20,670 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-19 21:08:20,670 - INFO - Loading data from /tmp/tmpn9yve412/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-19 21:08:20,677 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-19 21:08:20,677 - INFO - Randomly subsampled 50 images
2025-10-19 21:08:20,688 - DEBUG - Loaded metadata from /tmp/tmpn9yve412/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-19 21:08:20,688 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-19 21:08:20,688 - INFO - Loading data from /tmp/tmpn9yve412/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-19 21:08:20,694 - INFO - Using full dataset of 100 images
2025-10-19 21:08:20,694 - INFO - Loaded test data from /tmp/tmpn9yve412/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-19 21:08:20,695 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-19 21:08:20,695 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 21:08:20,695 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-19 21:08:20,695 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 21:08:20,695 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 21:08:20,695 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 21:08:20,695 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 21:08:20,695 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 21:08:20,695 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-19 21:08:20,695 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-19 21:08:20,695 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-19 21:08:20,695 - INFO - Using all 50 points as seeds
2025-10-19 21:08:20,695 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 21:08:20,695 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 21:08:20,695 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 21:08:20,695 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 21:08:20,695 - INFO - Generated 50 groups efficiently
2025-10-19 21:08:21,610 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-19 21:08:21,610 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 21:08:21,610 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-19 21:08:21,610 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 21:08:21,610 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 21:08:21,610 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 21:08:21,610 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 21:08:21,610 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 21:08:21,610 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-19 21:08:21,610 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-19 21:08:21,611 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-19 21:08:21,611 - INFO - Sampled 50 seed points from 100 total points
2025-10-19 21:08:21,611 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 21:08:21,611 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 21:08:21,611 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 21:08:21,611 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 21:08:21,611 - INFO - Generated 50 groups efficiently
2025-10-19 21:08:22,779 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:08:24,614 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:08:28,173 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:08:31,374 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-19 21:08:31,389 - DEBUG - Creating converter from 5 to 3
2025-10-19 21:08:32,501 - INFO - Outputs saved to /tmp/tmpn9yve412/training/training_nphotons_1000000.0_single
2025-10-19 21:09:02,233 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-19 21:09:02,409 - DEBUG - Creating converter from 7 to 5
2025-10-19 21:09:02,409 - DEBUG - Creating converter from 5 to 7
2025-10-19 21:09:02,409 - DEBUG - Creating converter from 7 to 5
2025-10-19 21:09:02,409 - DEBUG - Creating converter from 5 to 7
2025-10-19 21:09:03,027 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-19 21:09:03,034 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-19 21:09:03,035 - DEBUG - interactive is False
2025-10-19 21:09:03,035 - DEBUG - platform is linux
2025-10-19 21:09:03,064 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-19 21:09:03,065 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-19 21:09:04,073 - DEBUG - Field: train_data_file
2025-10-19 21:09:04,073 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 21:09:04,073 - DEBUG - Field default: None
2025-10-19 21:09:04,073 - DEBUG - Field: test_data_file
2025-10-19 21:09:04,073 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 21:09:04,073 - DEBUG - Field default: None
2025-10-19 21:09:04,073 - DEBUG - Field: output_dir
2025-10-19 21:09:04,073 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-19 21:09:04,073 - DEBUG - Field default: training_outputs
2025-10-19 21:09:04,073 - DEBUG - Converting path value: /tmp/tmpbf5jsila/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-19 21:09:04,074 - DEBUG - Converting path value: /tmp/tmpbf5jsila/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-19 21:09:04,074 - DEBUG - Converting path value: /tmp/tmpbf5jsila/training/training_mismatch_test
2025-10-19 21:09:04,074 - DEBUG - YAML config: {}
2025-10-19 21:09:04,074 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpbf5jsila/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpbf5jsila/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpbf5jsila/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 21:09:04,074 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpbf5jsila/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpbf5jsila/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpbf5jsila/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 21:09:04,074 - INFO - Configuration setup complete
2025-10-19 21:09:04,074 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpbf5jsila/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmpbf5jsila/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpbf5jsila/training/training_mismatch_test'), sequential_sampling=False, backend='tensorflow')
2025-10-19 21:09:04,074 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-19 21:09:04,074 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-19 21:09:04,074 - INFO - Loading data from /tmp/tmpbf5jsila/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-19 21:09:04,079 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-19 21:09:04,080 - INFO - Randomly subsampled 50 images
2025-10-19 21:09:04,090 - DEBUG - Loaded metadata from /tmp/tmpbf5jsila/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-19 21:09:04,090 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-19 21:09:04,090 - INFO - Loading data from /tmp/tmpbf5jsila/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-19 21:09:04,094 - INFO - Using full dataset of 100 images
2025-10-19 21:09:04,095 - INFO - Loaded test data from /tmp/tmpbf5jsila/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-19 21:09:04,095 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-19 21:09:04,095 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 21:09:04,095 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-19 21:09:04,095 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 21:09:04,095 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 21:09:04,095 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 21:09:04,095 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 21:09:04,095 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 21:09:04,095 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-19 21:09:04,096 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-19 21:09:04,096 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-19 21:09:04,096 - INFO - Using all 50 points as seeds
2025-10-19 21:09:04,096 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 21:09:04,096 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 21:09:04,096 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 21:09:04,096 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 21:09:04,096 - INFO - Generated 50 groups efficiently
2025-10-19 21:09:05,012 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-19 21:09:05,012 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 21:09:05,012 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-19 21:09:05,012 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 21:09:05,012 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 21:09:05,012 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 21:09:05,012 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 21:09:05,012 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 21:09:05,012 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-19 21:09:05,012 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-19 21:09:05,012 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-19 21:09:05,012 - INFO - Sampled 50 seed points from 100 total points
2025-10-19 21:09:05,012 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 21:09:05,012 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 21:09:05,012 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 21:09:05,012 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 21:09:05,012 - INFO - Generated 50 groups efficiently
2025-10-19 21:09:06,197 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:09:08,036 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:09:11,510 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:09:14,758 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-19 21:09:14,773 - DEBUG - Creating converter from 5 to 3
2025-10-19 21:09:15,874 - INFO - Outputs saved to /tmp/tmpbf5jsila/training/training_mismatch_test
2025-10-19 21:28:37,704 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-19 21:28:37,875 - DEBUG - Creating converter from 7 to 5
2025-10-19 21:28:37,875 - DEBUG - Creating converter from 5 to 7
2025-10-19 21:28:37,875 - DEBUG - Creating converter from 7 to 5
2025-10-19 21:28:37,875 - DEBUG - Creating converter from 5 to 7
2025-10-19 21:28:38,481 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-19 21:28:38,489 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-19 21:28:38,489 - DEBUG - interactive is False
2025-10-19 21:28:38,489 - DEBUG - platform is linux
2025-10-19 21:28:38,518 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-19 21:28:38,520 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-19 21:28:39,512 - DEBUG - Field: train_data_file
2025-10-19 21:28:39,512 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 21:28:39,512 - DEBUG - Field default: None
2025-10-19 21:28:39,512 - DEBUG - Field: test_data_file
2025-10-19 21:28:39,512 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 21:28:39,512 - DEBUG - Field default: None
2025-10-19 21:28:39,512 - DEBUG - Field: output_dir
2025-10-19 21:28:39,512 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-19 21:28:39,512 - DEBUG - Field default: training_outputs
2025-10-19 21:28:39,512 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-19 21:28:39,512 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-19 21:28:39,512 - DEBUG - Converting path value: /tmp/tmpwlnxh7u4/training_outputs
2025-10-19 21:28:39,512 - DEBUG - YAML config: {}
2025-10-19 21:28:39,512 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpwlnxh7u4/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 21:28:39,512 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpwlnxh7u4/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 21:28:39,513 - INFO - Configuration setup complete
2025-10-19 21:28:39,513 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpwlnxh7u4/training_outputs'), sequential_sampling=False, backend='tensorflow')
2025-10-19 21:28:39,513 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-19 21:28:39,513 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-19 21:28:39,513 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-19 21:28:39,531 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-19 21:28:39,531 - INFO - Randomly subsampled 64 images
2025-10-19 21:28:39,548 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-19 21:28:39,563 - INFO - Using full dataset of 1087 images
2025-10-19 21:28:39,577 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-19 21:28:39,578 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-19 21:28:39,578 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 21:28:39,578 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-19 21:28:39,578 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 21:28:39,578 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 21:28:39,578 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 21:28:39,578 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 21:28:39,578 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-19 21:28:39,578 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-19 21:28:39,578 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-19 21:28:39,578 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-19 21:28:39,578 - INFO - Using all 64 points as seeds
2025-10-19 21:28:39,578 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 21:28:39,578 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-19 21:28:39,578 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-19 21:28:39,578 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-19 21:28:39,578 - INFO - Generated 64 groups efficiently
2025-10-19 21:28:40,548 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-19 21:28:40,549 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 21:28:40,549 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-19 21:28:40,549 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 21:28:40,549 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 21:28:40,549 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 21:28:40,549 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 21:28:40,549 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-19 21:28:40,549 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-19 21:28:40,549 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-19 21:28:40,549 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-19 21:28:40,549 - INFO - Sampled 64 seed points from 1087 total points
2025-10-19 21:28:40,549 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 21:28:40,549 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-19 21:28:40,549 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-19 21:28:40,549 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-19 21:28:40,549 - INFO - Generated 64 groups efficiently
2025-10-19 21:28:41,782 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:28:43,622 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:28:47,481 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:28:50,258 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-19 21:28:50,480 - DEBUG - Creating converter from 5 to 3
2025-10-19 21:28:51,603 - INFO - Outputs saved to /tmp/tmpwlnxh7u4/training_outputs
2025-10-19 21:29:11,034 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-19 21:29:11,207 - DEBUG - Creating converter from 7 to 5
2025-10-19 21:29:11,207 - DEBUG - Creating converter from 5 to 7
2025-10-19 21:29:11,207 - DEBUG - Creating converter from 7 to 5
2025-10-19 21:29:11,207 - DEBUG - Creating converter from 5 to 7
2025-10-19 21:29:11,826 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-19 21:29:11,834 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-19 21:29:11,834 - DEBUG - interactive is False
2025-10-19 21:29:11,834 - DEBUG - platform is linux
2025-10-19 21:29:11,864 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-19 21:29:11,865 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-19 21:29:12,878 - DEBUG - Field: train_data_file
2025-10-19 21:29:12,878 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 21:29:12,878 - DEBUG - Field default: None
2025-10-19 21:29:12,878 - DEBUG - Field: test_data_file
2025-10-19 21:29:12,878 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 21:29:12,878 - DEBUG - Field default: None
2025-10-19 21:29:12,878 - DEBUG - Field: output_dir
2025-10-19 21:29:12,878 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-19 21:29:12,878 - DEBUG - Field default: training_outputs
2025-10-19 21:29:12,879 - DEBUG - Converting path value: /tmp/tmp7b2dxhpc/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-19 21:29:12,879 - DEBUG - Converting path value: /tmp/tmp7b2dxhpc/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-19 21:29:12,879 - DEBUG - Converting path value: /tmp/tmp7b2dxhpc/training/training_nphotons_500000.0_e2e
2025-10-19 21:29:12,879 - DEBUG - YAML config: {}
2025-10-19 21:29:12,879 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp7b2dxhpc/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmp7b2dxhpc/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp7b2dxhpc/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 21:29:12,879 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp7b2dxhpc/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmp7b2dxhpc/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp7b2dxhpc/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 21:29:12,879 - INFO - Configuration setup complete
2025-10-19 21:29:12,879 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp7b2dxhpc/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmp7b2dxhpc/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp7b2dxhpc/training/training_nphotons_500000.0_e2e'), sequential_sampling=False, backend='tensorflow')
2025-10-19 21:29:12,879 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-19 21:29:12,879 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-19 21:29:12,879 - INFO - Loading data from /tmp/tmp7b2dxhpc/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-19 21:29:12,885 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-19 21:29:12,885 - INFO - Randomly subsampled 50 images
2025-10-19 21:29:12,897 - DEBUG - Loaded metadata from /tmp/tmp7b2dxhpc/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-19 21:29:12,897 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-19 21:29:12,897 - INFO - Loading data from /tmp/tmp7b2dxhpc/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-19 21:29:12,902 - INFO - Using full dataset of 100 images
2025-10-19 21:29:12,903 - INFO - Loaded test data from /tmp/tmp7b2dxhpc/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-19 21:29:12,903 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-19 21:29:12,903 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 21:29:12,903 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-19 21:29:12,903 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 21:29:12,903 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 21:29:12,903 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 21:29:12,903 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 21:29:12,903 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 21:29:12,903 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-19 21:29:12,903 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-19 21:29:12,903 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-19 21:29:12,903 - INFO - Using all 50 points as seeds
2025-10-19 21:29:12,903 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 21:29:12,903 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 21:29:12,903 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 21:29:12,903 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 21:29:12,903 - INFO - Generated 50 groups efficiently
2025-10-19 21:29:13,816 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-19 21:29:13,816 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 21:29:13,816 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-19 21:29:13,816 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 21:29:13,816 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 21:29:13,816 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 21:29:13,816 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 21:29:13,816 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 21:29:13,816 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-19 21:29:13,816 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-19 21:29:13,816 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-19 21:29:13,816 - INFO - Sampled 50 seed points from 100 total points
2025-10-19 21:29:13,816 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 21:29:13,816 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 21:29:13,816 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 21:29:13,816 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 21:29:13,816 - INFO - Generated 50 groups efficiently
2025-10-19 21:29:15,007 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:29:16,885 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:29:20,413 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:29:23,637 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-19 21:29:23,656 - DEBUG - Creating converter from 5 to 3
2025-10-19 21:29:24,768 - INFO - Outputs saved to /tmp/tmp7b2dxhpc/training/training_nphotons_500000.0_e2e
2025-10-19 21:29:39,284 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-19 21:29:39,462 - DEBUG - Creating converter from 7 to 5
2025-10-19 21:29:39,462 - DEBUG - Creating converter from 5 to 7
2025-10-19 21:29:39,462 - DEBUG - Creating converter from 7 to 5
2025-10-19 21:29:39,462 - DEBUG - Creating converter from 5 to 7
2025-10-19 21:29:40,084 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-19 21:29:40,091 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-19 21:29:40,092 - DEBUG - interactive is False
2025-10-19 21:29:40,092 - DEBUG - platform is linux
2025-10-19 21:29:40,121 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-19 21:29:40,122 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-19 21:29:41,126 - DEBUG - Field: train_data_file
2025-10-19 21:29:41,126 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 21:29:41,126 - DEBUG - Field default: None
2025-10-19 21:29:41,127 - DEBUG - Field: test_data_file
2025-10-19 21:29:41,127 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 21:29:41,127 - DEBUG - Field default: None
2025-10-19 21:29:41,127 - DEBUG - Field: output_dir
2025-10-19 21:29:41,127 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-19 21:29:41,127 - DEBUG - Field default: training_outputs
2025-10-19 21:29:41,127 - DEBUG - Converting path value: /tmp/tmpe1eztzzh/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-19 21:29:41,127 - DEBUG - Converting path value: /tmp/tmpe1eztzzh/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-19 21:29:41,127 - DEBUG - Converting path value: /tmp/tmpe1eztzzh/training/training_nphotons_1000000.0_single
2025-10-19 21:29:41,127 - DEBUG - YAML config: {}
2025-10-19 21:29:41,127 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpe1eztzzh/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpe1eztzzh/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpe1eztzzh/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 21:29:41,127 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpe1eztzzh/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpe1eztzzh/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpe1eztzzh/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 21:29:41,127 - INFO - Configuration setup complete
2025-10-19 21:29:41,127 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpe1eztzzh/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmpe1eztzzh/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpe1eztzzh/training/training_nphotons_1000000.0_single'), sequential_sampling=False, backend='tensorflow')
2025-10-19 21:29:41,127 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-19 21:29:41,127 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-19 21:29:41,127 - INFO - Loading data from /tmp/tmpe1eztzzh/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-19 21:29:41,134 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-19 21:29:41,134 - INFO - Randomly subsampled 50 images
2025-10-19 21:29:41,146 - DEBUG - Loaded metadata from /tmp/tmpe1eztzzh/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-19 21:29:41,146 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-19 21:29:41,146 - INFO - Loading data from /tmp/tmpe1eztzzh/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-19 21:29:41,152 - INFO - Using full dataset of 100 images
2025-10-19 21:29:41,152 - INFO - Loaded test data from /tmp/tmpe1eztzzh/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-19 21:29:41,153 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-19 21:29:41,153 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 21:29:41,153 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-19 21:29:41,153 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 21:29:41,153 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 21:29:41,153 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 21:29:41,153 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 21:29:41,153 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 21:29:41,153 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-19 21:29:41,153 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-19 21:29:41,153 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-19 21:29:41,153 - INFO - Using all 50 points as seeds
2025-10-19 21:29:41,153 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 21:29:41,153 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 21:29:41,153 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 21:29:41,153 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 21:29:41,153 - INFO - Generated 50 groups efficiently
2025-10-19 21:29:42,065 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-19 21:29:42,065 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 21:29:42,065 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-19 21:29:42,065 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 21:29:42,065 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 21:29:42,065 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 21:29:42,065 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 21:29:42,065 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 21:29:42,066 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-19 21:29:42,066 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-19 21:29:42,066 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-19 21:29:42,066 - INFO - Sampled 50 seed points from 100 total points
2025-10-19 21:29:42,066 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 21:29:42,066 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 21:29:42,066 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 21:29:42,066 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 21:29:42,066 - INFO - Generated 50 groups efficiently
2025-10-19 21:29:43,240 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:29:45,099 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:29:48,644 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:29:51,875 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-19 21:29:51,890 - DEBUG - Creating converter from 5 to 3
2025-10-19 21:29:53,010 - INFO - Outputs saved to /tmp/tmpe1eztzzh/training/training_nphotons_1000000.0_single
2025-10-19 21:30:22,674 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-19 21:30:22,850 - DEBUG - Creating converter from 7 to 5
2025-10-19 21:30:22,850 - DEBUG - Creating converter from 5 to 7
2025-10-19 21:30:22,851 - DEBUG - Creating converter from 7 to 5
2025-10-19 21:30:22,851 - DEBUG - Creating converter from 5 to 7
2025-10-19 21:30:23,473 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-19 21:30:23,481 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-19 21:30:23,481 - DEBUG - interactive is False
2025-10-19 21:30:23,481 - DEBUG - platform is linux
2025-10-19 21:30:23,510 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-19 21:30:23,512 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-19 21:30:24,522 - DEBUG - Field: train_data_file
2025-10-19 21:30:24,522 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 21:30:24,522 - DEBUG - Field default: None
2025-10-19 21:30:24,522 - DEBUG - Field: test_data_file
2025-10-19 21:30:24,522 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 21:30:24,522 - DEBUG - Field default: None
2025-10-19 21:30:24,523 - DEBUG - Field: output_dir
2025-10-19 21:30:24,523 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-19 21:30:24,523 - DEBUG - Field default: training_outputs
2025-10-19 21:30:24,523 - DEBUG - Converting path value: /tmp/tmpxb44_u2u/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-19 21:30:24,523 - DEBUG - Converting path value: /tmp/tmpxb44_u2u/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-19 21:30:24,523 - DEBUG - Converting path value: /tmp/tmpxb44_u2u/training/training_mismatch_test
2025-10-19 21:30:24,523 - DEBUG - YAML config: {}
2025-10-19 21:30:24,523 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpxb44_u2u/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpxb44_u2u/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpxb44_u2u/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 21:30:24,523 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpxb44_u2u/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpxb44_u2u/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpxb44_u2u/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 21:30:24,523 - INFO - Configuration setup complete
2025-10-19 21:30:24,523 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpxb44_u2u/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmpxb44_u2u/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpxb44_u2u/training/training_mismatch_test'), sequential_sampling=False, backend='tensorflow')
2025-10-19 21:30:24,523 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-19 21:30:24,523 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-19 21:30:24,523 - INFO - Loading data from /tmp/tmpxb44_u2u/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-19 21:30:24,529 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-19 21:30:24,529 - INFO - Randomly subsampled 50 images
2025-10-19 21:30:24,539 - DEBUG - Loaded metadata from /tmp/tmpxb44_u2u/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-19 21:30:24,539 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-19 21:30:24,539 - INFO - Loading data from /tmp/tmpxb44_u2u/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-19 21:30:24,544 - INFO - Using full dataset of 100 images
2025-10-19 21:30:24,544 - INFO - Loaded test data from /tmp/tmpxb44_u2u/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-19 21:30:24,545 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-19 21:30:24,545 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 21:30:24,545 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-19 21:30:24,545 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 21:30:24,545 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 21:30:24,545 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 21:30:24,545 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 21:30:24,545 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 21:30:24,545 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-19 21:30:24,545 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-19 21:30:24,545 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-19 21:30:24,545 - INFO - Using all 50 points as seeds
2025-10-19 21:30:24,545 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 21:30:24,545 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 21:30:24,545 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 21:30:24,545 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 21:30:24,545 - INFO - Generated 50 groups efficiently
2025-10-19 21:30:25,450 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-19 21:30:25,450 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 21:30:25,450 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-19 21:30:25,450 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 21:30:25,450 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 21:30:25,450 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 21:30:25,450 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 21:30:25,450 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 21:30:25,450 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-19 21:30:25,450 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-19 21:30:25,450 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-19 21:30:25,450 - INFO - Sampled 50 seed points from 100 total points
2025-10-19 21:30:25,450 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 21:30:25,450 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 21:30:25,450 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 21:30:25,450 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 21:30:25,450 - INFO - Generated 50 groups efficiently
2025-10-19 21:30:26,622 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:30:28,469 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:30:31,990 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:30:35,205 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-19 21:30:35,221 - DEBUG - Creating converter from 5 to 3
2025-10-19 21:30:36,324 - INFO - Outputs saved to /tmp/tmpxb44_u2u/training/training_mismatch_test
2025-10-19 21:56:28,585 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-19 21:56:28,762 - DEBUG - Creating converter from 7 to 5
2025-10-19 21:56:28,762 - DEBUG - Creating converter from 5 to 7
2025-10-19 21:56:28,762 - DEBUG - Creating converter from 7 to 5
2025-10-19 21:56:28,762 - DEBUG - Creating converter from 5 to 7
2025-10-19 21:56:29,383 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-19 21:56:29,390 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-19 21:56:29,390 - DEBUG - interactive is False
2025-10-19 21:56:29,390 - DEBUG - platform is linux
2025-10-19 21:56:29,419 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-19 21:56:29,421 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-19 21:56:30,426 - DEBUG - Field: train_data_file
2025-10-19 21:56:30,426 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 21:56:30,426 - DEBUG - Field default: None
2025-10-19 21:56:30,426 - DEBUG - Field: test_data_file
2025-10-19 21:56:30,426 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 21:56:30,426 - DEBUG - Field default: None
2025-10-19 21:56:30,426 - DEBUG - Field: output_dir
2025-10-19 21:56:30,426 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-19 21:56:30,426 - DEBUG - Field default: training_outputs
2025-10-19 21:56:30,426 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-19 21:56:30,426 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-19 21:56:30,426 - DEBUG - Converting path value: /tmp/tmp9eby8mnw/training_outputs
2025-10-19 21:56:30,426 - DEBUG - YAML config: {}
2025-10-19 21:56:30,426 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp9eby8mnw/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 21:56:30,426 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp9eby8mnw/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 21:56:30,427 - INFO - Configuration setup complete
2025-10-19 21:56:30,427 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp9eby8mnw/training_outputs'), sequential_sampling=False, backend='tensorflow')
2025-10-19 21:56:30,427 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-19 21:56:30,427 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-19 21:56:30,427 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-19 21:56:30,443 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-19 21:56:30,443 - INFO - Randomly subsampled 64 images
2025-10-19 21:56:30,460 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-19 21:56:30,476 - INFO - Using full dataset of 1087 images
2025-10-19 21:56:30,491 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-19 21:56:30,491 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-19 21:56:30,492 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 21:56:30,492 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-19 21:56:30,492 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 21:56:30,492 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 21:56:30,492 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 21:56:30,492 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 21:56:30,492 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-19 21:56:30,492 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-19 21:56:30,492 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-19 21:56:30,492 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-19 21:56:30,492 - INFO - Using all 64 points as seeds
2025-10-19 21:56:30,492 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 21:56:30,492 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-19 21:56:30,492 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-19 21:56:30,492 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-19 21:56:30,492 - INFO - Generated 64 groups efficiently
2025-10-19 21:56:31,461 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-19 21:56:31,461 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 21:56:31,461 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-19 21:56:31,461 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 21:56:31,461 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 21:56:31,461 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 21:56:31,461 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 21:56:31,461 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-19 21:56:31,461 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-19 21:56:31,461 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-19 21:56:31,461 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-19 21:56:31,462 - INFO - Sampled 64 seed points from 1087 total points
2025-10-19 21:56:31,462 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 21:56:31,462 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-19 21:56:31,462 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-19 21:56:31,462 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-19 21:56:31,462 - INFO - Generated 64 groups efficiently
2025-10-19 21:56:32,697 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:56:34,526 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:56:38,362 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:56:41,195 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-19 21:56:41,423 - DEBUG - Creating converter from 5 to 3
2025-10-19 21:56:42,535 - INFO - Outputs saved to /tmp/tmp9eby8mnw/training_outputs
2025-10-19 21:57:01,974 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-19 21:57:02,145 - DEBUG - Creating converter from 7 to 5
2025-10-19 21:57:02,145 - DEBUG - Creating converter from 5 to 7
2025-10-19 21:57:02,145 - DEBUG - Creating converter from 7 to 5
2025-10-19 21:57:02,145 - DEBUG - Creating converter from 5 to 7
2025-10-19 21:57:02,754 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-19 21:57:02,761 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-19 21:57:02,761 - DEBUG - interactive is False
2025-10-19 21:57:02,761 - DEBUG - platform is linux
2025-10-19 21:57:02,790 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-19 21:57:02,792 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-19 21:57:03,787 - DEBUG - Field: train_data_file
2025-10-19 21:57:03,787 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 21:57:03,787 - DEBUG - Field default: None
2025-10-19 21:57:03,787 - DEBUG - Field: test_data_file
2025-10-19 21:57:03,787 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 21:57:03,787 - DEBUG - Field default: None
2025-10-19 21:57:03,787 - DEBUG - Field: output_dir
2025-10-19 21:57:03,787 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-19 21:57:03,787 - DEBUG - Field default: training_outputs
2025-10-19 21:57:03,787 - DEBUG - Converting path value: /tmp/tmp6e8w_fe8/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-19 21:57:03,787 - DEBUG - Converting path value: /tmp/tmp6e8w_fe8/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-19 21:57:03,787 - DEBUG - Converting path value: /tmp/tmp6e8w_fe8/training/training_nphotons_500000.0_e2e
2025-10-19 21:57:03,787 - DEBUG - YAML config: {}
2025-10-19 21:57:03,787 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp6e8w_fe8/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmp6e8w_fe8/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp6e8w_fe8/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 21:57:03,787 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp6e8w_fe8/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmp6e8w_fe8/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp6e8w_fe8/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 21:57:03,787 - INFO - Configuration setup complete
2025-10-19 21:57:03,787 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp6e8w_fe8/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmp6e8w_fe8/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp6e8w_fe8/training/training_nphotons_500000.0_e2e'), sequential_sampling=False, backend='tensorflow')
2025-10-19 21:57:03,787 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-19 21:57:03,788 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-19 21:57:03,788 - INFO - Loading data from /tmp/tmp6e8w_fe8/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-19 21:57:03,794 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-19 21:57:03,794 - INFO - Randomly subsampled 50 images
2025-10-19 21:57:03,805 - DEBUG - Loaded metadata from /tmp/tmp6e8w_fe8/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-19 21:57:03,806 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-19 21:57:03,806 - INFO - Loading data from /tmp/tmp6e8w_fe8/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-19 21:57:03,811 - INFO - Using full dataset of 100 images
2025-10-19 21:57:03,811 - INFO - Loaded test data from /tmp/tmp6e8w_fe8/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-19 21:57:03,812 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-19 21:57:03,812 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 21:57:03,812 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-19 21:57:03,812 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 21:57:03,812 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 21:57:03,812 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 21:57:03,812 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 21:57:03,812 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 21:57:03,812 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-19 21:57:03,812 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-19 21:57:03,812 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-19 21:57:03,812 - INFO - Using all 50 points as seeds
2025-10-19 21:57:03,812 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 21:57:03,812 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 21:57:03,812 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 21:57:03,812 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 21:57:03,812 - INFO - Generated 50 groups efficiently
2025-10-19 21:57:04,724 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-19 21:57:04,724 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 21:57:04,724 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-19 21:57:04,724 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 21:57:04,724 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 21:57:04,724 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 21:57:04,724 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 21:57:04,724 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 21:57:04,724 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-19 21:57:04,724 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-19 21:57:04,724 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-19 21:57:04,724 - INFO - Sampled 50 seed points from 100 total points
2025-10-19 21:57:04,724 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 21:57:04,724 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 21:57:04,725 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 21:57:04,725 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 21:57:04,725 - INFO - Generated 50 groups efficiently
2025-10-19 21:57:05,913 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:57:07,746 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:57:11,301 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:57:14,490 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-19 21:57:14,507 - DEBUG - Creating converter from 5 to 3
2025-10-19 21:57:15,636 - INFO - Outputs saved to /tmp/tmp6e8w_fe8/training/training_nphotons_500000.0_e2e
2025-10-19 21:57:30,112 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-19 21:57:30,288 - DEBUG - Creating converter from 7 to 5
2025-10-19 21:57:30,288 - DEBUG - Creating converter from 5 to 7
2025-10-19 21:57:30,288 - DEBUG - Creating converter from 7 to 5
2025-10-19 21:57:30,288 - DEBUG - Creating converter from 5 to 7
2025-10-19 21:57:30,898 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-19 21:57:30,906 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-19 21:57:30,906 - DEBUG - interactive is False
2025-10-19 21:57:30,906 - DEBUG - platform is linux
2025-10-19 21:57:30,935 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-19 21:57:30,937 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-19 21:57:31,931 - DEBUG - Field: train_data_file
2025-10-19 21:57:31,932 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 21:57:31,932 - DEBUG - Field default: None
2025-10-19 21:57:31,932 - DEBUG - Field: test_data_file
2025-10-19 21:57:31,932 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 21:57:31,932 - DEBUG - Field default: None
2025-10-19 21:57:31,932 - DEBUG - Field: output_dir
2025-10-19 21:57:31,932 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-19 21:57:31,932 - DEBUG - Field default: training_outputs
2025-10-19 21:57:31,932 - DEBUG - Converting path value: /tmp/tmp1qgn9hsg/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-19 21:57:31,932 - DEBUG - Converting path value: /tmp/tmp1qgn9hsg/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-19 21:57:31,932 - DEBUG - Converting path value: /tmp/tmp1qgn9hsg/training/training_nphotons_1000000.0_single
2025-10-19 21:57:31,932 - DEBUG - YAML config: {}
2025-10-19 21:57:31,932 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp1qgn9hsg/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmp1qgn9hsg/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp1qgn9hsg/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 21:57:31,932 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp1qgn9hsg/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmp1qgn9hsg/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp1qgn9hsg/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 21:57:31,932 - INFO - Configuration setup complete
2025-10-19 21:57:31,932 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp1qgn9hsg/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmp1qgn9hsg/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp1qgn9hsg/training/training_nphotons_1000000.0_single'), sequential_sampling=False, backend='tensorflow')
2025-10-19 21:57:31,932 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-19 21:57:31,932 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-19 21:57:31,933 - INFO - Loading data from /tmp/tmp1qgn9hsg/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-19 21:57:31,939 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-19 21:57:31,939 - INFO - Randomly subsampled 50 images
2025-10-19 21:57:31,950 - DEBUG - Loaded metadata from /tmp/tmp1qgn9hsg/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-19 21:57:31,950 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-19 21:57:31,950 - INFO - Loading data from /tmp/tmp1qgn9hsg/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-19 21:57:31,956 - INFO - Using full dataset of 100 images
2025-10-19 21:57:31,956 - INFO - Loaded test data from /tmp/tmp1qgn9hsg/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-19 21:57:31,957 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-19 21:57:31,957 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 21:57:31,957 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-19 21:57:31,957 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 21:57:31,957 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 21:57:31,957 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 21:57:31,957 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 21:57:31,957 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 21:57:31,957 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-19 21:57:31,957 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-19 21:57:31,957 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-19 21:57:31,957 - INFO - Using all 50 points as seeds
2025-10-19 21:57:31,957 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 21:57:31,957 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 21:57:31,957 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 21:57:31,957 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 21:57:31,957 - INFO - Generated 50 groups efficiently
2025-10-19 21:57:32,865 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-19 21:57:32,865 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 21:57:32,865 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-19 21:57:32,865 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 21:57:32,865 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 21:57:32,865 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 21:57:32,865 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 21:57:32,865 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 21:57:32,865 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-19 21:57:32,865 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-19 21:57:32,865 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-19 21:57:32,865 - INFO - Sampled 50 seed points from 100 total points
2025-10-19 21:57:32,865 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 21:57:32,865 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 21:57:32,865 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 21:57:32,865 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 21:57:32,865 - INFO - Generated 50 groups efficiently
2025-10-19 21:57:34,045 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:57:35,912 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:57:39,474 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:57:42,691 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-19 21:57:42,707 - DEBUG - Creating converter from 5 to 3
2025-10-19 21:57:43,835 - INFO - Outputs saved to /tmp/tmp1qgn9hsg/training/training_nphotons_1000000.0_single
2025-10-19 21:58:13,617 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-19 21:58:13,795 - DEBUG - Creating converter from 7 to 5
2025-10-19 21:58:13,795 - DEBUG - Creating converter from 5 to 7
2025-10-19 21:58:13,795 - DEBUG - Creating converter from 7 to 5
2025-10-19 21:58:13,795 - DEBUG - Creating converter from 5 to 7
2025-10-19 21:58:14,424 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-19 21:58:14,432 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-19 21:58:14,432 - DEBUG - interactive is False
2025-10-19 21:58:14,432 - DEBUG - platform is linux
2025-10-19 21:58:14,461 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-19 21:58:14,463 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-19 21:58:15,477 - DEBUG - Field: train_data_file
2025-10-19 21:58:15,477 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 21:58:15,477 - DEBUG - Field default: None
2025-10-19 21:58:15,477 - DEBUG - Field: test_data_file
2025-10-19 21:58:15,477 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-19 21:58:15,477 - DEBUG - Field default: None
2025-10-19 21:58:15,477 - DEBUG - Field: output_dir
2025-10-19 21:58:15,477 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-19 21:58:15,477 - DEBUG - Field default: training_outputs
2025-10-19 21:58:15,478 - DEBUG - Converting path value: /tmp/tmpypjerp1y/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-19 21:58:15,478 - DEBUG - Converting path value: /tmp/tmpypjerp1y/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-19 21:58:15,478 - DEBUG - Converting path value: /tmp/tmpypjerp1y/training/training_mismatch_test
2025-10-19 21:58:15,478 - DEBUG - YAML config: {}
2025-10-19 21:58:15,478 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpypjerp1y/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpypjerp1y/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpypjerp1y/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 21:58:15,478 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpypjerp1y/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpypjerp1y/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpypjerp1y/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-19 21:58:15,478 - INFO - Configuration setup complete
2025-10-19 21:58:15,478 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpypjerp1y/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmpypjerp1y/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpypjerp1y/training/training_mismatch_test'), sequential_sampling=False, backend='tensorflow')
2025-10-19 21:58:15,478 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-19 21:58:15,478 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-19 21:58:15,478 - INFO - Loading data from /tmp/tmpypjerp1y/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-19 21:58:15,483 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-19 21:58:15,484 - INFO - Randomly subsampled 50 images
2025-10-19 21:58:15,494 - DEBUG - Loaded metadata from /tmp/tmpypjerp1y/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-19 21:58:15,494 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-19 21:58:15,494 - INFO - Loading data from /tmp/tmpypjerp1y/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-19 21:58:15,498 - INFO - Using full dataset of 100 images
2025-10-19 21:58:15,499 - INFO - Loaded test data from /tmp/tmpypjerp1y/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-19 21:58:15,499 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-19 21:58:15,499 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 21:58:15,499 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-19 21:58:15,499 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 21:58:15,499 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 21:58:15,499 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 21:58:15,499 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 21:58:15,499 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 21:58:15,499 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-19 21:58:15,499 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-19 21:58:15,499 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-19 21:58:15,499 - INFO - Using all 50 points as seeds
2025-10-19 21:58:15,499 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 21:58:15,499 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 21:58:15,499 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 21:58:15,499 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 21:58:15,499 - INFO - Generated 50 groups efficiently
2025-10-19 21:58:16,435 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-19 21:58:16,435 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-19 21:58:16,435 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-19 21:58:16,435 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-19 21:58:16,435 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-19 21:58:16,435 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-19 21:58:16,435 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-19 21:58:16,435 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-19 21:58:16,435 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-19 21:58:16,435 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-19 21:58:16,435 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-19 21:58:16,435 - INFO - Sampled 50 seed points from 100 total points
2025-10-19 21:58:16,435 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-19 21:58:16,435 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-19 21:58:16,435 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-19 21:58:16,435 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-19 21:58:16,435 - INFO - Generated 50 groups efficiently
2025-10-19 21:58:17,625 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:58:19,512 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:58:23,060 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-19 21:58:26,264 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-19 21:58:26,280 - DEBUG - Creating converter from 5 to 3
2025-10-19 21:58:27,392 - INFO - Outputs saved to /tmp/tmpypjerp1y/training/training_mismatch_test
