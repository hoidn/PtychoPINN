2025-10-16 23:47:35,087 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 23:47:35,262 - DEBUG - Creating converter from 7 to 5
2025-10-16 23:47:35,263 - DEBUG - Creating converter from 5 to 7
2025-10-16 23:47:35,263 - DEBUG - Creating converter from 7 to 5
2025-10-16 23:47:35,263 - DEBUG - Creating converter from 5 to 7
2025-10-16 23:47:35,880 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 23:47:35,887 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 23:47:35,888 - DEBUG - interactive is False
2025-10-16 23:47:35,888 - DEBUG - platform is linux
2025-10-16 23:47:35,916 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 23:47:35,918 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 23:47:36,951 - DEBUG - Field: train_data_file
2025-10-16 23:47:36,952 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 23:47:36,952 - DEBUG - Field default: None
2025-10-16 23:47:36,952 - DEBUG - Field: test_data_file
2025-10-16 23:47:36,952 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 23:47:36,952 - DEBUG - Field default: None
2025-10-16 23:47:36,952 - DEBUG - Field: output_dir
2025-10-16 23:47:36,952 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 23:47:36,952 - DEBUG - Field default: training_outputs
2025-10-16 23:47:36,952 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-16 23:47:36,952 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-16 23:47:36,952 - DEBUG - Converting path value: /tmp/tmp3x5mmtza/training_outputs
2025-10-16 23:47:36,952 - DEBUG - YAML config: {}
2025-10-16 23:47:36,952 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp3x5mmtza/training_outputs'), 'sequential_sampling': False}
2025-10-16 23:47:36,952 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp3x5mmtza/training_outputs'), 'sequential_sampling': False}
2025-10-16 23:47:36,952 - INFO - Configuration setup complete
2025-10-16 23:47:36,952 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp3x5mmtza/training_outputs'), sequential_sampling=False)
2025-10-16 23:47:36,952 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-16 23:47:36,952 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-16 23:47:36,953 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-16 23:47:36,968 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-16 23:47:36,968 - INFO - Randomly subsampled 64 images
2025-10-16 23:47:36,985 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-16 23:47:37,000 - INFO - Using full dataset of 1087 images
2025-10-16 23:47:37,015 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-16 23:47:37,015 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-16 23:47:37,015 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 23:47:37,015 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-16 23:47:37,015 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 23:47:37,015 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 23:47:37,015 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 23:47:37,015 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 23:47:37,015 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-16 23:47:37,015 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-16 23:47:37,016 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-16 23:47:37,016 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-16 23:47:37,016 - INFO - Using all 64 points as seeds
2025-10-16 23:47:37,016 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 23:47:37,016 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-16 23:47:37,016 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-16 23:47:37,016 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-16 23:47:37,016 - INFO - Generated 64 groups efficiently
2025-10-16 23:47:38,575 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-16 23:47:38,575 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 23:47:38,575 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-16 23:47:38,575 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 23:47:38,575 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 23:47:38,575 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 23:47:38,575 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 23:47:38,575 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-16 23:47:38,575 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-16 23:47:38,575 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-16 23:47:38,575 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-16 23:47:38,575 - INFO - Sampled 64 seed points from 1087 total points
2025-10-16 23:47:38,575 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 23:47:38,575 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-16 23:47:38,575 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-16 23:47:38,575 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-16 23:47:38,575 - INFO - Generated 64 groups efficiently
2025-10-16 23:47:40,640 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 23:47:42,500 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 23:47:49,551 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 23:47:51,493 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 23:47:51,711 - DEBUG - Creating converter from 5 to 3
2025-10-16 23:47:52,833 - INFO - Outputs saved to /tmp/tmp3x5mmtza/training_outputs
2025-10-16 23:48:17,282 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 23:48:17,453 - DEBUG - Creating converter from 7 to 5
2025-10-16 23:48:17,453 - DEBUG - Creating converter from 5 to 7
2025-10-16 23:48:17,453 - DEBUG - Creating converter from 7 to 5
2025-10-16 23:48:17,454 - DEBUG - Creating converter from 5 to 7
2025-10-16 23:48:18,067 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 23:48:18,074 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 23:48:18,074 - DEBUG - interactive is False
2025-10-16 23:48:18,074 - DEBUG - platform is linux
2025-10-16 23:48:18,103 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 23:48:18,104 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 23:48:19,151 - DEBUG - Field: train_data_file
2025-10-16 23:48:19,151 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 23:48:19,151 - DEBUG - Field default: None
2025-10-16 23:48:19,151 - DEBUG - Field: test_data_file
2025-10-16 23:48:19,151 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 23:48:19,151 - DEBUG - Field default: None
2025-10-16 23:48:19,152 - DEBUG - Field: output_dir
2025-10-16 23:48:19,152 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 23:48:19,152 - DEBUG - Field default: training_outputs
2025-10-16 23:48:19,152 - DEBUG - Converting path value: /tmp/tmp9l89s_50/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 23:48:19,152 - DEBUG - Converting path value: /tmp/tmp9l89s_50/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 23:48:19,152 - DEBUG - Converting path value: /tmp/tmp9l89s_50/training/training_nphotons_500000.0_e2e
2025-10-16 23:48:19,152 - DEBUG - YAML config: {}
2025-10-16 23:48:19,152 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp9l89s_50/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmp9l89s_50/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp9l89s_50/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-16 23:48:19,152 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp9l89s_50/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmp9l89s_50/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp9l89s_50/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-16 23:48:19,152 - INFO - Configuration setup complete
2025-10-16 23:48:19,152 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp9l89s_50/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmp9l89s_50/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp9l89s_50/training/training_nphotons_500000.0_e2e'), sequential_sampling=False)
2025-10-16 23:48:19,152 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-16 23:48:19,152 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-16 23:48:19,152 - INFO - Loading data from /tmp/tmp9l89s_50/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-16 23:48:19,159 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-16 23:48:19,159 - INFO - Randomly subsampled 50 images
2025-10-16 23:48:19,170 - DEBUG - Loaded metadata from /tmp/tmp9l89s_50/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 23:48:19,170 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-16 23:48:19,170 - INFO - Loading data from /tmp/tmp9l89s_50/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-16 23:48:19,175 - INFO - Using full dataset of 100 images
2025-10-16 23:48:19,176 - INFO - Loaded test data from /tmp/tmp9l89s_50/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 23:48:19,176 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-16 23:48:19,176 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 23:48:19,176 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-16 23:48:19,176 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 23:48:19,176 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 23:48:19,176 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 23:48:19,176 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 23:48:19,176 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 23:48:19,176 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-16 23:48:19,176 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-16 23:48:19,176 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-16 23:48:19,176 - INFO - Using all 50 points as seeds
2025-10-16 23:48:19,176 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 23:48:19,176 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 23:48:19,176 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 23:48:19,176 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 23:48:19,176 - INFO - Generated 50 groups efficiently
2025-10-16 23:48:20,758 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-16 23:48:20,758 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 23:48:20,758 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-16 23:48:20,758 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 23:48:20,758 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 23:48:20,758 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 23:48:20,758 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 23:48:20,758 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 23:48:20,758 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-16 23:48:20,758 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-16 23:48:20,759 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-16 23:48:20,759 - INFO - Sampled 50 seed points from 100 total points
2025-10-16 23:48:20,759 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 23:48:20,759 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 23:48:20,759 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 23:48:20,759 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 23:48:20,759 - INFO - Generated 50 groups efficiently
2025-10-16 23:48:22,747 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 23:48:24,616 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 23:48:31,922 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 23:48:35,046 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 23:48:35,062 - DEBUG - Creating converter from 5 to 3
2025-10-16 23:48:36,210 - INFO - Outputs saved to /tmp/tmp9l89s_50/training/training_nphotons_500000.0_e2e
2025-10-16 23:48:54,504 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 23:48:54,673 - DEBUG - Creating converter from 7 to 5
2025-10-16 23:48:54,673 - DEBUG - Creating converter from 5 to 7
2025-10-16 23:48:54,673 - DEBUG - Creating converter from 7 to 5
2025-10-16 23:48:54,673 - DEBUG - Creating converter from 5 to 7
2025-10-16 23:48:55,273 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 23:48:55,280 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 23:48:55,280 - DEBUG - interactive is False
2025-10-16 23:48:55,281 - DEBUG - platform is linux
2025-10-16 23:48:55,309 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 23:48:55,311 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 23:48:56,353 - DEBUG - Field: train_data_file
2025-10-16 23:48:56,353 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 23:48:56,353 - DEBUG - Field default: None
2025-10-16 23:48:56,353 - DEBUG - Field: test_data_file
2025-10-16 23:48:56,353 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 23:48:56,353 - DEBUG - Field default: None
2025-10-16 23:48:56,353 - DEBUG - Field: output_dir
2025-10-16 23:48:56,353 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 23:48:56,353 - DEBUG - Field default: training_outputs
2025-10-16 23:48:56,353 - DEBUG - Converting path value: /tmp/tmp5m3iyva0/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 23:48:56,353 - DEBUG - Converting path value: /tmp/tmp5m3iyva0/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 23:48:56,353 - DEBUG - Converting path value: /tmp/tmp5m3iyva0/training/training_nphotons_1000000.0_single
2025-10-16 23:48:56,353 - DEBUG - YAML config: {}
2025-10-16 23:48:56,353 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp5m3iyva0/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmp5m3iyva0/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp5m3iyva0/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-16 23:48:56,353 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp5m3iyva0/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmp5m3iyva0/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp5m3iyva0/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-16 23:48:56,354 - INFO - Configuration setup complete
2025-10-16 23:48:56,354 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp5m3iyva0/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmp5m3iyva0/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp5m3iyva0/training/training_nphotons_1000000.0_single'), sequential_sampling=False)
2025-10-16 23:48:56,354 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-16 23:48:56,354 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-16 23:48:56,354 - INFO - Loading data from /tmp/tmp5m3iyva0/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-16 23:48:56,360 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-16 23:48:56,360 - INFO - Randomly subsampled 50 images
2025-10-16 23:48:56,371 - DEBUG - Loaded metadata from /tmp/tmp5m3iyva0/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 23:48:56,371 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-16 23:48:56,371 - INFO - Loading data from /tmp/tmp5m3iyva0/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-16 23:48:56,377 - INFO - Using full dataset of 100 images
2025-10-16 23:48:56,377 - INFO - Loaded test data from /tmp/tmp5m3iyva0/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 23:48:56,377 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-16 23:48:56,377 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 23:48:56,377 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-16 23:48:56,377 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 23:48:56,377 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 23:48:56,377 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 23:48:56,377 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 23:48:56,378 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 23:48:56,378 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-16 23:48:56,378 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-16 23:48:56,378 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-16 23:48:56,378 - INFO - Using all 50 points as seeds
2025-10-16 23:48:56,378 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 23:48:56,378 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 23:48:56,378 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 23:48:56,378 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 23:48:56,378 - INFO - Generated 50 groups efficiently
2025-10-16 23:48:57,947 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-16 23:48:57,947 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 23:48:57,948 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-16 23:48:57,948 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 23:48:57,948 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 23:48:57,948 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 23:48:57,948 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 23:48:57,948 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 23:48:57,948 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-16 23:48:57,948 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-16 23:48:57,948 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-16 23:48:57,948 - INFO - Sampled 50 seed points from 100 total points
2025-10-16 23:48:57,948 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 23:48:57,948 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 23:48:57,948 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 23:48:57,948 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 23:48:57,948 - INFO - Generated 50 groups efficiently
2025-10-16 23:48:59,931 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 23:49:01,781 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 23:49:08,978 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 23:49:12,113 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 23:49:12,128 - DEBUG - Creating converter from 5 to 3
2025-10-16 23:49:13,263 - INFO - Outputs saved to /tmp/tmp5m3iyva0/training/training_nphotons_1000000.0_single
2025-10-16 23:49:49,098 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 23:49:49,274 - DEBUG - Creating converter from 7 to 5
2025-10-16 23:49:49,274 - DEBUG - Creating converter from 5 to 7
2025-10-16 23:49:49,274 - DEBUG - Creating converter from 7 to 5
2025-10-16 23:49:49,274 - DEBUG - Creating converter from 5 to 7
2025-10-16 23:49:49,897 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 23:49:49,905 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 23:49:49,905 - DEBUG - interactive is False
2025-10-16 23:49:49,905 - DEBUG - platform is linux
2025-10-16 23:49:49,934 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 23:49:49,936 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 23:49:50,989 - DEBUG - Field: train_data_file
2025-10-16 23:49:50,989 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 23:49:50,989 - DEBUG - Field default: None
2025-10-16 23:49:50,990 - DEBUG - Field: test_data_file
2025-10-16 23:49:50,990 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 23:49:50,990 - DEBUG - Field default: None
2025-10-16 23:49:50,990 - DEBUG - Field: output_dir
2025-10-16 23:49:50,990 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 23:49:50,990 - DEBUG - Field default: training_outputs
2025-10-16 23:49:50,990 - DEBUG - Converting path value: /tmp/tmpdml2_dzl/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 23:49:50,990 - DEBUG - Converting path value: /tmp/tmpdml2_dzl/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 23:49:50,990 - DEBUG - Converting path value: /tmp/tmpdml2_dzl/training/training_mismatch_test
2025-10-16 23:49:50,990 - DEBUG - YAML config: {}
2025-10-16 23:49:50,990 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpdml2_dzl/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpdml2_dzl/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpdml2_dzl/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-16 23:49:50,990 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpdml2_dzl/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpdml2_dzl/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpdml2_dzl/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-16 23:49:50,990 - INFO - Configuration setup complete
2025-10-16 23:49:50,990 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpdml2_dzl/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmpdml2_dzl/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpdml2_dzl/training/training_mismatch_test'), sequential_sampling=False)
2025-10-16 23:49:50,990 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-16 23:49:50,990 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-16 23:49:50,990 - INFO - Loading data from /tmp/tmpdml2_dzl/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-16 23:49:50,996 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-16 23:49:50,996 - INFO - Randomly subsampled 50 images
2025-10-16 23:49:51,006 - DEBUG - Loaded metadata from /tmp/tmpdml2_dzl/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 23:49:51,006 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-16 23:49:51,006 - INFO - Loading data from /tmp/tmpdml2_dzl/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-16 23:49:51,010 - INFO - Using full dataset of 100 images
2025-10-16 23:49:51,011 - INFO - Loaded test data from /tmp/tmpdml2_dzl/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 23:49:51,011 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-16 23:49:51,011 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 23:49:51,011 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-16 23:49:51,011 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 23:49:51,011 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 23:49:51,011 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 23:49:51,011 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 23:49:51,011 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 23:49:51,011 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-16 23:49:51,011 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-16 23:49:51,012 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-16 23:49:51,012 - INFO - Using all 50 points as seeds
2025-10-16 23:49:51,012 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 23:49:51,012 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 23:49:51,012 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 23:49:51,012 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 23:49:51,012 - INFO - Generated 50 groups efficiently
2025-10-16 23:49:52,550 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-16 23:49:52,550 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 23:49:52,550 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-16 23:49:52,550 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 23:49:52,550 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 23:49:52,550 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 23:49:52,550 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 23:49:52,550 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 23:49:52,550 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-16 23:49:52,550 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-16 23:49:52,550 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-16 23:49:52,550 - INFO - Sampled 50 seed points from 100 total points
2025-10-16 23:49:52,550 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 23:49:52,550 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 23:49:52,550 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 23:49:52,550 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 23:49:52,550 - INFO - Generated 50 groups efficiently
2025-10-16 23:49:54,565 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 23:49:56,477 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 23:50:03,790 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 23:50:06,935 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 23:50:06,953 - DEBUG - Creating converter from 5 to 3
2025-10-16 23:50:08,092 - INFO - Outputs saved to /tmp/tmpdml2_dzl/training/training_mismatch_test
2025-10-17 00:27:07,422 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 00:27:07,594 - DEBUG - Creating converter from 7 to 5
2025-10-17 00:27:07,594 - DEBUG - Creating converter from 5 to 7
2025-10-17 00:27:07,594 - DEBUG - Creating converter from 7 to 5
2025-10-17 00:27:07,594 - DEBUG - Creating converter from 5 to 7
2025-10-17 00:27:08,208 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 00:27:08,216 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 00:27:08,216 - DEBUG - interactive is False
2025-10-17 00:27:08,216 - DEBUG - platform is linux
2025-10-17 00:27:08,245 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 00:27:08,246 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 00:27:09,280 - DEBUG - Field: train_data_file
2025-10-17 00:27:09,280 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 00:27:09,280 - DEBUG - Field default: None
2025-10-17 00:27:09,280 - DEBUG - Field: test_data_file
2025-10-17 00:27:09,280 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 00:27:09,280 - DEBUG - Field default: None
2025-10-17 00:27:09,280 - DEBUG - Field: output_dir
2025-10-17 00:27:09,280 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 00:27:09,280 - DEBUG - Field default: training_outputs
2025-10-17 00:27:09,281 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 00:27:09,281 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 00:27:09,281 - DEBUG - Converting path value: /tmp/tmpc8vvgfdb/training_outputs
2025-10-17 00:27:09,281 - DEBUG - YAML config: {}
2025-10-17 00:27:09,281 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpc8vvgfdb/training_outputs'), 'sequential_sampling': False}
2025-10-17 00:27:09,281 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpc8vvgfdb/training_outputs'), 'sequential_sampling': False}
2025-10-17 00:27:09,281 - INFO - Configuration setup complete
2025-10-17 00:27:09,281 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpc8vvgfdb/training_outputs'), sequential_sampling=False)
2025-10-17 00:27:09,281 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-17 00:27:09,281 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-17 00:27:09,281 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-17 00:27:09,297 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-17 00:27:09,297 - INFO - Randomly subsampled 64 images
2025-10-17 00:27:09,313 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-17 00:27:09,328 - INFO - Using full dataset of 1087 images
2025-10-17 00:27:09,344 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 00:27:09,344 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-17 00:27:09,345 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 00:27:09,345 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-17 00:27:09,345 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 00:27:09,345 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 00:27:09,345 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 00:27:09,345 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 00:27:09,345 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-17 00:27:09,345 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-17 00:27:09,345 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-17 00:27:09,345 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-17 00:27:09,345 - INFO - Using all 64 points as seeds
2025-10-17 00:27:09,345 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 00:27:09,345 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-17 00:27:09,345 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-17 00:27:09,345 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-17 00:27:09,345 - INFO - Generated 64 groups efficiently
2025-10-17 00:27:10,901 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-17 00:27:10,901 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 00:27:10,901 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-17 00:27:10,901 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 00:27:10,901 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 00:27:10,901 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 00:27:10,901 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 00:27:10,901 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-17 00:27:10,902 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-17 00:27:10,902 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-17 00:27:10,902 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-17 00:27:10,902 - INFO - Sampled 64 seed points from 1087 total points
2025-10-17 00:27:10,902 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 00:27:10,902 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-17 00:27:10,902 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-17 00:27:10,902 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-17 00:27:10,902 - INFO - Generated 64 groups efficiently
2025-10-17 00:27:12,978 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 00:27:14,840 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 00:27:21,940 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 00:27:23,873 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 00:27:24,097 - DEBUG - Creating converter from 5 to 3
2025-10-17 00:27:25,229 - INFO - Outputs saved to /tmp/tmpc8vvgfdb/training_outputs
2025-10-17 00:27:49,457 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 00:27:49,633 - DEBUG - Creating converter from 7 to 5
2025-10-17 00:27:49,633 - DEBUG - Creating converter from 5 to 7
2025-10-17 00:27:49,633 - DEBUG - Creating converter from 7 to 5
2025-10-17 00:27:49,633 - DEBUG - Creating converter from 5 to 7
2025-10-17 00:27:50,235 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 00:27:50,242 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 00:27:50,243 - DEBUG - interactive is False
2025-10-17 00:27:50,243 - DEBUG - platform is linux
2025-10-17 00:27:50,272 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 00:27:50,273 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 00:27:51,322 - DEBUG - Field: train_data_file
2025-10-17 00:27:51,322 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 00:27:51,322 - DEBUG - Field default: None
2025-10-17 00:27:51,322 - DEBUG - Field: test_data_file
2025-10-17 00:27:51,322 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 00:27:51,322 - DEBUG - Field default: None
2025-10-17 00:27:51,322 - DEBUG - Field: output_dir
2025-10-17 00:27:51,322 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 00:27:51,322 - DEBUG - Field default: training_outputs
2025-10-17 00:27:51,322 - DEBUG - Converting path value: /tmp/tmpnlctpg_7/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 00:27:51,322 - DEBUG - Converting path value: /tmp/tmpnlctpg_7/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 00:27:51,322 - DEBUG - Converting path value: /tmp/tmpnlctpg_7/training/training_nphotons_500000.0_e2e
2025-10-17 00:27:51,322 - DEBUG - YAML config: {}
2025-10-17 00:27:51,322 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpnlctpg_7/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpnlctpg_7/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpnlctpg_7/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-17 00:27:51,322 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpnlctpg_7/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpnlctpg_7/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpnlctpg_7/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-17 00:27:51,322 - INFO - Configuration setup complete
2025-10-17 00:27:51,322 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpnlctpg_7/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmpnlctpg_7/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpnlctpg_7/training/training_nphotons_500000.0_e2e'), sequential_sampling=False)
2025-10-17 00:27:51,322 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 00:27:51,323 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 00:27:51,323 - INFO - Loading data from /tmp/tmpnlctpg_7/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-17 00:27:51,329 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 00:27:51,329 - INFO - Randomly subsampled 50 images
2025-10-17 00:27:51,340 - DEBUG - Loaded metadata from /tmp/tmpnlctpg_7/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 00:27:51,340 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-17 00:27:51,340 - INFO - Loading data from /tmp/tmpnlctpg_7/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-17 00:27:51,345 - INFO - Using full dataset of 100 images
2025-10-17 00:27:51,346 - INFO - Loaded test data from /tmp/tmpnlctpg_7/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 00:27:51,346 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 00:27:51,346 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 00:27:51,346 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 00:27:51,346 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 00:27:51,346 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 00:27:51,346 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 00:27:51,346 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 00:27:51,346 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 00:27:51,346 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 00:27:51,346 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 00:27:51,346 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 00:27:51,346 - INFO - Using all 50 points as seeds
2025-10-17 00:27:51,346 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 00:27:51,346 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 00:27:51,346 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 00:27:51,346 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 00:27:51,346 - INFO - Generated 50 groups efficiently
2025-10-17 00:27:52,917 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 00:27:52,917 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 00:27:52,917 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 00:27:52,917 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 00:27:52,917 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 00:27:52,917 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 00:27:52,917 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 00:27:52,917 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 00:27:52,917 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 00:27:52,917 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 00:27:52,917 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 00:27:52,917 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 00:27:52,917 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 00:27:52,917 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 00:27:52,917 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 00:27:52,917 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 00:27:52,917 - INFO - Generated 50 groups efficiently
2025-10-17 00:27:54,918 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 00:27:56,815 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 00:28:04,209 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 00:28:07,406 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 00:28:07,423 - DEBUG - Creating converter from 5 to 3
2025-10-17 00:28:08,557 - INFO - Outputs saved to /tmp/tmpnlctpg_7/training/training_nphotons_500000.0_e2e
2025-10-17 00:28:26,996 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 00:28:27,173 - DEBUG - Creating converter from 7 to 5
2025-10-17 00:28:27,173 - DEBUG - Creating converter from 5 to 7
2025-10-17 00:28:27,173 - DEBUG - Creating converter from 7 to 5
2025-10-17 00:28:27,173 - DEBUG - Creating converter from 5 to 7
2025-10-17 00:28:27,794 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 00:28:27,801 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 00:28:27,802 - DEBUG - interactive is False
2025-10-17 00:28:27,802 - DEBUG - platform is linux
2025-10-17 00:28:27,831 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 00:28:27,833 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 00:28:28,885 - DEBUG - Field: train_data_file
2025-10-17 00:28:28,885 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 00:28:28,885 - DEBUG - Field default: None
2025-10-17 00:28:28,885 - DEBUG - Field: test_data_file
2025-10-17 00:28:28,885 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 00:28:28,885 - DEBUG - Field default: None
2025-10-17 00:28:28,886 - DEBUG - Field: output_dir
2025-10-17 00:28:28,886 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 00:28:28,886 - DEBUG - Field default: training_outputs
2025-10-17 00:28:28,886 - DEBUG - Converting path value: /tmp/tmplho2c0hs/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 00:28:28,886 - DEBUG - Converting path value: /tmp/tmplho2c0hs/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 00:28:28,886 - DEBUG - Converting path value: /tmp/tmplho2c0hs/training/training_nphotons_1000000.0_single
2025-10-17 00:28:28,886 - DEBUG - YAML config: {}
2025-10-17 00:28:28,886 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmplho2c0hs/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmplho2c0hs/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmplho2c0hs/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-17 00:28:28,886 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmplho2c0hs/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmplho2c0hs/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmplho2c0hs/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-17 00:28:28,886 - INFO - Configuration setup complete
2025-10-17 00:28:28,886 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmplho2c0hs/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmplho2c0hs/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmplho2c0hs/training/training_nphotons_1000000.0_single'), sequential_sampling=False)
2025-10-17 00:28:28,886 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 00:28:28,886 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 00:28:28,886 - INFO - Loading data from /tmp/tmplho2c0hs/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-17 00:28:28,893 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 00:28:28,893 - INFO - Randomly subsampled 50 images
2025-10-17 00:28:28,904 - DEBUG - Loaded metadata from /tmp/tmplho2c0hs/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 00:28:28,904 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-17 00:28:28,904 - INFO - Loading data from /tmp/tmplho2c0hs/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-17 00:28:28,910 - INFO - Using full dataset of 100 images
2025-10-17 00:28:28,910 - INFO - Loaded test data from /tmp/tmplho2c0hs/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 00:28:28,910 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 00:28:28,910 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 00:28:28,910 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 00:28:28,910 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 00:28:28,911 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 00:28:28,911 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 00:28:28,911 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 00:28:28,911 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 00:28:28,911 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 00:28:28,911 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 00:28:28,911 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 00:28:28,911 - INFO - Using all 50 points as seeds
2025-10-17 00:28:28,911 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 00:28:28,911 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 00:28:28,911 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 00:28:28,911 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 00:28:28,911 - INFO - Generated 50 groups efficiently
2025-10-17 00:28:30,456 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 00:28:30,456 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 00:28:30,456 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 00:28:30,456 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 00:28:30,456 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 00:28:30,456 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 00:28:30,456 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 00:28:30,456 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 00:28:30,456 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 00:28:30,456 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 00:28:30,456 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 00:28:30,456 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 00:28:30,456 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 00:28:30,456 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 00:28:30,457 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 00:28:30,457 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 00:28:30,457 - INFO - Generated 50 groups efficiently
2025-10-17 00:28:32,436 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 00:28:34,303 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 00:28:41,687 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 00:28:44,853 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 00:28:44,868 - DEBUG - Creating converter from 5 to 3
2025-10-17 00:28:46,003 - INFO - Outputs saved to /tmp/tmplho2c0hs/training/training_nphotons_1000000.0_single
2025-10-17 00:29:22,122 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 00:29:22,299 - DEBUG - Creating converter from 7 to 5
2025-10-17 00:29:22,299 - DEBUG - Creating converter from 5 to 7
2025-10-17 00:29:22,299 - DEBUG - Creating converter from 7 to 5
2025-10-17 00:29:22,299 - DEBUG - Creating converter from 5 to 7
2025-10-17 00:29:22,910 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 00:29:22,917 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 00:29:22,917 - DEBUG - interactive is False
2025-10-17 00:29:22,917 - DEBUG - platform is linux
2025-10-17 00:29:22,946 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 00:29:22,948 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 00:29:23,996 - DEBUG - Field: train_data_file
2025-10-17 00:29:23,996 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 00:29:23,996 - DEBUG - Field default: None
2025-10-17 00:29:23,996 - DEBUG - Field: test_data_file
2025-10-17 00:29:23,996 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 00:29:23,996 - DEBUG - Field default: None
2025-10-17 00:29:23,996 - DEBUG - Field: output_dir
2025-10-17 00:29:23,996 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 00:29:23,996 - DEBUG - Field default: training_outputs
2025-10-17 00:29:23,997 - DEBUG - Converting path value: /tmp/tmpphw8prmy/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 00:29:23,997 - DEBUG - Converting path value: /tmp/tmpphw8prmy/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 00:29:23,997 - DEBUG - Converting path value: /tmp/tmpphw8prmy/training/training_mismatch_test
2025-10-17 00:29:23,997 - DEBUG - YAML config: {}
2025-10-17 00:29:23,997 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpphw8prmy/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpphw8prmy/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpphw8prmy/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-17 00:29:23,997 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpphw8prmy/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpphw8prmy/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpphw8prmy/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-17 00:29:23,997 - INFO - Configuration setup complete
2025-10-17 00:29:23,997 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpphw8prmy/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmpphw8prmy/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpphw8prmy/training/training_mismatch_test'), sequential_sampling=False)
2025-10-17 00:29:23,997 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 00:29:23,997 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 00:29:23,997 - INFO - Loading data from /tmp/tmpphw8prmy/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-17 00:29:24,002 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 00:29:24,002 - INFO - Randomly subsampled 50 images
2025-10-17 00:29:24,012 - DEBUG - Loaded metadata from /tmp/tmpphw8prmy/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 00:29:24,012 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-17 00:29:24,012 - INFO - Loading data from /tmp/tmpphw8prmy/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-17 00:29:24,017 - INFO - Using full dataset of 100 images
2025-10-17 00:29:24,017 - INFO - Loaded test data from /tmp/tmpphw8prmy/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 00:29:24,018 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 00:29:24,018 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 00:29:24,018 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 00:29:24,018 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 00:29:24,018 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 00:29:24,018 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 00:29:24,018 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 00:29:24,018 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 00:29:24,018 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 00:29:24,018 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 00:29:24,018 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 00:29:24,018 - INFO - Using all 50 points as seeds
2025-10-17 00:29:24,018 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 00:29:24,018 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 00:29:24,018 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 00:29:24,018 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 00:29:24,018 - INFO - Generated 50 groups efficiently
2025-10-17 00:29:25,600 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 00:29:25,600 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 00:29:25,600 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 00:29:25,600 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 00:29:25,600 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 00:29:25,600 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 00:29:25,600 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 00:29:25,600 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 00:29:25,600 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 00:29:25,600 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 00:29:25,601 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 00:29:25,601 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 00:29:25,601 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 00:29:25,601 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 00:29:25,601 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 00:29:25,601 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 00:29:25,601 - INFO - Generated 50 groups efficiently
2025-10-17 00:29:27,588 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 00:29:29,461 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 00:29:36,801 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 00:29:39,952 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 00:29:39,968 - DEBUG - Creating converter from 5 to 3
2025-10-17 00:29:41,095 - INFO - Outputs saved to /tmp/tmpphw8prmy/training/training_mismatch_test
2025-10-17 00:46:24,669 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 00:46:24,842 - DEBUG - Creating converter from 7 to 5
2025-10-17 00:46:24,842 - DEBUG - Creating converter from 5 to 7
2025-10-17 00:46:24,842 - DEBUG - Creating converter from 7 to 5
2025-10-17 00:46:24,842 - DEBUG - Creating converter from 5 to 7
2025-10-17 00:46:25,441 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 00:46:25,448 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 00:46:25,448 - DEBUG - interactive is False
2025-10-17 00:46:25,448 - DEBUG - platform is linux
2025-10-17 00:46:25,477 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 00:46:25,478 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 00:46:26,506 - DEBUG - Field: train_data_file
2025-10-17 00:46:26,506 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 00:46:26,506 - DEBUG - Field default: None
2025-10-17 00:46:26,506 - DEBUG - Field: test_data_file
2025-10-17 00:46:26,506 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 00:46:26,506 - DEBUG - Field default: None
2025-10-17 00:46:26,506 - DEBUG - Field: output_dir
2025-10-17 00:46:26,506 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 00:46:26,506 - DEBUG - Field default: training_outputs
2025-10-17 00:46:26,506 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 00:46:26,506 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 00:46:26,506 - DEBUG - Converting path value: /tmp/tmp30121178/training_outputs
2025-10-17 00:46:26,506 - DEBUG - YAML config: {}
2025-10-17 00:46:26,506 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp30121178/training_outputs'), 'sequential_sampling': False}
2025-10-17 00:46:26,506 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp30121178/training_outputs'), 'sequential_sampling': False}
2025-10-17 00:46:26,506 - INFO - Configuration setup complete
2025-10-17 00:46:26,506 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp30121178/training_outputs'), sequential_sampling=False)
2025-10-17 00:46:26,506 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-17 00:46:26,507 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-17 00:46:26,507 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-17 00:46:26,522 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-17 00:46:26,522 - INFO - Randomly subsampled 64 images
2025-10-17 00:46:26,539 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-17 00:46:26,555 - INFO - Using full dataset of 1087 images
2025-10-17 00:46:26,569 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 00:46:26,570 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-17 00:46:26,570 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 00:46:26,570 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-17 00:46:26,570 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 00:46:26,570 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 00:46:26,570 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 00:46:26,570 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 00:46:26,570 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-17 00:46:26,570 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-17 00:46:26,570 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-17 00:46:26,570 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-17 00:46:26,570 - INFO - Using all 64 points as seeds
2025-10-17 00:46:26,570 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 00:46:26,570 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-17 00:46:26,570 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-17 00:46:26,570 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-17 00:46:26,570 - INFO - Generated 64 groups efficiently
2025-10-17 00:46:28,115 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-17 00:46:28,115 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 00:46:28,115 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-17 00:46:28,115 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 00:46:28,115 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 00:46:28,115 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 00:46:28,115 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 00:46:28,115 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-17 00:46:28,115 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-17 00:46:28,115 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-17 00:46:28,115 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-17 00:46:28,116 - INFO - Sampled 64 seed points from 1087 total points
2025-10-17 00:46:28,116 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 00:46:28,116 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-17 00:46:28,116 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-17 00:46:28,116 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-17 00:46:28,116 - INFO - Generated 64 groups efficiently
2025-10-17 00:46:30,177 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 00:46:32,026 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 00:46:39,192 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 00:46:41,164 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 00:46:41,384 - DEBUG - Creating converter from 5 to 3
2025-10-17 00:46:42,515 - INFO - Outputs saved to /tmp/tmp30121178/training_outputs
2025-10-17 00:47:06,842 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 00:47:07,016 - DEBUG - Creating converter from 7 to 5
2025-10-17 00:47:07,016 - DEBUG - Creating converter from 5 to 7
2025-10-17 00:47:07,016 - DEBUG - Creating converter from 7 to 5
2025-10-17 00:47:07,016 - DEBUG - Creating converter from 5 to 7
2025-10-17 00:47:07,629 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 00:47:07,636 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 00:47:07,637 - DEBUG - interactive is False
2025-10-17 00:47:07,637 - DEBUG - platform is linux
2025-10-17 00:47:07,665 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 00:47:07,667 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 00:47:08,724 - DEBUG - Field: train_data_file
2025-10-17 00:47:08,724 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 00:47:08,724 - DEBUG - Field default: None
2025-10-17 00:47:08,724 - DEBUG - Field: test_data_file
2025-10-17 00:47:08,724 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 00:47:08,724 - DEBUG - Field default: None
2025-10-17 00:47:08,724 - DEBUG - Field: output_dir
2025-10-17 00:47:08,724 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 00:47:08,724 - DEBUG - Field default: training_outputs
2025-10-17 00:47:08,725 - DEBUG - Converting path value: /tmp/tmpl8ptwng1/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 00:47:08,725 - DEBUG - Converting path value: /tmp/tmpl8ptwng1/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 00:47:08,725 - DEBUG - Converting path value: /tmp/tmpl8ptwng1/training/training_nphotons_500000.0_e2e
2025-10-17 00:47:08,725 - DEBUG - YAML config: {}
2025-10-17 00:47:08,725 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpl8ptwng1/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpl8ptwng1/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpl8ptwng1/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-17 00:47:08,725 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpl8ptwng1/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpl8ptwng1/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpl8ptwng1/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-17 00:47:08,725 - INFO - Configuration setup complete
2025-10-17 00:47:08,725 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpl8ptwng1/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmpl8ptwng1/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpl8ptwng1/training/training_nphotons_500000.0_e2e'), sequential_sampling=False)
2025-10-17 00:47:08,725 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 00:47:08,725 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 00:47:08,725 - INFO - Loading data from /tmp/tmpl8ptwng1/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-17 00:47:08,732 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 00:47:08,732 - INFO - Randomly subsampled 50 images
2025-10-17 00:47:08,743 - DEBUG - Loaded metadata from /tmp/tmpl8ptwng1/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 00:47:08,743 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-17 00:47:08,743 - INFO - Loading data from /tmp/tmpl8ptwng1/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-17 00:47:08,748 - INFO - Using full dataset of 100 images
2025-10-17 00:47:08,749 - INFO - Loaded test data from /tmp/tmpl8ptwng1/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 00:47:08,749 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 00:47:08,749 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 00:47:08,749 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 00:47:08,749 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 00:47:08,749 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 00:47:08,749 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 00:47:08,749 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 00:47:08,749 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 00:47:08,749 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 00:47:08,749 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 00:47:08,749 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 00:47:08,749 - INFO - Using all 50 points as seeds
2025-10-17 00:47:08,749 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 00:47:08,749 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 00:47:08,749 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 00:47:08,749 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 00:47:08,749 - INFO - Generated 50 groups efficiently
2025-10-17 00:47:10,315 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 00:47:10,315 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 00:47:10,315 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 00:47:10,315 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 00:47:10,315 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 00:47:10,315 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 00:47:10,315 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 00:47:10,316 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 00:47:10,316 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 00:47:10,316 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 00:47:10,316 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 00:47:10,316 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 00:47:10,316 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 00:47:10,316 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 00:47:10,316 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 00:47:10,316 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 00:47:10,316 - INFO - Generated 50 groups efficiently
2025-10-17 00:47:12,329 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 00:47:14,194 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 00:47:21,634 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 00:47:24,804 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 00:47:24,820 - DEBUG - Creating converter from 5 to 3
2025-10-17 00:47:25,960 - INFO - Outputs saved to /tmp/tmpl8ptwng1/training/training_nphotons_500000.0_e2e
2025-10-17 00:47:44,271 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 00:47:44,447 - DEBUG - Creating converter from 7 to 5
2025-10-17 00:47:44,447 - DEBUG - Creating converter from 5 to 7
2025-10-17 00:47:44,447 - DEBUG - Creating converter from 7 to 5
2025-10-17 00:47:44,447 - DEBUG - Creating converter from 5 to 7
2025-10-17 00:47:45,069 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 00:47:45,076 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 00:47:45,077 - DEBUG - interactive is False
2025-10-17 00:47:45,077 - DEBUG - platform is linux
2025-10-17 00:47:45,107 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 00:47:45,108 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 00:47:46,163 - DEBUG - Field: train_data_file
2025-10-17 00:47:46,163 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 00:47:46,163 - DEBUG - Field default: None
2025-10-17 00:47:46,163 - DEBUG - Field: test_data_file
2025-10-17 00:47:46,163 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 00:47:46,164 - DEBUG - Field default: None
2025-10-17 00:47:46,164 - DEBUG - Field: output_dir
2025-10-17 00:47:46,164 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 00:47:46,164 - DEBUG - Field default: training_outputs
2025-10-17 00:47:46,164 - DEBUG - Converting path value: /tmp/tmpmyff1r28/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 00:47:46,164 - DEBUG - Converting path value: /tmp/tmpmyff1r28/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 00:47:46,164 - DEBUG - Converting path value: /tmp/tmpmyff1r28/training/training_nphotons_1000000.0_single
2025-10-17 00:47:46,164 - DEBUG - YAML config: {}
2025-10-17 00:47:46,164 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpmyff1r28/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpmyff1r28/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpmyff1r28/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-17 00:47:46,164 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpmyff1r28/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpmyff1r28/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpmyff1r28/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-17 00:47:46,164 - INFO - Configuration setup complete
2025-10-17 00:47:46,164 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpmyff1r28/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmpmyff1r28/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpmyff1r28/training/training_nphotons_1000000.0_single'), sequential_sampling=False)
2025-10-17 00:47:46,164 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 00:47:46,164 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 00:47:46,164 - INFO - Loading data from /tmp/tmpmyff1r28/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-17 00:47:46,171 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 00:47:46,171 - INFO - Randomly subsampled 50 images
2025-10-17 00:47:46,182 - DEBUG - Loaded metadata from /tmp/tmpmyff1r28/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 00:47:46,182 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-17 00:47:46,182 - INFO - Loading data from /tmp/tmpmyff1r28/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-17 00:47:46,188 - INFO - Using full dataset of 100 images
2025-10-17 00:47:46,188 - INFO - Loaded test data from /tmp/tmpmyff1r28/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 00:47:46,189 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 00:47:46,189 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 00:47:46,189 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 00:47:46,189 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 00:47:46,189 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 00:47:46,189 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 00:47:46,189 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 00:47:46,189 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 00:47:46,189 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 00:47:46,189 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 00:47:46,189 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 00:47:46,189 - INFO - Using all 50 points as seeds
2025-10-17 00:47:46,189 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 00:47:46,189 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 00:47:46,189 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 00:47:46,189 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 00:47:46,189 - INFO - Generated 50 groups efficiently
2025-10-17 00:47:47,716 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 00:47:47,716 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 00:47:47,716 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 00:47:47,716 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 00:47:47,716 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 00:47:47,716 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 00:47:47,716 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 00:47:47,716 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 00:47:47,716 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 00:47:47,716 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 00:47:47,716 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 00:47:47,716 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 00:47:47,716 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 00:47:47,716 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 00:47:47,716 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 00:47:47,716 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 00:47:47,716 - INFO - Generated 50 groups efficiently
2025-10-17 00:47:49,715 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 00:47:51,606 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 00:47:58,885 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 00:48:02,078 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 00:48:02,094 - DEBUG - Creating converter from 5 to 3
2025-10-17 00:48:03,235 - INFO - Outputs saved to /tmp/tmpmyff1r28/training/training_nphotons_1000000.0_single
2025-10-17 00:48:39,172 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 00:48:39,347 - DEBUG - Creating converter from 7 to 5
2025-10-17 00:48:39,347 - DEBUG - Creating converter from 5 to 7
2025-10-17 00:48:39,347 - DEBUG - Creating converter from 7 to 5
2025-10-17 00:48:39,347 - DEBUG - Creating converter from 5 to 7
2025-10-17 00:48:39,958 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 00:48:39,966 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 00:48:39,966 - DEBUG - interactive is False
2025-10-17 00:48:39,966 - DEBUG - platform is linux
2025-10-17 00:48:39,996 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 00:48:39,997 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 00:48:41,045 - DEBUG - Field: train_data_file
2025-10-17 00:48:41,045 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 00:48:41,045 - DEBUG - Field default: None
2025-10-17 00:48:41,046 - DEBUG - Field: test_data_file
2025-10-17 00:48:41,046 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 00:48:41,046 - DEBUG - Field default: None
2025-10-17 00:48:41,046 - DEBUG - Field: output_dir
2025-10-17 00:48:41,046 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 00:48:41,046 - DEBUG - Field default: training_outputs
2025-10-17 00:48:41,046 - DEBUG - Converting path value: /tmp/tmpc6z0771b/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 00:48:41,046 - DEBUG - Converting path value: /tmp/tmpc6z0771b/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 00:48:41,046 - DEBUG - Converting path value: /tmp/tmpc6z0771b/training/training_mismatch_test
2025-10-17 00:48:41,046 - DEBUG - YAML config: {}
2025-10-17 00:48:41,046 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpc6z0771b/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpc6z0771b/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpc6z0771b/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-17 00:48:41,046 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpc6z0771b/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpc6z0771b/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpc6z0771b/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-17 00:48:41,046 - INFO - Configuration setup complete
2025-10-17 00:48:41,046 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpc6z0771b/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmpc6z0771b/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpc6z0771b/training/training_mismatch_test'), sequential_sampling=False)
2025-10-17 00:48:41,046 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 00:48:41,046 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 00:48:41,046 - INFO - Loading data from /tmp/tmpc6z0771b/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-17 00:48:41,052 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 00:48:41,052 - INFO - Randomly subsampled 50 images
2025-10-17 00:48:41,062 - DEBUG - Loaded metadata from /tmp/tmpc6z0771b/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 00:48:41,063 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-17 00:48:41,063 - INFO - Loading data from /tmp/tmpc6z0771b/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-17 00:48:41,067 - INFO - Using full dataset of 100 images
2025-10-17 00:48:41,067 - INFO - Loaded test data from /tmp/tmpc6z0771b/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 00:48:41,068 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 00:48:41,068 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 00:48:41,068 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 00:48:41,068 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 00:48:41,068 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 00:48:41,068 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 00:48:41,068 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 00:48:41,068 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 00:48:41,068 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 00:48:41,068 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 00:48:41,068 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 00:48:41,068 - INFO - Using all 50 points as seeds
2025-10-17 00:48:41,068 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 00:48:41,068 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 00:48:41,068 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 00:48:41,068 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 00:48:41,068 - INFO - Generated 50 groups efficiently
2025-10-17 00:48:42,626 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 00:48:42,626 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 00:48:42,626 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 00:48:42,626 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 00:48:42,626 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 00:48:42,626 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 00:48:42,626 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 00:48:42,626 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 00:48:42,626 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 00:48:42,626 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 00:48:42,627 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 00:48:42,627 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 00:48:42,627 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 00:48:42,627 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 00:48:42,627 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 00:48:42,627 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 00:48:42,627 - INFO - Generated 50 groups efficiently
2025-10-17 00:48:44,605 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 00:48:46,505 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 00:48:53,829 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 00:48:56,959 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 00:48:56,974 - DEBUG - Creating converter from 5 to 3
2025-10-17 00:48:58,101 - INFO - Outputs saved to /tmp/tmpc6z0771b/training/training_mismatch_test
2025-10-17 01:09:54,495 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 01:09:54,669 - DEBUG - Creating converter from 7 to 5
2025-10-17 01:09:54,669 - DEBUG - Creating converter from 5 to 7
2025-10-17 01:09:54,669 - DEBUG - Creating converter from 7 to 5
2025-10-17 01:09:54,669 - DEBUG - Creating converter from 5 to 7
2025-10-17 01:09:55,269 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 01:09:55,276 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 01:09:55,276 - DEBUG - interactive is False
2025-10-17 01:09:55,276 - DEBUG - platform is linux
2025-10-17 01:09:55,305 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 01:09:55,306 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 01:09:56,325 - DEBUG - Field: train_data_file
2025-10-17 01:09:56,326 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 01:09:56,326 - DEBUG - Field default: None
2025-10-17 01:09:56,326 - DEBUG - Field: test_data_file
2025-10-17 01:09:56,326 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 01:09:56,326 - DEBUG - Field default: None
2025-10-17 01:09:56,326 - DEBUG - Field: output_dir
2025-10-17 01:09:56,326 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 01:09:56,326 - DEBUG - Field default: training_outputs
2025-10-17 01:09:56,326 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 01:09:56,326 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 01:09:56,326 - DEBUG - Converting path value: /tmp/tmpntgtca1a/training_outputs
2025-10-17 01:09:56,326 - DEBUG - YAML config: {}
2025-10-17 01:09:56,326 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpntgtca1a/training_outputs'), 'sequential_sampling': False}
2025-10-17 01:09:56,326 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpntgtca1a/training_outputs'), 'sequential_sampling': False}
2025-10-17 01:09:56,326 - INFO - Configuration setup complete
2025-10-17 01:09:56,326 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpntgtca1a/training_outputs'), sequential_sampling=False)
2025-10-17 01:09:56,326 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-17 01:09:56,327 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-17 01:09:56,327 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-17 01:09:56,342 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-17 01:09:56,342 - INFO - Randomly subsampled 64 images
2025-10-17 01:09:56,359 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-17 01:09:56,375 - INFO - Using full dataset of 1087 images
2025-10-17 01:09:56,389 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 01:09:56,390 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-17 01:09:56,390 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 01:09:56,390 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-17 01:09:56,390 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 01:09:56,390 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 01:09:56,390 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 01:09:56,390 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 01:09:56,390 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-17 01:09:56,390 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-17 01:09:56,390 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-17 01:09:56,390 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-17 01:09:56,390 - INFO - Using all 64 points as seeds
2025-10-17 01:09:56,390 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 01:09:56,390 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-17 01:09:56,390 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-17 01:09:56,390 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-17 01:09:56,390 - INFO - Generated 64 groups efficiently
2025-10-17 01:09:57,981 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-17 01:09:57,981 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 01:09:57,981 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-17 01:09:57,981 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 01:09:57,981 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 01:09:57,981 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 01:09:57,981 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 01:09:57,981 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-17 01:09:57,981 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-17 01:09:57,981 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-17 01:09:57,982 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-17 01:09:57,982 - INFO - Sampled 64 seed points from 1087 total points
2025-10-17 01:09:57,982 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 01:09:57,982 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-17 01:09:57,982 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-17 01:09:57,982 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-17 01:09:57,982 - INFO - Generated 64 groups efficiently
2025-10-17 01:10:00,016 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 01:10:01,870 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 01:10:09,040 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 01:10:10,994 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 01:10:11,222 - DEBUG - Creating converter from 5 to 3
2025-10-17 01:10:12,361 - INFO - Outputs saved to /tmp/tmpntgtca1a/training_outputs
2025-10-17 01:10:36,568 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 01:10:36,749 - DEBUG - Creating converter from 7 to 5
2025-10-17 01:10:36,749 - DEBUG - Creating converter from 5 to 7
2025-10-17 01:10:36,749 - DEBUG - Creating converter from 7 to 5
2025-10-17 01:10:36,749 - DEBUG - Creating converter from 5 to 7
2025-10-17 01:10:37,384 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 01:10:37,392 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 01:10:37,392 - DEBUG - interactive is False
2025-10-17 01:10:37,392 - DEBUG - platform is linux
2025-10-17 01:10:37,421 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 01:10:37,423 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 01:10:38,470 - DEBUG - Field: train_data_file
2025-10-17 01:10:38,470 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 01:10:38,470 - DEBUG - Field default: None
2025-10-17 01:10:38,470 - DEBUG - Field: test_data_file
2025-10-17 01:10:38,470 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 01:10:38,470 - DEBUG - Field default: None
2025-10-17 01:10:38,470 - DEBUG - Field: output_dir
2025-10-17 01:10:38,470 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 01:10:38,470 - DEBUG - Field default: training_outputs
2025-10-17 01:10:38,470 - DEBUG - Converting path value: /tmp/tmpziba6v9o/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 01:10:38,470 - DEBUG - Converting path value: /tmp/tmpziba6v9o/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 01:10:38,470 - DEBUG - Converting path value: /tmp/tmpziba6v9o/training/training_nphotons_500000.0_e2e
2025-10-17 01:10:38,471 - DEBUG - YAML config: {}
2025-10-17 01:10:38,471 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpziba6v9o/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpziba6v9o/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpziba6v9o/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-17 01:10:38,471 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpziba6v9o/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpziba6v9o/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpziba6v9o/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-17 01:10:38,471 - INFO - Configuration setup complete
2025-10-17 01:10:38,471 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpziba6v9o/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmpziba6v9o/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpziba6v9o/training/training_nphotons_500000.0_e2e'), sequential_sampling=False)
2025-10-17 01:10:38,471 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 01:10:38,471 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 01:10:38,471 - INFO - Loading data from /tmp/tmpziba6v9o/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-17 01:10:38,477 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 01:10:38,477 - INFO - Randomly subsampled 50 images
2025-10-17 01:10:38,488 - DEBUG - Loaded metadata from /tmp/tmpziba6v9o/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 01:10:38,488 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-17 01:10:38,488 - INFO - Loading data from /tmp/tmpziba6v9o/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-17 01:10:38,494 - INFO - Using full dataset of 100 images
2025-10-17 01:10:38,494 - INFO - Loaded test data from /tmp/tmpziba6v9o/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 01:10:38,494 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 01:10:38,494 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 01:10:38,494 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 01:10:38,494 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 01:10:38,494 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 01:10:38,494 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 01:10:38,495 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 01:10:38,495 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 01:10:38,495 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 01:10:38,495 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 01:10:38,495 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 01:10:38,495 - INFO - Using all 50 points as seeds
2025-10-17 01:10:38,495 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 01:10:38,495 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 01:10:38,495 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 01:10:38,495 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 01:10:38,495 - INFO - Generated 50 groups efficiently
2025-10-17 01:10:40,053 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 01:10:40,053 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 01:10:40,053 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 01:10:40,053 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 01:10:40,053 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 01:10:40,053 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 01:10:40,053 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 01:10:40,053 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 01:10:40,053 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 01:10:40,053 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 01:10:40,053 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 01:10:40,053 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 01:10:40,053 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 01:10:40,053 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 01:10:40,053 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 01:10:40,053 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 01:10:40,053 - INFO - Generated 50 groups efficiently
2025-10-17 01:10:42,033 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 01:10:43,913 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 01:10:51,221 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 01:10:54,397 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 01:10:54,413 - DEBUG - Creating converter from 5 to 3
2025-10-17 01:10:55,555 - INFO - Outputs saved to /tmp/tmpziba6v9o/training/training_nphotons_500000.0_e2e
2025-10-17 01:11:13,878 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 01:11:14,054 - DEBUG - Creating converter from 7 to 5
2025-10-17 01:11:14,054 - DEBUG - Creating converter from 5 to 7
2025-10-17 01:11:14,054 - DEBUG - Creating converter from 7 to 5
2025-10-17 01:11:14,054 - DEBUG - Creating converter from 5 to 7
2025-10-17 01:11:14,671 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 01:11:14,678 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 01:11:14,679 - DEBUG - interactive is False
2025-10-17 01:11:14,679 - DEBUG - platform is linux
2025-10-17 01:11:14,709 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 01:11:14,710 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 01:11:15,778 - DEBUG - Field: train_data_file
2025-10-17 01:11:15,778 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 01:11:15,778 - DEBUG - Field default: None
2025-10-17 01:11:15,778 - DEBUG - Field: test_data_file
2025-10-17 01:11:15,778 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 01:11:15,778 - DEBUG - Field default: None
2025-10-17 01:11:15,778 - DEBUG - Field: output_dir
2025-10-17 01:11:15,778 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 01:11:15,778 - DEBUG - Field default: training_outputs
2025-10-17 01:11:15,778 - DEBUG - Converting path value: /tmp/tmp2o6zwpp4/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 01:11:15,778 - DEBUG - Converting path value: /tmp/tmp2o6zwpp4/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 01:11:15,778 - DEBUG - Converting path value: /tmp/tmp2o6zwpp4/training/training_nphotons_1000000.0_single
2025-10-17 01:11:15,779 - DEBUG - YAML config: {}
2025-10-17 01:11:15,779 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp2o6zwpp4/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmp2o6zwpp4/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp2o6zwpp4/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-17 01:11:15,779 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp2o6zwpp4/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmp2o6zwpp4/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp2o6zwpp4/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-17 01:11:15,779 - INFO - Configuration setup complete
2025-10-17 01:11:15,779 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp2o6zwpp4/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmp2o6zwpp4/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp2o6zwpp4/training/training_nphotons_1000000.0_single'), sequential_sampling=False)
2025-10-17 01:11:15,779 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 01:11:15,779 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 01:11:15,779 - INFO - Loading data from /tmp/tmp2o6zwpp4/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-17 01:11:15,785 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 01:11:15,785 - INFO - Randomly subsampled 50 images
2025-10-17 01:11:15,797 - DEBUG - Loaded metadata from /tmp/tmp2o6zwpp4/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 01:11:15,797 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-17 01:11:15,797 - INFO - Loading data from /tmp/tmp2o6zwpp4/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-17 01:11:15,802 - INFO - Using full dataset of 100 images
2025-10-17 01:11:15,802 - INFO - Loaded test data from /tmp/tmp2o6zwpp4/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 01:11:15,803 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 01:11:15,803 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 01:11:15,803 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 01:11:15,803 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 01:11:15,803 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 01:11:15,803 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 01:11:15,803 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 01:11:15,803 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 01:11:15,803 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 01:11:15,803 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 01:11:15,803 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 01:11:15,803 - INFO - Using all 50 points as seeds
2025-10-17 01:11:15,803 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 01:11:15,803 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 01:11:15,803 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 01:11:15,803 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 01:11:15,803 - INFO - Generated 50 groups efficiently
2025-10-17 01:11:17,350 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 01:11:17,350 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 01:11:17,350 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 01:11:17,350 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 01:11:17,350 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 01:11:17,350 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 01:11:17,350 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 01:11:17,350 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 01:11:17,350 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 01:11:17,350 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 01:11:17,350 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 01:11:17,350 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 01:11:17,350 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 01:11:17,350 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 01:11:17,350 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 01:11:17,350 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 01:11:17,350 - INFO - Generated 50 groups efficiently
2025-10-17 01:11:19,331 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 01:11:21,200 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 01:11:28,478 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 01:11:31,666 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 01:11:31,683 - DEBUG - Creating converter from 5 to 3
2025-10-17 01:11:32,820 - INFO - Outputs saved to /tmp/tmp2o6zwpp4/training/training_nphotons_1000000.0_single
2025-10-17 01:12:08,657 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 01:12:08,833 - DEBUG - Creating converter from 7 to 5
2025-10-17 01:12:08,833 - DEBUG - Creating converter from 5 to 7
2025-10-17 01:12:08,833 - DEBUG - Creating converter from 7 to 5
2025-10-17 01:12:08,833 - DEBUG - Creating converter from 5 to 7
2025-10-17 01:12:09,442 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 01:12:09,449 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 01:12:09,450 - DEBUG - interactive is False
2025-10-17 01:12:09,450 - DEBUG - platform is linux
2025-10-17 01:12:09,479 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 01:12:09,480 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 01:12:10,537 - DEBUG - Field: train_data_file
2025-10-17 01:12:10,537 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 01:12:10,537 - DEBUG - Field default: None
2025-10-17 01:12:10,537 - DEBUG - Field: test_data_file
2025-10-17 01:12:10,537 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 01:12:10,537 - DEBUG - Field default: None
2025-10-17 01:12:10,537 - DEBUG - Field: output_dir
2025-10-17 01:12:10,537 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 01:12:10,537 - DEBUG - Field default: training_outputs
2025-10-17 01:12:10,538 - DEBUG - Converting path value: /tmp/tmprind0onb/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 01:12:10,538 - DEBUG - Converting path value: /tmp/tmprind0onb/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 01:12:10,538 - DEBUG - Converting path value: /tmp/tmprind0onb/training/training_mismatch_test
2025-10-17 01:12:10,538 - DEBUG - YAML config: {}
2025-10-17 01:12:10,538 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmprind0onb/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmprind0onb/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmprind0onb/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-17 01:12:10,538 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmprind0onb/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmprind0onb/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmprind0onb/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-17 01:12:10,538 - INFO - Configuration setup complete
2025-10-17 01:12:10,538 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmprind0onb/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmprind0onb/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmprind0onb/training/training_mismatch_test'), sequential_sampling=False)
2025-10-17 01:12:10,538 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 01:12:10,538 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 01:12:10,538 - INFO - Loading data from /tmp/tmprind0onb/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-17 01:12:10,544 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 01:12:10,544 - INFO - Randomly subsampled 50 images
2025-10-17 01:12:10,554 - DEBUG - Loaded metadata from /tmp/tmprind0onb/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 01:12:10,554 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-17 01:12:10,554 - INFO - Loading data from /tmp/tmprind0onb/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-17 01:12:10,558 - INFO - Using full dataset of 100 images
2025-10-17 01:12:10,559 - INFO - Loaded test data from /tmp/tmprind0onb/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 01:12:10,559 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 01:12:10,559 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 01:12:10,559 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 01:12:10,559 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 01:12:10,559 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 01:12:10,559 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 01:12:10,559 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 01:12:10,559 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 01:12:10,559 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 01:12:10,559 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 01:12:10,559 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 01:12:10,559 - INFO - Using all 50 points as seeds
2025-10-17 01:12:10,559 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 01:12:10,560 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 01:12:10,560 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 01:12:10,560 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 01:12:10,560 - INFO - Generated 50 groups efficiently
2025-10-17 01:12:12,133 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 01:12:12,133 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 01:12:12,133 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 01:12:12,133 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 01:12:12,133 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 01:12:12,133 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 01:12:12,133 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 01:12:12,133 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 01:12:12,133 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 01:12:12,133 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 01:12:12,134 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 01:12:12,134 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 01:12:12,134 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 01:12:12,134 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 01:12:12,134 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 01:12:12,134 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 01:12:12,134 - INFO - Generated 50 groups efficiently
2025-10-17 01:12:14,139 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 01:12:16,028 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 01:12:23,402 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 01:12:26,559 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 01:12:26,574 - DEBUG - Creating converter from 5 to 3
2025-10-17 01:12:27,689 - INFO - Outputs saved to /tmp/tmprind0onb/training/training_mismatch_test
2025-10-17 01:31:28,775 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 01:31:28,950 - DEBUG - Creating converter from 7 to 5
2025-10-17 01:31:28,950 - DEBUG - Creating converter from 5 to 7
2025-10-17 01:31:28,950 - DEBUG - Creating converter from 7 to 5
2025-10-17 01:31:28,950 - DEBUG - Creating converter from 5 to 7
2025-10-17 01:31:29,559 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 01:31:29,567 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 01:31:29,567 - DEBUG - interactive is False
2025-10-17 01:31:29,567 - DEBUG - platform is linux
2025-10-17 01:31:29,597 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 01:31:29,598 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 01:31:30,630 - DEBUG - Field: train_data_file
2025-10-17 01:31:30,630 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 01:31:30,630 - DEBUG - Field default: None
2025-10-17 01:31:30,630 - DEBUG - Field: test_data_file
2025-10-17 01:31:30,630 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 01:31:30,630 - DEBUG - Field default: None
2025-10-17 01:31:30,630 - DEBUG - Field: output_dir
2025-10-17 01:31:30,630 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 01:31:30,630 - DEBUG - Field default: training_outputs
2025-10-17 01:31:30,630 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 01:31:30,630 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 01:31:30,630 - DEBUG - Converting path value: /tmp/tmphjmh8t7e/training_outputs
2025-10-17 01:31:30,631 - DEBUG - YAML config: {}
2025-10-17 01:31:30,631 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmphjmh8t7e/training_outputs'), 'sequential_sampling': False}
2025-10-17 01:31:30,631 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmphjmh8t7e/training_outputs'), 'sequential_sampling': False}
2025-10-17 01:31:30,631 - INFO - Configuration setup complete
2025-10-17 01:31:30,631 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmphjmh8t7e/training_outputs'), sequential_sampling=False)
2025-10-17 01:31:30,631 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-17 01:31:30,631 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-17 01:31:30,631 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-17 01:31:30,650 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-17 01:31:30,650 - INFO - Randomly subsampled 64 images
2025-10-17 01:31:30,667 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-17 01:31:30,682 - INFO - Using full dataset of 1087 images
2025-10-17 01:31:30,697 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 01:31:30,697 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-17 01:31:30,697 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 01:31:30,697 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-17 01:31:30,697 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 01:31:30,697 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 01:31:30,697 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 01:31:30,697 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 01:31:30,698 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-17 01:31:30,698 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-17 01:31:30,698 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-17 01:31:30,698 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-17 01:31:30,698 - INFO - Using all 64 points as seeds
2025-10-17 01:31:30,698 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 01:31:30,698 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-17 01:31:30,698 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-17 01:31:30,698 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-17 01:31:30,698 - INFO - Generated 64 groups efficiently
2025-10-17 01:31:32,256 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-17 01:31:32,256 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 01:31:32,256 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-17 01:31:32,256 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 01:31:32,256 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 01:31:32,256 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 01:31:32,256 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 01:31:32,256 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-17 01:31:32,256 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-17 01:31:32,256 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-17 01:31:32,256 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-17 01:31:32,256 - INFO - Sampled 64 seed points from 1087 total points
2025-10-17 01:31:32,256 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 01:31:32,256 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-17 01:31:32,256 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-17 01:31:32,256 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-17 01:31:32,256 - INFO - Generated 64 groups efficiently
2025-10-17 01:31:34,291 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 01:31:36,144 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 01:31:43,503 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 01:31:45,450 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 01:31:45,666 - DEBUG - Creating converter from 5 to 3
2025-10-17 01:31:46,795 - INFO - Outputs saved to /tmp/tmphjmh8t7e/training_outputs
2025-10-17 01:32:10,983 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 01:32:11,159 - DEBUG - Creating converter from 7 to 5
2025-10-17 01:32:11,160 - DEBUG - Creating converter from 5 to 7
2025-10-17 01:32:11,160 - DEBUG - Creating converter from 7 to 5
2025-10-17 01:32:11,160 - DEBUG - Creating converter from 5 to 7
2025-10-17 01:32:11,772 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 01:32:11,780 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 01:32:11,780 - DEBUG - interactive is False
2025-10-17 01:32:11,780 - DEBUG - platform is linux
2025-10-17 01:32:11,810 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 01:32:11,811 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 01:32:12,877 - DEBUG - Field: train_data_file
2025-10-17 01:32:12,877 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 01:32:12,877 - DEBUG - Field default: None
2025-10-17 01:32:12,877 - DEBUG - Field: test_data_file
2025-10-17 01:32:12,877 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 01:32:12,877 - DEBUG - Field default: None
2025-10-17 01:32:12,878 - DEBUG - Field: output_dir
2025-10-17 01:32:12,878 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 01:32:12,878 - DEBUG - Field default: training_outputs
2025-10-17 01:32:12,878 - DEBUG - Converting path value: /tmp/tmpvnvak162/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 01:32:12,878 - DEBUG - Converting path value: /tmp/tmpvnvak162/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 01:32:12,878 - DEBUG - Converting path value: /tmp/tmpvnvak162/training/training_nphotons_500000.0_e2e
2025-10-17 01:32:12,878 - DEBUG - YAML config: {}
2025-10-17 01:32:12,878 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpvnvak162/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpvnvak162/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpvnvak162/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-17 01:32:12,878 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpvnvak162/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpvnvak162/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpvnvak162/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-17 01:32:12,878 - INFO - Configuration setup complete
2025-10-17 01:32:12,878 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpvnvak162/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmpvnvak162/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpvnvak162/training/training_nphotons_500000.0_e2e'), sequential_sampling=False)
2025-10-17 01:32:12,878 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 01:32:12,878 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 01:32:12,878 - INFO - Loading data from /tmp/tmpvnvak162/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-17 01:32:12,885 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 01:32:12,885 - INFO - Randomly subsampled 50 images
2025-10-17 01:32:12,896 - DEBUG - Loaded metadata from /tmp/tmpvnvak162/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 01:32:12,896 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-17 01:32:12,896 - INFO - Loading data from /tmp/tmpvnvak162/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-17 01:32:12,901 - INFO - Using full dataset of 100 images
2025-10-17 01:32:12,902 - INFO - Loaded test data from /tmp/tmpvnvak162/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 01:32:12,902 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 01:32:12,902 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 01:32:12,902 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 01:32:12,902 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 01:32:12,902 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 01:32:12,902 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 01:32:12,902 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 01:32:12,902 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 01:32:12,902 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 01:32:12,902 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 01:32:12,902 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 01:32:12,902 - INFO - Using all 50 points as seeds
2025-10-17 01:32:12,902 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 01:32:12,902 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 01:32:12,902 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 01:32:12,902 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 01:32:12,902 - INFO - Generated 50 groups efficiently
2025-10-17 01:32:14,432 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 01:32:14,432 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 01:32:14,432 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 01:32:14,432 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 01:32:14,432 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 01:32:14,432 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 01:32:14,432 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 01:32:14,432 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 01:32:14,432 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 01:32:14,432 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 01:32:14,432 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 01:32:14,432 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 01:32:14,432 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 01:32:14,432 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 01:32:14,432 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 01:32:14,432 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 01:32:14,432 - INFO - Generated 50 groups efficiently
2025-10-17 01:32:16,411 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 01:32:18,262 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 01:32:25,575 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 01:32:28,891 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 01:32:28,907 - DEBUG - Creating converter from 5 to 3
2025-10-17 01:32:30,054 - INFO - Outputs saved to /tmp/tmpvnvak162/training/training_nphotons_500000.0_e2e
2025-10-17 01:32:48,356 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 01:32:48,527 - DEBUG - Creating converter from 7 to 5
2025-10-17 01:32:48,527 - DEBUG - Creating converter from 5 to 7
2025-10-17 01:32:48,527 - DEBUG - Creating converter from 7 to 5
2025-10-17 01:32:48,527 - DEBUG - Creating converter from 5 to 7
2025-10-17 01:32:49,132 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 01:32:49,139 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 01:32:49,139 - DEBUG - interactive is False
2025-10-17 01:32:49,139 - DEBUG - platform is linux
2025-10-17 01:32:49,168 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 01:32:49,170 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 01:32:50,211 - DEBUG - Field: train_data_file
2025-10-17 01:32:50,211 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 01:32:50,211 - DEBUG - Field default: None
2025-10-17 01:32:50,211 - DEBUG - Field: test_data_file
2025-10-17 01:32:50,211 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 01:32:50,211 - DEBUG - Field default: None
2025-10-17 01:32:50,212 - DEBUG - Field: output_dir
2025-10-17 01:32:50,212 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 01:32:50,212 - DEBUG - Field default: training_outputs
2025-10-17 01:32:50,212 - DEBUG - Converting path value: /tmp/tmpjtsnrgwh/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 01:32:50,212 - DEBUG - Converting path value: /tmp/tmpjtsnrgwh/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 01:32:50,212 - DEBUG - Converting path value: /tmp/tmpjtsnrgwh/training/training_nphotons_1000000.0_single
2025-10-17 01:32:50,212 - DEBUG - YAML config: {}
2025-10-17 01:32:50,212 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpjtsnrgwh/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpjtsnrgwh/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpjtsnrgwh/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-17 01:32:50,212 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpjtsnrgwh/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpjtsnrgwh/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpjtsnrgwh/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-17 01:32:50,212 - INFO - Configuration setup complete
2025-10-17 01:32:50,212 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpjtsnrgwh/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmpjtsnrgwh/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpjtsnrgwh/training/training_nphotons_1000000.0_single'), sequential_sampling=False)
2025-10-17 01:32:50,212 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 01:32:50,212 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 01:32:50,212 - INFO - Loading data from /tmp/tmpjtsnrgwh/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-17 01:32:50,219 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 01:32:50,219 - INFO - Randomly subsampled 50 images
2025-10-17 01:32:50,230 - DEBUG - Loaded metadata from /tmp/tmpjtsnrgwh/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 01:32:50,230 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-17 01:32:50,230 - INFO - Loading data from /tmp/tmpjtsnrgwh/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-17 01:32:50,235 - INFO - Using full dataset of 100 images
2025-10-17 01:32:50,236 - INFO - Loaded test data from /tmp/tmpjtsnrgwh/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 01:32:50,236 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 01:32:50,236 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 01:32:50,236 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 01:32:50,236 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 01:32:50,236 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 01:32:50,236 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 01:32:50,236 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 01:32:50,236 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 01:32:50,236 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 01:32:50,236 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 01:32:50,236 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 01:32:50,236 - INFO - Using all 50 points as seeds
2025-10-17 01:32:50,236 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 01:32:50,236 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 01:32:50,236 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 01:32:50,236 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 01:32:50,236 - INFO - Generated 50 groups efficiently
2025-10-17 01:32:51,809 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 01:32:51,809 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 01:32:51,810 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 01:32:51,810 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 01:32:51,810 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 01:32:51,810 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 01:32:51,810 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 01:32:51,810 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 01:32:51,810 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 01:32:51,810 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 01:32:51,810 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 01:32:51,810 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 01:32:51,810 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 01:32:51,810 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 01:32:51,810 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 01:32:51,810 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 01:32:51,810 - INFO - Generated 50 groups efficiently
2025-10-17 01:32:53,795 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 01:32:55,692 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 01:33:03,032 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 01:33:06,163 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 01:33:06,178 - DEBUG - Creating converter from 5 to 3
2025-10-17 01:33:07,314 - INFO - Outputs saved to /tmp/tmpjtsnrgwh/training/training_nphotons_1000000.0_single
2025-10-17 01:33:43,140 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 01:33:43,317 - DEBUG - Creating converter from 7 to 5
2025-10-17 01:33:43,317 - DEBUG - Creating converter from 5 to 7
2025-10-17 01:33:43,317 - DEBUG - Creating converter from 7 to 5
2025-10-17 01:33:43,317 - DEBUG - Creating converter from 5 to 7
2025-10-17 01:33:43,930 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 01:33:43,937 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 01:33:43,938 - DEBUG - interactive is False
2025-10-17 01:33:43,938 - DEBUG - platform is linux
2025-10-17 01:33:43,967 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 01:33:43,968 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 01:33:45,020 - DEBUG - Field: train_data_file
2025-10-17 01:33:45,020 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 01:33:45,020 - DEBUG - Field default: None
2025-10-17 01:33:45,020 - DEBUG - Field: test_data_file
2025-10-17 01:33:45,020 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 01:33:45,020 - DEBUG - Field default: None
2025-10-17 01:33:45,020 - DEBUG - Field: output_dir
2025-10-17 01:33:45,020 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 01:33:45,020 - DEBUG - Field default: training_outputs
2025-10-17 01:33:45,020 - DEBUG - Converting path value: /tmp/tmpitdn9lgn/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 01:33:45,020 - DEBUG - Converting path value: /tmp/tmpitdn9lgn/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 01:33:45,020 - DEBUG - Converting path value: /tmp/tmpitdn9lgn/training/training_mismatch_test
2025-10-17 01:33:45,020 - DEBUG - YAML config: {}
2025-10-17 01:33:45,020 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpitdn9lgn/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpitdn9lgn/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpitdn9lgn/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-17 01:33:45,020 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpitdn9lgn/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpitdn9lgn/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpitdn9lgn/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-17 01:33:45,020 - INFO - Configuration setup complete
2025-10-17 01:33:45,021 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpitdn9lgn/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmpitdn9lgn/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpitdn9lgn/training/training_mismatch_test'), sequential_sampling=False)
2025-10-17 01:33:45,021 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 01:33:45,021 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 01:33:45,021 - INFO - Loading data from /tmp/tmpitdn9lgn/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-17 01:33:45,026 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 01:33:45,026 - INFO - Randomly subsampled 50 images
2025-10-17 01:33:45,037 - DEBUG - Loaded metadata from /tmp/tmpitdn9lgn/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 01:33:45,037 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-17 01:33:45,037 - INFO - Loading data from /tmp/tmpitdn9lgn/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-17 01:33:45,041 - INFO - Using full dataset of 100 images
2025-10-17 01:33:45,042 - INFO - Loaded test data from /tmp/tmpitdn9lgn/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 01:33:45,042 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 01:33:45,042 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 01:33:45,042 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 01:33:45,042 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 01:33:45,042 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 01:33:45,042 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 01:33:45,042 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 01:33:45,042 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 01:33:45,042 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 01:33:45,042 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 01:33:45,042 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 01:33:45,042 - INFO - Using all 50 points as seeds
2025-10-17 01:33:45,042 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 01:33:45,042 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 01:33:45,042 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 01:33:45,042 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 01:33:45,042 - INFO - Generated 50 groups efficiently
2025-10-17 01:33:46,585 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 01:33:46,585 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 01:33:46,585 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 01:33:46,586 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 01:33:46,586 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 01:33:46,586 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 01:33:46,586 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 01:33:46,586 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 01:33:46,586 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 01:33:46,586 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 01:33:46,586 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 01:33:46,586 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 01:33:46,586 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 01:33:46,586 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 01:33:46,586 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 01:33:46,586 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 01:33:46,586 - INFO - Generated 50 groups efficiently
2025-10-17 01:33:48,572 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 01:33:50,433 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 01:33:57,655 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 01:34:00,815 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 01:34:00,832 - DEBUG - Creating converter from 5 to 3
2025-10-17 01:34:01,955 - INFO - Outputs saved to /tmp/tmpitdn9lgn/training/training_mismatch_test
2025-10-17 02:22:59,903 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 02:23:00,079 - DEBUG - Creating converter from 7 to 5
2025-10-17 02:23:00,079 - DEBUG - Creating converter from 5 to 7
2025-10-17 02:23:00,079 - DEBUG - Creating converter from 7 to 5
2025-10-17 02:23:00,079 - DEBUG - Creating converter from 5 to 7
2025-10-17 02:23:00,699 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 02:23:00,706 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 02:23:00,706 - DEBUG - interactive is False
2025-10-17 02:23:00,706 - DEBUG - platform is linux
2025-10-17 02:23:00,736 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 02:23:00,737 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 02:23:01,770 - DEBUG - Field: train_data_file
2025-10-17 02:23:01,770 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 02:23:01,770 - DEBUG - Field default: None
2025-10-17 02:23:01,770 - DEBUG - Field: test_data_file
2025-10-17 02:23:01,770 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 02:23:01,770 - DEBUG - Field default: None
2025-10-17 02:23:01,770 - DEBUG - Field: output_dir
2025-10-17 02:23:01,770 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 02:23:01,770 - DEBUG - Field default: training_outputs
2025-10-17 02:23:01,770 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 02:23:01,771 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 02:23:01,771 - DEBUG - Converting path value: /tmp/tmpyx8aq9_o/training_outputs
2025-10-17 02:23:01,771 - DEBUG - YAML config: {}
2025-10-17 02:23:01,771 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpyx8aq9_o/training_outputs'), 'sequential_sampling': False}
2025-10-17 02:23:01,771 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpyx8aq9_o/training_outputs'), 'sequential_sampling': False}
2025-10-17 02:23:01,771 - INFO - Configuration setup complete
2025-10-17 02:23:01,771 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpyx8aq9_o/training_outputs'), sequential_sampling=False)
2025-10-17 02:23:01,771 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-17 02:23:01,771 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-17 02:23:01,771 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-17 02:23:01,787 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-17 02:23:01,787 - INFO - Randomly subsampled 64 images
2025-10-17 02:23:01,804 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-17 02:23:01,820 - INFO - Using full dataset of 1087 images
2025-10-17 02:23:01,834 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-17 02:23:01,835 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-17 02:23:01,835 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 02:23:01,835 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-17 02:23:01,835 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 02:23:01,835 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 02:23:01,835 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 02:23:01,835 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 02:23:01,835 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-17 02:23:01,835 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-17 02:23:01,835 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-17 02:23:01,835 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-17 02:23:01,835 - INFO - Using all 64 points as seeds
2025-10-17 02:23:01,835 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 02:23:01,835 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-17 02:23:01,835 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-17 02:23:01,835 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-17 02:23:01,835 - INFO - Generated 64 groups efficiently
2025-10-17 02:23:03,394 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-17 02:23:03,394 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 02:23:03,394 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-17 02:23:03,394 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 02:23:03,394 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 02:23:03,394 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 02:23:03,394 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 02:23:03,394 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-17 02:23:03,394 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-17 02:23:03,394 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-17 02:23:03,394 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-17 02:23:03,394 - INFO - Sampled 64 seed points from 1087 total points
2025-10-17 02:23:03,394 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 02:23:03,394 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-17 02:23:03,394 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-17 02:23:03,394 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-17 02:23:03,394 - INFO - Generated 64 groups efficiently
2025-10-17 02:23:05,425 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 02:23:07,276 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 02:23:14,398 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 02:23:16,331 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 02:23:16,550 - DEBUG - Creating converter from 5 to 3
2025-10-17 02:23:17,678 - INFO - Outputs saved to /tmp/tmpyx8aq9_o/training_outputs
2025-10-17 02:23:41,862 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 02:23:42,039 - DEBUG - Creating converter from 7 to 5
2025-10-17 02:23:42,039 - DEBUG - Creating converter from 5 to 7
2025-10-17 02:23:42,039 - DEBUG - Creating converter from 7 to 5
2025-10-17 02:23:42,039 - DEBUG - Creating converter from 5 to 7
2025-10-17 02:23:42,664 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 02:23:42,671 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 02:23:42,672 - DEBUG - interactive is False
2025-10-17 02:23:42,672 - DEBUG - platform is linux
2025-10-17 02:23:42,701 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 02:23:42,703 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 02:23:43,766 - DEBUG - Field: train_data_file
2025-10-17 02:23:43,766 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 02:23:43,766 - DEBUG - Field default: None
2025-10-17 02:23:43,766 - DEBUG - Field: test_data_file
2025-10-17 02:23:43,766 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 02:23:43,766 - DEBUG - Field default: None
2025-10-17 02:23:43,767 - DEBUG - Field: output_dir
2025-10-17 02:23:43,767 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 02:23:43,767 - DEBUG - Field default: training_outputs
2025-10-17 02:23:43,767 - DEBUG - Converting path value: /tmp/tmpqhyvzlpr/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 02:23:43,767 - DEBUG - Converting path value: /tmp/tmpqhyvzlpr/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 02:23:43,767 - DEBUG - Converting path value: /tmp/tmpqhyvzlpr/training/training_nphotons_500000.0_e2e
2025-10-17 02:23:43,767 - DEBUG - YAML config: {}
2025-10-17 02:23:43,767 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpqhyvzlpr/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpqhyvzlpr/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpqhyvzlpr/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-17 02:23:43,767 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpqhyvzlpr/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpqhyvzlpr/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpqhyvzlpr/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-17 02:23:43,767 - INFO - Configuration setup complete
2025-10-17 02:23:43,767 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpqhyvzlpr/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmpqhyvzlpr/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpqhyvzlpr/training/training_nphotons_500000.0_e2e'), sequential_sampling=False)
2025-10-17 02:23:43,767 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 02:23:43,767 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 02:23:43,767 - INFO - Loading data from /tmp/tmpqhyvzlpr/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-17 02:23:43,774 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 02:23:43,774 - INFO - Randomly subsampled 50 images
2025-10-17 02:23:43,785 - DEBUG - Loaded metadata from /tmp/tmpqhyvzlpr/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 02:23:43,785 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-17 02:23:43,785 - INFO - Loading data from /tmp/tmpqhyvzlpr/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-17 02:23:43,790 - INFO - Using full dataset of 100 images
2025-10-17 02:23:43,790 - INFO - Loaded test data from /tmp/tmpqhyvzlpr/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-17 02:23:43,791 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 02:23:43,791 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 02:23:43,791 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 02:23:43,791 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 02:23:43,791 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 02:23:43,791 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 02:23:43,791 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 02:23:43,791 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 02:23:43,791 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 02:23:43,791 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 02:23:43,791 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 02:23:43,791 - INFO - Using all 50 points as seeds
2025-10-17 02:23:43,791 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 02:23:43,791 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 02:23:43,791 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 02:23:43,791 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 02:23:43,791 - INFO - Generated 50 groups efficiently
2025-10-17 02:23:45,356 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 02:23:45,356 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 02:23:45,356 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 02:23:45,356 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 02:23:45,356 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 02:23:45,356 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 02:23:45,356 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 02:23:45,356 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 02:23:45,356 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 02:23:45,356 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 02:23:45,356 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 02:23:45,356 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 02:23:45,356 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 02:23:45,356 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 02:23:45,356 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 02:23:45,356 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 02:23:45,356 - INFO - Generated 50 groups efficiently
2025-10-17 02:23:47,340 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 02:23:49,234 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 02:23:56,493 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 02:23:59,639 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 02:23:59,655 - DEBUG - Creating converter from 5 to 3
2025-10-17 02:24:00,801 - INFO - Outputs saved to /tmp/tmpqhyvzlpr/training/training_nphotons_500000.0_e2e
2025-10-17 02:24:19,152 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 02:24:19,332 - DEBUG - Creating converter from 7 to 5
2025-10-17 02:24:19,332 - DEBUG - Creating converter from 5 to 7
2025-10-17 02:24:19,332 - DEBUG - Creating converter from 7 to 5
2025-10-17 02:24:19,332 - DEBUG - Creating converter from 5 to 7
2025-10-17 02:24:19,953 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 02:24:19,960 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 02:24:19,961 - DEBUG - interactive is False
2025-10-17 02:24:19,961 - DEBUG - platform is linux
2025-10-17 02:24:19,990 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 02:24:19,991 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 02:24:21,040 - DEBUG - Field: train_data_file
2025-10-17 02:24:21,040 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 02:24:21,040 - DEBUG - Field default: None
2025-10-17 02:24:21,041 - DEBUG - Field: test_data_file
2025-10-17 02:24:21,041 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 02:24:21,041 - DEBUG - Field default: None
2025-10-17 02:24:21,041 - DEBUG - Field: output_dir
2025-10-17 02:24:21,041 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 02:24:21,041 - DEBUG - Field default: training_outputs
2025-10-17 02:24:21,041 - DEBUG - Converting path value: /tmp/tmpp7a77w8t/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 02:24:21,041 - DEBUG - Converting path value: /tmp/tmpp7a77w8t/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 02:24:21,041 - DEBUG - Converting path value: /tmp/tmpp7a77w8t/training/training_nphotons_1000000.0_single
2025-10-17 02:24:21,041 - DEBUG - YAML config: {}
2025-10-17 02:24:21,041 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpp7a77w8t/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpp7a77w8t/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpp7a77w8t/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-17 02:24:21,041 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpp7a77w8t/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpp7a77w8t/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpp7a77w8t/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-17 02:24:21,041 - INFO - Configuration setup complete
2025-10-17 02:24:21,041 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpp7a77w8t/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmpp7a77w8t/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpp7a77w8t/training/training_nphotons_1000000.0_single'), sequential_sampling=False)
2025-10-17 02:24:21,041 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 02:24:21,041 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 02:24:21,041 - INFO - Loading data from /tmp/tmpp7a77w8t/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-17 02:24:21,048 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 02:24:21,048 - INFO - Randomly subsampled 50 images
2025-10-17 02:24:21,059 - DEBUG - Loaded metadata from /tmp/tmpp7a77w8t/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 02:24:21,059 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-17 02:24:21,059 - INFO - Loading data from /tmp/tmpp7a77w8t/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-17 02:24:21,065 - INFO - Using full dataset of 100 images
2025-10-17 02:24:21,065 - INFO - Loaded test data from /tmp/tmpp7a77w8t/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-17 02:24:21,065 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 02:24:21,065 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 02:24:21,065 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 02:24:21,065 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 02:24:21,065 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 02:24:21,065 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 02:24:21,065 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 02:24:21,065 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 02:24:21,066 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 02:24:21,066 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 02:24:21,066 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 02:24:21,066 - INFO - Using all 50 points as seeds
2025-10-17 02:24:21,066 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 02:24:21,066 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 02:24:21,066 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 02:24:21,066 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 02:24:21,066 - INFO - Generated 50 groups efficiently
2025-10-17 02:24:22,583 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 02:24:22,583 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 02:24:22,583 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 02:24:22,583 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 02:24:22,583 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 02:24:22,583 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 02:24:22,583 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 02:24:22,583 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 02:24:22,583 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 02:24:22,583 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 02:24:22,583 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 02:24:22,583 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 02:24:22,583 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 02:24:22,583 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 02:24:22,583 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 02:24:22,583 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 02:24:22,583 - INFO - Generated 50 groups efficiently
2025-10-17 02:24:24,560 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 02:24:26,426 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 02:24:33,697 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 02:24:36,829 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 02:24:36,845 - DEBUG - Creating converter from 5 to 3
2025-10-17 02:24:37,974 - INFO - Outputs saved to /tmp/tmpp7a77w8t/training/training_nphotons_1000000.0_single
2025-10-17 02:25:13,844 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-17 02:25:14,020 - DEBUG - Creating converter from 7 to 5
2025-10-17 02:25:14,020 - DEBUG - Creating converter from 5 to 7
2025-10-17 02:25:14,020 - DEBUG - Creating converter from 7 to 5
2025-10-17 02:25:14,020 - DEBUG - Creating converter from 5 to 7
2025-10-17 02:25:14,641 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-17 02:25:14,648 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-17 02:25:14,649 - DEBUG - interactive is False
2025-10-17 02:25:14,649 - DEBUG - platform is linux
2025-10-17 02:25:14,678 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-17 02:25:14,680 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-17 02:25:15,738 - DEBUG - Field: train_data_file
2025-10-17 02:25:15,738 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 02:25:15,738 - DEBUG - Field default: None
2025-10-17 02:25:15,738 - DEBUG - Field: test_data_file
2025-10-17 02:25:15,738 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-17 02:25:15,738 - DEBUG - Field default: None
2025-10-17 02:25:15,738 - DEBUG - Field: output_dir
2025-10-17 02:25:15,738 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-17 02:25:15,738 - DEBUG - Field default: training_outputs
2025-10-17 02:25:15,738 - DEBUG - Converting path value: /tmp/tmp53wz4ta0/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 02:25:15,738 - DEBUG - Converting path value: /tmp/tmp53wz4ta0/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 02:25:15,738 - DEBUG - Converting path value: /tmp/tmp53wz4ta0/training/training_mismatch_test
2025-10-17 02:25:15,739 - DEBUG - YAML config: {}
2025-10-17 02:25:15,739 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp53wz4ta0/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmp53wz4ta0/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp53wz4ta0/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-17 02:25:15,739 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp53wz4ta0/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmp53wz4ta0/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp53wz4ta0/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-17 02:25:15,739 - INFO - Configuration setup complete
2025-10-17 02:25:15,739 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp53wz4ta0/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmp53wz4ta0/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp53wz4ta0/training/training_mismatch_test'), sequential_sampling=False)
2025-10-17 02:25:15,739 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-17 02:25:15,739 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-17 02:25:15,739 - INFO - Loading data from /tmp/tmp53wz4ta0/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-17 02:25:15,744 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-17 02:25:15,744 - INFO - Randomly subsampled 50 images
2025-10-17 02:25:15,754 - DEBUG - Loaded metadata from /tmp/tmp53wz4ta0/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 02:25:15,754 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-17 02:25:15,755 - INFO - Loading data from /tmp/tmp53wz4ta0/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-17 02:25:15,759 - INFO - Using full dataset of 100 images
2025-10-17 02:25:15,759 - INFO - Loaded test data from /tmp/tmp53wz4ta0/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-17 02:25:15,760 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-17 02:25:15,760 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 02:25:15,760 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-17 02:25:15,760 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 02:25:15,760 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 02:25:15,760 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 02:25:15,760 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 02:25:15,760 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 02:25:15,760 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-17 02:25:15,760 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-17 02:25:15,760 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-17 02:25:15,760 - INFO - Using all 50 points as seeds
2025-10-17 02:25:15,760 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 02:25:15,760 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 02:25:15,760 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 02:25:15,760 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 02:25:15,760 - INFO - Generated 50 groups efficiently
2025-10-17 02:25:17,323 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-17 02:25:17,323 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-17 02:25:17,323 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-17 02:25:17,323 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-17 02:25:17,323 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-17 02:25:17,323 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-17 02:25:17,323 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-17 02:25:17,323 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-17 02:25:17,323 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-17 02:25:17,323 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-17 02:25:17,323 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-17 02:25:17,323 - INFO - Sampled 50 seed points from 100 total points
2025-10-17 02:25:17,323 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-17 02:25:17,323 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-17 02:25:17,323 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-17 02:25:17,323 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-17 02:25:17,323 - INFO - Generated 50 groups efficiently
2025-10-17 02:25:19,341 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 02:25:21,226 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 02:25:28,581 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-17 02:25:31,693 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-17 02:25:31,708 - DEBUG - Creating converter from 5 to 3
2025-10-17 02:25:32,831 - INFO - Outputs saved to /tmp/tmp53wz4ta0/training/training_mismatch_test
