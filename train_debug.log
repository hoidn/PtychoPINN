2025-10-20 01:07:21,837 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-20 01:07:22,014 - DEBUG - Creating converter from 7 to 5
2025-10-20 01:07:22,014 - DEBUG - Creating converter from 5 to 7
2025-10-20 01:07:22,014 - DEBUG - Creating converter from 7 to 5
2025-10-20 01:07:22,014 - DEBUG - Creating converter from 5 to 7
2025-10-20 01:07:22,624 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-20 01:07:22,631 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-20 01:07:22,631 - DEBUG - interactive is False
2025-10-20 01:07:22,632 - DEBUG - platform is linux
2025-10-20 01:07:22,661 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-20 01:07:22,662 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-20 01:07:23,666 - DEBUG - Field: train_data_file
2025-10-20 01:07:23,666 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 01:07:23,666 - DEBUG - Field default: None
2025-10-20 01:07:23,666 - DEBUG - Field: test_data_file
2025-10-20 01:07:23,666 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 01:07:23,666 - DEBUG - Field default: None
2025-10-20 01:07:23,666 - DEBUG - Field: output_dir
2025-10-20 01:07:23,666 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-20 01:07:23,666 - DEBUG - Field default: training_outputs
2025-10-20 01:07:23,666 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-20 01:07:23,666 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-20 01:07:23,666 - DEBUG - Converting path value: /tmp/tmpi823wb1x/training_outputs
2025-10-20 01:07:23,666 - DEBUG - YAML config: {}
2025-10-20 01:07:23,666 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpi823wb1x/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 01:07:23,666 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpi823wb1x/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 01:07:23,666 - INFO - Configuration setup complete
2025-10-20 01:07:23,667 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpi823wb1x/training_outputs'), sequential_sampling=False, backend='tensorflow')
2025-10-20 01:07:23,667 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-20 01:07:23,667 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-20 01:07:23,667 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-20 01:07:23,682 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-20 01:07:23,683 - INFO - Randomly subsampled 64 images
2025-10-20 01:07:23,700 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-20 01:07:23,715 - INFO - Using full dataset of 1087 images
2025-10-20 01:07:23,730 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-20 01:07:23,730 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-20 01:07:23,730 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 01:07:23,730 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-20 01:07:23,730 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 01:07:23,730 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 01:07:23,730 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 01:07:23,730 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 01:07:23,730 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-20 01:07:23,730 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-20 01:07:23,730 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-20 01:07:23,730 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-20 01:07:23,730 - INFO - Using all 64 points as seeds
2025-10-20 01:07:23,730 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 01:07:23,730 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-20 01:07:23,731 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-20 01:07:23,731 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-20 01:07:23,731 - INFO - Generated 64 groups efficiently
2025-10-20 01:07:24,704 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-20 01:07:24,704 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 01:07:24,704 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-20 01:07:24,704 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 01:07:24,704 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 01:07:24,704 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 01:07:24,704 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 01:07:24,704 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-20 01:07:24,704 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-20 01:07:24,704 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-20 01:07:24,704 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-20 01:07:24,705 - INFO - Sampled 64 seed points from 1087 total points
2025-10-20 01:07:24,705 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 01:07:24,705 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-20 01:07:24,705 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-20 01:07:24,705 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-20 01:07:24,705 - INFO - Generated 64 groups efficiently
2025-10-20 01:07:25,927 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:07:27,762 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:07:31,586 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:07:34,350 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-20 01:07:34,566 - DEBUG - Creating converter from 5 to 3
2025-10-20 01:07:35,685 - INFO - Outputs saved to /tmp/tmpi823wb1x/training_outputs
2025-10-20 01:07:55,221 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-20 01:07:55,395 - DEBUG - Creating converter from 7 to 5
2025-10-20 01:07:55,396 - DEBUG - Creating converter from 5 to 7
2025-10-20 01:07:55,396 - DEBUG - Creating converter from 7 to 5
2025-10-20 01:07:55,396 - DEBUG - Creating converter from 5 to 7
2025-10-20 01:07:56,013 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-20 01:07:56,021 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-20 01:07:56,021 - DEBUG - interactive is False
2025-10-20 01:07:56,021 - DEBUG - platform is linux
2025-10-20 01:07:56,051 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-20 01:07:56,052 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-20 01:07:57,061 - DEBUG - Field: train_data_file
2025-10-20 01:07:57,061 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 01:07:57,061 - DEBUG - Field default: None
2025-10-20 01:07:57,061 - DEBUG - Field: test_data_file
2025-10-20 01:07:57,061 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 01:07:57,061 - DEBUG - Field default: None
2025-10-20 01:07:57,061 - DEBUG - Field: output_dir
2025-10-20 01:07:57,061 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-20 01:07:57,061 - DEBUG - Field default: training_outputs
2025-10-20 01:07:57,061 - DEBUG - Converting path value: /tmp/tmpbvxzjn_u/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-20 01:07:57,061 - DEBUG - Converting path value: /tmp/tmpbvxzjn_u/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-20 01:07:57,061 - DEBUG - Converting path value: /tmp/tmpbvxzjn_u/training/training_nphotons_500000.0_e2e
2025-10-20 01:07:57,061 - DEBUG - YAML config: {}
2025-10-20 01:07:57,061 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpbvxzjn_u/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpbvxzjn_u/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpbvxzjn_u/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 01:07:57,061 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpbvxzjn_u/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpbvxzjn_u/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpbvxzjn_u/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 01:07:57,062 - INFO - Configuration setup complete
2025-10-20 01:07:57,062 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpbvxzjn_u/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmpbvxzjn_u/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpbvxzjn_u/training/training_nphotons_500000.0_e2e'), sequential_sampling=False, backend='tensorflow')
2025-10-20 01:07:57,062 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-20 01:07:57,062 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-20 01:07:57,062 - INFO - Loading data from /tmp/tmpbvxzjn_u/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-20 01:07:57,068 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-20 01:07:57,068 - INFO - Randomly subsampled 50 images
2025-10-20 01:07:57,079 - DEBUG - Loaded metadata from /tmp/tmpbvxzjn_u/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-20 01:07:57,080 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-20 01:07:57,080 - INFO - Loading data from /tmp/tmpbvxzjn_u/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-20 01:07:57,085 - INFO - Using full dataset of 100 images
2025-10-20 01:07:57,086 - INFO - Loaded test data from /tmp/tmpbvxzjn_u/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-20 01:07:57,086 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-20 01:07:57,086 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 01:07:57,086 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-20 01:07:57,086 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 01:07:57,086 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 01:07:57,086 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 01:07:57,086 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 01:07:57,086 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 01:07:57,086 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-20 01:07:57,086 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-20 01:07:57,086 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-20 01:07:57,086 - INFO - Using all 50 points as seeds
2025-10-20 01:07:57,086 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 01:07:57,086 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 01:07:57,086 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 01:07:57,086 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 01:07:57,086 - INFO - Generated 50 groups efficiently
2025-10-20 01:07:57,997 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-20 01:07:57,998 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 01:07:57,998 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-20 01:07:57,998 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 01:07:57,998 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 01:07:57,998 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 01:07:57,998 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 01:07:57,998 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 01:07:57,998 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-20 01:07:57,998 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-20 01:07:57,998 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-20 01:07:57,998 - INFO - Sampled 50 seed points from 100 total points
2025-10-20 01:07:57,998 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 01:07:57,998 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 01:07:57,998 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 01:07:57,998 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 01:07:57,998 - INFO - Generated 50 groups efficiently
2025-10-20 01:07:59,173 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:08:01,040 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:08:04,574 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:08:07,806 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-20 01:08:07,824 - DEBUG - Creating converter from 5 to 3
2025-10-20 01:08:08,944 - INFO - Outputs saved to /tmp/tmpbvxzjn_u/training/training_nphotons_500000.0_e2e
2025-10-20 01:08:23,456 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-20 01:08:23,633 - DEBUG - Creating converter from 7 to 5
2025-10-20 01:08:23,633 - DEBUG - Creating converter from 5 to 7
2025-10-20 01:08:23,634 - DEBUG - Creating converter from 7 to 5
2025-10-20 01:08:23,634 - DEBUG - Creating converter from 5 to 7
2025-10-20 01:08:24,255 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-20 01:08:24,262 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-20 01:08:24,263 - DEBUG - interactive is False
2025-10-20 01:08:24,263 - DEBUG - platform is linux
2025-10-20 01:08:24,292 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-20 01:08:24,293 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-20 01:08:25,298 - DEBUG - Field: train_data_file
2025-10-20 01:08:25,298 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 01:08:25,298 - DEBUG - Field default: None
2025-10-20 01:08:25,298 - DEBUG - Field: test_data_file
2025-10-20 01:08:25,298 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 01:08:25,298 - DEBUG - Field default: None
2025-10-20 01:08:25,298 - DEBUG - Field: output_dir
2025-10-20 01:08:25,298 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-20 01:08:25,298 - DEBUG - Field default: training_outputs
2025-10-20 01:08:25,298 - DEBUG - Converting path value: /tmp/tmpmy61td1c/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-20 01:08:25,298 - DEBUG - Converting path value: /tmp/tmpmy61td1c/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-20 01:08:25,298 - DEBUG - Converting path value: /tmp/tmpmy61td1c/training/training_nphotons_1000000.0_single
2025-10-20 01:08:25,298 - DEBUG - YAML config: {}
2025-10-20 01:08:25,299 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpmy61td1c/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpmy61td1c/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpmy61td1c/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 01:08:25,299 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpmy61td1c/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpmy61td1c/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpmy61td1c/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 01:08:25,299 - INFO - Configuration setup complete
2025-10-20 01:08:25,299 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpmy61td1c/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmpmy61td1c/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpmy61td1c/training/training_nphotons_1000000.0_single'), sequential_sampling=False, backend='tensorflow')
2025-10-20 01:08:25,299 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-20 01:08:25,299 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-20 01:08:25,299 - INFO - Loading data from /tmp/tmpmy61td1c/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-20 01:08:25,305 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-20 01:08:25,305 - INFO - Randomly subsampled 50 images
2025-10-20 01:08:25,317 - DEBUG - Loaded metadata from /tmp/tmpmy61td1c/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-20 01:08:25,317 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-20 01:08:25,317 - INFO - Loading data from /tmp/tmpmy61td1c/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-20 01:08:25,322 - INFO - Using full dataset of 100 images
2025-10-20 01:08:25,323 - INFO - Loaded test data from /tmp/tmpmy61td1c/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-20 01:08:25,323 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-20 01:08:25,323 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 01:08:25,323 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-20 01:08:25,323 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 01:08:25,323 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 01:08:25,323 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 01:08:25,323 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 01:08:25,323 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 01:08:25,323 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-20 01:08:25,323 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-20 01:08:25,323 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-20 01:08:25,323 - INFO - Using all 50 points as seeds
2025-10-20 01:08:25,323 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 01:08:25,323 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 01:08:25,323 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 01:08:25,323 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 01:08:25,323 - INFO - Generated 50 groups efficiently
2025-10-20 01:08:26,241 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-20 01:08:26,241 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 01:08:26,242 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-20 01:08:26,242 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 01:08:26,242 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 01:08:26,242 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 01:08:26,242 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 01:08:26,242 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 01:08:26,242 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-20 01:08:26,242 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-20 01:08:26,242 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-20 01:08:26,242 - INFO - Sampled 50 seed points from 100 total points
2025-10-20 01:08:26,242 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 01:08:26,242 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 01:08:26,242 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 01:08:26,242 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 01:08:26,242 - INFO - Generated 50 groups efficiently
2025-10-20 01:08:27,419 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:08:29,275 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:08:32,837 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:08:36,031 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-20 01:08:36,046 - DEBUG - Creating converter from 5 to 3
2025-10-20 01:08:37,177 - INFO - Outputs saved to /tmp/tmpmy61td1c/training/training_nphotons_1000000.0_single
2025-10-20 01:09:06,875 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-20 01:09:07,050 - DEBUG - Creating converter from 7 to 5
2025-10-20 01:09:07,050 - DEBUG - Creating converter from 5 to 7
2025-10-20 01:09:07,050 - DEBUG - Creating converter from 7 to 5
2025-10-20 01:09:07,050 - DEBUG - Creating converter from 5 to 7
2025-10-20 01:09:07,649 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-20 01:09:07,656 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-20 01:09:07,657 - DEBUG - interactive is False
2025-10-20 01:09:07,657 - DEBUG - platform is linux
2025-10-20 01:09:07,685 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-20 01:09:07,687 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-20 01:09:08,682 - DEBUG - Field: train_data_file
2025-10-20 01:09:08,682 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 01:09:08,682 - DEBUG - Field default: None
2025-10-20 01:09:08,682 - DEBUG - Field: test_data_file
2025-10-20 01:09:08,682 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 01:09:08,682 - DEBUG - Field default: None
2025-10-20 01:09:08,682 - DEBUG - Field: output_dir
2025-10-20 01:09:08,682 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-20 01:09:08,682 - DEBUG - Field default: training_outputs
2025-10-20 01:09:08,683 - DEBUG - Converting path value: /tmp/tmpi48_e89w/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-20 01:09:08,683 - DEBUG - Converting path value: /tmp/tmpi48_e89w/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-20 01:09:08,683 - DEBUG - Converting path value: /tmp/tmpi48_e89w/training/training_mismatch_test
2025-10-20 01:09:08,683 - DEBUG - YAML config: {}
2025-10-20 01:09:08,683 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpi48_e89w/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpi48_e89w/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpi48_e89w/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 01:09:08,683 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpi48_e89w/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpi48_e89w/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpi48_e89w/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 01:09:08,683 - INFO - Configuration setup complete
2025-10-20 01:09:08,683 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpi48_e89w/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmpi48_e89w/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpi48_e89w/training/training_mismatch_test'), sequential_sampling=False, backend='tensorflow')
2025-10-20 01:09:08,683 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-20 01:09:08,683 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-20 01:09:08,683 - INFO - Loading data from /tmp/tmpi48_e89w/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-20 01:09:08,689 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-20 01:09:08,689 - INFO - Randomly subsampled 50 images
2025-10-20 01:09:08,699 - DEBUG - Loaded metadata from /tmp/tmpi48_e89w/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-20 01:09:08,699 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-20 01:09:08,699 - INFO - Loading data from /tmp/tmpi48_e89w/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-20 01:09:08,704 - INFO - Using full dataset of 100 images
2025-10-20 01:09:08,705 - INFO - Loaded test data from /tmp/tmpi48_e89w/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-20 01:09:08,705 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-20 01:09:08,705 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 01:09:08,705 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-20 01:09:08,705 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 01:09:08,705 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 01:09:08,705 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 01:09:08,705 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 01:09:08,705 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 01:09:08,705 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-20 01:09:08,705 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-20 01:09:08,705 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-20 01:09:08,705 - INFO - Using all 50 points as seeds
2025-10-20 01:09:08,705 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 01:09:08,705 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 01:09:08,705 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 01:09:08,705 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 01:09:08,705 - INFO - Generated 50 groups efficiently
2025-10-20 01:09:09,613 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-20 01:09:09,613 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 01:09:09,613 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-20 01:09:09,613 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 01:09:09,613 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 01:09:09,613 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 01:09:09,613 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 01:09:09,613 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 01:09:09,613 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-20 01:09:09,613 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-20 01:09:09,613 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-20 01:09:09,613 - INFO - Sampled 50 seed points from 100 total points
2025-10-20 01:09:09,613 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 01:09:09,613 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 01:09:09,613 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 01:09:09,613 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 01:09:09,613 - INFO - Generated 50 groups efficiently
2025-10-20 01:09:10,781 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:09:12,631 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:09:16,141 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:09:19,351 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-20 01:09:19,366 - DEBUG - Creating converter from 5 to 3
2025-10-20 01:09:20,467 - INFO - Outputs saved to /tmp/tmpi48_e89w/training/training_mismatch_test
2025-10-20 01:35:30,206 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-20 01:35:30,383 - DEBUG - Creating converter from 7 to 5
2025-10-20 01:35:30,383 - DEBUG - Creating converter from 5 to 7
2025-10-20 01:35:30,383 - DEBUG - Creating converter from 7 to 5
2025-10-20 01:35:30,383 - DEBUG - Creating converter from 5 to 7
2025-10-20 01:35:31,008 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-20 01:35:31,015 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-20 01:35:31,016 - DEBUG - interactive is False
2025-10-20 01:35:31,016 - DEBUG - platform is linux
2025-10-20 01:35:31,045 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-20 01:35:31,046 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-20 01:35:32,090 - DEBUG - Field: train_data_file
2025-10-20 01:35:32,090 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 01:35:32,090 - DEBUG - Field default: None
2025-10-20 01:35:32,090 - DEBUG - Field: test_data_file
2025-10-20 01:35:32,090 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 01:35:32,090 - DEBUG - Field default: None
2025-10-20 01:35:32,091 - DEBUG - Field: output_dir
2025-10-20 01:35:32,091 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-20 01:35:32,091 - DEBUG - Field default: training_outputs
2025-10-20 01:35:32,091 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-20 01:35:32,091 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-20 01:35:32,091 - DEBUG - Converting path value: /tmp/tmp8ywbitj1/training_outputs
2025-10-20 01:35:32,091 - DEBUG - YAML config: {}
2025-10-20 01:35:32,091 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp8ywbitj1/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 01:35:32,091 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp8ywbitj1/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 01:35:32,091 - INFO - Configuration setup complete
2025-10-20 01:35:32,091 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp8ywbitj1/training_outputs'), sequential_sampling=False, backend='tensorflow')
2025-10-20 01:35:32,091 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-20 01:35:32,091 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-20 01:35:32,091 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-20 01:35:32,108 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-20 01:35:32,108 - INFO - Randomly subsampled 64 images
2025-10-20 01:35:32,125 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-20 01:35:32,140 - INFO - Using full dataset of 1087 images
2025-10-20 01:35:32,155 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-20 01:35:32,155 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-20 01:35:32,155 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 01:35:32,156 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-20 01:35:32,156 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 01:35:32,156 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 01:35:32,156 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 01:35:32,156 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 01:35:32,156 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-20 01:35:32,156 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-20 01:35:32,156 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-20 01:35:32,156 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-20 01:35:32,156 - INFO - Using all 64 points as seeds
2025-10-20 01:35:32,156 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 01:35:32,156 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-20 01:35:32,156 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-20 01:35:32,156 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-20 01:35:32,156 - INFO - Generated 64 groups efficiently
2025-10-20 01:35:33,768 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-20 01:35:33,768 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 01:35:33,768 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-20 01:35:33,768 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 01:35:33,768 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 01:35:33,768 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 01:35:33,768 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 01:35:33,768 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-20 01:35:33,768 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-20 01:35:33,768 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-20 01:35:33,768 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-20 01:35:33,768 - INFO - Sampled 64 seed points from 1087 total points
2025-10-20 01:35:33,768 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 01:35:33,768 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-20 01:35:33,768 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-20 01:35:33,768 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-20 01:35:33,768 - INFO - Generated 64 groups efficiently
2025-10-20 01:35:35,847 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:35:37,716 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:35:45,066 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:35:47,029 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-20 01:35:47,255 - DEBUG - Creating converter from 5 to 3
2025-10-20 01:35:48,375 - INFO - Outputs saved to /tmp/tmp8ywbitj1/training_outputs
2025-10-20 01:36:12,680 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-20 01:36:12,852 - DEBUG - Creating converter from 7 to 5
2025-10-20 01:36:12,852 - DEBUG - Creating converter from 5 to 7
2025-10-20 01:36:12,852 - DEBUG - Creating converter from 7 to 5
2025-10-20 01:36:12,853 - DEBUG - Creating converter from 5 to 7
2025-10-20 01:36:13,459 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-20 01:36:13,466 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-20 01:36:13,466 - DEBUG - interactive is False
2025-10-20 01:36:13,466 - DEBUG - platform is linux
2025-10-20 01:36:13,495 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-20 01:36:13,497 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-20 01:36:14,549 - DEBUG - Field: train_data_file
2025-10-20 01:36:14,549 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 01:36:14,549 - DEBUG - Field default: None
2025-10-20 01:36:14,549 - DEBUG - Field: test_data_file
2025-10-20 01:36:14,549 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 01:36:14,549 - DEBUG - Field default: None
2025-10-20 01:36:14,549 - DEBUG - Field: output_dir
2025-10-20 01:36:14,549 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-20 01:36:14,549 - DEBUG - Field default: training_outputs
2025-10-20 01:36:14,549 - DEBUG - Converting path value: /tmp/tmpnptkyrc5/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-20 01:36:14,549 - DEBUG - Converting path value: /tmp/tmpnptkyrc5/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-20 01:36:14,549 - DEBUG - Converting path value: /tmp/tmpnptkyrc5/training/training_nphotons_500000.0_e2e
2025-10-20 01:36:14,549 - DEBUG - YAML config: {}
2025-10-20 01:36:14,549 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpnptkyrc5/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpnptkyrc5/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpnptkyrc5/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 01:36:14,549 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpnptkyrc5/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpnptkyrc5/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpnptkyrc5/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 01:36:14,549 - INFO - Configuration setup complete
2025-10-20 01:36:14,549 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpnptkyrc5/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmpnptkyrc5/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpnptkyrc5/training/training_nphotons_500000.0_e2e'), sequential_sampling=False, backend='tensorflow')
2025-10-20 01:36:14,550 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-20 01:36:14,550 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-20 01:36:14,550 - INFO - Loading data from /tmp/tmpnptkyrc5/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-20 01:36:14,556 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-20 01:36:14,556 - INFO - Randomly subsampled 50 images
2025-10-20 01:36:14,567 - DEBUG - Loaded metadata from /tmp/tmpnptkyrc5/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-20 01:36:14,567 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-20 01:36:14,567 - INFO - Loading data from /tmp/tmpnptkyrc5/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-20 01:36:14,573 - INFO - Using full dataset of 100 images
2025-10-20 01:36:14,573 - INFO - Loaded test data from /tmp/tmpnptkyrc5/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-20 01:36:14,574 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-20 01:36:14,574 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 01:36:14,574 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-20 01:36:14,574 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 01:36:14,574 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 01:36:14,574 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 01:36:14,574 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 01:36:14,574 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 01:36:14,574 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-20 01:36:14,574 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-20 01:36:14,574 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-20 01:36:14,574 - INFO - Using all 50 points as seeds
2025-10-20 01:36:14,574 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 01:36:14,574 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 01:36:14,574 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 01:36:14,574 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 01:36:14,574 - INFO - Generated 50 groups efficiently
2025-10-20 01:36:16,100 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-20 01:36:16,100 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 01:36:16,100 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-20 01:36:16,100 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 01:36:16,100 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 01:36:16,100 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 01:36:16,100 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 01:36:16,100 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 01:36:16,100 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-20 01:36:16,100 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-20 01:36:16,100 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-20 01:36:16,100 - INFO - Sampled 50 seed points from 100 total points
2025-10-20 01:36:16,100 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 01:36:16,100 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 01:36:16,100 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 01:36:16,100 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 01:36:16,101 - INFO - Generated 50 groups efficiently
2025-10-20 01:36:18,093 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:36:19,942 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:36:27,182 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:36:30,350 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-20 01:36:30,366 - DEBUG - Creating converter from 5 to 3
2025-10-20 01:36:31,508 - INFO - Outputs saved to /tmp/tmpnptkyrc5/training/training_nphotons_500000.0_e2e
2025-10-20 01:36:49,844 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-20 01:36:50,019 - DEBUG - Creating converter from 7 to 5
2025-10-20 01:36:50,019 - DEBUG - Creating converter from 5 to 7
2025-10-20 01:36:50,019 - DEBUG - Creating converter from 7 to 5
2025-10-20 01:36:50,019 - DEBUG - Creating converter from 5 to 7
2025-10-20 01:36:50,633 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-20 01:36:50,640 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-20 01:36:50,640 - DEBUG - interactive is False
2025-10-20 01:36:50,640 - DEBUG - platform is linux
2025-10-20 01:36:50,669 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-20 01:36:50,671 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-20 01:36:51,724 - DEBUG - Field: train_data_file
2025-10-20 01:36:51,724 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 01:36:51,724 - DEBUG - Field default: None
2025-10-20 01:36:51,724 - DEBUG - Field: test_data_file
2025-10-20 01:36:51,724 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 01:36:51,724 - DEBUG - Field default: None
2025-10-20 01:36:51,724 - DEBUG - Field: output_dir
2025-10-20 01:36:51,724 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-20 01:36:51,724 - DEBUG - Field default: training_outputs
2025-10-20 01:36:51,724 - DEBUG - Converting path value: /tmp/tmps1auwtg6/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-20 01:36:51,724 - DEBUG - Converting path value: /tmp/tmps1auwtg6/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-20 01:36:51,724 - DEBUG - Converting path value: /tmp/tmps1auwtg6/training/training_nphotons_1000000.0_single
2025-10-20 01:36:51,724 - DEBUG - YAML config: {}
2025-10-20 01:36:51,724 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmps1auwtg6/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmps1auwtg6/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmps1auwtg6/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 01:36:51,725 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmps1auwtg6/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmps1auwtg6/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmps1auwtg6/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 01:36:51,725 - INFO - Configuration setup complete
2025-10-20 01:36:51,725 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmps1auwtg6/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmps1auwtg6/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmps1auwtg6/training/training_nphotons_1000000.0_single'), sequential_sampling=False, backend='tensorflow')
2025-10-20 01:36:51,725 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-20 01:36:51,725 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-20 01:36:51,725 - INFO - Loading data from /tmp/tmps1auwtg6/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-20 01:36:51,731 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-20 01:36:51,732 - INFO - Randomly subsampled 50 images
2025-10-20 01:36:51,743 - DEBUG - Loaded metadata from /tmp/tmps1auwtg6/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-20 01:36:51,743 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-20 01:36:51,743 - INFO - Loading data from /tmp/tmps1auwtg6/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-20 01:36:51,749 - INFO - Using full dataset of 100 images
2025-10-20 01:36:51,749 - INFO - Loaded test data from /tmp/tmps1auwtg6/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-20 01:36:51,749 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-20 01:36:51,749 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 01:36:51,749 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-20 01:36:51,749 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 01:36:51,749 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 01:36:51,749 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 01:36:51,749 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 01:36:51,749 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 01:36:51,749 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-20 01:36:51,749 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-20 01:36:51,749 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-20 01:36:51,749 - INFO - Using all 50 points as seeds
2025-10-20 01:36:51,749 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 01:36:51,749 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 01:36:51,750 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 01:36:51,750 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 01:36:51,750 - INFO - Generated 50 groups efficiently
2025-10-20 01:36:53,316 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-20 01:36:53,316 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 01:36:53,316 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-20 01:36:53,316 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 01:36:53,316 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 01:36:53,316 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 01:36:53,316 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 01:36:53,316 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 01:36:53,316 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-20 01:36:53,316 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-20 01:36:53,316 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-20 01:36:53,316 - INFO - Sampled 50 seed points from 100 total points
2025-10-20 01:36:53,316 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 01:36:53,316 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 01:36:53,316 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 01:36:53,316 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 01:36:53,316 - INFO - Generated 50 groups efficiently
2025-10-20 01:36:55,321 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:36:57,189 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:37:04,315 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:37:07,441 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-20 01:37:07,458 - DEBUG - Creating converter from 5 to 3
2025-10-20 01:37:08,596 - INFO - Outputs saved to /tmp/tmps1auwtg6/training/training_nphotons_1000000.0_single
2025-10-20 01:37:44,596 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-20 01:37:44,765 - DEBUG - Creating converter from 7 to 5
2025-10-20 01:37:44,765 - DEBUG - Creating converter from 5 to 7
2025-10-20 01:37:44,765 - DEBUG - Creating converter from 7 to 5
2025-10-20 01:37:44,765 - DEBUG - Creating converter from 5 to 7
2025-10-20 01:37:45,372 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-20 01:37:45,379 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-20 01:37:45,379 - DEBUG - interactive is False
2025-10-20 01:37:45,379 - DEBUG - platform is linux
2025-10-20 01:37:45,408 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-20 01:37:45,410 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-20 01:37:46,467 - DEBUG - Field: train_data_file
2025-10-20 01:37:46,467 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 01:37:46,467 - DEBUG - Field default: None
2025-10-20 01:37:46,467 - DEBUG - Field: test_data_file
2025-10-20 01:37:46,467 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 01:37:46,467 - DEBUG - Field default: None
2025-10-20 01:37:46,467 - DEBUG - Field: output_dir
2025-10-20 01:37:46,467 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-20 01:37:46,467 - DEBUG - Field default: training_outputs
2025-10-20 01:37:46,467 - DEBUG - Converting path value: /tmp/tmpmqsx4t7x/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-20 01:37:46,467 - DEBUG - Converting path value: /tmp/tmpmqsx4t7x/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-20 01:37:46,467 - DEBUG - Converting path value: /tmp/tmpmqsx4t7x/training/training_mismatch_test
2025-10-20 01:37:46,468 - DEBUG - YAML config: {}
2025-10-20 01:37:46,468 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpmqsx4t7x/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpmqsx4t7x/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpmqsx4t7x/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 01:37:46,468 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpmqsx4t7x/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpmqsx4t7x/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpmqsx4t7x/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 01:37:46,468 - INFO - Configuration setup complete
2025-10-20 01:37:46,468 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpmqsx4t7x/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmpmqsx4t7x/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpmqsx4t7x/training/training_mismatch_test'), sequential_sampling=False, backend='tensorflow')
2025-10-20 01:37:46,468 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-20 01:37:46,468 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-20 01:37:46,468 - INFO - Loading data from /tmp/tmpmqsx4t7x/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-20 01:37:46,473 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-20 01:37:46,473 - INFO - Randomly subsampled 50 images
2025-10-20 01:37:46,483 - DEBUG - Loaded metadata from /tmp/tmpmqsx4t7x/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-20 01:37:46,484 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-20 01:37:46,484 - INFO - Loading data from /tmp/tmpmqsx4t7x/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-20 01:37:46,488 - INFO - Using full dataset of 100 images
2025-10-20 01:37:46,489 - INFO - Loaded test data from /tmp/tmpmqsx4t7x/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-20 01:37:46,489 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-20 01:37:46,489 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 01:37:46,489 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-20 01:37:46,489 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 01:37:46,489 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 01:37:46,489 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 01:37:46,489 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 01:37:46,489 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 01:37:46,489 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-20 01:37:46,489 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-20 01:37:46,489 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-20 01:37:46,489 - INFO - Using all 50 points as seeds
2025-10-20 01:37:46,489 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 01:37:46,489 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 01:37:46,489 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 01:37:46,489 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 01:37:46,489 - INFO - Generated 50 groups efficiently
2025-10-20 01:37:48,070 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-20 01:37:48,070 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 01:37:48,070 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-20 01:37:48,070 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 01:37:48,070 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 01:37:48,070 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 01:37:48,070 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 01:37:48,070 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 01:37:48,070 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-20 01:37:48,070 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-20 01:37:48,071 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-20 01:37:48,071 - INFO - Sampled 50 seed points from 100 total points
2025-10-20 01:37:48,071 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 01:37:48,071 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 01:37:48,071 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 01:37:48,071 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 01:37:48,071 - INFO - Generated 50 groups efficiently
2025-10-20 01:37:50,088 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:37:51,970 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:37:59,305 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:38:02,429 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-20 01:38:02,447 - DEBUG - Creating converter from 5 to 3
2025-10-20 01:38:03,579 - INFO - Outputs saved to /tmp/tmpmqsx4t7x/training/training_mismatch_test
2025-10-20 01:59:41,675 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-20 01:59:41,851 - DEBUG - Creating converter from 7 to 5
2025-10-20 01:59:41,851 - DEBUG - Creating converter from 5 to 7
2025-10-20 01:59:41,851 - DEBUG - Creating converter from 7 to 5
2025-10-20 01:59:41,851 - DEBUG - Creating converter from 5 to 7
2025-10-20 01:59:42,462 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-20 01:59:42,470 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-20 01:59:42,470 - DEBUG - interactive is False
2025-10-20 01:59:42,470 - DEBUG - platform is linux
2025-10-20 01:59:42,499 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-20 01:59:42,501 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-20 01:59:43,534 - DEBUG - Field: train_data_file
2025-10-20 01:59:43,534 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 01:59:43,534 - DEBUG - Field default: None
2025-10-20 01:59:43,534 - DEBUG - Field: test_data_file
2025-10-20 01:59:43,534 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 01:59:43,534 - DEBUG - Field default: None
2025-10-20 01:59:43,534 - DEBUG - Field: output_dir
2025-10-20 01:59:43,534 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-20 01:59:43,534 - DEBUG - Field default: training_outputs
2025-10-20 01:59:43,535 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-20 01:59:43,535 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-20 01:59:43,535 - DEBUG - Converting path value: /tmp/tmp_jvgf0ml/training_outputs
2025-10-20 01:59:43,535 - DEBUG - YAML config: {}
2025-10-20 01:59:43,535 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp_jvgf0ml/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 01:59:43,535 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp_jvgf0ml/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 01:59:43,535 - INFO - Configuration setup complete
2025-10-20 01:59:43,535 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp_jvgf0ml/training_outputs'), sequential_sampling=False, backend='tensorflow')
2025-10-20 01:59:43,535 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-20 01:59:43,535 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-20 01:59:43,535 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-20 01:59:43,552 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-20 01:59:43,552 - INFO - Randomly subsampled 64 images
2025-10-20 01:59:43,569 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-20 01:59:43,585 - INFO - Using full dataset of 1087 images
2025-10-20 01:59:43,599 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-20 01:59:43,600 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-20 01:59:43,600 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 01:59:43,600 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-20 01:59:43,600 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 01:59:43,600 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 01:59:43,600 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 01:59:43,600 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 01:59:43,600 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-20 01:59:43,600 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-20 01:59:43,600 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-20 01:59:43,600 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-20 01:59:43,600 - INFO - Using all 64 points as seeds
2025-10-20 01:59:43,600 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 01:59:43,600 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-20 01:59:43,600 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-20 01:59:43,600 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-20 01:59:43,600 - INFO - Generated 64 groups efficiently
2025-10-20 01:59:45,162 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-20 01:59:45,163 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 01:59:45,163 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-20 01:59:45,163 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 01:59:45,163 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 01:59:45,163 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 01:59:45,163 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 01:59:45,163 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-20 01:59:45,163 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-20 01:59:45,163 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-20 01:59:45,163 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-20 01:59:45,163 - INFO - Sampled 64 seed points from 1087 total points
2025-10-20 01:59:45,163 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 01:59:45,163 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-20 01:59:45,163 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-20 01:59:45,163 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-20 01:59:45,163 - INFO - Generated 64 groups efficiently
2025-10-20 01:59:47,219 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:59:49,089 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:59:56,405 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 01:59:58,389 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-20 01:59:58,608 - DEBUG - Creating converter from 5 to 3
2025-10-20 01:59:59,733 - INFO - Outputs saved to /tmp/tmp_jvgf0ml/training_outputs
2025-10-20 02:00:24,038 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-20 02:00:24,213 - DEBUG - Creating converter from 7 to 5
2025-10-20 02:00:24,213 - DEBUG - Creating converter from 5 to 7
2025-10-20 02:00:24,213 - DEBUG - Creating converter from 7 to 5
2025-10-20 02:00:24,213 - DEBUG - Creating converter from 5 to 7
2025-10-20 02:00:24,816 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-20 02:00:24,823 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-20 02:00:24,824 - DEBUG - interactive is False
2025-10-20 02:00:24,824 - DEBUG - platform is linux
2025-10-20 02:00:24,853 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-20 02:00:24,854 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-20 02:00:25,898 - DEBUG - Field: train_data_file
2025-10-20 02:00:25,898 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 02:00:25,898 - DEBUG - Field default: None
2025-10-20 02:00:25,898 - DEBUG - Field: test_data_file
2025-10-20 02:00:25,898 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 02:00:25,898 - DEBUG - Field default: None
2025-10-20 02:00:25,898 - DEBUG - Field: output_dir
2025-10-20 02:00:25,898 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-20 02:00:25,898 - DEBUG - Field default: training_outputs
2025-10-20 02:00:25,899 - DEBUG - Converting path value: /tmp/tmp6vrd2ofw/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-20 02:00:25,899 - DEBUG - Converting path value: /tmp/tmp6vrd2ofw/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-20 02:00:25,899 - DEBUG - Converting path value: /tmp/tmp6vrd2ofw/training/training_nphotons_500000.0_e2e
2025-10-20 02:00:25,899 - DEBUG - YAML config: {}
2025-10-20 02:00:25,899 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp6vrd2ofw/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmp6vrd2ofw/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp6vrd2ofw/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 02:00:25,899 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp6vrd2ofw/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmp6vrd2ofw/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp6vrd2ofw/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 02:00:25,899 - INFO - Configuration setup complete
2025-10-20 02:00:25,899 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp6vrd2ofw/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmp6vrd2ofw/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp6vrd2ofw/training/training_nphotons_500000.0_e2e'), sequential_sampling=False, backend='tensorflow')
2025-10-20 02:00:25,899 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-20 02:00:25,899 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-20 02:00:25,899 - INFO - Loading data from /tmp/tmp6vrd2ofw/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-20 02:00:25,906 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-20 02:00:25,906 - INFO - Randomly subsampled 50 images
2025-10-20 02:00:25,917 - DEBUG - Loaded metadata from /tmp/tmp6vrd2ofw/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-20 02:00:25,917 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-20 02:00:25,917 - INFO - Loading data from /tmp/tmp6vrd2ofw/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-20 02:00:25,922 - INFO - Using full dataset of 100 images
2025-10-20 02:00:25,923 - INFO - Loaded test data from /tmp/tmp6vrd2ofw/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-20 02:00:25,923 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-20 02:00:25,923 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 02:00:25,923 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-20 02:00:25,923 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 02:00:25,923 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 02:00:25,923 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 02:00:25,924 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 02:00:25,924 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 02:00:25,924 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-20 02:00:25,924 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-20 02:00:25,924 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-20 02:00:25,924 - INFO - Using all 50 points as seeds
2025-10-20 02:00:25,924 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 02:00:25,924 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 02:00:25,924 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 02:00:25,924 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 02:00:25,924 - INFO - Generated 50 groups efficiently
2025-10-20 02:00:27,472 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-20 02:00:27,472 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 02:00:27,472 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-20 02:00:27,472 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 02:00:27,472 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 02:00:27,472 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 02:00:27,472 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 02:00:27,472 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 02:00:27,472 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-20 02:00:27,472 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-20 02:00:27,472 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-20 02:00:27,472 - INFO - Sampled 50 seed points from 100 total points
2025-10-20 02:00:27,472 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 02:00:27,472 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 02:00:27,472 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 02:00:27,472 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 02:00:27,472 - INFO - Generated 50 groups efficiently
2025-10-20 02:00:29,501 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 02:00:31,392 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 02:00:38,661 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 02:00:41,784 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-20 02:00:41,801 - DEBUG - Creating converter from 5 to 3
2025-10-20 02:00:42,942 - INFO - Outputs saved to /tmp/tmp6vrd2ofw/training/training_nphotons_500000.0_e2e
2025-10-20 02:01:01,396 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-20 02:01:01,568 - DEBUG - Creating converter from 7 to 5
2025-10-20 02:01:01,568 - DEBUG - Creating converter from 5 to 7
2025-10-20 02:01:01,568 - DEBUG - Creating converter from 7 to 5
2025-10-20 02:01:01,568 - DEBUG - Creating converter from 5 to 7
2025-10-20 02:01:02,172 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-20 02:01:02,179 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-20 02:01:02,180 - DEBUG - interactive is False
2025-10-20 02:01:02,180 - DEBUG - platform is linux
2025-10-20 02:01:02,208 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-20 02:01:02,210 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-20 02:01:03,276 - DEBUG - Field: train_data_file
2025-10-20 02:01:03,276 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 02:01:03,276 - DEBUG - Field default: None
2025-10-20 02:01:03,276 - DEBUG - Field: test_data_file
2025-10-20 02:01:03,276 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 02:01:03,276 - DEBUG - Field default: None
2025-10-20 02:01:03,276 - DEBUG - Field: output_dir
2025-10-20 02:01:03,276 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-20 02:01:03,276 - DEBUG - Field default: training_outputs
2025-10-20 02:01:03,277 - DEBUG - Converting path value: /tmp/tmp1di9v5t3/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-20 02:01:03,277 - DEBUG - Converting path value: /tmp/tmp1di9v5t3/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-20 02:01:03,277 - DEBUG - Converting path value: /tmp/tmp1di9v5t3/training/training_nphotons_1000000.0_single
2025-10-20 02:01:03,277 - DEBUG - YAML config: {}
2025-10-20 02:01:03,277 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp1di9v5t3/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmp1di9v5t3/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp1di9v5t3/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 02:01:03,277 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp1di9v5t3/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmp1di9v5t3/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp1di9v5t3/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 02:01:03,277 - INFO - Configuration setup complete
2025-10-20 02:01:03,277 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp1di9v5t3/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmp1di9v5t3/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp1di9v5t3/training/training_nphotons_1000000.0_single'), sequential_sampling=False, backend='tensorflow')
2025-10-20 02:01:03,277 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-20 02:01:03,277 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-20 02:01:03,277 - INFO - Loading data from /tmp/tmp1di9v5t3/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-20 02:01:03,284 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-20 02:01:03,284 - INFO - Randomly subsampled 50 images
2025-10-20 02:01:03,295 - DEBUG - Loaded metadata from /tmp/tmp1di9v5t3/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-20 02:01:03,295 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-20 02:01:03,295 - INFO - Loading data from /tmp/tmp1di9v5t3/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-20 02:01:03,300 - INFO - Using full dataset of 100 images
2025-10-20 02:01:03,301 - INFO - Loaded test data from /tmp/tmp1di9v5t3/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-20 02:01:03,301 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-20 02:01:03,301 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 02:01:03,301 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-20 02:01:03,301 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 02:01:03,301 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 02:01:03,301 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 02:01:03,301 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 02:01:03,301 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 02:01:03,301 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-20 02:01:03,301 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-20 02:01:03,301 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-20 02:01:03,301 - INFO - Using all 50 points as seeds
2025-10-20 02:01:03,301 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 02:01:03,301 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 02:01:03,301 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 02:01:03,301 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 02:01:03,301 - INFO - Generated 50 groups efficiently
2025-10-20 02:01:04,862 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-20 02:01:04,862 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 02:01:04,862 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-20 02:01:04,862 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 02:01:04,862 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 02:01:04,862 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 02:01:04,862 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 02:01:04,862 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 02:01:04,862 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-20 02:01:04,862 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-20 02:01:04,862 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-20 02:01:04,862 - INFO - Sampled 50 seed points from 100 total points
2025-10-20 02:01:04,862 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 02:01:04,862 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 02:01:04,862 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 02:01:04,862 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 02:01:04,862 - INFO - Generated 50 groups efficiently
2025-10-20 02:01:06,875 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 02:01:08,739 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 02:01:15,951 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 02:01:19,132 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-20 02:01:19,150 - DEBUG - Creating converter from 5 to 3
2025-10-20 02:01:20,296 - INFO - Outputs saved to /tmp/tmp1di9v5t3/training/training_nphotons_1000000.0_single
2025-10-20 02:01:56,379 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-20 02:01:56,556 - DEBUG - Creating converter from 7 to 5
2025-10-20 02:01:56,556 - DEBUG - Creating converter from 5 to 7
2025-10-20 02:01:56,556 - DEBUG - Creating converter from 7 to 5
2025-10-20 02:01:56,556 - DEBUG - Creating converter from 5 to 7
2025-10-20 02:01:57,173 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-20 02:01:57,180 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-20 02:01:57,181 - DEBUG - interactive is False
2025-10-20 02:01:57,181 - DEBUG - platform is linux
2025-10-20 02:01:57,210 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-20 02:01:57,211 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-20 02:01:58,268 - DEBUG - Field: train_data_file
2025-10-20 02:01:58,268 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 02:01:58,268 - DEBUG - Field default: None
2025-10-20 02:01:58,268 - DEBUG - Field: test_data_file
2025-10-20 02:01:58,268 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 02:01:58,268 - DEBUG - Field default: None
2025-10-20 02:01:58,268 - DEBUG - Field: output_dir
2025-10-20 02:01:58,268 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-20 02:01:58,268 - DEBUG - Field default: training_outputs
2025-10-20 02:01:58,268 - DEBUG - Converting path value: /tmp/tmpdnictnv6/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-20 02:01:58,268 - DEBUG - Converting path value: /tmp/tmpdnictnv6/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-20 02:01:58,268 - DEBUG - Converting path value: /tmp/tmpdnictnv6/training/training_mismatch_test
2025-10-20 02:01:58,268 - DEBUG - YAML config: {}
2025-10-20 02:01:58,268 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpdnictnv6/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpdnictnv6/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpdnictnv6/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 02:01:58,268 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpdnictnv6/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpdnictnv6/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpdnictnv6/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 02:01:58,268 - INFO - Configuration setup complete
2025-10-20 02:01:58,268 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpdnictnv6/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmpdnictnv6/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpdnictnv6/training/training_mismatch_test'), sequential_sampling=False, backend='tensorflow')
2025-10-20 02:01:58,268 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-20 02:01:58,269 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-20 02:01:58,269 - INFO - Loading data from /tmp/tmpdnictnv6/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-20 02:01:58,274 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-20 02:01:58,274 - INFO - Randomly subsampled 50 images
2025-10-20 02:01:58,284 - DEBUG - Loaded metadata from /tmp/tmpdnictnv6/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-20 02:01:58,284 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-20 02:01:58,284 - INFO - Loading data from /tmp/tmpdnictnv6/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-20 02:01:58,289 - INFO - Using full dataset of 100 images
2025-10-20 02:01:58,289 - INFO - Loaded test data from /tmp/tmpdnictnv6/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-20 02:01:58,290 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-20 02:01:58,290 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 02:01:58,290 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-20 02:01:58,290 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 02:01:58,290 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 02:01:58,290 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 02:01:58,290 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 02:01:58,290 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 02:01:58,290 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-20 02:01:58,290 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-20 02:01:58,290 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-20 02:01:58,290 - INFO - Using all 50 points as seeds
2025-10-20 02:01:58,290 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 02:01:58,290 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 02:01:58,290 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 02:01:58,290 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 02:01:58,290 - INFO - Generated 50 groups efficiently
2025-10-20 02:01:59,871 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-20 02:01:59,871 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 02:01:59,871 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-20 02:01:59,871 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 02:01:59,871 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 02:01:59,871 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 02:01:59,871 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 02:01:59,871 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 02:01:59,871 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-20 02:01:59,871 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-20 02:01:59,871 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-20 02:01:59,871 - INFO - Sampled 50 seed points from 100 total points
2025-10-20 02:01:59,871 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 02:01:59,871 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 02:01:59,871 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 02:01:59,871 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 02:01:59,871 - INFO - Generated 50 groups efficiently
2025-10-20 02:02:01,871 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 02:02:03,734 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 02:02:10,918 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 02:02:14,094 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-20 02:02:14,111 - DEBUG - Creating converter from 5 to 3
2025-10-20 02:02:15,241 - INFO - Outputs saved to /tmp/tmpdnictnv6/training/training_mismatch_test
2025-10-20 02:44:23,690 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-20 02:44:23,866 - DEBUG - Creating converter from 7 to 5
2025-10-20 02:44:23,866 - DEBUG - Creating converter from 5 to 7
2025-10-20 02:44:23,867 - DEBUG - Creating converter from 7 to 5
2025-10-20 02:44:23,867 - DEBUG - Creating converter from 5 to 7
2025-10-20 02:44:24,474 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-20 02:44:24,481 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-20 02:44:24,482 - DEBUG - interactive is False
2025-10-20 02:44:24,482 - DEBUG - platform is linux
2025-10-20 02:44:24,511 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-20 02:44:24,512 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-20 02:44:25,515 - DEBUG - Field: train_data_file
2025-10-20 02:44:25,516 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 02:44:25,516 - DEBUG - Field default: None
2025-10-20 02:44:25,516 - DEBUG - Field: test_data_file
2025-10-20 02:44:25,516 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 02:44:25,516 - DEBUG - Field default: None
2025-10-20 02:44:25,516 - DEBUG - Field: output_dir
2025-10-20 02:44:25,516 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-20 02:44:25,516 - DEBUG - Field default: training_outputs
2025-10-20 02:44:25,516 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-20 02:44:25,516 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-20 02:44:25,516 - DEBUG - Converting path value: /tmp/tmpb0stuqjw/training_outputs
2025-10-20 02:44:25,516 - DEBUG - YAML config: {}
2025-10-20 02:44:25,516 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpb0stuqjw/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 02:44:25,516 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpb0stuqjw/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 02:44:25,516 - INFO - Configuration setup complete
2025-10-20 02:44:25,516 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpb0stuqjw/training_outputs'), sequential_sampling=False, backend='tensorflow')
2025-10-20 02:44:25,516 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-20 02:44:25,516 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-20 02:44:25,516 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-20 02:44:25,532 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-20 02:44:25,532 - INFO - Randomly subsampled 64 images
2025-10-20 02:44:25,549 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-20 02:44:25,565 - INFO - Using full dataset of 1087 images
2025-10-20 02:44:25,580 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-20 02:44:25,581 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-20 02:44:25,581 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 02:44:25,581 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-20 02:44:25,581 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 02:44:25,581 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 02:44:25,581 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 02:44:25,581 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 02:44:25,581 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-20 02:44:25,581 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-20 02:44:25,581 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-20 02:44:25,581 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-20 02:44:25,581 - INFO - Using all 64 points as seeds
2025-10-20 02:44:25,581 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 02:44:25,581 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-20 02:44:25,581 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-20 02:44:25,581 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-20 02:44:25,581 - INFO - Generated 64 groups efficiently
2025-10-20 02:44:26,545 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-20 02:44:26,545 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 02:44:26,545 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-20 02:44:26,545 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 02:44:26,545 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 02:44:26,545 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 02:44:26,545 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 02:44:26,545 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-20 02:44:26,545 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-20 02:44:26,545 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-20 02:44:26,545 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-20 02:44:26,545 - INFO - Sampled 64 seed points from 1087 total points
2025-10-20 02:44:26,545 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 02:44:26,545 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-20 02:44:26,545 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-20 02:44:26,545 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-20 02:44:26,545 - INFO - Generated 64 groups efficiently
2025-10-20 02:44:27,781 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 02:44:29,632 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 02:44:33,462 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 02:44:36,261 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-20 02:44:36,481 - DEBUG - Creating converter from 5 to 3
2025-10-20 02:44:37,596 - INFO - Outputs saved to /tmp/tmpb0stuqjw/training_outputs
2025-10-20 02:44:57,136 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-20 02:44:57,315 - DEBUG - Creating converter from 7 to 5
2025-10-20 02:44:57,315 - DEBUG - Creating converter from 5 to 7
2025-10-20 02:44:57,315 - DEBUG - Creating converter from 7 to 5
2025-10-20 02:44:57,316 - DEBUG - Creating converter from 5 to 7
2025-10-20 02:44:57,938 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-20 02:44:57,945 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-20 02:44:57,946 - DEBUG - interactive is False
2025-10-20 02:44:57,946 - DEBUG - platform is linux
2025-10-20 02:44:57,975 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-20 02:44:57,977 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-20 02:44:58,985 - DEBUG - Field: train_data_file
2025-10-20 02:44:58,985 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 02:44:58,985 - DEBUG - Field default: None
2025-10-20 02:44:58,985 - DEBUG - Field: test_data_file
2025-10-20 02:44:58,985 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 02:44:58,985 - DEBUG - Field default: None
2025-10-20 02:44:58,985 - DEBUG - Field: output_dir
2025-10-20 02:44:58,985 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-20 02:44:58,985 - DEBUG - Field default: training_outputs
2025-10-20 02:44:58,985 - DEBUG - Converting path value: /tmp/tmplwlnkvuy/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-20 02:44:58,985 - DEBUG - Converting path value: /tmp/tmplwlnkvuy/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-20 02:44:58,985 - DEBUG - Converting path value: /tmp/tmplwlnkvuy/training/training_nphotons_500000.0_e2e
2025-10-20 02:44:58,985 - DEBUG - YAML config: {}
2025-10-20 02:44:58,985 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmplwlnkvuy/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmplwlnkvuy/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmplwlnkvuy/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 02:44:58,985 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmplwlnkvuy/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmplwlnkvuy/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmplwlnkvuy/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 02:44:58,985 - INFO - Configuration setup complete
2025-10-20 02:44:58,985 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmplwlnkvuy/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmplwlnkvuy/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmplwlnkvuy/training/training_nphotons_500000.0_e2e'), sequential_sampling=False, backend='tensorflow')
2025-10-20 02:44:58,985 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-20 02:44:58,986 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-20 02:44:58,986 - INFO - Loading data from /tmp/tmplwlnkvuy/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-20 02:44:58,992 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-20 02:44:58,992 - INFO - Randomly subsampled 50 images
2025-10-20 02:44:59,003 - DEBUG - Loaded metadata from /tmp/tmplwlnkvuy/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-20 02:44:59,003 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-20 02:44:59,003 - INFO - Loading data from /tmp/tmplwlnkvuy/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-20 02:44:59,009 - INFO - Using full dataset of 100 images
2025-10-20 02:44:59,009 - INFO - Loaded test data from /tmp/tmplwlnkvuy/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-20 02:44:59,010 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-20 02:44:59,010 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 02:44:59,010 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-20 02:44:59,010 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 02:44:59,010 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 02:44:59,010 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 02:44:59,010 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 02:44:59,010 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 02:44:59,010 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-20 02:44:59,010 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-20 02:44:59,010 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-20 02:44:59,010 - INFO - Using all 50 points as seeds
2025-10-20 02:44:59,010 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 02:44:59,010 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 02:44:59,010 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 02:44:59,010 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 02:44:59,010 - INFO - Generated 50 groups efficiently
2025-10-20 02:44:59,922 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-20 02:44:59,922 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 02:44:59,922 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-20 02:44:59,922 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 02:44:59,922 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 02:44:59,923 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 02:44:59,923 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 02:44:59,923 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 02:44:59,923 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-20 02:44:59,923 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-20 02:44:59,923 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-20 02:44:59,923 - INFO - Sampled 50 seed points from 100 total points
2025-10-20 02:44:59,923 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 02:44:59,923 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 02:44:59,923 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 02:44:59,923 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 02:44:59,923 - INFO - Generated 50 groups efficiently
2025-10-20 02:45:01,100 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 02:45:02,945 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 02:45:06,464 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 02:45:09,608 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-20 02:45:09,626 - DEBUG - Creating converter from 5 to 3
2025-10-20 02:45:10,735 - INFO - Outputs saved to /tmp/tmplwlnkvuy/training/training_nphotons_500000.0_e2e
2025-10-20 02:45:25,192 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-20 02:45:25,364 - DEBUG - Creating converter from 7 to 5
2025-10-20 02:45:25,364 - DEBUG - Creating converter from 5 to 7
2025-10-20 02:45:25,364 - DEBUG - Creating converter from 7 to 5
2025-10-20 02:45:25,364 - DEBUG - Creating converter from 5 to 7
2025-10-20 02:45:25,983 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-20 02:45:25,991 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-20 02:45:25,991 - DEBUG - interactive is False
2025-10-20 02:45:25,991 - DEBUG - platform is linux
2025-10-20 02:45:26,020 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-20 02:45:26,022 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-20 02:45:27,020 - DEBUG - Field: train_data_file
2025-10-20 02:45:27,020 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 02:45:27,020 - DEBUG - Field default: None
2025-10-20 02:45:27,020 - DEBUG - Field: test_data_file
2025-10-20 02:45:27,020 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 02:45:27,020 - DEBUG - Field default: None
2025-10-20 02:45:27,020 - DEBUG - Field: output_dir
2025-10-20 02:45:27,020 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-20 02:45:27,020 - DEBUG - Field default: training_outputs
2025-10-20 02:45:27,020 - DEBUG - Converting path value: /tmp/tmpy3ml10wi/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-20 02:45:27,020 - DEBUG - Converting path value: /tmp/tmpy3ml10wi/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-20 02:45:27,020 - DEBUG - Converting path value: /tmp/tmpy3ml10wi/training/training_nphotons_1000000.0_single
2025-10-20 02:45:27,020 - DEBUG - YAML config: {}
2025-10-20 02:45:27,020 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpy3ml10wi/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpy3ml10wi/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpy3ml10wi/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 02:45:27,020 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpy3ml10wi/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpy3ml10wi/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpy3ml10wi/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 02:45:27,020 - INFO - Configuration setup complete
2025-10-20 02:45:27,021 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpy3ml10wi/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmpy3ml10wi/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpy3ml10wi/training/training_nphotons_1000000.0_single'), sequential_sampling=False, backend='tensorflow')
2025-10-20 02:45:27,021 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-20 02:45:27,021 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-20 02:45:27,021 - INFO - Loading data from /tmp/tmpy3ml10wi/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-20 02:45:27,027 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-20 02:45:27,027 - INFO - Randomly subsampled 50 images
2025-10-20 02:45:27,038 - DEBUG - Loaded metadata from /tmp/tmpy3ml10wi/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-20 02:45:27,038 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-20 02:45:27,038 - INFO - Loading data from /tmp/tmpy3ml10wi/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-20 02:45:27,044 - INFO - Using full dataset of 100 images
2025-10-20 02:45:27,044 - INFO - Loaded test data from /tmp/tmpy3ml10wi/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-20 02:45:27,044 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-20 02:45:27,045 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 02:45:27,045 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-20 02:45:27,045 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 02:45:27,045 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 02:45:27,045 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 02:45:27,045 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 02:45:27,045 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 02:45:27,045 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-20 02:45:27,045 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-20 02:45:27,045 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-20 02:45:27,045 - INFO - Using all 50 points as seeds
2025-10-20 02:45:27,045 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 02:45:27,045 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 02:45:27,045 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 02:45:27,045 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 02:45:27,045 - INFO - Generated 50 groups efficiently
2025-10-20 02:45:27,947 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-20 02:45:27,947 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 02:45:27,947 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-20 02:45:27,947 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 02:45:27,947 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 02:45:27,947 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 02:45:27,948 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 02:45:27,948 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 02:45:27,948 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-20 02:45:27,948 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-20 02:45:27,948 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-20 02:45:27,948 - INFO - Sampled 50 seed points from 100 total points
2025-10-20 02:45:27,948 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 02:45:27,948 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 02:45:27,948 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 02:45:27,948 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 02:45:27,948 - INFO - Generated 50 groups efficiently
2025-10-20 02:45:29,122 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 02:45:30,980 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 02:45:34,518 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 02:45:37,718 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-20 02:45:37,734 - DEBUG - Creating converter from 5 to 3
2025-10-20 02:45:38,856 - INFO - Outputs saved to /tmp/tmpy3ml10wi/training/training_nphotons_1000000.0_single
2025-10-20 02:46:08,561 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-20 02:46:08,740 - DEBUG - Creating converter from 7 to 5
2025-10-20 02:46:08,740 - DEBUG - Creating converter from 5 to 7
2025-10-20 02:46:08,740 - DEBUG - Creating converter from 7 to 5
2025-10-20 02:46:08,740 - DEBUG - Creating converter from 5 to 7
2025-10-20 02:46:09,370 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-20 02:46:09,378 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-20 02:46:09,379 - DEBUG - interactive is False
2025-10-20 02:46:09,379 - DEBUG - platform is linux
2025-10-20 02:46:09,408 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-20 02:46:09,410 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-20 02:46:10,424 - DEBUG - Field: train_data_file
2025-10-20 02:46:10,424 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 02:46:10,424 - DEBUG - Field default: None
2025-10-20 02:46:10,424 - DEBUG - Field: test_data_file
2025-10-20 02:46:10,424 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 02:46:10,424 - DEBUG - Field default: None
2025-10-20 02:46:10,425 - DEBUG - Field: output_dir
2025-10-20 02:46:10,425 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-20 02:46:10,425 - DEBUG - Field default: training_outputs
2025-10-20 02:46:10,425 - DEBUG - Converting path value: /tmp/tmp0afr01hg/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-20 02:46:10,425 - DEBUG - Converting path value: /tmp/tmp0afr01hg/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-20 02:46:10,425 - DEBUG - Converting path value: /tmp/tmp0afr01hg/training/training_mismatch_test
2025-10-20 02:46:10,425 - DEBUG - YAML config: {}
2025-10-20 02:46:10,425 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp0afr01hg/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmp0afr01hg/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp0afr01hg/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 02:46:10,425 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp0afr01hg/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmp0afr01hg/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp0afr01hg/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 02:46:10,425 - INFO - Configuration setup complete
2025-10-20 02:46:10,425 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp0afr01hg/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmp0afr01hg/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp0afr01hg/training/training_mismatch_test'), sequential_sampling=False, backend='tensorflow')
2025-10-20 02:46:10,425 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-20 02:46:10,425 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-20 02:46:10,425 - INFO - Loading data from /tmp/tmp0afr01hg/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-20 02:46:10,431 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-20 02:46:10,431 - INFO - Randomly subsampled 50 images
2025-10-20 02:46:10,441 - DEBUG - Loaded metadata from /tmp/tmp0afr01hg/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-20 02:46:10,441 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-20 02:46:10,441 - INFO - Loading data from /tmp/tmp0afr01hg/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-20 02:46:10,445 - INFO - Using full dataset of 100 images
2025-10-20 02:46:10,446 - INFO - Loaded test data from /tmp/tmp0afr01hg/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-20 02:46:10,446 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-20 02:46:10,446 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 02:46:10,446 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-20 02:46:10,446 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 02:46:10,446 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 02:46:10,446 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 02:46:10,446 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 02:46:10,446 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 02:46:10,447 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-20 02:46:10,447 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-20 02:46:10,447 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-20 02:46:10,447 - INFO - Using all 50 points as seeds
2025-10-20 02:46:10,447 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 02:46:10,447 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 02:46:10,447 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 02:46:10,447 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 02:46:10,447 - INFO - Generated 50 groups efficiently
2025-10-20 02:46:11,354 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-20 02:46:11,355 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 02:46:11,355 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-20 02:46:11,355 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 02:46:11,355 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 02:46:11,355 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 02:46:11,355 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 02:46:11,355 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 02:46:11,355 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-20 02:46:11,355 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-20 02:46:11,355 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-20 02:46:11,355 - INFO - Sampled 50 seed points from 100 total points
2025-10-20 02:46:11,355 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 02:46:11,355 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 02:46:11,355 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 02:46:11,355 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 02:46:11,355 - INFO - Generated 50 groups efficiently
2025-10-20 02:46:12,540 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 02:46:14,405 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 02:46:17,923 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 02:46:21,121 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-20 02:46:21,138 - DEBUG - Creating converter from 5 to 3
2025-10-20 02:46:22,243 - INFO - Outputs saved to /tmp/tmp0afr01hg/training/training_mismatch_test
2025-10-20 04:16:16,662 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-20 04:16:16,836 - DEBUG - Creating converter from 7 to 5
2025-10-20 04:16:16,836 - DEBUG - Creating converter from 5 to 7
2025-10-20 04:16:16,836 - DEBUG - Creating converter from 7 to 5
2025-10-20 04:16:16,836 - DEBUG - Creating converter from 5 to 7
2025-10-20 04:16:17,442 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-20 04:16:17,449 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-20 04:16:17,450 - DEBUG - interactive is False
2025-10-20 04:16:17,450 - DEBUG - platform is linux
2025-10-20 04:16:17,479 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-20 04:16:17,480 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-20 04:16:18,517 - DEBUG - Field: train_data_file
2025-10-20 04:16:18,517 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 04:16:18,517 - DEBUG - Field default: None
2025-10-20 04:16:18,517 - DEBUG - Field: test_data_file
2025-10-20 04:16:18,517 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 04:16:18,517 - DEBUG - Field default: None
2025-10-20 04:16:18,517 - DEBUG - Field: output_dir
2025-10-20 04:16:18,517 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-20 04:16:18,517 - DEBUG - Field default: training_outputs
2025-10-20 04:16:18,517 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-20 04:16:18,517 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-20 04:16:18,517 - DEBUG - Converting path value: /tmp/tmpn5lb_sp9/training_outputs
2025-10-20 04:16:18,517 - DEBUG - YAML config: {}
2025-10-20 04:16:18,517 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpn5lb_sp9/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 04:16:18,518 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpn5lb_sp9/training_outputs'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 04:16:18,518 - INFO - Configuration setup complete
2025-10-20 04:16:18,518 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpn5lb_sp9/training_outputs'), sequential_sampling=False, backend='tensorflow')
2025-10-20 04:16:18,518 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-20 04:16:18,518 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-20 04:16:18,518 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-20 04:16:18,537 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-20 04:16:18,537 - INFO - Randomly subsampled 64 images
2025-10-20 04:16:18,554 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-20 04:16:18,569 - INFO - Using full dataset of 1087 images
2025-10-20 04:16:18,585 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-20 04:16:18,585 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-20 04:16:18,585 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 04:16:18,585 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-20 04:16:18,585 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 04:16:18,585 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 04:16:18,585 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 04:16:18,585 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 04:16:18,585 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-20 04:16:18,585 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-20 04:16:18,585 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-20 04:16:18,586 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-20 04:16:18,586 - INFO - Using all 64 points as seeds
2025-10-20 04:16:18,586 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 04:16:18,586 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-20 04:16:18,586 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-20 04:16:18,586 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-20 04:16:18,586 - INFO - Generated 64 groups efficiently
2025-10-20 04:16:20,190 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-20 04:16:20,190 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 04:16:20,190 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-20 04:16:20,190 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 04:16:20,190 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 04:16:20,190 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 04:16:20,190 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 04:16:20,190 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-20 04:16:20,190 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-20 04:16:20,190 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-20 04:16:20,190 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-20 04:16:20,190 - INFO - Sampled 64 seed points from 1087 total points
2025-10-20 04:16:20,190 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 04:16:20,190 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-20 04:16:20,190 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-20 04:16:20,190 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-20 04:16:20,190 - INFO - Generated 64 groups efficiently
2025-10-20 04:16:22,239 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 04:16:24,075 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 04:16:31,227 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 04:16:33,158 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-20 04:16:33,384 - DEBUG - Creating converter from 5 to 3
2025-10-20 04:16:34,505 - INFO - Outputs saved to /tmp/tmpn5lb_sp9/training_outputs
2025-10-20 04:16:58,764 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-20 04:16:58,938 - DEBUG - Creating converter from 7 to 5
2025-10-20 04:16:58,939 - DEBUG - Creating converter from 5 to 7
2025-10-20 04:16:58,939 - DEBUG - Creating converter from 7 to 5
2025-10-20 04:16:58,939 - DEBUG - Creating converter from 5 to 7
2025-10-20 04:16:59,554 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-20 04:16:59,561 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-20 04:16:59,562 - DEBUG - interactive is False
2025-10-20 04:16:59,562 - DEBUG - platform is linux
2025-10-20 04:16:59,591 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-20 04:16:59,592 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-20 04:17:00,669 - DEBUG - Field: train_data_file
2025-10-20 04:17:00,669 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 04:17:00,669 - DEBUG - Field default: None
2025-10-20 04:17:00,669 - DEBUG - Field: test_data_file
2025-10-20 04:17:00,669 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 04:17:00,669 - DEBUG - Field default: None
2025-10-20 04:17:00,669 - DEBUG - Field: output_dir
2025-10-20 04:17:00,669 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-20 04:17:00,669 - DEBUG - Field default: training_outputs
2025-10-20 04:17:00,669 - DEBUG - Converting path value: /tmp/tmpzlwv4bow/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-20 04:17:00,669 - DEBUG - Converting path value: /tmp/tmpzlwv4bow/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-20 04:17:00,669 - DEBUG - Converting path value: /tmp/tmpzlwv4bow/training/training_nphotons_500000.0_e2e
2025-10-20 04:17:00,669 - DEBUG - YAML config: {}
2025-10-20 04:17:00,669 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpzlwv4bow/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpzlwv4bow/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpzlwv4bow/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 04:17:00,669 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpzlwv4bow/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpzlwv4bow/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpzlwv4bow/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 04:17:00,669 - INFO - Configuration setup complete
2025-10-20 04:17:00,669 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpzlwv4bow/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmpzlwv4bow/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpzlwv4bow/training/training_nphotons_500000.0_e2e'), sequential_sampling=False, backend='tensorflow')
2025-10-20 04:17:00,669 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-20 04:17:00,670 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-20 04:17:00,670 - INFO - Loading data from /tmp/tmpzlwv4bow/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-20 04:17:00,676 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-20 04:17:00,676 - INFO - Randomly subsampled 50 images
2025-10-20 04:17:00,687 - DEBUG - Loaded metadata from /tmp/tmpzlwv4bow/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-20 04:17:00,687 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-20 04:17:00,687 - INFO - Loading data from /tmp/tmpzlwv4bow/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-20 04:17:00,693 - INFO - Using full dataset of 100 images
2025-10-20 04:17:00,693 - INFO - Loaded test data from /tmp/tmpzlwv4bow/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-20 04:17:00,693 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-20 04:17:00,694 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 04:17:00,694 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-20 04:17:00,694 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 04:17:00,694 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 04:17:00,694 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 04:17:00,694 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 04:17:00,694 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 04:17:00,694 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-20 04:17:00,694 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-20 04:17:00,694 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-20 04:17:00,694 - INFO - Using all 50 points as seeds
2025-10-20 04:17:00,694 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 04:17:00,694 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 04:17:00,694 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 04:17:00,694 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 04:17:00,694 - INFO - Generated 50 groups efficiently
2025-10-20 04:17:02,260 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-20 04:17:02,260 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 04:17:02,260 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-20 04:17:02,260 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 04:17:02,260 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 04:17:02,260 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 04:17:02,260 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 04:17:02,260 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 04:17:02,260 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-20 04:17:02,260 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-20 04:17:02,260 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-20 04:17:02,260 - INFO - Sampled 50 seed points from 100 total points
2025-10-20 04:17:02,260 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 04:17:02,260 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 04:17:02,260 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 04:17:02,260 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 04:17:02,260 - INFO - Generated 50 groups efficiently
2025-10-20 04:17:04,255 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 04:17:06,122 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 04:17:13,403 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 04:17:16,538 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-20 04:17:16,554 - DEBUG - Creating converter from 5 to 3
2025-10-20 04:17:17,686 - INFO - Outputs saved to /tmp/tmpzlwv4bow/training/training_nphotons_500000.0_e2e
2025-10-20 04:17:36,002 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-20 04:17:36,176 - DEBUG - Creating converter from 7 to 5
2025-10-20 04:17:36,176 - DEBUG - Creating converter from 5 to 7
2025-10-20 04:17:36,176 - DEBUG - Creating converter from 7 to 5
2025-10-20 04:17:36,176 - DEBUG - Creating converter from 5 to 7
2025-10-20 04:17:36,785 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-20 04:17:36,793 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-20 04:17:36,793 - DEBUG - interactive is False
2025-10-20 04:17:36,793 - DEBUG - platform is linux
2025-10-20 04:17:36,822 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-20 04:17:36,824 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-20 04:17:37,896 - DEBUG - Field: train_data_file
2025-10-20 04:17:37,896 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 04:17:37,896 - DEBUG - Field default: None
2025-10-20 04:17:37,896 - DEBUG - Field: test_data_file
2025-10-20 04:17:37,896 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 04:17:37,896 - DEBUG - Field default: None
2025-10-20 04:17:37,896 - DEBUG - Field: output_dir
2025-10-20 04:17:37,896 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-20 04:17:37,896 - DEBUG - Field default: training_outputs
2025-10-20 04:17:37,896 - DEBUG - Converting path value: /tmp/tmp0r8xwuz4/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-20 04:17:37,897 - DEBUG - Converting path value: /tmp/tmp0r8xwuz4/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-20 04:17:37,897 - DEBUG - Converting path value: /tmp/tmp0r8xwuz4/training/training_nphotons_1000000.0_single
2025-10-20 04:17:37,897 - DEBUG - YAML config: {}
2025-10-20 04:17:37,897 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp0r8xwuz4/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmp0r8xwuz4/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp0r8xwuz4/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 04:17:37,897 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp0r8xwuz4/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmp0r8xwuz4/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp0r8xwuz4/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 04:17:37,897 - INFO - Configuration setup complete
2025-10-20 04:17:37,897 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp0r8xwuz4/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmp0r8xwuz4/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp0r8xwuz4/training/training_nphotons_1000000.0_single'), sequential_sampling=False, backend='tensorflow')
2025-10-20 04:17:37,897 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-20 04:17:37,897 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-20 04:17:37,897 - INFO - Loading data from /tmp/tmp0r8xwuz4/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-20 04:17:37,904 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-20 04:17:37,904 - INFO - Randomly subsampled 50 images
2025-10-20 04:17:37,917 - DEBUG - Loaded metadata from /tmp/tmp0r8xwuz4/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-20 04:17:37,917 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-20 04:17:37,917 - INFO - Loading data from /tmp/tmp0r8xwuz4/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-20 04:17:37,924 - INFO - Using full dataset of 100 images
2025-10-20 04:17:37,924 - INFO - Loaded test data from /tmp/tmp0r8xwuz4/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-20 04:17:37,925 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-20 04:17:37,925 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 04:17:37,925 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-20 04:17:37,925 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 04:17:37,925 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 04:17:37,925 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 04:17:37,925 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 04:17:37,925 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 04:17:37,925 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-20 04:17:37,925 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-20 04:17:37,925 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-20 04:17:37,925 - INFO - Using all 50 points as seeds
2025-10-20 04:17:37,925 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 04:17:37,925 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 04:17:37,925 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 04:17:37,925 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 04:17:37,925 - INFO - Generated 50 groups efficiently
2025-10-20 04:17:39,488 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-20 04:17:39,489 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 04:17:39,489 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-20 04:17:39,489 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 04:17:39,489 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 04:17:39,489 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 04:17:39,489 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 04:17:39,489 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 04:17:39,489 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-20 04:17:39,489 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-20 04:17:39,489 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-20 04:17:39,489 - INFO - Sampled 50 seed points from 100 total points
2025-10-20 04:17:39,489 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 04:17:39,489 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 04:17:39,489 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 04:17:39,489 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 04:17:39,489 - INFO - Generated 50 groups efficiently
2025-10-20 04:17:41,508 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 04:17:43,370 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 04:17:50,744 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 04:17:53,910 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-20 04:17:53,926 - DEBUG - Creating converter from 5 to 3
2025-10-20 04:17:55,059 - INFO - Outputs saved to /tmp/tmp0r8xwuz4/training/training_nphotons_1000000.0_single
2025-10-20 04:18:30,938 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-20 04:18:31,110 - DEBUG - Creating converter from 7 to 5
2025-10-20 04:18:31,111 - DEBUG - Creating converter from 5 to 7
2025-10-20 04:18:31,111 - DEBUG - Creating converter from 7 to 5
2025-10-20 04:18:31,111 - DEBUG - Creating converter from 5 to 7
2025-10-20 04:18:31,713 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-20 04:18:31,720 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-20 04:18:31,721 - DEBUG - interactive is False
2025-10-20 04:18:31,721 - DEBUG - platform is linux
2025-10-20 04:18:31,749 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-20 04:18:31,751 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-20 04:18:32,813 - DEBUG - Field: train_data_file
2025-10-20 04:18:32,813 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 04:18:32,813 - DEBUG - Field default: None
2025-10-20 04:18:32,813 - DEBUG - Field: test_data_file
2025-10-20 04:18:32,813 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-20 04:18:32,813 - DEBUG - Field default: None
2025-10-20 04:18:32,813 - DEBUG - Field: output_dir
2025-10-20 04:18:32,813 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-20 04:18:32,813 - DEBUG - Field default: training_outputs
2025-10-20 04:18:32,813 - DEBUG - Converting path value: /tmp/tmpwixnvuls/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-20 04:18:32,813 - DEBUG - Converting path value: /tmp/tmpwixnvuls/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-20 04:18:32,813 - DEBUG - Converting path value: /tmp/tmpwixnvuls/training/training_mismatch_test
2025-10-20 04:18:32,813 - DEBUG - YAML config: {}
2025-10-20 04:18:32,814 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpwixnvuls/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpwixnvuls/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpwixnvuls/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 04:18:32,814 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpwixnvuls/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpwixnvuls/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpwixnvuls/training/training_mismatch_test'), 'sequential_sampling': False, 'backend': 'tensorflow'}
2025-10-20 04:18:32,814 - INFO - Configuration setup complete
2025-10-20 04:18:32,814 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpwixnvuls/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmpwixnvuls/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpwixnvuls/training/training_mismatch_test'), sequential_sampling=False, backend='tensorflow')
2025-10-20 04:18:32,814 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-20 04:18:32,814 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-20 04:18:32,814 - INFO - Loading data from /tmp/tmpwixnvuls/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-20 04:18:32,819 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-20 04:18:32,819 - INFO - Randomly subsampled 50 images
2025-10-20 04:18:32,829 - DEBUG - Loaded metadata from /tmp/tmpwixnvuls/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-20 04:18:32,829 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-20 04:18:32,829 - INFO - Loading data from /tmp/tmpwixnvuls/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-20 04:18:32,834 - INFO - Using full dataset of 100 images
2025-10-20 04:18:32,834 - INFO - Loaded test data from /tmp/tmpwixnvuls/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-20 04:18:32,835 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-20 04:18:32,835 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 04:18:32,835 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-20 04:18:32,835 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 04:18:32,835 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 04:18:32,835 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 04:18:32,835 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 04:18:32,835 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 04:18:32,835 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-20 04:18:32,835 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-20 04:18:32,835 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-20 04:18:32,835 - INFO - Using all 50 points as seeds
2025-10-20 04:18:32,835 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 04:18:32,835 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 04:18:32,835 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 04:18:32,835 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 04:18:32,835 - INFO - Generated 50 groups efficiently
2025-10-20 04:18:34,375 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-20 04:18:34,376 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-20 04:18:34,376 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-20 04:18:34,376 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-20 04:18:34,376 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-20 04:18:34,376 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-20 04:18:34,376 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-20 04:18:34,376 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-20 04:18:34,376 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-20 04:18:34,376 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-20 04:18:34,376 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-20 04:18:34,376 - INFO - Sampled 50 seed points from 100 total points
2025-10-20 04:18:34,376 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-20 04:18:34,376 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-20 04:18:34,376 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-20 04:18:34,376 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-20 04:18:34,376 - INFO - Generated 50 groups efficiently
2025-10-20 04:18:36,359 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 04:18:38,220 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 04:18:45,614 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-20 04:18:48,753 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-20 04:18:48,771 - DEBUG - Creating converter from 5 to 3
2025-10-20 04:18:49,908 - INFO - Outputs saved to /tmp/tmpwixnvuls/training/training_mismatch_test
