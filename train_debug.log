2025-10-16 20:52:06,852 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 20:52:07,019 - DEBUG - Creating converter from 7 to 5
2025-10-16 20:52:07,019 - DEBUG - Creating converter from 5 to 7
2025-10-16 20:52:07,020 - DEBUG - Creating converter from 7 to 5
2025-10-16 20:52:07,020 - DEBUG - Creating converter from 5 to 7
2025-10-16 20:52:07,613 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 20:52:07,620 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 20:52:07,621 - DEBUG - interactive is False
2025-10-16 20:52:07,621 - DEBUG - platform is linux
2025-10-16 20:52:07,650 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 20:52:07,651 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 20:52:08,664 - DEBUG - Field: train_data_file
2025-10-16 20:52:08,664 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 20:52:08,664 - DEBUG - Field default: None
2025-10-16 20:52:08,665 - DEBUG - Field: test_data_file
2025-10-16 20:52:08,665 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 20:52:08,665 - DEBUG - Field default: None
2025-10-16 20:52:08,665 - DEBUG - Field: output_dir
2025-10-16 20:52:08,665 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 20:52:08,665 - DEBUG - Field default: training_outputs
2025-10-16 20:52:08,665 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-16 20:52:08,665 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-16 20:52:08,665 - DEBUG - Converting path value: /tmp/tmp2rarg48_/training_outputs
2025-10-16 20:52:08,665 - DEBUG - YAML config: {}
2025-10-16 20:52:08,665 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp2rarg48_/training_outputs'), 'sequential_sampling': False}
2025-10-16 20:52:08,665 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp2rarg48_/training_outputs'), 'sequential_sampling': False}
2025-10-16 20:52:08,665 - INFO - Configuration setup complete
2025-10-16 20:52:08,665 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp2rarg48_/training_outputs'), sequential_sampling=False)
2025-10-16 20:52:08,665 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-16 20:52:08,665 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-16 20:52:08,665 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-16 20:52:08,681 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-16 20:52:08,682 - INFO - Randomly subsampled 64 images
2025-10-16 20:52:08,698 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-16 20:52:08,714 - INFO - Using full dataset of 1087 images
2025-10-16 20:52:08,729 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-16 20:52:08,729 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-16 20:52:08,729 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 20:52:08,729 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-16 20:52:08,729 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 20:52:08,729 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 20:52:08,729 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 20:52:08,729 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 20:52:08,729 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-16 20:52:08,729 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-16 20:52:08,729 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-16 20:52:08,729 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-16 20:52:08,729 - INFO - Using all 64 points as seeds
2025-10-16 20:52:08,729 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 20:52:08,729 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-16 20:52:08,729 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-16 20:52:08,729 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-16 20:52:08,729 - INFO - Generated 64 groups efficiently
2025-10-16 20:52:10,333 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-16 20:52:10,334 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 20:52:10,334 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-16 20:52:10,334 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 20:52:10,334 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 20:52:10,334 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 20:52:10,334 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 20:52:10,334 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-16 20:52:10,334 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-16 20:52:10,334 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-16 20:52:10,334 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-16 20:52:10,334 - INFO - Sampled 64 seed points from 1087 total points
2025-10-16 20:52:10,334 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 20:52:10,334 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-16 20:52:10,334 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-16 20:52:10,334 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-16 20:52:10,334 - INFO - Generated 64 groups efficiently
2025-10-16 20:52:12,385 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 20:52:14,254 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 20:52:21,550 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 20:52:23,582 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 20:52:23,794 - DEBUG - Creating converter from 5 to 3
2025-10-16 20:52:24,916 - INFO - Outputs saved to /tmp/tmp2rarg48_/training_outputs
2025-10-16 20:52:48,934 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 20:52:49,104 - DEBUG - Creating converter from 7 to 5
2025-10-16 20:52:49,104 - DEBUG - Creating converter from 5 to 7
2025-10-16 20:52:49,104 - DEBUG - Creating converter from 7 to 5
2025-10-16 20:52:49,104 - DEBUG - Creating converter from 5 to 7
2025-10-16 20:52:49,715 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 20:52:49,722 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 20:52:49,722 - DEBUG - interactive is False
2025-10-16 20:52:49,722 - DEBUG - platform is linux
2025-10-16 20:52:49,751 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 20:52:49,752 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 20:52:50,775 - DEBUG - Field: train_data_file
2025-10-16 20:52:50,775 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 20:52:50,775 - DEBUG - Field default: None
2025-10-16 20:52:50,775 - DEBUG - Field: test_data_file
2025-10-16 20:52:50,775 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 20:52:50,775 - DEBUG - Field default: None
2025-10-16 20:52:50,776 - DEBUG - Field: output_dir
2025-10-16 20:52:50,776 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 20:52:50,776 - DEBUG - Field default: training_outputs
2025-10-16 20:52:50,776 - DEBUG - Converting path value: /tmp/tmpru9lxjqe/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 20:52:50,776 - DEBUG - Converting path value: /tmp/tmpru9lxjqe/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 20:52:50,776 - DEBUG - Converting path value: /tmp/tmpru9lxjqe/training/training_nphotons_500000.0_e2e
2025-10-16 20:52:50,776 - DEBUG - YAML config: {}
2025-10-16 20:52:50,776 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpru9lxjqe/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpru9lxjqe/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpru9lxjqe/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-16 20:52:50,776 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpru9lxjqe/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpru9lxjqe/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpru9lxjqe/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-16 20:52:50,776 - INFO - Configuration setup complete
2025-10-16 20:52:50,776 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpru9lxjqe/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmpru9lxjqe/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpru9lxjqe/training/training_nphotons_500000.0_e2e'), sequential_sampling=False)
2025-10-16 20:52:50,776 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-16 20:52:50,776 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-16 20:52:50,776 - INFO - Loading data from /tmp/tmpru9lxjqe/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-16 20:52:50,783 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-16 20:52:50,783 - INFO - Randomly subsampled 50 images
2025-10-16 20:52:50,794 - DEBUG - Loaded metadata from /tmp/tmpru9lxjqe/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 20:52:50,794 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-16 20:52:50,794 - INFO - Loading data from /tmp/tmpru9lxjqe/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-16 20:52:50,799 - INFO - Using full dataset of 100 images
2025-10-16 20:52:50,800 - INFO - Loaded test data from /tmp/tmpru9lxjqe/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 20:52:50,800 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-16 20:52:50,800 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 20:52:50,800 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-16 20:52:50,800 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 20:52:50,800 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 20:52:50,800 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 20:52:50,800 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 20:52:50,800 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 20:52:50,800 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-16 20:52:50,800 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-16 20:52:50,800 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-16 20:52:50,800 - INFO - Using all 50 points as seeds
2025-10-16 20:52:50,800 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 20:52:50,801 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 20:52:50,801 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 20:52:50,801 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 20:52:50,801 - INFO - Generated 50 groups efficiently
2025-10-16 20:52:52,342 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-16 20:52:52,342 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 20:52:52,342 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-16 20:52:52,342 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 20:52:52,342 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 20:52:52,342 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 20:52:52,342 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 20:52:52,342 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 20:52:52,342 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-16 20:52:52,342 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-16 20:52:52,342 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-16 20:52:52,342 - INFO - Sampled 50 seed points from 100 total points
2025-10-16 20:52:52,342 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 20:52:52,342 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 20:52:52,342 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 20:52:52,342 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 20:52:52,342 - INFO - Generated 50 groups efficiently
2025-10-16 20:52:54,331 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 20:52:56,183 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 20:53:03,429 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 20:53:06,645 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 20:53:06,662 - DEBUG - Creating converter from 5 to 3
2025-10-16 20:53:07,808 - INFO - Outputs saved to /tmp/tmpru9lxjqe/training/training_nphotons_500000.0_e2e
2025-10-16 20:53:26,034 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 20:53:26,212 - DEBUG - Creating converter from 7 to 5
2025-10-16 20:53:26,212 - DEBUG - Creating converter from 5 to 7
2025-10-16 20:53:26,212 - DEBUG - Creating converter from 7 to 5
2025-10-16 20:53:26,212 - DEBUG - Creating converter from 5 to 7
2025-10-16 20:53:26,831 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 20:53:26,838 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 20:53:26,839 - DEBUG - interactive is False
2025-10-16 20:53:26,839 - DEBUG - platform is linux
2025-10-16 20:53:26,868 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 20:53:26,869 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 20:53:27,901 - DEBUG - Field: train_data_file
2025-10-16 20:53:27,901 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 20:53:27,901 - DEBUG - Field default: None
2025-10-16 20:53:27,901 - DEBUG - Field: test_data_file
2025-10-16 20:53:27,901 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 20:53:27,901 - DEBUG - Field default: None
2025-10-16 20:53:27,901 - DEBUG - Field: output_dir
2025-10-16 20:53:27,901 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 20:53:27,901 - DEBUG - Field default: training_outputs
2025-10-16 20:53:27,901 - DEBUG - Converting path value: /tmp/tmp9d6tpw6_/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 20:53:27,901 - DEBUG - Converting path value: /tmp/tmp9d6tpw6_/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 20:53:27,902 - DEBUG - Converting path value: /tmp/tmp9d6tpw6_/training/training_nphotons_1000000.0_single
2025-10-16 20:53:27,902 - DEBUG - YAML config: {}
2025-10-16 20:53:27,902 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp9d6tpw6_/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmp9d6tpw6_/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp9d6tpw6_/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-16 20:53:27,902 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp9d6tpw6_/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmp9d6tpw6_/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp9d6tpw6_/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-16 20:53:27,902 - INFO - Configuration setup complete
2025-10-16 20:53:27,902 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp9d6tpw6_/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmp9d6tpw6_/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp9d6tpw6_/training/training_nphotons_1000000.0_single'), sequential_sampling=False)
2025-10-16 20:53:27,902 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-16 20:53:27,902 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-16 20:53:27,902 - INFO - Loading data from /tmp/tmp9d6tpw6_/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-16 20:53:27,908 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-16 20:53:27,909 - INFO - Randomly subsampled 50 images
2025-10-16 20:53:27,920 - DEBUG - Loaded metadata from /tmp/tmp9d6tpw6_/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 20:53:27,920 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-16 20:53:27,920 - INFO - Loading data from /tmp/tmp9d6tpw6_/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-16 20:53:27,925 - INFO - Using full dataset of 100 images
2025-10-16 20:53:27,926 - INFO - Loaded test data from /tmp/tmp9d6tpw6_/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 20:53:27,926 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-16 20:53:27,926 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 20:53:27,926 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-16 20:53:27,926 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 20:53:27,926 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 20:53:27,926 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 20:53:27,926 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 20:53:27,926 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 20:53:27,926 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-16 20:53:27,926 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-16 20:53:27,926 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-16 20:53:27,926 - INFO - Using all 50 points as seeds
2025-10-16 20:53:27,926 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 20:53:27,926 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 20:53:27,926 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 20:53:27,926 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 20:53:27,926 - INFO - Generated 50 groups efficiently
2025-10-16 20:53:29,466 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-16 20:53:29,466 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 20:53:29,466 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-16 20:53:29,466 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 20:53:29,466 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 20:53:29,466 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 20:53:29,466 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 20:53:29,466 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 20:53:29,466 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-16 20:53:29,466 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-16 20:53:29,466 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-16 20:53:29,466 - INFO - Sampled 50 seed points from 100 total points
2025-10-16 20:53:29,466 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 20:53:29,466 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 20:53:29,466 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 20:53:29,467 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 20:53:29,467 - INFO - Generated 50 groups efficiently
2025-10-16 20:53:31,455 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 20:53:33,325 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 20:53:40,506 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 20:53:43,670 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 20:53:43,687 - DEBUG - Creating converter from 5 to 3
2025-10-16 20:53:44,813 - INFO - Outputs saved to /tmp/tmp9d6tpw6_/training/training_nphotons_1000000.0_single
2025-10-16 20:54:20,577 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 20:54:20,753 - DEBUG - Creating converter from 7 to 5
2025-10-16 20:54:20,753 - DEBUG - Creating converter from 5 to 7
2025-10-16 20:54:20,753 - DEBUG - Creating converter from 7 to 5
2025-10-16 20:54:20,753 - DEBUG - Creating converter from 5 to 7
2025-10-16 20:54:21,376 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 20:54:21,383 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 20:54:21,384 - DEBUG - interactive is False
2025-10-16 20:54:21,384 - DEBUG - platform is linux
2025-10-16 20:54:21,412 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 20:54:21,414 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 20:54:22,447 - DEBUG - Field: train_data_file
2025-10-16 20:54:22,447 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 20:54:22,447 - DEBUG - Field default: None
2025-10-16 20:54:22,447 - DEBUG - Field: test_data_file
2025-10-16 20:54:22,447 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 20:54:22,447 - DEBUG - Field default: None
2025-10-16 20:54:22,447 - DEBUG - Field: output_dir
2025-10-16 20:54:22,447 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 20:54:22,447 - DEBUG - Field default: training_outputs
2025-10-16 20:54:22,447 - DEBUG - Converting path value: /tmp/tmpdqp3608i/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 20:54:22,447 - DEBUG - Converting path value: /tmp/tmpdqp3608i/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 20:54:22,447 - DEBUG - Converting path value: /tmp/tmpdqp3608i/training/training_mismatch_test
2025-10-16 20:54:22,447 - DEBUG - YAML config: {}
2025-10-16 20:54:22,448 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpdqp3608i/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpdqp3608i/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpdqp3608i/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-16 20:54:22,448 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpdqp3608i/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpdqp3608i/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpdqp3608i/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-16 20:54:22,448 - INFO - Configuration setup complete
2025-10-16 20:54:22,448 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpdqp3608i/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmpdqp3608i/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpdqp3608i/training/training_mismatch_test'), sequential_sampling=False)
2025-10-16 20:54:22,448 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-16 20:54:22,448 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-16 20:54:22,448 - INFO - Loading data from /tmp/tmpdqp3608i/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-16 20:54:22,453 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-16 20:54:22,453 - INFO - Randomly subsampled 50 images
2025-10-16 20:54:22,463 - DEBUG - Loaded metadata from /tmp/tmpdqp3608i/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 20:54:22,463 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-16 20:54:22,463 - INFO - Loading data from /tmp/tmpdqp3608i/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-16 20:54:22,468 - INFO - Using full dataset of 100 images
2025-10-16 20:54:22,468 - INFO - Loaded test data from /tmp/tmpdqp3608i/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 20:54:22,468 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-16 20:54:22,468 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 20:54:22,468 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-16 20:54:22,468 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 20:54:22,468 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 20:54:22,468 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 20:54:22,468 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 20:54:22,468 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 20:54:22,468 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-16 20:54:22,468 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-16 20:54:22,468 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-16 20:54:22,468 - INFO - Using all 50 points as seeds
2025-10-16 20:54:22,468 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 20:54:22,468 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 20:54:22,468 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 20:54:22,468 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 20:54:22,469 - INFO - Generated 50 groups efficiently
2025-10-16 20:54:24,021 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-16 20:54:24,022 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 20:54:24,022 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-16 20:54:24,022 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 20:54:24,022 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 20:54:24,022 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 20:54:24,022 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 20:54:24,022 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 20:54:24,022 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-16 20:54:24,022 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-16 20:54:24,022 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-16 20:54:24,022 - INFO - Sampled 50 seed points from 100 total points
2025-10-16 20:54:24,022 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 20:54:24,022 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 20:54:24,022 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 20:54:24,022 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 20:54:24,022 - INFO - Generated 50 groups efficiently
2025-10-16 20:54:26,014 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 20:54:27,881 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 20:54:35,123 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 20:54:38,354 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 20:54:38,371 - DEBUG - Creating converter from 5 to 3
2025-10-16 20:54:39,501 - INFO - Outputs saved to /tmp/tmpdqp3608i/training/training_mismatch_test
2025-10-16 21:09:59,803 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 21:09:59,977 - DEBUG - Creating converter from 7 to 5
2025-10-16 21:09:59,977 - DEBUG - Creating converter from 5 to 7
2025-10-16 21:09:59,977 - DEBUG - Creating converter from 7 to 5
2025-10-16 21:09:59,977 - DEBUG - Creating converter from 5 to 7
2025-10-16 21:10:00,595 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 21:10:00,602 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 21:10:00,602 - DEBUG - interactive is False
2025-10-16 21:10:00,602 - DEBUG - platform is linux
2025-10-16 21:10:00,631 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 21:10:00,633 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 21:10:01,653 - DEBUG - Field: train_data_file
2025-10-16 21:10:01,653 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 21:10:01,653 - DEBUG - Field default: None
2025-10-16 21:10:01,653 - DEBUG - Field: test_data_file
2025-10-16 21:10:01,654 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 21:10:01,654 - DEBUG - Field default: None
2025-10-16 21:10:01,654 - DEBUG - Field: output_dir
2025-10-16 21:10:01,654 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 21:10:01,654 - DEBUG - Field default: training_outputs
2025-10-16 21:10:01,654 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-16 21:10:01,654 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-16 21:10:01,654 - DEBUG - Converting path value: /tmp/tmpe2sdqzwm/training_outputs
2025-10-16 21:10:01,654 - DEBUG - YAML config: {}
2025-10-16 21:10:01,654 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpe2sdqzwm/training_outputs'), 'sequential_sampling': False}
2025-10-16 21:10:01,654 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpe2sdqzwm/training_outputs'), 'sequential_sampling': False}
2025-10-16 21:10:01,654 - INFO - Configuration setup complete
2025-10-16 21:10:01,654 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpe2sdqzwm/training_outputs'), sequential_sampling=False)
2025-10-16 21:10:01,654 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-16 21:10:01,654 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-16 21:10:01,654 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-16 21:10:01,671 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-16 21:10:01,671 - INFO - Randomly subsampled 64 images
2025-10-16 21:10:01,688 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-16 21:10:01,704 - INFO - Using full dataset of 1087 images
2025-10-16 21:10:01,719 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-16 21:10:01,719 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-16 21:10:01,720 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 21:10:01,720 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-16 21:10:01,720 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 21:10:01,720 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 21:10:01,720 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 21:10:01,720 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 21:10:01,720 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-16 21:10:01,720 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-16 21:10:01,720 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-16 21:10:01,720 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-16 21:10:01,720 - INFO - Using all 64 points as seeds
2025-10-16 21:10:01,720 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 21:10:01,720 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-16 21:10:01,720 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-16 21:10:01,720 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-16 21:10:01,720 - INFO - Generated 64 groups efficiently
2025-10-16 21:10:03,283 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-16 21:10:03,283 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 21:10:03,283 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-16 21:10:03,283 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 21:10:03,283 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 21:10:03,283 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 21:10:03,283 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 21:10:03,283 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-16 21:10:03,283 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-16 21:10:03,283 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-16 21:10:03,284 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-16 21:10:03,284 - INFO - Sampled 64 seed points from 1087 total points
2025-10-16 21:10:03,284 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 21:10:03,284 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-16 21:10:03,284 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-16 21:10:03,284 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-16 21:10:03,284 - INFO - Generated 64 groups efficiently
2025-10-16 21:10:05,327 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:10:07,182 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:10:14,346 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:10:16,326 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 21:10:16,550 - DEBUG - Creating converter from 5 to 3
2025-10-16 21:10:17,694 - INFO - Outputs saved to /tmp/tmpe2sdqzwm/training_outputs
2025-10-16 21:10:41,820 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 21:10:41,995 - DEBUG - Creating converter from 7 to 5
2025-10-16 21:10:41,995 - DEBUG - Creating converter from 5 to 7
2025-10-16 21:10:41,995 - DEBUG - Creating converter from 7 to 5
2025-10-16 21:10:41,995 - DEBUG - Creating converter from 5 to 7
2025-10-16 21:10:42,604 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 21:10:42,611 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 21:10:42,612 - DEBUG - interactive is False
2025-10-16 21:10:42,612 - DEBUG - platform is linux
2025-10-16 21:10:42,641 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 21:10:42,642 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 21:10:43,674 - DEBUG - Field: train_data_file
2025-10-16 21:10:43,674 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 21:10:43,674 - DEBUG - Field default: None
2025-10-16 21:10:43,674 - DEBUG - Field: test_data_file
2025-10-16 21:10:43,674 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 21:10:43,674 - DEBUG - Field default: None
2025-10-16 21:10:43,674 - DEBUG - Field: output_dir
2025-10-16 21:10:43,674 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 21:10:43,674 - DEBUG - Field default: training_outputs
2025-10-16 21:10:43,675 - DEBUG - Converting path value: /tmp/tmp68q1si2l/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 21:10:43,675 - DEBUG - Converting path value: /tmp/tmp68q1si2l/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 21:10:43,675 - DEBUG - Converting path value: /tmp/tmp68q1si2l/training/training_nphotons_500000.0_e2e
2025-10-16 21:10:43,675 - DEBUG - YAML config: {}
2025-10-16 21:10:43,675 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp68q1si2l/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmp68q1si2l/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp68q1si2l/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-16 21:10:43,675 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp68q1si2l/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmp68q1si2l/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp68q1si2l/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-16 21:10:43,675 - INFO - Configuration setup complete
2025-10-16 21:10:43,675 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp68q1si2l/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmp68q1si2l/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp68q1si2l/training/training_nphotons_500000.0_e2e'), sequential_sampling=False)
2025-10-16 21:10:43,675 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-16 21:10:43,675 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-16 21:10:43,675 - INFO - Loading data from /tmp/tmp68q1si2l/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-16 21:10:43,682 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-16 21:10:43,682 - INFO - Randomly subsampled 50 images
2025-10-16 21:10:43,693 - DEBUG - Loaded metadata from /tmp/tmp68q1si2l/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 21:10:43,693 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-16 21:10:43,693 - INFO - Loading data from /tmp/tmp68q1si2l/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-16 21:10:43,699 - INFO - Using full dataset of 100 images
2025-10-16 21:10:43,699 - INFO - Loaded test data from /tmp/tmp68q1si2l/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 21:10:43,699 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-16 21:10:43,699 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 21:10:43,699 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-16 21:10:43,699 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 21:10:43,699 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 21:10:43,699 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 21:10:43,699 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 21:10:43,699 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 21:10:43,699 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-16 21:10:43,699 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-16 21:10:43,699 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-16 21:10:43,699 - INFO - Using all 50 points as seeds
2025-10-16 21:10:43,699 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 21:10:43,699 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 21:10:43,700 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 21:10:43,700 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 21:10:43,700 - INFO - Generated 50 groups efficiently
2025-10-16 21:10:45,261 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-16 21:10:45,261 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 21:10:45,261 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-16 21:10:45,261 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 21:10:45,261 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 21:10:45,261 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 21:10:45,261 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 21:10:45,261 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 21:10:45,261 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-16 21:10:45,261 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-16 21:10:45,261 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-16 21:10:45,261 - INFO - Sampled 50 seed points from 100 total points
2025-10-16 21:10:45,261 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 21:10:45,261 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 21:10:45,261 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 21:10:45,261 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 21:10:45,261 - INFO - Generated 50 groups efficiently
2025-10-16 21:10:47,277 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:10:49,151 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:10:56,430 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:10:59,625 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 21:10:59,641 - DEBUG - Creating converter from 5 to 3
2025-10-16 21:11:00,777 - INFO - Outputs saved to /tmp/tmp68q1si2l/training/training_nphotons_500000.0_e2e
2025-10-16 21:11:19,044 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 21:11:19,219 - DEBUG - Creating converter from 7 to 5
2025-10-16 21:11:19,219 - DEBUG - Creating converter from 5 to 7
2025-10-16 21:11:19,219 - DEBUG - Creating converter from 7 to 5
2025-10-16 21:11:19,219 - DEBUG - Creating converter from 5 to 7
2025-10-16 21:11:19,832 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 21:11:19,839 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 21:11:19,840 - DEBUG - interactive is False
2025-10-16 21:11:19,840 - DEBUG - platform is linux
2025-10-16 21:11:19,869 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 21:11:19,870 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 21:11:20,904 - DEBUG - Field: train_data_file
2025-10-16 21:11:20,904 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 21:11:20,904 - DEBUG - Field default: None
2025-10-16 21:11:20,904 - DEBUG - Field: test_data_file
2025-10-16 21:11:20,904 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 21:11:20,904 - DEBUG - Field default: None
2025-10-16 21:11:20,904 - DEBUG - Field: output_dir
2025-10-16 21:11:20,904 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 21:11:20,904 - DEBUG - Field default: training_outputs
2025-10-16 21:11:20,904 - DEBUG - Converting path value: /tmp/tmpsr2pundp/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 21:11:20,904 - DEBUG - Converting path value: /tmp/tmpsr2pundp/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 21:11:20,904 - DEBUG - Converting path value: /tmp/tmpsr2pundp/training/training_nphotons_1000000.0_single
2025-10-16 21:11:20,904 - DEBUG - YAML config: {}
2025-10-16 21:11:20,904 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpsr2pundp/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpsr2pundp/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpsr2pundp/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-16 21:11:20,904 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpsr2pundp/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpsr2pundp/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpsr2pundp/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-16 21:11:20,905 - INFO - Configuration setup complete
2025-10-16 21:11:20,905 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpsr2pundp/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmpsr2pundp/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpsr2pundp/training/training_nphotons_1000000.0_single'), sequential_sampling=False)
2025-10-16 21:11:20,905 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-16 21:11:20,905 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-16 21:11:20,905 - INFO - Loading data from /tmp/tmpsr2pundp/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-16 21:11:20,912 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-16 21:11:20,912 - INFO - Randomly subsampled 50 images
2025-10-16 21:11:20,923 - DEBUG - Loaded metadata from /tmp/tmpsr2pundp/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 21:11:20,923 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-16 21:11:20,923 - INFO - Loading data from /tmp/tmpsr2pundp/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-16 21:11:20,929 - INFO - Using full dataset of 100 images
2025-10-16 21:11:20,929 - INFO - Loaded test data from /tmp/tmpsr2pundp/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 21:11:20,929 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-16 21:11:20,929 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 21:11:20,929 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-16 21:11:20,929 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 21:11:20,929 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 21:11:20,929 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 21:11:20,930 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 21:11:20,930 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 21:11:20,930 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-16 21:11:20,930 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-16 21:11:20,930 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-16 21:11:20,930 - INFO - Using all 50 points as seeds
2025-10-16 21:11:20,930 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 21:11:20,930 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 21:11:20,930 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 21:11:20,930 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 21:11:20,930 - INFO - Generated 50 groups efficiently
2025-10-16 21:11:22,449 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-16 21:11:22,449 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 21:11:22,449 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-16 21:11:22,449 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 21:11:22,449 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 21:11:22,449 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 21:11:22,450 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 21:11:22,450 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 21:11:22,450 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-16 21:11:22,450 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-16 21:11:22,450 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-16 21:11:22,450 - INFO - Sampled 50 seed points from 100 total points
2025-10-16 21:11:22,450 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 21:11:22,450 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 21:11:22,450 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 21:11:22,450 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 21:11:22,450 - INFO - Generated 50 groups efficiently
2025-10-16 21:11:24,441 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:11:26,318 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:11:33,565 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:11:36,764 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 21:11:36,779 - DEBUG - Creating converter from 5 to 3
2025-10-16 21:11:37,905 - INFO - Outputs saved to /tmp/tmpsr2pundp/training/training_nphotons_1000000.0_single
2025-10-16 21:12:13,644 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 21:12:13,822 - DEBUG - Creating converter from 7 to 5
2025-10-16 21:12:13,822 - DEBUG - Creating converter from 5 to 7
2025-10-16 21:12:13,822 - DEBUG - Creating converter from 7 to 5
2025-10-16 21:12:13,822 - DEBUG - Creating converter from 5 to 7
2025-10-16 21:12:14,446 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 21:12:14,454 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 21:12:14,454 - DEBUG - interactive is False
2025-10-16 21:12:14,454 - DEBUG - platform is linux
2025-10-16 21:12:14,485 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 21:12:14,486 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 21:12:15,525 - DEBUG - Field: train_data_file
2025-10-16 21:12:15,525 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 21:12:15,525 - DEBUG - Field default: None
2025-10-16 21:12:15,525 - DEBUG - Field: test_data_file
2025-10-16 21:12:15,525 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 21:12:15,525 - DEBUG - Field default: None
2025-10-16 21:12:15,526 - DEBUG - Field: output_dir
2025-10-16 21:12:15,526 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 21:12:15,526 - DEBUG - Field default: training_outputs
2025-10-16 21:12:15,526 - DEBUG - Converting path value: /tmp/tmpp83ozd2x/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 21:12:15,526 - DEBUG - Converting path value: /tmp/tmpp83ozd2x/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 21:12:15,526 - DEBUG - Converting path value: /tmp/tmpp83ozd2x/training/training_mismatch_test
2025-10-16 21:12:15,526 - DEBUG - YAML config: {}
2025-10-16 21:12:15,526 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpp83ozd2x/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpp83ozd2x/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpp83ozd2x/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-16 21:12:15,526 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpp83ozd2x/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpp83ozd2x/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpp83ozd2x/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-16 21:12:15,526 - INFO - Configuration setup complete
2025-10-16 21:12:15,526 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpp83ozd2x/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmpp83ozd2x/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpp83ozd2x/training/training_mismatch_test'), sequential_sampling=False)
2025-10-16 21:12:15,526 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-16 21:12:15,526 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-16 21:12:15,526 - INFO - Loading data from /tmp/tmpp83ozd2x/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-16 21:12:15,532 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-16 21:12:15,532 - INFO - Randomly subsampled 50 images
2025-10-16 21:12:15,542 - DEBUG - Loaded metadata from /tmp/tmpp83ozd2x/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 21:12:15,542 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-16 21:12:15,542 - INFO - Loading data from /tmp/tmpp83ozd2x/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-16 21:12:15,546 - INFO - Using full dataset of 100 images
2025-10-16 21:12:15,547 - INFO - Loaded test data from /tmp/tmpp83ozd2x/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 21:12:15,547 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-16 21:12:15,547 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 21:12:15,547 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-16 21:12:15,547 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 21:12:15,547 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 21:12:15,547 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 21:12:15,547 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 21:12:15,547 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 21:12:15,547 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-16 21:12:15,547 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-16 21:12:15,547 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-16 21:12:15,547 - INFO - Using all 50 points as seeds
2025-10-16 21:12:15,547 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 21:12:15,547 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 21:12:15,547 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 21:12:15,547 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 21:12:15,547 - INFO - Generated 50 groups efficiently
2025-10-16 21:12:17,075 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-16 21:12:17,075 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 21:12:17,075 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-16 21:12:17,075 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 21:12:17,075 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 21:12:17,075 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 21:12:17,075 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 21:12:17,075 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 21:12:17,075 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-16 21:12:17,075 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-16 21:12:17,075 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-16 21:12:17,075 - INFO - Sampled 50 seed points from 100 total points
2025-10-16 21:12:17,075 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 21:12:17,075 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 21:12:17,075 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 21:12:17,075 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 21:12:17,075 - INFO - Generated 50 groups efficiently
2025-10-16 21:12:19,052 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:12:20,909 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:12:28,152 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:12:31,322 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 21:12:31,338 - DEBUG - Creating converter from 5 to 3
2025-10-16 21:12:32,463 - INFO - Outputs saved to /tmp/tmpp83ozd2x/training/training_mismatch_test
2025-10-16 21:31:28,107 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 21:31:28,278 - DEBUG - Creating converter from 7 to 5
2025-10-16 21:31:28,278 - DEBUG - Creating converter from 5 to 7
2025-10-16 21:31:28,278 - DEBUG - Creating converter from 7 to 5
2025-10-16 21:31:28,278 - DEBUG - Creating converter from 5 to 7
2025-10-16 21:31:28,891 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 21:31:28,898 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 21:31:28,898 - DEBUG - interactive is False
2025-10-16 21:31:28,899 - DEBUG - platform is linux
2025-10-16 21:31:28,927 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 21:31:28,929 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 21:31:29,937 - DEBUG - Field: train_data_file
2025-10-16 21:31:29,938 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 21:31:29,938 - DEBUG - Field default: None
2025-10-16 21:31:29,938 - DEBUG - Field: test_data_file
2025-10-16 21:31:29,938 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 21:31:29,938 - DEBUG - Field default: None
2025-10-16 21:31:29,938 - DEBUG - Field: output_dir
2025-10-16 21:31:29,938 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 21:31:29,938 - DEBUG - Field default: training_outputs
2025-10-16 21:31:29,938 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-16 21:31:29,938 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-16 21:31:29,938 - DEBUG - Converting path value: /tmp/tmp56wq1y9q/training_outputs
2025-10-16 21:31:29,938 - DEBUG - YAML config: {}
2025-10-16 21:31:29,938 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp56wq1y9q/training_outputs'), 'sequential_sampling': False}
2025-10-16 21:31:29,938 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp56wq1y9q/training_outputs'), 'sequential_sampling': False}
2025-10-16 21:31:29,938 - INFO - Configuration setup complete
2025-10-16 21:31:29,938 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp56wq1y9q/training_outputs'), sequential_sampling=False)
2025-10-16 21:31:29,938 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-16 21:31:29,939 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-16 21:31:29,939 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-16 21:31:29,954 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-16 21:31:29,954 - INFO - Randomly subsampled 64 images
2025-10-16 21:31:29,971 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-16 21:31:29,986 - INFO - Using full dataset of 1087 images
2025-10-16 21:31:30,000 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-16 21:31:30,001 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-16 21:31:30,001 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 21:31:30,001 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-16 21:31:30,001 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 21:31:30,001 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 21:31:30,001 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 21:31:30,001 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 21:31:30,001 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-16 21:31:30,001 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-16 21:31:30,001 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-16 21:31:30,001 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-16 21:31:30,001 - INFO - Using all 64 points as seeds
2025-10-16 21:31:30,001 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 21:31:30,001 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-16 21:31:30,001 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-16 21:31:30,001 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-16 21:31:30,001 - INFO - Generated 64 groups efficiently
2025-10-16 21:31:31,599 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-16 21:31:31,599 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 21:31:31,599 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-16 21:31:31,599 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 21:31:31,599 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 21:31:31,599 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 21:31:31,599 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 21:31:31,599 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-16 21:31:31,599 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-16 21:31:31,599 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-16 21:31:31,600 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-16 21:31:31,600 - INFO - Sampled 64 seed points from 1087 total points
2025-10-16 21:31:31,600 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 21:31:31,600 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-16 21:31:31,600 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-16 21:31:31,600 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-16 21:31:31,600 - INFO - Generated 64 groups efficiently
2025-10-16 21:31:33,635 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:31:35,510 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:31:42,600 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:31:44,542 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 21:31:44,758 - DEBUG - Creating converter from 5 to 3
2025-10-16 21:31:45,899 - INFO - Outputs saved to /tmp/tmp56wq1y9q/training_outputs
2025-10-16 21:32:10,131 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 21:32:10,305 - DEBUG - Creating converter from 7 to 5
2025-10-16 21:32:10,305 - DEBUG - Creating converter from 5 to 7
2025-10-16 21:32:10,305 - DEBUG - Creating converter from 7 to 5
2025-10-16 21:32:10,305 - DEBUG - Creating converter from 5 to 7
2025-10-16 21:32:10,925 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 21:32:10,933 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 21:32:10,933 - DEBUG - interactive is False
2025-10-16 21:32:10,933 - DEBUG - platform is linux
2025-10-16 21:32:10,962 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 21:32:10,964 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 21:32:12,013 - DEBUG - Field: train_data_file
2025-10-16 21:32:12,013 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 21:32:12,013 - DEBUG - Field default: None
2025-10-16 21:32:12,013 - DEBUG - Field: test_data_file
2025-10-16 21:32:12,013 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 21:32:12,013 - DEBUG - Field default: None
2025-10-16 21:32:12,013 - DEBUG - Field: output_dir
2025-10-16 21:32:12,013 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 21:32:12,013 - DEBUG - Field default: training_outputs
2025-10-16 21:32:12,013 - DEBUG - Converting path value: /tmp/tmph4uge7l0/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 21:32:12,013 - DEBUG - Converting path value: /tmp/tmph4uge7l0/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 21:32:12,013 - DEBUG - Converting path value: /tmp/tmph4uge7l0/training/training_nphotons_500000.0_e2e
2025-10-16 21:32:12,013 - DEBUG - YAML config: {}
2025-10-16 21:32:12,013 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmph4uge7l0/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmph4uge7l0/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmph4uge7l0/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-16 21:32:12,013 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmph4uge7l0/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmph4uge7l0/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmph4uge7l0/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-16 21:32:12,014 - INFO - Configuration setup complete
2025-10-16 21:32:12,014 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmph4uge7l0/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmph4uge7l0/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmph4uge7l0/training/training_nphotons_500000.0_e2e'), sequential_sampling=False)
2025-10-16 21:32:12,014 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-16 21:32:12,014 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-16 21:32:12,014 - INFO - Loading data from /tmp/tmph4uge7l0/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-16 21:32:12,020 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-16 21:32:12,020 - INFO - Randomly subsampled 50 images
2025-10-16 21:32:12,031 - DEBUG - Loaded metadata from /tmp/tmph4uge7l0/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 21:32:12,031 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-16 21:32:12,032 - INFO - Loading data from /tmp/tmph4uge7l0/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-16 21:32:12,037 - INFO - Using full dataset of 100 images
2025-10-16 21:32:12,037 - INFO - Loaded test data from /tmp/tmph4uge7l0/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 21:32:12,038 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-16 21:32:12,038 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 21:32:12,038 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-16 21:32:12,038 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 21:32:12,038 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 21:32:12,038 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 21:32:12,038 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 21:32:12,038 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 21:32:12,038 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-16 21:32:12,038 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-16 21:32:12,038 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-16 21:32:12,038 - INFO - Using all 50 points as seeds
2025-10-16 21:32:12,038 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 21:32:12,038 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 21:32:12,038 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 21:32:12,038 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 21:32:12,038 - INFO - Generated 50 groups efficiently
2025-10-16 21:32:13,618 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-16 21:32:13,618 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 21:32:13,618 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-16 21:32:13,618 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 21:32:13,618 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 21:32:13,618 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 21:32:13,618 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 21:32:13,618 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 21:32:13,618 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-16 21:32:13,618 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-16 21:32:13,618 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-16 21:32:13,618 - INFO - Sampled 50 seed points from 100 total points
2025-10-16 21:32:13,618 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 21:32:13,618 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 21:32:13,618 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 21:32:13,618 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 21:32:13,618 - INFO - Generated 50 groups efficiently
2025-10-16 21:32:15,611 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:32:17,476 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:32:24,740 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:32:27,954 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 21:32:27,970 - DEBUG - Creating converter from 5 to 3
2025-10-16 21:32:29,109 - INFO - Outputs saved to /tmp/tmph4uge7l0/training/training_nphotons_500000.0_e2e
2025-10-16 21:32:47,292 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 21:32:47,469 - DEBUG - Creating converter from 7 to 5
2025-10-16 21:32:47,469 - DEBUG - Creating converter from 5 to 7
2025-10-16 21:32:47,469 - DEBUG - Creating converter from 7 to 5
2025-10-16 21:32:47,469 - DEBUG - Creating converter from 5 to 7
2025-10-16 21:32:48,078 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 21:32:48,085 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 21:32:48,086 - DEBUG - interactive is False
2025-10-16 21:32:48,086 - DEBUG - platform is linux
2025-10-16 21:32:48,115 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 21:32:48,116 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 21:32:49,162 - DEBUG - Field: train_data_file
2025-10-16 21:32:49,162 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 21:32:49,162 - DEBUG - Field default: None
2025-10-16 21:32:49,162 - DEBUG - Field: test_data_file
2025-10-16 21:32:49,162 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 21:32:49,162 - DEBUG - Field default: None
2025-10-16 21:32:49,162 - DEBUG - Field: output_dir
2025-10-16 21:32:49,162 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 21:32:49,162 - DEBUG - Field default: training_outputs
2025-10-16 21:32:49,162 - DEBUG - Converting path value: /tmp/tmpkkfo9byh/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 21:32:49,162 - DEBUG - Converting path value: /tmp/tmpkkfo9byh/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 21:32:49,162 - DEBUG - Converting path value: /tmp/tmpkkfo9byh/training/training_nphotons_1000000.0_single
2025-10-16 21:32:49,163 - DEBUG - YAML config: {}
2025-10-16 21:32:49,163 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpkkfo9byh/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpkkfo9byh/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpkkfo9byh/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-16 21:32:49,163 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpkkfo9byh/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpkkfo9byh/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpkkfo9byh/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-16 21:32:49,163 - INFO - Configuration setup complete
2025-10-16 21:32:49,163 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpkkfo9byh/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmpkkfo9byh/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpkkfo9byh/training/training_nphotons_1000000.0_single'), sequential_sampling=False)
2025-10-16 21:32:49,163 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-16 21:32:49,163 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-16 21:32:49,163 - INFO - Loading data from /tmp/tmpkkfo9byh/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-16 21:32:49,169 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-16 21:32:49,170 - INFO - Randomly subsampled 50 images
2025-10-16 21:32:49,181 - DEBUG - Loaded metadata from /tmp/tmpkkfo9byh/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 21:32:49,181 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-16 21:32:49,181 - INFO - Loading data from /tmp/tmpkkfo9byh/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-16 21:32:49,186 - INFO - Using full dataset of 100 images
2025-10-16 21:32:49,187 - INFO - Loaded test data from /tmp/tmpkkfo9byh/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 21:32:49,187 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-16 21:32:49,187 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 21:32:49,187 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-16 21:32:49,187 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 21:32:49,187 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 21:32:49,187 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 21:32:49,187 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 21:32:49,187 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 21:32:49,187 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-16 21:32:49,187 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-16 21:32:49,187 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-16 21:32:49,187 - INFO - Using all 50 points as seeds
2025-10-16 21:32:49,187 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 21:32:49,187 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 21:32:49,187 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 21:32:49,187 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 21:32:49,187 - INFO - Generated 50 groups efficiently
2025-10-16 21:32:50,750 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-16 21:32:50,750 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 21:32:50,750 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-16 21:32:50,750 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 21:32:50,750 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 21:32:50,750 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 21:32:50,750 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 21:32:50,750 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 21:32:50,750 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-16 21:32:50,750 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-16 21:32:50,750 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-16 21:32:50,750 - INFO - Sampled 50 seed points from 100 total points
2025-10-16 21:32:50,750 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 21:32:50,750 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 21:32:50,750 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 21:32:50,751 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 21:32:50,751 - INFO - Generated 50 groups efficiently
2025-10-16 21:32:52,751 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:32:54,604 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:33:01,908 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:33:05,087 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 21:33:05,104 - DEBUG - Creating converter from 5 to 3
2025-10-16 21:33:06,233 - INFO - Outputs saved to /tmp/tmpkkfo9byh/training/training_nphotons_1000000.0_single
2025-10-16 21:33:42,179 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 21:33:42,350 - DEBUG - Creating converter from 7 to 5
2025-10-16 21:33:42,351 - DEBUG - Creating converter from 5 to 7
2025-10-16 21:33:42,351 - DEBUG - Creating converter from 7 to 5
2025-10-16 21:33:42,351 - DEBUG - Creating converter from 5 to 7
2025-10-16 21:33:42,961 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 21:33:42,968 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 21:33:42,969 - DEBUG - interactive is False
2025-10-16 21:33:42,969 - DEBUG - platform is linux
2025-10-16 21:33:42,998 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 21:33:42,999 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 21:33:44,027 - DEBUG - Field: train_data_file
2025-10-16 21:33:44,027 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 21:33:44,027 - DEBUG - Field default: None
2025-10-16 21:33:44,027 - DEBUG - Field: test_data_file
2025-10-16 21:33:44,027 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 21:33:44,027 - DEBUG - Field default: None
2025-10-16 21:33:44,027 - DEBUG - Field: output_dir
2025-10-16 21:33:44,027 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 21:33:44,027 - DEBUG - Field default: training_outputs
2025-10-16 21:33:44,027 - DEBUG - Converting path value: /tmp/tmpp897tb64/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 21:33:44,027 - DEBUG - Converting path value: /tmp/tmpp897tb64/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 21:33:44,027 - DEBUG - Converting path value: /tmp/tmpp897tb64/training/training_mismatch_test
2025-10-16 21:33:44,027 - DEBUG - YAML config: {}
2025-10-16 21:33:44,027 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpp897tb64/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpp897tb64/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpp897tb64/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-16 21:33:44,028 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpp897tb64/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpp897tb64/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpp897tb64/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-16 21:33:44,028 - INFO - Configuration setup complete
2025-10-16 21:33:44,028 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpp897tb64/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmpp897tb64/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpp897tb64/training/training_mismatch_test'), sequential_sampling=False)
2025-10-16 21:33:44,028 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-16 21:33:44,028 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-16 21:33:44,028 - INFO - Loading data from /tmp/tmpp897tb64/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-16 21:33:44,033 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-16 21:33:44,033 - INFO - Randomly subsampled 50 images
2025-10-16 21:33:44,043 - DEBUG - Loaded metadata from /tmp/tmpp897tb64/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 21:33:44,043 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-16 21:33:44,043 - INFO - Loading data from /tmp/tmpp897tb64/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-16 21:33:44,048 - INFO - Using full dataset of 100 images
2025-10-16 21:33:44,048 - INFO - Loaded test data from /tmp/tmpp897tb64/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 21:33:44,048 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-16 21:33:44,048 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 21:33:44,049 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-16 21:33:44,049 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 21:33:44,049 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 21:33:44,049 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 21:33:44,049 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 21:33:44,049 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 21:33:44,049 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-16 21:33:44,049 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-16 21:33:44,049 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-16 21:33:44,049 - INFO - Using all 50 points as seeds
2025-10-16 21:33:44,049 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 21:33:44,049 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 21:33:44,049 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 21:33:44,049 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 21:33:44,049 - INFO - Generated 50 groups efficiently
2025-10-16 21:33:45,600 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-16 21:33:45,600 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 21:33:45,600 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-16 21:33:45,600 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 21:33:45,600 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 21:33:45,600 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 21:33:45,600 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 21:33:45,600 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 21:33:45,600 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-16 21:33:45,600 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-16 21:33:45,600 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-16 21:33:45,600 - INFO - Sampled 50 seed points from 100 total points
2025-10-16 21:33:45,600 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 21:33:45,600 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 21:33:45,600 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 21:33:45,600 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 21:33:45,600 - INFO - Generated 50 groups efficiently
2025-10-16 21:33:47,584 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:33:49,446 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:33:56,786 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:33:59,935 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 21:33:59,951 - DEBUG - Creating converter from 5 to 3
2025-10-16 21:34:01,066 - INFO - Outputs saved to /tmp/tmpp897tb64/training/training_mismatch_test
2025-10-16 21:49:45,338 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 21:49:45,507 - DEBUG - Creating converter from 7 to 5
2025-10-16 21:49:45,507 - DEBUG - Creating converter from 5 to 7
2025-10-16 21:49:45,507 - DEBUG - Creating converter from 7 to 5
2025-10-16 21:49:45,507 - DEBUG - Creating converter from 5 to 7
2025-10-16 21:49:46,116 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 21:49:46,123 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 21:49:46,124 - DEBUG - interactive is False
2025-10-16 21:49:46,124 - DEBUG - platform is linux
2025-10-16 21:49:46,153 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 21:49:46,154 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 21:49:47,162 - DEBUG - Field: train_data_file
2025-10-16 21:49:47,162 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 21:49:47,162 - DEBUG - Field default: None
2025-10-16 21:49:47,162 - DEBUG - Field: test_data_file
2025-10-16 21:49:47,162 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 21:49:47,162 - DEBUG - Field default: None
2025-10-16 21:49:47,162 - DEBUG - Field: output_dir
2025-10-16 21:49:47,162 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 21:49:47,162 - DEBUG - Field default: training_outputs
2025-10-16 21:49:47,163 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-16 21:49:47,163 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-16 21:49:47,163 - DEBUG - Converting path value: /tmp/tmp0p5_f7tk/training_outputs
2025-10-16 21:49:47,163 - DEBUG - YAML config: {}
2025-10-16 21:49:47,163 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp0p5_f7tk/training_outputs'), 'sequential_sampling': False}
2025-10-16 21:49:47,163 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp0p5_f7tk/training_outputs'), 'sequential_sampling': False}
2025-10-16 21:49:47,163 - INFO - Configuration setup complete
2025-10-16 21:49:47,163 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp0p5_f7tk/training_outputs'), sequential_sampling=False)
2025-10-16 21:49:47,163 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-16 21:49:47,163 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-16 21:49:47,163 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-16 21:49:47,179 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-16 21:49:47,180 - INFO - Randomly subsampled 64 images
2025-10-16 21:49:47,197 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-16 21:49:47,213 - INFO - Using full dataset of 1087 images
2025-10-16 21:49:47,227 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-16 21:49:47,228 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-16 21:49:47,228 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 21:49:47,228 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-16 21:49:47,228 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 21:49:47,228 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 21:49:47,228 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 21:49:47,228 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 21:49:47,228 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-16 21:49:47,228 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-16 21:49:47,228 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-16 21:49:47,228 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-16 21:49:47,228 - INFO - Using all 64 points as seeds
2025-10-16 21:49:47,228 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 21:49:47,228 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-16 21:49:47,228 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-16 21:49:47,228 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-16 21:49:47,228 - INFO - Generated 64 groups efficiently
2025-10-16 21:49:48,797 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-16 21:49:48,797 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 21:49:48,797 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-16 21:49:48,797 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 21:49:48,797 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 21:49:48,797 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 21:49:48,797 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 21:49:48,797 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-16 21:49:48,797 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-16 21:49:48,797 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-16 21:49:48,797 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-16 21:49:48,797 - INFO - Sampled 64 seed points from 1087 total points
2025-10-16 21:49:48,797 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 21:49:48,797 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-16 21:49:48,797 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-16 21:49:48,797 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-16 21:49:48,797 - INFO - Generated 64 groups efficiently
2025-10-16 21:49:50,829 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:49:52,686 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:49:59,985 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:50:01,937 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 21:50:02,160 - DEBUG - Creating converter from 5 to 3
2025-10-16 21:50:03,285 - INFO - Outputs saved to /tmp/tmp0p5_f7tk/training_outputs
2025-10-16 21:50:27,461 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 21:50:27,640 - DEBUG - Creating converter from 7 to 5
2025-10-16 21:50:27,640 - DEBUG - Creating converter from 5 to 7
2025-10-16 21:50:27,640 - DEBUG - Creating converter from 7 to 5
2025-10-16 21:50:27,640 - DEBUG - Creating converter from 5 to 7
2025-10-16 21:50:28,254 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 21:50:28,261 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 21:50:28,262 - DEBUG - interactive is False
2025-10-16 21:50:28,262 - DEBUG - platform is linux
2025-10-16 21:50:28,291 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 21:50:28,292 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 21:50:29,337 - DEBUG - Field: train_data_file
2025-10-16 21:50:29,337 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 21:50:29,337 - DEBUG - Field default: None
2025-10-16 21:50:29,337 - DEBUG - Field: test_data_file
2025-10-16 21:50:29,337 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 21:50:29,337 - DEBUG - Field default: None
2025-10-16 21:50:29,337 - DEBUG - Field: output_dir
2025-10-16 21:50:29,337 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 21:50:29,337 - DEBUG - Field default: training_outputs
2025-10-16 21:50:29,337 - DEBUG - Converting path value: /tmp/tmpu7uwn7mi/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 21:50:29,337 - DEBUG - Converting path value: /tmp/tmpu7uwn7mi/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 21:50:29,337 - DEBUG - Converting path value: /tmp/tmpu7uwn7mi/training/training_nphotons_500000.0_e2e
2025-10-16 21:50:29,338 - DEBUG - YAML config: {}
2025-10-16 21:50:29,338 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpu7uwn7mi/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpu7uwn7mi/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpu7uwn7mi/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-16 21:50:29,338 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpu7uwn7mi/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpu7uwn7mi/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpu7uwn7mi/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-16 21:50:29,338 - INFO - Configuration setup complete
2025-10-16 21:50:29,338 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpu7uwn7mi/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmpu7uwn7mi/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpu7uwn7mi/training/training_nphotons_500000.0_e2e'), sequential_sampling=False)
2025-10-16 21:50:29,338 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-16 21:50:29,338 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-16 21:50:29,338 - INFO - Loading data from /tmp/tmpu7uwn7mi/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-16 21:50:29,344 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-16 21:50:29,344 - INFO - Randomly subsampled 50 images
2025-10-16 21:50:29,356 - DEBUG - Loaded metadata from /tmp/tmpu7uwn7mi/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 21:50:29,356 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-16 21:50:29,356 - INFO - Loading data from /tmp/tmpu7uwn7mi/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-16 21:50:29,362 - INFO - Using full dataset of 100 images
2025-10-16 21:50:29,362 - INFO - Loaded test data from /tmp/tmpu7uwn7mi/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 21:50:29,362 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-16 21:50:29,362 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 21:50:29,362 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-16 21:50:29,362 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 21:50:29,362 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 21:50:29,362 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 21:50:29,362 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 21:50:29,362 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 21:50:29,362 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-16 21:50:29,362 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-16 21:50:29,362 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-16 21:50:29,362 - INFO - Using all 50 points as seeds
2025-10-16 21:50:29,362 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 21:50:29,363 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 21:50:29,363 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 21:50:29,363 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 21:50:29,363 - INFO - Generated 50 groups efficiently
2025-10-16 21:50:30,933 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-16 21:50:30,933 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 21:50:30,933 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-16 21:50:30,933 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 21:50:30,933 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 21:50:30,933 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 21:50:30,933 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 21:50:30,933 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 21:50:30,933 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-16 21:50:30,933 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-16 21:50:30,933 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-16 21:50:30,933 - INFO - Sampled 50 seed points from 100 total points
2025-10-16 21:50:30,933 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 21:50:30,933 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 21:50:30,933 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 21:50:30,933 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 21:50:30,933 - INFO - Generated 50 groups efficiently
2025-10-16 21:50:32,911 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:50:34,775 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:50:41,995 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:50:45,190 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 21:50:45,205 - DEBUG - Creating converter from 5 to 3
2025-10-16 21:50:46,339 - INFO - Outputs saved to /tmp/tmpu7uwn7mi/training/training_nphotons_500000.0_e2e
2025-10-16 21:51:04,529 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 21:51:04,707 - DEBUG - Creating converter from 7 to 5
2025-10-16 21:51:04,707 - DEBUG - Creating converter from 5 to 7
2025-10-16 21:51:04,707 - DEBUG - Creating converter from 7 to 5
2025-10-16 21:51:04,707 - DEBUG - Creating converter from 5 to 7
2025-10-16 21:51:05,321 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 21:51:05,328 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 21:51:05,329 - DEBUG - interactive is False
2025-10-16 21:51:05,329 - DEBUG - platform is linux
2025-10-16 21:51:05,359 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 21:51:05,360 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 21:51:06,409 - DEBUG - Field: train_data_file
2025-10-16 21:51:06,409 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 21:51:06,409 - DEBUG - Field default: None
2025-10-16 21:51:06,409 - DEBUG - Field: test_data_file
2025-10-16 21:51:06,409 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 21:51:06,409 - DEBUG - Field default: None
2025-10-16 21:51:06,410 - DEBUG - Field: output_dir
2025-10-16 21:51:06,410 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 21:51:06,410 - DEBUG - Field default: training_outputs
2025-10-16 21:51:06,410 - DEBUG - Converting path value: /tmp/tmppkulouc7/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 21:51:06,410 - DEBUG - Converting path value: /tmp/tmppkulouc7/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 21:51:06,410 - DEBUG - Converting path value: /tmp/tmppkulouc7/training/training_nphotons_1000000.0_single
2025-10-16 21:51:06,410 - DEBUG - YAML config: {}
2025-10-16 21:51:06,410 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmppkulouc7/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmppkulouc7/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmppkulouc7/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-16 21:51:06,410 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmppkulouc7/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmppkulouc7/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmppkulouc7/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-16 21:51:06,410 - INFO - Configuration setup complete
2025-10-16 21:51:06,410 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmppkulouc7/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmppkulouc7/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmppkulouc7/training/training_nphotons_1000000.0_single'), sequential_sampling=False)
2025-10-16 21:51:06,410 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-16 21:51:06,410 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-16 21:51:06,410 - INFO - Loading data from /tmp/tmppkulouc7/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-16 21:51:06,417 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-16 21:51:06,417 - INFO - Randomly subsampled 50 images
2025-10-16 21:51:06,428 - DEBUG - Loaded metadata from /tmp/tmppkulouc7/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 21:51:06,428 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-16 21:51:06,428 - INFO - Loading data from /tmp/tmppkulouc7/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-16 21:51:06,434 - INFO - Using full dataset of 100 images
2025-10-16 21:51:06,434 - INFO - Loaded test data from /tmp/tmppkulouc7/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 21:51:06,434 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-16 21:51:06,434 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 21:51:06,434 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-16 21:51:06,434 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 21:51:06,435 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 21:51:06,435 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 21:51:06,435 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 21:51:06,435 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 21:51:06,435 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-16 21:51:06,435 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-16 21:51:06,435 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-16 21:51:06,435 - INFO - Using all 50 points as seeds
2025-10-16 21:51:06,435 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 21:51:06,435 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 21:51:06,435 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 21:51:06,435 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 21:51:06,435 - INFO - Generated 50 groups efficiently
2025-10-16 21:51:07,972 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-16 21:51:07,972 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 21:51:07,972 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-16 21:51:07,972 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 21:51:07,972 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 21:51:07,972 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 21:51:07,972 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 21:51:07,972 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 21:51:07,972 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-16 21:51:07,972 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-16 21:51:07,972 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-16 21:51:07,972 - INFO - Sampled 50 seed points from 100 total points
2025-10-16 21:51:07,972 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 21:51:07,972 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 21:51:07,972 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 21:51:07,972 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 21:51:07,972 - INFO - Generated 50 groups efficiently
2025-10-16 21:51:09,965 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:51:11,837 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:51:19,172 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:51:22,349 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 21:51:22,366 - DEBUG - Creating converter from 5 to 3
2025-10-16 21:51:23,507 - INFO - Outputs saved to /tmp/tmppkulouc7/training/training_nphotons_1000000.0_single
2025-10-16 21:51:59,177 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 21:51:59,356 - DEBUG - Creating converter from 7 to 5
2025-10-16 21:51:59,356 - DEBUG - Creating converter from 5 to 7
2025-10-16 21:51:59,356 - DEBUG - Creating converter from 7 to 5
2025-10-16 21:51:59,356 - DEBUG - Creating converter from 5 to 7
2025-10-16 21:51:59,976 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 21:51:59,984 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 21:51:59,985 - DEBUG - interactive is False
2025-10-16 21:51:59,985 - DEBUG - platform is linux
2025-10-16 21:52:00,014 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 21:52:00,015 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 21:52:01,055 - DEBUG - Field: train_data_file
2025-10-16 21:52:01,055 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 21:52:01,055 - DEBUG - Field default: None
2025-10-16 21:52:01,055 - DEBUG - Field: test_data_file
2025-10-16 21:52:01,055 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 21:52:01,055 - DEBUG - Field default: None
2025-10-16 21:52:01,055 - DEBUG - Field: output_dir
2025-10-16 21:52:01,055 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 21:52:01,055 - DEBUG - Field default: training_outputs
2025-10-16 21:52:01,055 - DEBUG - Converting path value: /tmp/tmp3pursu9p/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 21:52:01,055 - DEBUG - Converting path value: /tmp/tmp3pursu9p/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 21:52:01,055 - DEBUG - Converting path value: /tmp/tmp3pursu9p/training/training_mismatch_test
2025-10-16 21:52:01,056 - DEBUG - YAML config: {}
2025-10-16 21:52:01,056 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp3pursu9p/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmp3pursu9p/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp3pursu9p/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-16 21:52:01,056 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp3pursu9p/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmp3pursu9p/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp3pursu9p/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-16 21:52:01,056 - INFO - Configuration setup complete
2025-10-16 21:52:01,056 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp3pursu9p/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmp3pursu9p/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp3pursu9p/training/training_mismatch_test'), sequential_sampling=False)
2025-10-16 21:52:01,056 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-16 21:52:01,056 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-16 21:52:01,056 - INFO - Loading data from /tmp/tmp3pursu9p/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-16 21:52:01,061 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-16 21:52:01,062 - INFO - Randomly subsampled 50 images
2025-10-16 21:52:01,072 - DEBUG - Loaded metadata from /tmp/tmp3pursu9p/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 21:52:01,072 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-16 21:52:01,072 - INFO - Loading data from /tmp/tmp3pursu9p/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-16 21:52:01,076 - INFO - Using full dataset of 100 images
2025-10-16 21:52:01,076 - INFO - Loaded test data from /tmp/tmp3pursu9p/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 21:52:01,077 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-16 21:52:01,077 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 21:52:01,077 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-16 21:52:01,077 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 21:52:01,077 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 21:52:01,077 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 21:52:01,077 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 21:52:01,077 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 21:52:01,077 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-16 21:52:01,077 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-16 21:52:01,077 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-16 21:52:01,077 - INFO - Using all 50 points as seeds
2025-10-16 21:52:01,077 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 21:52:01,077 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 21:52:01,077 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 21:52:01,077 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 21:52:01,077 - INFO - Generated 50 groups efficiently
2025-10-16 21:52:02,623 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-16 21:52:02,623 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 21:52:02,623 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-16 21:52:02,623 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 21:52:02,623 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 21:52:02,623 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 21:52:02,623 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 21:52:02,623 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 21:52:02,623 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-16 21:52:02,623 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-16 21:52:02,623 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-16 21:52:02,623 - INFO - Sampled 50 seed points from 100 total points
2025-10-16 21:52:02,623 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 21:52:02,623 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 21:52:02,623 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 21:52:02,623 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 21:52:02,623 - INFO - Generated 50 groups efficiently
2025-10-16 21:52:04,626 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:52:06,499 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:52:13,774 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 21:52:17,002 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 21:52:17,018 - DEBUG - Creating converter from 5 to 3
2025-10-16 21:52:18,141 - INFO - Outputs saved to /tmp/tmp3pursu9p/training/training_mismatch_test
2025-10-16 22:07:11,093 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 22:07:11,267 - DEBUG - Creating converter from 7 to 5
2025-10-16 22:07:11,267 - DEBUG - Creating converter from 5 to 7
2025-10-16 22:07:11,267 - DEBUG - Creating converter from 7 to 5
2025-10-16 22:07:11,267 - DEBUG - Creating converter from 5 to 7
2025-10-16 22:07:11,871 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 22:07:11,878 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 22:07:11,878 - DEBUG - interactive is False
2025-10-16 22:07:11,878 - DEBUG - platform is linux
2025-10-16 22:07:11,907 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 22:07:11,909 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 22:07:12,919 - DEBUG - Field: train_data_file
2025-10-16 22:07:12,919 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 22:07:12,919 - DEBUG - Field default: None
2025-10-16 22:07:12,919 - DEBUG - Field: test_data_file
2025-10-16 22:07:12,919 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 22:07:12,919 - DEBUG - Field default: None
2025-10-16 22:07:12,920 - DEBUG - Field: output_dir
2025-10-16 22:07:12,920 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 22:07:12,920 - DEBUG - Field default: training_outputs
2025-10-16 22:07:12,920 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-16 22:07:12,920 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-16 22:07:12,920 - DEBUG - Converting path value: /tmp/tmpih5bu4ll/training_outputs
2025-10-16 22:07:12,920 - DEBUG - YAML config: {}
2025-10-16 22:07:12,920 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpih5bu4ll/training_outputs'), 'sequential_sampling': False}
2025-10-16 22:07:12,920 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpih5bu4ll/training_outputs'), 'sequential_sampling': False}
2025-10-16 22:07:12,920 - INFO - Configuration setup complete
2025-10-16 22:07:12,920 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpih5bu4ll/training_outputs'), sequential_sampling=False)
2025-10-16 22:07:12,920 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-16 22:07:12,920 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-16 22:07:12,920 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-16 22:07:12,936 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-16 22:07:12,936 - INFO - Randomly subsampled 64 images
2025-10-16 22:07:12,956 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-16 22:07:12,971 - INFO - Using full dataset of 1087 images
2025-10-16 22:07:12,985 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-16 22:07:12,986 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-16 22:07:12,986 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 22:07:12,986 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-16 22:07:12,986 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 22:07:12,986 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 22:07:12,986 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 22:07:12,986 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 22:07:12,986 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-16 22:07:12,986 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-16 22:07:12,986 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-16 22:07:12,986 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-16 22:07:12,986 - INFO - Using all 64 points as seeds
2025-10-16 22:07:12,986 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 22:07:12,986 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-16 22:07:12,986 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-16 22:07:12,986 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-16 22:07:12,986 - INFO - Generated 64 groups efficiently
2025-10-16 22:07:14,560 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-16 22:07:14,560 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 22:07:14,560 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-16 22:07:14,560 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 22:07:14,560 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 22:07:14,560 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 22:07:14,560 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 22:07:14,560 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-16 22:07:14,560 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-16 22:07:14,560 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-16 22:07:14,560 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-16 22:07:14,560 - INFO - Sampled 64 seed points from 1087 total points
2025-10-16 22:07:14,560 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 22:07:14,560 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-16 22:07:14,560 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-16 22:07:14,560 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-16 22:07:14,560 - INFO - Generated 64 groups efficiently
2025-10-16 22:07:16,603 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:07:18,443 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:07:25,568 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:07:27,517 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 22:07:27,732 - DEBUG - Creating converter from 5 to 3
2025-10-16 22:07:28,862 - INFO - Outputs saved to /tmp/tmpih5bu4ll/training_outputs
2025-10-16 22:07:53,007 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 22:07:53,182 - DEBUG - Creating converter from 7 to 5
2025-10-16 22:07:53,182 - DEBUG - Creating converter from 5 to 7
2025-10-16 22:07:53,182 - DEBUG - Creating converter from 7 to 5
2025-10-16 22:07:53,182 - DEBUG - Creating converter from 5 to 7
2025-10-16 22:07:53,797 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 22:07:53,805 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 22:07:53,805 - DEBUG - interactive is False
2025-10-16 22:07:53,805 - DEBUG - platform is linux
2025-10-16 22:07:53,835 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 22:07:53,837 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 22:07:54,887 - DEBUG - Field: train_data_file
2025-10-16 22:07:54,887 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 22:07:54,887 - DEBUG - Field default: None
2025-10-16 22:07:54,887 - DEBUG - Field: test_data_file
2025-10-16 22:07:54,887 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 22:07:54,887 - DEBUG - Field default: None
2025-10-16 22:07:54,887 - DEBUG - Field: output_dir
2025-10-16 22:07:54,888 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 22:07:54,888 - DEBUG - Field default: training_outputs
2025-10-16 22:07:54,888 - DEBUG - Converting path value: /tmp/tmpqas5qg0c/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 22:07:54,888 - DEBUG - Converting path value: /tmp/tmpqas5qg0c/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 22:07:54,888 - DEBUG - Converting path value: /tmp/tmpqas5qg0c/training/training_nphotons_500000.0_e2e
2025-10-16 22:07:54,888 - DEBUG - YAML config: {}
2025-10-16 22:07:54,888 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpqas5qg0c/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpqas5qg0c/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpqas5qg0c/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-16 22:07:54,888 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpqas5qg0c/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpqas5qg0c/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpqas5qg0c/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-16 22:07:54,888 - INFO - Configuration setup complete
2025-10-16 22:07:54,888 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpqas5qg0c/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmpqas5qg0c/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpqas5qg0c/training/training_nphotons_500000.0_e2e'), sequential_sampling=False)
2025-10-16 22:07:54,888 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-16 22:07:54,888 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-16 22:07:54,888 - INFO - Loading data from /tmp/tmpqas5qg0c/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-16 22:07:54,895 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-16 22:07:54,895 - INFO - Randomly subsampled 50 images
2025-10-16 22:07:54,906 - DEBUG - Loaded metadata from /tmp/tmpqas5qg0c/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 22:07:54,906 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-16 22:07:54,906 - INFO - Loading data from /tmp/tmpqas5qg0c/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-16 22:07:54,911 - INFO - Using full dataset of 100 images
2025-10-16 22:07:54,912 - INFO - Loaded test data from /tmp/tmpqas5qg0c/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 22:07:54,912 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-16 22:07:54,912 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 22:07:54,912 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-16 22:07:54,912 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 22:07:54,912 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 22:07:54,912 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 22:07:54,912 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 22:07:54,912 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 22:07:54,912 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-16 22:07:54,912 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-16 22:07:54,912 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-16 22:07:54,912 - INFO - Using all 50 points as seeds
2025-10-16 22:07:54,912 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 22:07:54,912 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 22:07:54,912 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 22:07:54,912 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 22:07:54,912 - INFO - Generated 50 groups efficiently
2025-10-16 22:07:56,481 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-16 22:07:56,481 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 22:07:56,481 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-16 22:07:56,481 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 22:07:56,481 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 22:07:56,481 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 22:07:56,481 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 22:07:56,481 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 22:07:56,481 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-16 22:07:56,481 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-16 22:07:56,481 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-16 22:07:56,481 - INFO - Sampled 50 seed points from 100 total points
2025-10-16 22:07:56,481 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 22:07:56,481 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 22:07:56,481 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 22:07:56,481 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 22:07:56,481 - INFO - Generated 50 groups efficiently
2025-10-16 22:07:58,499 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:08:00,356 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:08:07,567 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:08:10,722 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 22:08:10,741 - DEBUG - Creating converter from 5 to 3
2025-10-16 22:08:11,877 - INFO - Outputs saved to /tmp/tmpqas5qg0c/training/training_nphotons_500000.0_e2e
2025-10-16 22:08:29,987 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 22:08:30,163 - DEBUG - Creating converter from 7 to 5
2025-10-16 22:08:30,163 - DEBUG - Creating converter from 5 to 7
2025-10-16 22:08:30,163 - DEBUG - Creating converter from 7 to 5
2025-10-16 22:08:30,164 - DEBUG - Creating converter from 5 to 7
2025-10-16 22:08:30,784 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 22:08:30,791 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 22:08:30,791 - DEBUG - interactive is False
2025-10-16 22:08:30,791 - DEBUG - platform is linux
2025-10-16 22:08:30,820 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 22:08:30,822 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 22:08:31,851 - DEBUG - Field: train_data_file
2025-10-16 22:08:31,851 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 22:08:31,851 - DEBUG - Field default: None
2025-10-16 22:08:31,851 - DEBUG - Field: test_data_file
2025-10-16 22:08:31,851 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 22:08:31,851 - DEBUG - Field default: None
2025-10-16 22:08:31,852 - DEBUG - Field: output_dir
2025-10-16 22:08:31,852 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 22:08:31,852 - DEBUG - Field default: training_outputs
2025-10-16 22:08:31,852 - DEBUG - Converting path value: /tmp/tmpamlsx2_5/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 22:08:31,852 - DEBUG - Converting path value: /tmp/tmpamlsx2_5/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 22:08:31,852 - DEBUG - Converting path value: /tmp/tmpamlsx2_5/training/training_nphotons_1000000.0_single
2025-10-16 22:08:31,852 - DEBUG - YAML config: {}
2025-10-16 22:08:31,852 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpamlsx2_5/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpamlsx2_5/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpamlsx2_5/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-16 22:08:31,852 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpamlsx2_5/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpamlsx2_5/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpamlsx2_5/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-16 22:08:31,852 - INFO - Configuration setup complete
2025-10-16 22:08:31,852 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpamlsx2_5/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmpamlsx2_5/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpamlsx2_5/training/training_nphotons_1000000.0_single'), sequential_sampling=False)
2025-10-16 22:08:31,852 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-16 22:08:31,852 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-16 22:08:31,852 - INFO - Loading data from /tmp/tmpamlsx2_5/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-16 22:08:31,859 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-16 22:08:31,859 - INFO - Randomly subsampled 50 images
2025-10-16 22:08:31,870 - DEBUG - Loaded metadata from /tmp/tmpamlsx2_5/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 22:08:31,870 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-16 22:08:31,870 - INFO - Loading data from /tmp/tmpamlsx2_5/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-16 22:08:31,875 - INFO - Using full dataset of 100 images
2025-10-16 22:08:31,876 - INFO - Loaded test data from /tmp/tmpamlsx2_5/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 22:08:31,876 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-16 22:08:31,876 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 22:08:31,876 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-16 22:08:31,876 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 22:08:31,876 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 22:08:31,876 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 22:08:31,876 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 22:08:31,876 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 22:08:31,876 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-16 22:08:31,876 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-16 22:08:31,876 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-16 22:08:31,876 - INFO - Using all 50 points as seeds
2025-10-16 22:08:31,876 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 22:08:31,876 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 22:08:31,876 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 22:08:31,877 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 22:08:31,877 - INFO - Generated 50 groups efficiently
2025-10-16 22:08:33,440 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-16 22:08:33,440 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 22:08:33,440 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-16 22:08:33,440 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 22:08:33,440 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 22:08:33,441 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 22:08:33,441 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 22:08:33,441 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 22:08:33,441 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-16 22:08:33,441 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-16 22:08:33,441 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-16 22:08:33,441 - INFO - Sampled 50 seed points from 100 total points
2025-10-16 22:08:33,441 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 22:08:33,441 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 22:08:33,441 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 22:08:33,441 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 22:08:33,441 - INFO - Generated 50 groups efficiently
2025-10-16 22:08:35,467 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:08:37,352 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:08:44,687 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:08:47,882 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 22:08:47,898 - DEBUG - Creating converter from 5 to 3
2025-10-16 22:08:49,031 - INFO - Outputs saved to /tmp/tmpamlsx2_5/training/training_nphotons_1000000.0_single
2025-10-16 22:09:24,659 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 22:09:24,829 - DEBUG - Creating converter from 7 to 5
2025-10-16 22:09:24,829 - DEBUG - Creating converter from 5 to 7
2025-10-16 22:09:24,829 - DEBUG - Creating converter from 7 to 5
2025-10-16 22:09:24,830 - DEBUG - Creating converter from 5 to 7
2025-10-16 22:09:25,443 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 22:09:25,450 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 22:09:25,451 - DEBUG - interactive is False
2025-10-16 22:09:25,451 - DEBUG - platform is linux
2025-10-16 22:09:25,480 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 22:09:25,481 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 22:09:26,513 - DEBUG - Field: train_data_file
2025-10-16 22:09:26,513 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 22:09:26,513 - DEBUG - Field default: None
2025-10-16 22:09:26,513 - DEBUG - Field: test_data_file
2025-10-16 22:09:26,513 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 22:09:26,513 - DEBUG - Field default: None
2025-10-16 22:09:26,513 - DEBUG - Field: output_dir
2025-10-16 22:09:26,513 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 22:09:26,513 - DEBUG - Field default: training_outputs
2025-10-16 22:09:26,513 - DEBUG - Converting path value: /tmp/tmpoqfryei4/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 22:09:26,514 - DEBUG - Converting path value: /tmp/tmpoqfryei4/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 22:09:26,514 - DEBUG - Converting path value: /tmp/tmpoqfryei4/training/training_mismatch_test
2025-10-16 22:09:26,514 - DEBUG - YAML config: {}
2025-10-16 22:09:26,514 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpoqfryei4/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpoqfryei4/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpoqfryei4/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-16 22:09:26,514 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpoqfryei4/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpoqfryei4/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpoqfryei4/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-16 22:09:26,514 - INFO - Configuration setup complete
2025-10-16 22:09:26,514 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpoqfryei4/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmpoqfryei4/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpoqfryei4/training/training_mismatch_test'), sequential_sampling=False)
2025-10-16 22:09:26,514 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-16 22:09:26,514 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-16 22:09:26,514 - INFO - Loading data from /tmp/tmpoqfryei4/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-16 22:09:26,519 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-16 22:09:26,519 - INFO - Randomly subsampled 50 images
2025-10-16 22:09:26,529 - DEBUG - Loaded metadata from /tmp/tmpoqfryei4/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 22:09:26,530 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-16 22:09:26,530 - INFO - Loading data from /tmp/tmpoqfryei4/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-16 22:09:26,534 - INFO - Using full dataset of 100 images
2025-10-16 22:09:26,534 - INFO - Loaded test data from /tmp/tmpoqfryei4/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 22:09:26,535 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-16 22:09:26,535 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 22:09:26,535 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-16 22:09:26,535 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 22:09:26,535 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 22:09:26,535 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 22:09:26,535 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 22:09:26,535 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 22:09:26,535 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-16 22:09:26,535 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-16 22:09:26,535 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-16 22:09:26,535 - INFO - Using all 50 points as seeds
2025-10-16 22:09:26,535 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 22:09:26,535 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 22:09:26,535 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 22:09:26,535 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 22:09:26,535 - INFO - Generated 50 groups efficiently
2025-10-16 22:09:28,099 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-16 22:09:28,099 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 22:09:28,099 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-16 22:09:28,099 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 22:09:28,099 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 22:09:28,099 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 22:09:28,099 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 22:09:28,099 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 22:09:28,099 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-16 22:09:28,099 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-16 22:09:28,099 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-16 22:09:28,099 - INFO - Sampled 50 seed points from 100 total points
2025-10-16 22:09:28,099 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 22:09:28,099 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 22:09:28,099 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 22:09:28,099 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 22:09:28,099 - INFO - Generated 50 groups efficiently
2025-10-16 22:09:30,075 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:09:31,939 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:09:39,199 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:09:42,373 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 22:09:42,391 - DEBUG - Creating converter from 5 to 3
2025-10-16 22:09:43,518 - INFO - Outputs saved to /tmp/tmpoqfryei4/training/training_mismatch_test
2025-10-16 22:26:07,009 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 22:26:07,196 - DEBUG - Creating converter from 7 to 5
2025-10-16 22:26:07,197 - DEBUG - Creating converter from 5 to 7
2025-10-16 22:26:07,197 - DEBUG - Creating converter from 7 to 5
2025-10-16 22:26:07,197 - DEBUG - Creating converter from 5 to 7
2025-10-16 22:26:07,890 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 22:26:07,898 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 22:26:07,898 - DEBUG - interactive is False
2025-10-16 22:26:07,898 - DEBUG - platform is linux
2025-10-16 22:26:07,930 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 22:26:07,931 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 22:26:09,009 - DEBUG - Field: train_data_file
2025-10-16 22:26:09,009 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 22:26:09,009 - DEBUG - Field default: None
2025-10-16 22:26:09,009 - DEBUG - Field: test_data_file
2025-10-16 22:26:09,009 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 22:26:09,009 - DEBUG - Field default: None
2025-10-16 22:26:09,009 - DEBUG - Field: output_dir
2025-10-16 22:26:09,009 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 22:26:09,009 - DEBUG - Field default: training_outputs
2025-10-16 22:26:09,009 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-16 22:26:09,009 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-16 22:26:09,009 - DEBUG - Converting path value: /tmp/tmpobf1pesk/training_outputs
2025-10-16 22:26:09,010 - DEBUG - YAML config: {}
2025-10-16 22:26:09,010 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpobf1pesk/training_outputs'), 'sequential_sampling': False}
2025-10-16 22:26:09,010 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpobf1pesk/training_outputs'), 'sequential_sampling': False}
2025-10-16 22:26:09,010 - INFO - Configuration setup complete
2025-10-16 22:26:09,010 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpobf1pesk/training_outputs'), sequential_sampling=False)
2025-10-16 22:26:09,010 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-16 22:26:09,010 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-16 22:26:09,010 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-16 22:26:09,026 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-16 22:26:09,026 - INFO - Randomly subsampled 64 images
2025-10-16 22:26:09,043 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-16 22:26:09,059 - INFO - Using full dataset of 1087 images
2025-10-16 22:26:09,075 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-16 22:26:09,075 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-16 22:26:09,075 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 22:26:09,075 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-16 22:26:09,075 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 22:26:09,075 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 22:26:09,075 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 22:26:09,075 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 22:26:09,075 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-16 22:26:09,075 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-16 22:26:09,076 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-16 22:26:09,076 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-16 22:26:09,076 - INFO - Using all 64 points as seeds
2025-10-16 22:26:09,076 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 22:26:09,076 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-16 22:26:09,076 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-16 22:26:09,076 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-16 22:26:09,076 - INFO - Generated 64 groups efficiently
2025-10-16 22:26:10,728 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-16 22:26:10,728 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 22:26:10,728 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-16 22:26:10,728 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 22:26:10,728 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 22:26:10,728 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 22:26:10,728 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 22:26:10,728 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-16 22:26:10,728 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-16 22:26:10,728 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-16 22:26:10,728 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-16 22:26:10,728 - INFO - Sampled 64 seed points from 1087 total points
2025-10-16 22:26:10,728 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 22:26:10,728 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-16 22:26:10,728 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-16 22:26:10,728 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-16 22:26:10,728 - INFO - Generated 64 groups efficiently
2025-10-16 22:26:12,873 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:26:14,822 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:26:22,370 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:26:24,433 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 22:26:24,689 - DEBUG - Creating converter from 5 to 3
2025-10-16 22:26:25,841 - INFO - Outputs saved to /tmp/tmpobf1pesk/training_outputs
2025-10-16 22:26:51,776 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 22:26:51,966 - DEBUG - Creating converter from 7 to 5
2025-10-16 22:26:51,966 - DEBUG - Creating converter from 5 to 7
2025-10-16 22:26:51,966 - DEBUG - Creating converter from 7 to 5
2025-10-16 22:26:51,966 - DEBUG - Creating converter from 5 to 7
2025-10-16 22:26:52,610 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 22:26:52,617 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 22:26:52,618 - DEBUG - interactive is False
2025-10-16 22:26:52,618 - DEBUG - platform is linux
2025-10-16 22:26:52,648 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 22:26:52,649 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 22:26:53,738 - DEBUG - Field: train_data_file
2025-10-16 22:26:53,738 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 22:26:53,738 - DEBUG - Field default: None
2025-10-16 22:26:53,738 - DEBUG - Field: test_data_file
2025-10-16 22:26:53,738 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 22:26:53,738 - DEBUG - Field default: None
2025-10-16 22:26:53,738 - DEBUG - Field: output_dir
2025-10-16 22:26:53,738 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 22:26:53,738 - DEBUG - Field default: training_outputs
2025-10-16 22:26:53,738 - DEBUG - Converting path value: /tmp/tmp52kvzwh3/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 22:26:53,738 - DEBUG - Converting path value: /tmp/tmp52kvzwh3/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 22:26:53,738 - DEBUG - Converting path value: /tmp/tmp52kvzwh3/training/training_nphotons_500000.0_e2e
2025-10-16 22:26:53,738 - DEBUG - YAML config: {}
2025-10-16 22:26:53,738 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp52kvzwh3/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmp52kvzwh3/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp52kvzwh3/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-16 22:26:53,738 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp52kvzwh3/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmp52kvzwh3/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp52kvzwh3/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-16 22:26:53,739 - INFO - Configuration setup complete
2025-10-16 22:26:53,739 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp52kvzwh3/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmp52kvzwh3/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp52kvzwh3/training/training_nphotons_500000.0_e2e'), sequential_sampling=False)
2025-10-16 22:26:53,739 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-16 22:26:53,739 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-16 22:26:53,739 - INFO - Loading data from /tmp/tmp52kvzwh3/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-16 22:26:53,745 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-16 22:26:53,745 - INFO - Randomly subsampled 50 images
2025-10-16 22:26:53,757 - DEBUG - Loaded metadata from /tmp/tmp52kvzwh3/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 22:26:53,757 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-16 22:26:53,757 - INFO - Loading data from /tmp/tmp52kvzwh3/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-16 22:26:53,762 - INFO - Using full dataset of 100 images
2025-10-16 22:26:53,763 - INFO - Loaded test data from /tmp/tmp52kvzwh3/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 22:26:53,763 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-16 22:26:53,763 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 22:26:53,763 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-16 22:26:53,763 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 22:26:53,763 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 22:26:53,763 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 22:26:53,763 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 22:26:53,763 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 22:26:53,763 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-16 22:26:53,763 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-16 22:26:53,763 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-16 22:26:53,763 - INFO - Using all 50 points as seeds
2025-10-16 22:26:53,763 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 22:26:53,763 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 22:26:53,763 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 22:26:53,763 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 22:26:53,763 - INFO - Generated 50 groups efficiently
2025-10-16 22:26:55,406 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-16 22:26:55,406 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 22:26:55,407 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-16 22:26:55,407 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 22:26:55,407 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 22:26:55,407 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 22:26:55,407 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 22:26:55,407 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 22:26:55,407 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-16 22:26:55,407 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-16 22:26:55,407 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-16 22:26:55,407 - INFO - Sampled 50 seed points from 100 total points
2025-10-16 22:26:55,407 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 22:26:55,407 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 22:26:55,407 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 22:26:55,407 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 22:26:55,407 - INFO - Generated 50 groups efficiently
2025-10-16 22:26:57,493 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:26:59,421 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:27:06,961 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:27:10,267 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 22:27:10,283 - DEBUG - Creating converter from 5 to 3
2025-10-16 22:27:11,443 - INFO - Outputs saved to /tmp/tmp52kvzwh3/training/training_nphotons_500000.0_e2e
2025-10-16 22:27:31,236 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 22:27:31,449 - DEBUG - Creating converter from 7 to 5
2025-10-16 22:27:31,450 - DEBUG - Creating converter from 5 to 7
2025-10-16 22:27:31,450 - DEBUG - Creating converter from 7 to 5
2025-10-16 22:27:31,450 - DEBUG - Creating converter from 5 to 7
2025-10-16 22:27:32,158 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 22:27:32,166 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 22:27:32,166 - DEBUG - interactive is False
2025-10-16 22:27:32,166 - DEBUG - platform is linux
2025-10-16 22:27:32,200 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 22:27:32,201 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 22:27:33,364 - DEBUG - Field: train_data_file
2025-10-16 22:27:33,364 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 22:27:33,364 - DEBUG - Field default: None
2025-10-16 22:27:33,364 - DEBUG - Field: test_data_file
2025-10-16 22:27:33,364 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 22:27:33,364 - DEBUG - Field default: None
2025-10-16 22:27:33,364 - DEBUG - Field: output_dir
2025-10-16 22:27:33,364 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 22:27:33,364 - DEBUG - Field default: training_outputs
2025-10-16 22:27:33,364 - DEBUG - Converting path value: /tmp/tmpzqwu7dz1/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 22:27:33,364 - DEBUG - Converting path value: /tmp/tmpzqwu7dz1/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 22:27:33,364 - DEBUG - Converting path value: /tmp/tmpzqwu7dz1/training/training_nphotons_1000000.0_single
2025-10-16 22:27:33,364 - DEBUG - YAML config: {}
2025-10-16 22:27:33,364 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpzqwu7dz1/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpzqwu7dz1/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpzqwu7dz1/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-16 22:27:33,364 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpzqwu7dz1/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpzqwu7dz1/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpzqwu7dz1/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-16 22:27:33,365 - INFO - Configuration setup complete
2025-10-16 22:27:33,365 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpzqwu7dz1/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmpzqwu7dz1/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpzqwu7dz1/training/training_nphotons_1000000.0_single'), sequential_sampling=False)
2025-10-16 22:27:33,365 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-16 22:27:33,365 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-16 22:27:33,365 - INFO - Loading data from /tmp/tmpzqwu7dz1/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-16 22:27:33,371 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-16 22:27:33,371 - INFO - Randomly subsampled 50 images
2025-10-16 22:27:33,383 - DEBUG - Loaded metadata from /tmp/tmpzqwu7dz1/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 22:27:33,383 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-16 22:27:33,383 - INFO - Loading data from /tmp/tmpzqwu7dz1/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-16 22:27:33,389 - INFO - Using full dataset of 100 images
2025-10-16 22:27:33,389 - INFO - Loaded test data from /tmp/tmpzqwu7dz1/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 22:27:33,389 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-16 22:27:33,389 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 22:27:33,389 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-16 22:27:33,389 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 22:27:33,389 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 22:27:33,389 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 22:27:33,389 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 22:27:33,389 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 22:27:33,389 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-16 22:27:33,389 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-16 22:27:33,389 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-16 22:27:33,390 - INFO - Using all 50 points as seeds
2025-10-16 22:27:33,390 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 22:27:33,390 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 22:27:33,390 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 22:27:33,390 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 22:27:33,390 - INFO - Generated 50 groups efficiently
2025-10-16 22:27:35,005 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-16 22:27:35,005 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 22:27:35,005 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-16 22:27:35,005 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 22:27:35,005 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 22:27:35,005 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 22:27:35,005 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 22:27:35,005 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 22:27:35,005 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-16 22:27:35,005 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-16 22:27:35,005 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-16 22:27:35,005 - INFO - Sampled 50 seed points from 100 total points
2025-10-16 22:27:35,005 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 22:27:35,005 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 22:27:35,005 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 22:27:35,005 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 22:27:35,005 - INFO - Generated 50 groups efficiently
2025-10-16 22:27:37,088 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:27:39,021 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:27:46,430 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:27:49,742 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 22:27:49,759 - DEBUG - Creating converter from 5 to 3
2025-10-16 22:27:50,920 - INFO - Outputs saved to /tmp/tmpzqwu7dz1/training/training_nphotons_1000000.0_single
2025-10-16 22:28:30,130 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 22:28:30,326 - DEBUG - Creating converter from 7 to 5
2025-10-16 22:28:30,326 - DEBUG - Creating converter from 5 to 7
2025-10-16 22:28:30,326 - DEBUG - Creating converter from 7 to 5
2025-10-16 22:28:30,326 - DEBUG - Creating converter from 5 to 7
2025-10-16 22:28:31,015 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 22:28:31,023 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 22:28:31,024 - DEBUG - interactive is False
2025-10-16 22:28:31,024 - DEBUG - platform is linux
2025-10-16 22:28:31,055 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 22:28:31,056 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 22:28:32,169 - DEBUG - Field: train_data_file
2025-10-16 22:28:32,169 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 22:28:32,169 - DEBUG - Field default: None
2025-10-16 22:28:32,169 - DEBUG - Field: test_data_file
2025-10-16 22:28:32,169 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 22:28:32,169 - DEBUG - Field default: None
2025-10-16 22:28:32,169 - DEBUG - Field: output_dir
2025-10-16 22:28:32,169 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 22:28:32,169 - DEBUG - Field default: training_outputs
2025-10-16 22:28:32,170 - DEBUG - Converting path value: /tmp/tmpqonuu5p_/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 22:28:32,170 - DEBUG - Converting path value: /tmp/tmpqonuu5p_/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 22:28:32,170 - DEBUG - Converting path value: /tmp/tmpqonuu5p_/training/training_mismatch_test
2025-10-16 22:28:32,170 - DEBUG - YAML config: {}
2025-10-16 22:28:32,170 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpqonuu5p_/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpqonuu5p_/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpqonuu5p_/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-16 22:28:32,170 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpqonuu5p_/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmpqonuu5p_/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpqonuu5p_/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-16 22:28:32,170 - INFO - Configuration setup complete
2025-10-16 22:28:32,170 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpqonuu5p_/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmpqonuu5p_/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpqonuu5p_/training/training_mismatch_test'), sequential_sampling=False)
2025-10-16 22:28:32,170 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-16 22:28:32,170 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-16 22:28:32,170 - INFO - Loading data from /tmp/tmpqonuu5p_/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-16 22:28:32,176 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-16 22:28:32,176 - INFO - Randomly subsampled 50 images
2025-10-16 22:28:32,186 - DEBUG - Loaded metadata from /tmp/tmpqonuu5p_/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 22:28:32,186 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-16 22:28:32,186 - INFO - Loading data from /tmp/tmpqonuu5p_/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-16 22:28:32,191 - INFO - Using full dataset of 100 images
2025-10-16 22:28:32,191 - INFO - Loaded test data from /tmp/tmpqonuu5p_/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 22:28:32,191 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-16 22:28:32,191 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 22:28:32,191 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-16 22:28:32,192 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 22:28:32,192 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 22:28:32,192 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 22:28:32,192 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 22:28:32,192 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 22:28:32,192 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-16 22:28:32,192 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-16 22:28:32,192 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-16 22:28:32,192 - INFO - Using all 50 points as seeds
2025-10-16 22:28:32,192 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 22:28:32,192 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 22:28:32,192 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 22:28:32,192 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 22:28:32,192 - INFO - Generated 50 groups efficiently
2025-10-16 22:28:33,862 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-16 22:28:33,862 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 22:28:33,862 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-16 22:28:33,862 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 22:28:33,862 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 22:28:33,862 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 22:28:33,862 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 22:28:33,862 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 22:28:33,862 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-16 22:28:33,862 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-16 22:28:33,862 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-16 22:28:33,862 - INFO - Sampled 50 seed points from 100 total points
2025-10-16 22:28:33,862 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 22:28:33,862 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 22:28:33,862 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 22:28:33,862 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 22:28:33,862 - INFO - Generated 50 groups efficiently
2025-10-16 22:28:35,925 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:28:37,841 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:28:45,464 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:28:48,806 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 22:28:48,823 - DEBUG - Creating converter from 5 to 3
2025-10-16 22:28:49,971 - INFO - Outputs saved to /tmp/tmpqonuu5p_/training/training_mismatch_test
2025-10-16 22:30:48,753 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 22:30:48,943 - DEBUG - Creating converter from 7 to 5
2025-10-16 22:30:48,943 - DEBUG - Creating converter from 5 to 7
2025-10-16 22:30:48,943 - DEBUG - Creating converter from 7 to 5
2025-10-16 22:30:48,943 - DEBUG - Creating converter from 5 to 7
2025-10-16 22:30:49,630 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 22:30:49,638 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 22:30:49,638 - DEBUG - interactive is False
2025-10-16 22:30:49,639 - DEBUG - platform is linux
2025-10-16 22:30:49,671 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 22:30:49,672 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 22:30:50,778 - DEBUG - Field: train_data_file
2025-10-16 22:30:50,778 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 22:30:50,778 - DEBUG - Field default: None
2025-10-16 22:30:50,778 - DEBUG - Field: test_data_file
2025-10-16 22:30:50,778 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 22:30:50,778 - DEBUG - Field default: None
2025-10-16 22:30:50,778 - DEBUG - Field: output_dir
2025-10-16 22:30:50,778 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 22:30:50,778 - DEBUG - Field default: training_outputs
2025-10-16 22:30:50,779 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-16 22:30:50,779 - DEBUG - Converting path value: /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-16 22:30:50,779 - DEBUG - Converting path value: /tmp/tmp0qc6tlm6/training_outputs
2025-10-16 22:30:50,779 - DEBUG - YAML config: {}
2025-10-16 22:30:50,779 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_groups': None, 'n_images': 64, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp0qc6tlm6/training_outputs'), 'sequential_sampling': False}
2025-10-16 22:30:50,779 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'test_data_file': PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'n_images': 64, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp0qc6tlm6/training_outputs'), 'sequential_sampling': False}
2025-10-16 22:30:50,779 - INFO - Configuration setup complete
2025-10-16 22:30:50,779 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), test_data_file=PosixPath('/home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=64, n_images=64, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp0qc6tlm6/training_outputs'), sequential_sampling=False)
2025-10-16 22:30:50,779 - INFO - Legacy mode: using 64 groups (gridsize=1)
2025-10-16 22:30:50,779 - INFO - Starting training with n_subsample=64, n_groups=64, stitching=disabled
2025-10-16 22:30:50,779 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=64, n_subsample=64
2025-10-16 22:30:50,797 - INFO - Independent sampling: subsampling 64 images from 1087 total
2025-10-16 22:30:50,797 - INFO - Randomly subsampled 64 images
2025-10-16 22:30:50,815 - INFO - Loading data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz with n_images=None, n_subsample=None
2025-10-16 22:30:50,830 - INFO - Using full dataset of 1087 images
2025-10-16 22:30:50,846 - INFO - Loaded test data from /home/ollie/Documents/PtychoPINN2/ptycho/datasets/Run1084_recon3_postPC_shrunk_3.npz
2025-10-16 22:30:50,846 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=64, C=1, K=4
2025-10-16 22:30:50,846 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 22:30:50,846 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 64 = False
2025-10-16 22:30:50,846 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 22:30:50,846 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 22:30:50,846 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 22:30:50,847 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 22:30:50,847 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-16 22:30:50,847 - INFO - Generating 64 groups efficiently from 64 points (K=4, C=1)
2025-10-16 22:30:50,847 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 64 points
2025-10-16 22:30:50,847 - INFO - [OVERSAMPLING DEBUG] Using all 64 points as seeds (no sampling needed)
2025-10-16 22:30:50,847 - INFO - Using all 64 points as seeds
2025-10-16 22:30:50,847 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 22:30:50,847 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-16 22:30:50,847 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-16 22:30:50,847 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-16 22:30:50,847 - INFO - Generated 64 groups efficiently
2025-10-16 22:30:52,496 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=64, n_points=1087, C=1, K=4
2025-10-16 22:30:52,496 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 22:30:52,496 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 64 > 1087 = False
2025-10-16 22:30:52,496 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 22:30:52,496 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 22:30:52,496 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 22:30:52,496 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 22:30:52,496 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=64, K=4, C=1
2025-10-16 22:30:52,496 - INFO - Generating 64 groups efficiently from 1087 points (K=4, C=1)
2025-10-16 22:30:52,496 - INFO - [OVERSAMPLING DEBUG] Standard case: using 64 groups from 1087 points
2025-10-16 22:30:52,496 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 64 seed points
2025-10-16 22:30:52,496 - INFO - Sampled 64 seed points from 1087 total points
2025-10-16 22:30:52,496 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 22:30:52,496 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 64 groups
2025-10-16 22:30:52,496 - INFO - Successfully generated 64 groups with shape (64, 1)
2025-10-16 22:30:52,496 - INFO - [OVERSAMPLING DEBUG] Generated 64 groups in total
2025-10-16 22:30:52,496 - INFO - Generated 64 groups efficiently
2025-10-16 22:30:54,614 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:30:56,577 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:31:04,169 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:31:06,215 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 22:31:06,462 - DEBUG - Creating converter from 5 to 3
2025-10-16 22:31:07,625 - INFO - Outputs saved to /tmp/tmp0qc6tlm6/training_outputs
2025-10-16 22:31:33,931 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 22:31:34,126 - DEBUG - Creating converter from 7 to 5
2025-10-16 22:31:34,126 - DEBUG - Creating converter from 5 to 7
2025-10-16 22:31:34,126 - DEBUG - Creating converter from 7 to 5
2025-10-16 22:31:34,126 - DEBUG - Creating converter from 5 to 7
2025-10-16 22:31:34,804 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 22:31:34,812 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 22:31:34,812 - DEBUG - interactive is False
2025-10-16 22:31:34,812 - DEBUG - platform is linux
2025-10-16 22:31:34,843 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 22:31:34,844 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 22:31:35,961 - DEBUG - Field: train_data_file
2025-10-16 22:31:35,961 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 22:31:35,961 - DEBUG - Field default: None
2025-10-16 22:31:35,961 - DEBUG - Field: test_data_file
2025-10-16 22:31:35,961 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 22:31:35,961 - DEBUG - Field default: None
2025-10-16 22:31:35,961 - DEBUG - Field: output_dir
2025-10-16 22:31:35,961 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 22:31:35,961 - DEBUG - Field default: training_outputs
2025-10-16 22:31:35,961 - DEBUG - Converting path value: /tmp/tmpjvnh7cyd/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 22:31:35,961 - DEBUG - Converting path value: /tmp/tmpjvnh7cyd/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 22:31:35,961 - DEBUG - Converting path value: /tmp/tmpjvnh7cyd/training/training_nphotons_500000.0_e2e
2025-10-16 22:31:35,961 - DEBUG - YAML config: {}
2025-10-16 22:31:35,961 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpjvnh7cyd/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpjvnh7cyd/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpjvnh7cyd/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-16 22:31:35,961 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpjvnh7cyd/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'test_data_file': PosixPath('/tmp/tmpjvnh7cyd/simulation/simulated_data_nphotons_500000.0_e2e.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 500000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpjvnh7cyd/training/training_nphotons_500000.0_e2e'), 'sequential_sampling': False}
2025-10-16 22:31:35,961 - INFO - Configuration setup complete
2025-10-16 22:31:35,962 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpjvnh7cyd/simulation/simulated_data_nphotons_500000.0_e2e.npz'), test_data_file=PosixPath('/tmp/tmpjvnh7cyd/simulation/simulated_data_nphotons_500000.0_e2e.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=500000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpjvnh7cyd/training/training_nphotons_500000.0_e2e'), sequential_sampling=False)
2025-10-16 22:31:35,962 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-16 22:31:35,962 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-16 22:31:35,962 - INFO - Loading data from /tmp/tmpjvnh7cyd/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=50, n_subsample=50
2025-10-16 22:31:35,968 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-16 22:31:35,968 - INFO - Randomly subsampled 50 images
2025-10-16 22:31:35,980 - DEBUG - Loaded metadata from /tmp/tmpjvnh7cyd/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 22:31:35,980 - INFO - Overriding nphotons from config (5.0e+05) with value from dataset metadata: 5.0e+05
2025-10-16 22:31:35,980 - INFO - Loading data from /tmp/tmpjvnh7cyd/simulation/simulated_data_nphotons_500000.0_e2e.npz with n_images=None, n_subsample=None
2025-10-16 22:31:35,986 - INFO - Using full dataset of 100 images
2025-10-16 22:31:35,986 - INFO - Loaded test data from /tmp/tmpjvnh7cyd/simulation/simulated_data_nphotons_500000.0_e2e.npz
2025-10-16 22:31:35,986 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-16 22:31:35,986 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 22:31:35,986 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-16 22:31:35,986 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 22:31:35,986 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 22:31:35,986 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 22:31:35,986 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 22:31:35,986 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 22:31:35,986 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-16 22:31:35,986 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-16 22:31:35,987 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-16 22:31:35,987 - INFO - Using all 50 points as seeds
2025-10-16 22:31:35,987 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 22:31:35,987 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 22:31:35,987 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 22:31:35,987 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 22:31:35,987 - INFO - Generated 50 groups efficiently
2025-10-16 22:31:37,641 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-16 22:31:37,641 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 22:31:37,641 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-16 22:31:37,641 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 22:31:37,641 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 22:31:37,641 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 22:31:37,641 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 22:31:37,641 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 22:31:37,641 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-16 22:31:37,641 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-16 22:31:37,642 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-16 22:31:37,642 - INFO - Sampled 50 seed points from 100 total points
2025-10-16 22:31:37,642 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 22:31:37,642 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 22:31:37,642 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 22:31:37,642 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 22:31:37,642 - INFO - Generated 50 groups efficiently
2025-10-16 22:31:39,727 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:31:41,703 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:31:49,190 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:31:52,526 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 22:31:52,545 - DEBUG - Creating converter from 5 to 3
2025-10-16 22:31:53,704 - INFO - Outputs saved to /tmp/tmpjvnh7cyd/training/training_nphotons_500000.0_e2e
2025-10-16 22:32:13,757 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 22:32:13,955 - DEBUG - Creating converter from 7 to 5
2025-10-16 22:32:13,955 - DEBUG - Creating converter from 5 to 7
2025-10-16 22:32:13,955 - DEBUG - Creating converter from 7 to 5
2025-10-16 22:32:13,955 - DEBUG - Creating converter from 5 to 7
2025-10-16 22:32:14,643 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 22:32:14,651 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 22:32:14,652 - DEBUG - interactive is False
2025-10-16 22:32:14,652 - DEBUG - platform is linux
2025-10-16 22:32:14,685 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 22:32:14,687 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 22:32:15,842 - DEBUG - Field: train_data_file
2025-10-16 22:32:15,842 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 22:32:15,842 - DEBUG - Field default: None
2025-10-16 22:32:15,842 - DEBUG - Field: test_data_file
2025-10-16 22:32:15,842 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 22:32:15,842 - DEBUG - Field default: None
2025-10-16 22:32:15,842 - DEBUG - Field: output_dir
2025-10-16 22:32:15,842 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 22:32:15,842 - DEBUG - Field default: training_outputs
2025-10-16 22:32:15,842 - DEBUG - Converting path value: /tmp/tmpyixynfe5/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 22:32:15,843 - DEBUG - Converting path value: /tmp/tmpyixynfe5/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 22:32:15,843 - DEBUG - Converting path value: /tmp/tmpyixynfe5/training/training_nphotons_1000000.0_single
2025-10-16 22:32:15,843 - DEBUG - YAML config: {}
2025-10-16 22:32:15,843 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpyixynfe5/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpyixynfe5/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpyixynfe5/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-16 22:32:15,843 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmpyixynfe5/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'test_data_file': PosixPath('/tmp/tmpyixynfe5/simulation/simulated_data_nphotons_1000000.0_single.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmpyixynfe5/training/training_nphotons_1000000.0_single'), 'sequential_sampling': False}
2025-10-16 22:32:15,843 - INFO - Configuration setup complete
2025-10-16 22:32:15,843 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmpyixynfe5/simulation/simulated_data_nphotons_1000000.0_single.npz'), test_data_file=PosixPath('/tmp/tmpyixynfe5/simulation/simulated_data_nphotons_1000000.0_single.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmpyixynfe5/training/training_nphotons_1000000.0_single'), sequential_sampling=False)
2025-10-16 22:32:15,843 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-16 22:32:15,843 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-16 22:32:15,843 - INFO - Loading data from /tmp/tmpyixynfe5/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=50, n_subsample=50
2025-10-16 22:32:15,850 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-16 22:32:15,850 - INFO - Randomly subsampled 50 images
2025-10-16 22:32:15,861 - DEBUG - Loaded metadata from /tmp/tmpyixynfe5/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 22:32:15,861 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+06
2025-10-16 22:32:15,861 - INFO - Loading data from /tmp/tmpyixynfe5/simulation/simulated_data_nphotons_1000000.0_single.npz with n_images=None, n_subsample=None
2025-10-16 22:32:15,867 - INFO - Using full dataset of 100 images
2025-10-16 22:32:15,867 - INFO - Loaded test data from /tmp/tmpyixynfe5/simulation/simulated_data_nphotons_1000000.0_single.npz
2025-10-16 22:32:15,868 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-16 22:32:15,868 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 22:32:15,868 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-16 22:32:15,868 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 22:32:15,868 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 22:32:15,868 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 22:32:15,868 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 22:32:15,868 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 22:32:15,868 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-16 22:32:15,868 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-16 22:32:15,868 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-16 22:32:15,868 - INFO - Using all 50 points as seeds
2025-10-16 22:32:15,868 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 22:32:15,868 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 22:32:15,868 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 22:32:15,868 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 22:32:15,868 - INFO - Generated 50 groups efficiently
2025-10-16 22:32:17,497 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-16 22:32:17,497 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 22:32:17,497 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-16 22:32:17,497 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 22:32:17,497 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 22:32:17,497 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 22:32:17,497 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 22:32:17,497 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 22:32:17,497 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-16 22:32:17,497 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-16 22:32:17,497 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-16 22:32:17,497 - INFO - Sampled 50 seed points from 100 total points
2025-10-16 22:32:17,497 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 22:32:17,497 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 22:32:17,498 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 22:32:17,498 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 22:32:17,498 - INFO - Generated 50 groups efficiently
2025-10-16 22:32:19,619 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:32:21,568 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:32:29,180 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:32:32,486 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 22:32:32,505 - DEBUG - Creating converter from 5 to 3
2025-10-16 22:32:33,661 - INFO - Outputs saved to /tmp/tmpyixynfe5/training/training_nphotons_1000000.0_single
2025-10-16 22:33:12,561 - DEBUG - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2025-10-16 22:33:12,744 - DEBUG - Creating converter from 7 to 5
2025-10-16 22:33:12,744 - DEBUG - Creating converter from 5 to 7
2025-10-16 22:33:12,744 - DEBUG - Creating converter from 7 to 5
2025-10-16 22:33:12,744 - DEBUG - Creating converter from 5 to 7
2025-10-16 22:33:13,411 - DEBUG - matplotlib data path: /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/matplotlib/mpl-data
2025-10-16 22:33:13,418 - DEBUG - CONFIGDIR=/home/ollie/.config/matplotlib
2025-10-16 22:33:13,418 - DEBUG - interactive is False
2025-10-16 22:33:13,418 - DEBUG - platform is linux
2025-10-16 22:33:13,449 - DEBUG - CACHEDIR=/home/ollie/.cache/matplotlib
2025-10-16 22:33:13,450 - DEBUG - Using fontManager instance from /home/ollie/.cache/matplotlib/fontlist-v390.json
2025-10-16 22:33:14,567 - DEBUG - Field: train_data_file
2025-10-16 22:33:14,567 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 22:33:14,567 - DEBUG - Field default: None
2025-10-16 22:33:14,567 - DEBUG - Field: test_data_file
2025-10-16 22:33:14,567 - DEBUG - Field type: typing.Optional[pathlib.Path]
2025-10-16 22:33:14,567 - DEBUG - Field default: None
2025-10-16 22:33:14,567 - DEBUG - Field: output_dir
2025-10-16 22:33:14,567 - DEBUG - Field type: <class 'pathlib.Path'>
2025-10-16 22:33:14,567 - DEBUG - Field default: training_outputs
2025-10-16 22:33:14,567 - DEBUG - Converting path value: /tmp/tmp3es5ta5u/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 22:33:14,567 - DEBUG - Converting path value: /tmp/tmp3es5ta5u/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 22:33:14,567 - DEBUG - Converting path value: /tmp/tmp3es5ta5u/training/training_mismatch_test
2025-10-16 22:33:14,568 - DEBUG - YAML config: {}
2025-10-16 22:33:14,568 - DEBUG - CLI arguments: {'config': None, 'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp3es5ta5u/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmp3es5ta5u/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_groups': None, 'n_images': 50, 'n_subsample': None, 'subsample_seed': None, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp3es5ta5u/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-16 22:33:14,568 - DEBUG - Merged config: {'do_stitching': False, 'quiet': True, 'verbose': False, 'console_level': 'INFO', 'N': 64, 'gridsize': 1, 'n_filters_scale': 2, 'model_type': 'pinn', 'amp_activation': 'sigmoid', 'object_big': True, 'probe_big': True, 'probe_mask': False, 'pad_object': True, 'probe_scale': 4.0, 'gaussian_smoothing_sigma': 0.0, 'train_data_file': PosixPath('/tmp/tmp3es5ta5u/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'test_data_file': PosixPath('/tmp/tmp3es5ta5u/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), 'batch_size': 16, 'nepochs': 2, 'mae_weight': 0.0, 'nll_weight': 1.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000.0, 'n_images': 50, 'neighbor_count': 4, 'positions_provided': True, 'probe_trainable': False, 'intensity_scale_trainable': True, 'output_dir': PosixPath('/tmp/tmp3es5ta5u/training/training_mismatch_test'), 'sequential_sampling': False}
2025-10-16 22:33:14,568 - INFO - Configuration setup complete
2025-10-16 22:33:14,568 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=1, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('/tmp/tmp3es5ta5u/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), test_data_file=PosixPath('/tmp/tmp3es5ta5u/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz'), batch_size=16, nepochs=2, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000.0, n_groups=50, n_images=50, n_subsample=None, subsample_seed=None, neighbor_count=4, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('/tmp/tmp3es5ta5u/training/training_mismatch_test'), sequential_sampling=False)
2025-10-16 22:33:14,568 - INFO - Legacy mode: using 50 groups (gridsize=1)
2025-10-16 22:33:14,568 - INFO - Starting training with n_subsample=50, n_groups=50, stitching=disabled
2025-10-16 22:33:14,568 - INFO - Loading data from /tmp/tmp3es5ta5u/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=50, n_subsample=50
2025-10-16 22:33:14,573 - INFO - Independent sampling: subsampling 50 images from 100 total
2025-10-16 22:33:14,573 - INFO - Randomly subsampled 50 images
2025-10-16 22:33:14,584 - DEBUG - Loaded metadata from /tmp/tmp3es5ta5u/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 22:33:14,584 - INFO - Overriding nphotons from config (1.0e+06) with value from dataset metadata: 1.0e+04
2025-10-16 22:33:14,584 - INFO - Loading data from /tmp/tmp3es5ta5u/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz with n_images=None, n_subsample=None
2025-10-16 22:33:14,588 - INFO - Using full dataset of 100 images
2025-10-16 22:33:14,589 - INFO - Loaded test data from /tmp/tmp3es5ta5u/simulation/simulated_data_nphotons_10000.0_train_mismatch.npz
2025-10-16 22:33:14,589 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=50, C=1, K=4
2025-10-16 22:33:14,589 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 22:33:14,589 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 50 = False
2025-10-16 22:33:14,589 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 22:33:14,589 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 22:33:14,589 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 22:33:14,589 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 22:33:14,589 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 22:33:14,589 - INFO - Generating 50 groups efficiently from 50 points (K=4, C=1)
2025-10-16 22:33:14,589 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 50 points
2025-10-16 22:33:14,589 - INFO - [OVERSAMPLING DEBUG] Using all 50 points as seeds (no sampling needed)
2025-10-16 22:33:14,589 - INFO - Using all 50 points as seeds
2025-10-16 22:33:14,589 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 22:33:14,590 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 22:33:14,590 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 22:33:14,590 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 22:33:14,590 - INFO - Generated 50 groups efficiently
2025-10-16 22:33:16,226 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=50, n_points=100, C=1, K=4
2025-10-16 22:33:16,226 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2025-10-16 22:33:16,226 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 50 > 100 = False
2025-10-16 22:33:16,226 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2025-10-16 22:33:16,226 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-10-16 22:33:16,226 - INFO - Using efficient random sampling strategy for gridsize=1
2025-10-16 22:33:16,227 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-10-16 22:33:16,227 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=50, K=4, C=1
2025-10-16 22:33:16,227 - INFO - Generating 50 groups efficiently from 100 points (K=4, C=1)
2025-10-16 22:33:16,227 - INFO - [OVERSAMPLING DEBUG] Standard case: using 50 groups from 100 points
2025-10-16 22:33:16,227 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 50 seed points
2025-10-16 22:33:16,227 - INFO - Sampled 50 seed points from 100 total points
2025-10-16 22:33:16,227 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-10-16 22:33:16,227 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 50 groups
2025-10-16 22:33:16,227 - INFO - Successfully generated 50 groups with shape (50, 1)
2025-10-16 22:33:16,227 - INFO - [OVERSAMPLING DEBUG] Generated 50 groups in total
2025-10-16 22:33:16,227 - INFO - Generated 50 groups efficiently
2025-10-16 22:33:18,335 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:33:20,294 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:33:27,744 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-10-16 22:33:31,038 - INFO - Skipping image stitching (disabled or no test data available)
2025-10-16 22:33:31,054 - DEBUG - Creating converter from 5 to 3
2025-10-16 22:33:32,200 - INFO - Outputs saved to /tmp/tmp3es5ta5u/training/training_mismatch_test
