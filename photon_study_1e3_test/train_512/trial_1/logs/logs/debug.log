2025-08-26 16:46:13,581 - INFO - Configuration: phase_align_method='plane', frc_sigma=0.0
2025-08-26 16:46:13,581 - INFO - Registration: enabled
2025-08-26 16:46:13,581 - INFO - NPZ output: raw=enabled, aligned=enabled
2025-08-26 16:46:13,581 - INFO - Initializing configuration before data loading...
2025-08-26 16:46:13,581 - INFO - Initialized with gridsize=1, n_images=512
2025-08-26 16:46:13,581 - INFO - Loading test data from photon_grid_study_regenerated_20250826_163348/data_p1e3.npz...
2025-08-26 16:46:13,581 - INFO - Loading data from photon_grid_study_regenerated_20250826_163348/data_p1e3.npz with n_images=512
2025-08-26 16:46:13,647 - INFO - Passing full dataset to RawData for unified sampling (gridsize=1)
2025-08-26 16:46:13,647 - INFO - diff3d shape: (4096, 64, 64)
2025-08-26 16:46:13,647 - INFO - probeGuess shape: (64, 64)
2025-08-26 16:46:13,647 - INFO - scan_index shape: (4096,)
2025-08-26 16:46:13,647 - INFO - objectGuess shape: (232, 232)
2025-08-26 16:46:13,647 - INFO - xcoords shape: (4096,)
2025-08-26 16:46:13,647 - INFO - ycoords shape: (4096,)
2025-08-26 16:46:13,647 - INFO - xcoords_start shape: (4096,)
2025-08-26 16:46:13,647 - INFO - ycoords_start shape: (4096,)
2025-08-26 16:46:13,647 - INFO - Using stitch_crop_size M=20 (N=64)
2025-08-26 16:46:13,647 - INFO - DEBUG:
2025-08-26 16:46:13,647 - INFO - nsamples: 4096, gridsize: 1 (using efficient random sample-then-group strategy)
2025-08-26 16:46:13,647 - INFO - Using efficient random sampling strategy for gridsize=1
2025-08-26 16:46:13,647 - INFO - Generating 4096 groups efficiently from 4096 points (K=4, C=1)
2025-08-26 16:46:13,647 - INFO - Using all 4096 points as seeds
2025-08-26 16:46:13,647 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2025-08-26 16:46:13,647 - INFO - Successfully generated 4096 groups with shape (4096, 1)
2025-08-26 16:46:13,647 - INFO - Generated 4096 groups efficiently
2025-08-26 16:46:13,657 - INFO - INFO: 'Y' array not found. Generating ground truth patches from 'objectGuess' as a fallback.
2025-08-26 16:46:29,483 - INFO - neighbor-sampled diffraction shape
2025-08-26 16:46:29,483 - INFO - (4096, 64, 64, 1)
2025-08-26 16:46:29,576 - INFO - loader: using provided ground truth patches.
2025-08-26 16:46:29,950 - INFO - INFO:
2025-08-26 16:46:29,950 - INFO - None
2025-08-26 16:46:29,950 - INFO - <PtychoDataContainer X=(4096, 64, 64, 1) Y_I=(4096, 64, 64, 1) Y_phi=(4096, 64, 64, 1) norm_Y_I=() coords_nominal=(4096, 1, 2, 1) coords_true=(4096, 1, 2, 1) nn_indices=(4096, 1) mean=2047.500 global_offsets=(4096, 1, 2, 1) mean=115.130 local_offsets=(4096, 1, 2, 1) mean=0.000 probe=(64, 64) mean_amplitude=0.009>
2025-08-26 16:46:29,951 - INFO - Loading PtychoPINN model from photon_study_1e3_test/train_512/trial_1/pinn_run...
2025-08-26 16:46:29,951 - INFO - Loading model from: photon_study_1e3_test/train_512/trial_1/pinn_run
2025-08-26 16:46:29,951 - DEBUG - Model archive path: photon_study_1e3_test/train_512/trial_1/pinn_run/wts.h5.zip
2025-08-26 16:46:30,781 - INFO - Model: "functional"
2025-08-26 16:46:30,804 - INFO - ┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ input (InputLayer)  │ (None, 64, 64, 1) │          0 │ -                 │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ intensity_scaler    │ (None, 64, 64, 1) │          0 │ input[0][0]       │
│ (IntensityScaler)   │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d (Conv2D)     │ (None, 64, 64,    │        640 │ intensity_scaler… │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_1 (Conv2D)   │ (None, 64, 64,    │     36,928 │ conv2d[0][0]      │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d       │ (None, 32, 32,    │          0 │ conv2d_1[0][0]    │
│ (MaxPooling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_2 (Conv2D)   │ (None, 32, 32,    │     73,856 │ max_pooling2d[0]… │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_3 (Conv2D)   │ (None, 32, 32,    │    147,584 │ conv2d_2[0][0]    │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d_1     │ (None, 16, 16,    │          0 │ conv2d_3[0][0]    │
│ (MaxPooling2D)      │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_4 (Conv2D)   │ (None, 16, 16,    │    295,168 │ max_pooling2d_1[… │
│                     │ 256)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_5 (Conv2D)   │ (None, 16, 16,    │    590,080 │ conv2d_4[0][0]    │
│                     │ 256)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d_2     │ (None, 8, 8, 256) │          0 │ conv2d_5[0][0]    │
│ (MaxPooling2D)      │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_8 (Conv2D)   │ (None, 8, 8, 128) │    295,040 │ max_pooling2d_2[… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_16 (Conv2D)  │ (None, 8, 8, 128) │    295,040 │ max_pooling2d_2[… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_9 (Conv2D)   │ (None, 8, 8, 128) │    147,584 │ conv2d_8[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_17 (Conv2D)  │ (None, 8, 8, 128) │    147,584 │ conv2d_16[0][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d       │ (None, 16, 16,    │          0 │ conv2d_9[0][0]    │
│ (UpSampling2D)      │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_3     │ (None, 16, 16,    │          0 │ conv2d_17[0][0]   │
│ (UpSampling2D)      │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_10 (Conv2D)  │ (None, 16, 16,    │     73,792 │ up_sampling2d[0]… │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_18 (Conv2D)  │ (None, 16, 16,    │     73,792 │ up_sampling2d_3[… │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_11 (Conv2D)  │ (None, 16, 16,    │     36,928 │ conv2d_10[0][0]   │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_19 (Conv2D)  │ (None, 16, 16,    │     36,928 │ conv2d_18[0][0]   │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_1     │ (None, 32, 32,    │          0 │ conv2d_11[0][0]   │
│ (UpSampling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_4     │ (None, 32, 32,    │          0 │ conv2d_19[0][0]   │
│ (UpSampling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ get_item_1          │ (None, 32, 32, 4) │          0 │ up_sampling2d_1[… │
│ (GetItem)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ get_item_3          │ (None, 32, 32, 4) │          0 │ up_sampling2d_4[… │
│ (GetItem)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_12 (Conv2D)  │ (None, 32, 32,    │      2,368 │ get_item_1[0][0]  │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_20 (Conv2D)  │ (None, 32, 32,    │      2,368 │ get_item_3[0][0]  │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_13 (Conv2D)  │ (None, 32, 32,    │     36,928 │ conv2d_12[0][0]   │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_21 (Conv2D)  │ (None, 32, 32,    │     36,928 │ conv2d_20[0][0]   │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_2     │ (None, 64, 64,    │          0 │ conv2d_13[0][0]   │
│ (UpSampling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_5     │ (None, 64, 64,    │          0 │ conv2d_21[0][0]   │
│ (UpSampling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ get_item (GetItem)  │ (None, 32, 32,    │          0 │ up_sampling2d_1[… │
│                     │ 60)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_7 (Conv2D)   │ (None, 64, 64, 1) │        577 │ up_sampling2d_2[… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ get_item_2          │ (None, 32, 32,    │          0 │ up_sampling2d_4[… │
│ (GetItem)           │ 60)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_15 (Conv2D)  │ (None, 64, 64, 1) │        577 │ up_sampling2d_5[… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_6 (Conv2D)   │ (None, 32, 32, 1) │        541 │ get_item[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ silu (Silu)         │ (None, 64, 64, 1) │          0 │ conv2d_7[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_14 (Conv2D)  │ (None, 32, 32, 1) │        541 │ get_item_2[0][0]  │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ silu_1 (Silu)       │ (None, 64, 64, 1) │          0 │ conv2d_15[0][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ amp                 │ (None, 32, 32, 1) │          0 │ conv2d_6[0][0]    │
│ (ActivationLayer)   │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ center_mask_layer   │ (None, 64, 64, 1) │          0 │ silu[0][0]        │
│ (CenterMaskLayer)   │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ phi                 │ (None, 32, 32, 1) │          0 │ conv2d_14[0][0]   │
│ (ActivationLayer)   │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ center_mask_layer_1 │ (None, 64, 64, 1) │          0 │ silu_1[0][0]      │
│ (CenterMaskLayer)   │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ amp_padded          │ (None, 64, 64, 1) │          0 │ amp[0][0]         │
│ (ZeroPadding2D)     │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ multiply (Multiply) │ (None, 64, 64, 1) │          0 │ silu[0][0],       │
│                     │                   │            │ center_mask_laye… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ phase_padded        │ (None, 64, 64, 1) │          0 │ phi[0][0]         │
│ (ZeroPadding2D)     │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ multiply_1          │ (None, 64, 64, 1) │          0 │ silu_1[0][0],     │
│ (Multiply)          │                   │            │ center_mask_laye… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ add (Add)           │ (None, 64, 64, 1) │          0 │ amp_padded[0][0], │
│                     │                   │            │ multiply[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ add_1 (Add)         │ (None, 64, 64, 1) │          0 │ phase_padded[0][… │
│                     │                   │            │ multiply_1[0][0]  │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ obj                 │ (None, 64, 64, 1) │          0 │ add[0][0],        │
│ (CombineComplexLay… │                   │            │ add_1[0][0]       │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ input_positions     │ (None, 1, 2, 1)   │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ padded_obj_2        │ (None, 74, 74, 1) │          0 │ obj[0][0],        │
│ (ReassemblePatches… │                   │            │ input_positions[… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ padded_objs_with_o… │ (None, 64, 64, 1) │          0 │ padded_obj_2[0][… │
│ (ExtractPatchesPos… │                   │            │ input_positions[… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ probe_illumination  │ [(None, 64, 64,   │          0 │ padded_objs_with… │
│ (ProbeIllumination) │ 1), (None, 64,    │            │                   │
│                     │ 64, 1)]           │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ pred_amplitude      │ [(None, 64, 64,   │          0 │ probe_illuminati… │
│ (PadAndDiffractLay… │ 1), (None, 64,    │            │                   │
│                     │ 64, 1)]           │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ pred_diff_channels  │ (None, 64, 64, 1) │          0 │ pred_amplitude[0… │
│ (FlatToChannelLaye… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ intensity_scaler_i… │ (None, 64, 64, 1) │          0 │ pred_diff_channe… │
│ (IntensityScaler_i… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ trimmed_obj         │ (None, 64, 64, 1) │          0 │ padded_obj_2[0][… │
│ (TrimReconstructio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ pred_intensity      │ (None, 64, 64, 1) │          0 │ intensity_scaler… │
│ (SquareLayer)       │                   │            │                   │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
2025-08-26 16:46:30,804 - INFO - Total params: 2,331,772 (8.90 MB)
2025-08-26 16:46:30,804 - INFO - Trainable params: 2,331,772 (8.90 MB)
2025-08-26 16:46:30,804 - INFO - Non-trainable params: 0 (0.00 B)
2025-08-26 16:46:30,804 - INFO - None
2025-08-26 16:46:30,982 - ERROR - /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py:421: UserWarning: `build()` was called on layer 'center_mask_layer', however the layer does not have a `build()` method implemented and it looks like it has unbuilt state. This will cause the layer to be marked as built, despite not being actually built, which may cause failures down the line. Make sure to implement a proper `build()` method.
  warnings.warn(
2025-08-26 16:46:30,983 - ERROR - /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py:421: UserWarning: `build()` was called on layer 'center_mask_layer_1', however the layer does not have a `build()` method implemented and it looks like it has unbuilt state. This will cause the layer to be marked as built, despite not being actually built, which may cause failures down the line. Make sure to implement a proper `build()` method.
  warnings.warn(
2025-08-26 16:46:31,503 - INFO - Successfully loaded model from photon_study_1e3_test/train_512/trial_1/pinn_run
2025-08-26 16:46:31,503 - DEBUG - Model configuration: {'N': 64, 'offset': 4, 'gridsize': 1, 'outer_offset_train': None, 'outer_offset_test': None, 'batch_size': 16, 'nepochs': 50, 'n_filters_scale': 2, 'output_prefix': 'photon_study_1e3_test/train_512/trial_1/pinn_run', 'big_gridsize': 10, 'max_position_jitter': 10, 'sim_jitter_scale': 0.0, 'default_probe_scale': 0.7, 'mae_weight': 0.0, 'nll_weight': 1.0, 'tv_weight': 0.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000000000.0, 'nimgs_train': 9, 'nimgs_test': 3, 'data_source': 'generic', 'probe.trainable': False, 'intensity_scale.trainable': True, 'positions.provided': True, 'object.big': True, 'probe.big': True, 'probe_scale': 4.0, 'set_phi': False, 'probe.mask': False, 'pad_object': True, 'model_type': 'pinn', 'label': '', 'size': 392, 'amp_activation': 'sigmoid', 'h5_path': 'wts.h5', 'npseed': 42, 'debug': True, 'gaussian_smoothing_sigma': 0.0, 'use_xla_translate': True, 'n_images': 512, 'sequential_sampling': False, 'train_data_file_path': 'photon_grid_study_regenerated_20250826_163348/data_p1e3.npz', 'test_data_file_path': 'photon_grid_study_regenerated_20250826_163348/data_p1e3.npz', 'probe': <tf.Tensor: shape=(64, 64, 1), dtype=complex64, numpy=
array([[[ 0.2439176 -0.08340841j],
        [-0.15334016-0.02022034j],
        [ 0.09241346+0.0011082j ],
        ...,
        [-0.02631152+0.06727955j],
        [ 0.09241346+0.0011082j ],
        [-0.15334016-0.02022034j]],

       [[-0.15334016-0.02022034j],
        [ 0.15800314-0.05954654j],
        [-0.0807294 +0.01716277j],
        ...,
        [-0.01330203+0.06116205j],
        [-0.0807294 +0.01716277j],
        [ 0.15800314-0.05954654j]],

       [[ 0.09241346+0.0011082j ],
        [-0.0807294 +0.01716277j],
        [ 0.02987642-0.0004351j ],
        ...,
        [ 0.02865356-0.06024491j],
        [ 0.02987642-0.0004351j ],
        [-0.0807294 +0.01716277j]],

       ...,

       [[-0.02631152+0.06727955j],
        [-0.01330203+0.06116205j],
        [ 0.02865356-0.06024491j],
        ...,
        [-0.05017986-0.01257323j],
        [ 0.02865356-0.06024491j],
        [-0.01330203+0.06116205j]],

       [[ 0.09241346+0.0011082j ],
        [-0.0807294 +0.01716277j],
        [ 0.02987642-0.0004351j ],
        ...,
        [ 0.02865356-0.06024491j],
        [ 0.02987642-0.0004351j ],
        [-0.0807294 +0.01716277j]],

       [[-0.15334016-0.02022034j],
        [ 0.15800314-0.05954654j],
        [-0.0807294 +0.01716277j],
        ...,
        [-0.01330203+0.06116205j],
        [-0.0807294 +0.01716277j],
        [ 0.15800314-0.05954654j]]], dtype=complex64)>, 'intensity_scale': np.float32(988.21173)}
2025-08-26 16:46:31,503 - INFO - Loading Baseline model from photon_study_1e3_test/train_512/trial_1/baseline_run/08-26-2025-16.45.46_baseline_gs1...
2025-08-26 16:46:31,504 - INFO - Found baseline model at: photon_study_1e3_test/train_512/trial_1/baseline_run/08-26-2025-16.45.46_baseline_gs1/baseline_model.h5
2025-08-26 16:46:31,504 - CRITICAL - Uncaught exception
Traceback (most recent call last):
  File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 1110, in <module>
    main()
  File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 811, in main
    baseline_model = load_baseline_model(args.baseline_dir)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 118, in load_baseline_model
    return tf.keras.models.load_model(baseline_model_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/saving/saving_api.py", line 196, in load_model
    return legacy_h5_format.load_model_from_hdf5(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/legacy/saving/legacy_h5_format.py", line 115, in load_model_from_hdf5
    f = h5py.File(filepath, mode="r")
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/h5py/_hl/files.py", line 564, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, fcpl, swmr=swmr)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/h5py/_hl/files.py", line 238, in make_fid
    fid = h5f.open(name, flags, fapl=fapl)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "h5py/_objects.pyx", line 56, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 57, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 102, in h5py.h5f.open
OSError: Unable to synchronously open file (bad object header version number)
2025-08-26 16:46:31,506 - ERROR - Traceback (most recent call last):
2025-08-26 16:46:31,506 - ERROR - File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 1110, in <module>
2025-08-26 16:46:31,506 - ERROR - main()
2025-08-26 16:46:31,506 - ERROR - File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 811, in main
2025-08-26 16:46:31,506 - ERROR - baseline_model = load_baseline_model(args.baseline_dir)
2025-08-26 16:46:31,506 - ERROR - ^
2025-08-26 16:46:31,506 - ERROR - ^
2025-08-26 16:46:31,506 - ERROR - ^
2025-08-26 16:46:31,506 - ERROR - ^
2025-08-26 16:46:31,506 - ERROR - ^
2025-08-26 16:46:31,506 - ERROR - ^
2025-08-26 16:46:31,506 - ERROR - ^
2025-08-26 16:46:31,506 - ERROR - ^
2025-08-26 16:46:31,506 - ERROR - ^
2025-08-26 16:46:31,506 - ERROR - ^
2025-08-26 16:46:31,506 - ERROR - ^
2025-08-26 16:46:31,506 - ERROR - ^
2025-08-26 16:46:31,506 - ERROR - ^
2025-08-26 16:46:31,506 - ERROR - ^
2025-08-26 16:46:31,506 - ERROR - ^
2025-08-26 16:46:31,506 - ERROR - ^
2025-08-26 16:46:31,506 - ERROR - ^
2025-08-26 16:46:31,506 - ERROR - ^
2025-08-26 16:46:31,506 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 118, in load_baseline_model
2025-08-26 16:46:31,507 - ERROR - return tf.keras.models.load_model(baseline_model_path)
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,507 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/saving/saving_api.py", line 196, in load_model
2025-08-26 16:46:31,508 - ERROR - return legacy_h5_format.load_model_from_hdf5(
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - ^
2025-08-26 16:46:31,508 - ERROR - File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/legacy/saving/legacy_h5_format.py", line 115, in load_model_from_hdf5
2025-08-26 16:46:31,508 - ERROR - f = h5py.File(filepath, mode="r")
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/h5py/_hl/files.py", line 564, in __init__
2025-08-26 16:46:31,509 - ERROR - fid = make_fid(name, mode, userblock_size, fapl, fcpl, swmr=swmr)
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,509 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/h5py/_hl/files.py", line 238, in make_fid
2025-08-26 16:46:31,510 - ERROR - fid = h5f.open(name, flags, fapl=fapl)
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,510 - ERROR - ^
2025-08-26 16:46:31,511 - ERROR - ^
2025-08-26 16:46:31,511 - ERROR - ^
2025-08-26 16:46:31,511 - ERROR - ^
2025-08-26 16:46:31,511 - ERROR - ^
2025-08-26 16:46:31,511 - ERROR - ^
2025-08-26 16:46:31,511 - ERROR - ^
2025-08-26 16:46:31,511 - ERROR - ^
2025-08-26 16:46:31,511 - ERROR - ^
2025-08-26 16:46:31,511 - ERROR - ^
2025-08-26 16:46:31,511 - ERROR - ^
2025-08-26 16:46:31,511 - ERROR - ^
2025-08-26 16:46:31,511 - ERROR - ^
2025-08-26 16:46:31,511 - ERROR - ^
2025-08-26 16:46:31,511 - ERROR - File "h5py/_objects.pyx", line 56, in h5py._objects.with_phil.wrapper
2025-08-26 16:46:31,511 - ERROR - File "h5py/_objects.pyx", line 57, in h5py._objects.with_phil.wrapper
2025-08-26 16:46:31,511 - ERROR - File "h5py/h5f.pyx", line 102, in h5py.h5f.open
2025-08-26 16:46:31,511 - ERROR - OSError
2025-08-26 16:46:31,511 - ERROR - :
2025-08-26 16:46:31,511 - ERROR - Unable to synchronously open file (bad object header version number)
