2025-11-14 07:04:06.556259: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1763132646.567559 3044540 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1763132646.571430 3044540 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1763132646.581557 3044540 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1763132646.581567 3044540 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1763132646.581568 3044540 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1763132646.581569 3044540 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-11-14 07:04:06.584301: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-14 07:04:09,408 - INFO - Configuration setup complete
2025-11-14 07:04:09,408 - INFO - Final configuration: TrainingConfig(model=ModelConfig(N=64, gridsize=2, n_filters_scale=2, model_type='pinn', amp_activation='sigmoid', object_big=True, probe_big=True, probe_mask=False, pad_object=True, probe_scale=4.0, gaussian_smoothing_sigma=0.0), train_data_file=PosixPath('datasets/fly64_coord_variants/fly001_64_train_converted_identity.npz'), test_data_file=PosixPath('datasets/fly001_reconstructed_prepared/fly001_reconstructed_final_downsampled_data_test.npz'), batch_size=4, nepochs=10, mae_weight=0.0, nll_weight=1.0, realspace_mae_weight=0.0, realspace_weight=0.0, nphotons=1000000000.0, n_groups=256, n_images=None, n_subsample=None, subsample_seed=None, neighbor_count=7, enable_oversampling=False, neighbor_pool_size=None, positions_provided=True, probe_trainable=False, intensity_scale_trainable=True, output_dir=PosixPath('outputs/tf_forward_parity_baseline'), sequential_sampling=False, backend='tensorflow', torch_loss_mode='poisson')
2025-11-14 07:04:09,408 - INFO - Legacy mode: --n-groups=256 refers to neighbor groups (gridsize=2, approx 1024 patterns)
2025-11-14 07:04:09,408 - INFO - Starting training with n_subsample=256, n_groups=256, stitching=enabled
2025-11-14 07:04:09,408 - INFO - Loading data from datasets/fly64_coord_variants/fly001_64_train_converted_identity.npz with n_images=256, n_subsample=256
2025-11-14 07:04:09,480 - INFO - Independent sampling: subsampling 256 images from 10304 total
2025-11-14 07:04:09,481 - INFO - Randomly subsampled 256 images
diff3d shape: (256, 64, 64)
probeGuess shape: (64, 64)
scan_index shape: (256,)
xcoords shape: (256,)
ycoords shape: (256,)
xcoords_start shape: (256,)
ycoords_start shape: (256,)
2025-11-14 07:04:09,551 - INFO - Loading data from datasets/fly001_reconstructed_prepared/fly001_reconstructed_final_downsampled_data_test.npz with n_images=None, n_subsample=None
2025-11-14 07:04:10,698 - INFO - Using full dataset of 7597 images
diff3d shape: (7597, 64, 64)
probeGuess shape: (64, 64)
scan_index shape: (7597,)
objectGuess shape: (232, 232)
xcoords shape: (7597,)
ycoords shape: (7597,)
xcoords_start shape: (7597,)
ycoords_start shape: (7597,)
2025-11-14 07:04:10,744 - INFO - Loaded test data from datasets/fly001_reconstructed_prepared/fly001_reconstructed_final_downsampled_data_test.npz
2025-11-14 07:04:10,744 - INFO - Backend dispatcher: params.cfg synchronized with TrainingConfig (backend=tensorflow)
2025-11-14 07:04:10,744 - INFO - Backend dispatcher: routing to TensorFlow workflow (ptycho.workflows.components)
2025-11-14 07:04:10,744 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=256, n_points=256, C=4, K=7
2025-11-14 07:04:10,744 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=2, N=64, sequential_sampling=False
2025-11-14 07:04:10,744 - INFO - [OVERSAMPLING DEBUG] Oversampling flags: enable_oversampling=False, neighbor_pool_size=None, effective_K=7
2025-11-14 07:04:10,744 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 256 > 256 = False
2025-11-14 07:04:10,744 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 4 > 1 = True
2025-11-14 07:04:10,744 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
DEBUG: nsamples: 256, gridsize: 2 (using efficient random sample-then-group strategy)
2025-11-14 07:04:10,744 - INFO - Using efficient random sampling strategy for gridsize=2
2025-11-14 07:04:10,744 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-14 07:04:10,744 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=256, K=7, C=4
2025-11-14 07:04:10,744 - INFO - Generating 256 groups efficiently from 256 points (K=7, C=4)
2025-11-14 07:04:10,744 - INFO - [OVERSAMPLING DEBUG] Standard case: using 256 groups from 256 points
2025-11-14 07:04:10,745 - INFO - [OVERSAMPLING DEBUG] Using all 256 points as seeds (no sampling needed)
2025-11-14 07:04:10,745 - INFO - Using all 256 points as seeds
2025-11-14 07:04:10,746 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 256 groups
2025-11-14 07:04:10,746 - INFO - Successfully generated 256 groups with shape (256, 4)
2025-11-14 07:04:10,746 - INFO - [OVERSAMPLING DEBUG] Generated 256 groups in total
2025-11-14 07:04:10,747 - INFO - Generated 256 groups efficiently
I0000 00:00:1763132650.883834 3044540 gpu_process_state.cc:208] Using CUDA malloc Async allocator for GPU: 0
I0000 00:00:1763132650.885178 3044540 gpu_device.cc:2019] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22259 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:04:00.0, compute capability: 8.6
INFO: No ground truth data ('Y' array or 'objectGuess') found.
INFO: This is expected for PINN training which doesn't require ground truth.
neighbor-sampled diffraction shape (256, 64, 64, 4)
loader: setting dummy Y ground truth with correct channel shape.
INFO: None
<PtychoDataContainer X=(256, 64, 64, 4) Y_I=(256, 64, 64, 4) Y_phi=(256, 64, 64, 4) norm_Y_I=() coords_nominal=(256, 1, 2, 4) coords_true=(256, 1, 2, 4) nn_indices=(256, 4) mean=127.768 global_offsets=(256, 1, 2, 1) mean=114.872 local_offsets=(256, 1, 2, 4) mean=0.000 probe=(64, 64) mean_amplitude=0.086>
2025-11-14 07:04:11,334 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=256, n_points=7597, C=4, K=7
2025-11-14 07:04:11,334 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=2, N=64, sequential_sampling=False
2025-11-14 07:04:11,334 - INFO - [OVERSAMPLING DEBUG] Oversampling flags: enable_oversampling=False, neighbor_pool_size=None, effective_K=7
2025-11-14 07:04:11,334 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 256 > 7597 = False
2025-11-14 07:04:11,334 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 4 > 1 = True
2025-11-14 07:04:11,334 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
DEBUG: nsamples: 256, gridsize: 2 (using efficient random sample-then-group strategy)
2025-11-14 07:04:11,334 - INFO - Using efficient random sampling strategy for gridsize=2
2025-11-14 07:04:11,334 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-14 07:04:11,334 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=256, K=7, C=4
2025-11-14 07:04:11,334 - INFO - Generating 256 groups efficiently from 7597 points (K=7, C=4)
2025-11-14 07:04:11,334 - INFO - [OVERSAMPLING DEBUG] Standard case: using 256 groups from 7597 points
2025-11-14 07:04:11,334 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 256 seed points
2025-11-14 07:04:11,334 - INFO - Sampled 256 seed points from 7597 total points
2025-11-14 07:04:11,337 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 256 groups
2025-11-14 07:04:11,337 - INFO - Successfully generated 256 groups with shape (256, 4)
2025-11-14 07:04:11,337 - INFO - [OVERSAMPLING DEBUG] Generated 256 groups in total
2025-11-14 07:04:11,337 - INFO - Generated 256 groups efficiently
INFO: Using pre-computed 'Y' array from the input file.
neighbor-sampled diffraction shape (256, 64, 64, 4)
loader: using provided ground truth patches.
INFO: None
<PtychoDataContainer X=(256, 64, 64, 4) Y_I=(256, 64, 64, 4) Y_phi=(256, 64, 64, 4) norm_Y_I=() coords_nominal=(256, 1, 2, 4) coords_true=(256, 1, 2, 4) nn_indices=(256, 4) mean=3758.343 global_offsets=(256, 1, 2, 1) mean=136.406 local_offsets=(256, 1, 2, 4) mean=0.000 probe=(64, 64) mean_amplitude=0.006>
DEBUG: Setting probe to tf.Tensor(
[[[ 0.05078768+0.03908647j]
  [-0.00147524+0.02986646j]
  [-0.04124447-0.02018933j]
  ...
  [ 0.02548227+0.01806978j]
  [ 0.04268315+0.0188654j ]
  [ 0.04516761+0.01956229j]]

 [[ 0.0220891 -0.01188079j]
  [ 0.03835767+0.03358509j]
  [-0.00142893+0.02197503j]
  ...
  [-0.01391465-0.00432523j]
  [ 0.03996065+0.03697475j]
  [ 0.02918082+0.03941054j]]

 [[ 0.02744894-0.00778296j]
  [-0.02554526+0.00479967j]
  [-0.01781248-0.02643128j]
  ...
  [-0.03899888+0.05420399j]
  [-0.02644318+0.00979219j]
  [ 0.03697952-0.08437678j]]

 ...

 [[-0.03238868-0.01856977j]
  [ 0.04393906+0.0009207j ]
  [-0.0523303 +0.16835369j]
  ...
  [ 0.07663022+0.06388126j]
  [-0.10884623+0.05475416j]
  [-0.09921163-0.09906429j]]

 [[-0.00452902-0.01962221j]
  [-0.03836754+0.03825318j]
  [-0.0233613 +0.0739998j ]
  ...
  [ 0.0232537 +0.04757752j]
  [-0.06083298-0.04434002j]
  [-0.0041243 -0.0299162j ]]

 [[ 0.02184559+0.02220817j]
  [-0.04714252-0.0093401j ]
  [-0.01891536-0.00193338j]
  ...
  [-0.10183024-0.00715991j]
  [ 0.0541427 -0.08391279j]
  [ 0.03675748+0.03997286j]]], shape=(64, 64, 1), dtype=complex64) in params
DEBUG: Setting intensity_scale to 988.21173 in params
DEBUG: Setting probe to tf.Tensor(
[[[ 0.05078768+0.03908647j]
  [-0.00147524+0.02986646j]
  [-0.04124447-0.02018933j]
  ...
  [ 0.02548227+0.01806978j]
  [ 0.04268315+0.0188654j ]
  [ 0.04516761+0.01956229j]]

 [[ 0.0220891 -0.01188079j]
  [ 0.03835767+0.03358509j]
  [-0.00142893+0.02197503j]
  ...
  [-0.01391465-0.00432523j]
  [ 0.03996065+0.03697475j]
  [ 0.02918082+0.03941054j]]

 [[ 0.02744894-0.00778296j]
  [-0.02554526+0.00479967j]
  [-0.01781248-0.02643128j]
  ...
  [-0.03899888+0.05420399j]
  [-0.02644318+0.00979219j]
  [ 0.03697952-0.08437678j]]

 ...

 [[-0.03238868-0.01856977j]
  [ 0.04393906+0.0009207j ]
  [-0.0523303 +0.16835369j]
  ...
  [ 0.07663022+0.06388126j]
  [-0.10884623+0.05475416j]
  [-0.09921163-0.09906429j]]

 [[-0.00452902-0.01962221j]
  [-0.03836754+0.03825318j]
  [-0.0233613 +0.0739998j ]
  ...
  [ 0.0232537 +0.04757752j]
  [-0.06083298-0.04434002j]
  [-0.0041243 -0.0299162j ]]

 [[ 0.02184559+0.02220817j]
  [-0.04714252-0.0093401j ]
  [-0.01891536-0.00193338j]
  ...
  [-0.10183024-0.00715991j]
  [ 0.0541427 -0.08391279j]
  [ 0.03675748+0.03997286j]]], shape=(64, 64, 1), dtype=complex64) in params
Model: "functional"
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ Layer (type)        â”ƒ Output Shape      â”ƒ    Param # â”ƒ Connected to      â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚ input (InputLayer)  â”‚ (None, 64, 64, 4) â”‚          0 â”‚ -                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ intensity_scaler    â”‚ (None, 64, 64, 4) â”‚          0 â”‚ input[0][0]       â”‚
â”‚ (IntensityScaler)   â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d (Conv2D)     â”‚ (None, 64, 64,    â”‚      2,368 â”‚ intensity_scalerâ€¦ â”‚
â”‚                     â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_1 (Conv2D)   â”‚ (None, 64, 64,    â”‚     36,928 â”‚ conv2d[0][0]      â”‚
â”‚                     â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ max_pooling2d       â”‚ (None, 32, 32,    â”‚          0 â”‚ conv2d_1[0][0]    â”‚
â”‚ (MaxPooling2D)      â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_2 (Conv2D)   â”‚ (None, 32, 32,    â”‚     73,856 â”‚ max_pooling2d[0]â€¦ â”‚
â”‚                     â”‚ 128)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_3 (Conv2D)   â”‚ (None, 32, 32,    â”‚    147,584 â”‚ conv2d_2[0][0]    â”‚
â”‚                     â”‚ 128)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ max_pooling2d_1     â”‚ (None, 16, 16,    â”‚          0 â”‚ conv2d_3[0][0]    â”‚
â”‚ (MaxPooling2D)      â”‚ 128)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_4 (Conv2D)   â”‚ (None, 16, 16,    â”‚    295,168 â”‚ max_pooling2d_1[â€¦ â”‚
â”‚                     â”‚ 256)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_5 (Conv2D)   â”‚ (None, 16, 16,    â”‚    590,080 â”‚ conv2d_4[0][0]    â”‚
â”‚                     â”‚ 256)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ max_pooling2d_2     â”‚ (None, 8, 8, 256) â”‚          0 â”‚ conv2d_5[0][0]    â”‚
â”‚ (MaxPooling2D)      â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_8 (Conv2D)   â”‚ (None, 8, 8, 128) â”‚    295,040 â”‚ max_pooling2d_2[â€¦ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_16 (Conv2D)  â”‚ (None, 8, 8, 128) â”‚    295,040 â”‚ max_pooling2d_2[â€¦ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_9 (Conv2D)   â”‚ (None, 8, 8, 128) â”‚    147,584 â”‚ conv2d_8[0][0]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_17 (Conv2D)  â”‚ (None, 8, 8, 128) â”‚    147,584 â”‚ conv2d_16[0][0]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ up_sampling2d       â”‚ (None, 16, 16,    â”‚          0 â”‚ conv2d_9[0][0]    â”‚
â”‚ (UpSampling2D)      â”‚ 128)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ up_sampling2d_3     â”‚ (None, 16, 16,    â”‚          0 â”‚ conv2d_17[0][0]   â”‚
â”‚ (UpSampling2D)      â”‚ 128)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_10 (Conv2D)  â”‚ (None, 16, 16,    â”‚     73,792 â”‚ up_sampling2d[0]â€¦ â”‚
â”‚                     â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_18 (Conv2D)  â”‚ (None, 16, 16,    â”‚     73,792 â”‚ up_sampling2d_3[â€¦ â”‚
â”‚                     â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_11 (Conv2D)  â”‚ (None, 16, 16,    â”‚     36,928 â”‚ conv2d_10[0][0]   â”‚
â”‚                     â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_19 (Conv2D)  â”‚ (None, 16, 16,    â”‚     36,928 â”‚ conv2d_18[0][0]   â”‚
â”‚                     â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ up_sampling2d_1     â”‚ (None, 32, 32,    â”‚          0 â”‚ conv2d_11[0][0]   â”‚
â”‚ (UpSampling2D)      â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ up_sampling2d_4     â”‚ (None, 32, 32,    â”‚          0 â”‚ conv2d_19[0][0]   â”‚
â”‚ (UpSampling2D)      â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ get_item_1          â”‚ (None, 32, 32, 4) â”‚          0 â”‚ up_sampling2d_1[â€¦ â”‚
â”‚ (GetItem)           â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ get_item_3          â”‚ (None, 32, 32, 4) â”‚          0 â”‚ up_sampling2d_4[â€¦ â”‚
â”‚ (GetItem)           â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_12 (Conv2D)  â”‚ (None, 32, 32,    â”‚      2,368 â”‚ get_item_1[0][0]  â”‚
â”‚                     â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_20 (Conv2D)  â”‚ (None, 32, 32,    â”‚      2,368 â”‚ get_item_3[0][0]  â”‚
â”‚                     â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_13 (Conv2D)  â”‚ (None, 32, 32,    â”‚     36,928 â”‚ conv2d_12[0][0]   â”‚
â”‚                     â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_21 (Conv2D)  â”‚ (None, 32, 32,    â”‚     36,928 â”‚ conv2d_20[0][0]   â”‚
â”‚                     â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ up_sampling2d_2     â”‚ (None, 64, 64,    â”‚          0 â”‚ conv2d_13[0][0]   â”‚
â”‚ (UpSampling2D)      â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ up_sampling2d_5     â”‚ (None, 64, 64,    â”‚          0 â”‚ conv2d_21[0][0]   â”‚
â”‚ (UpSampling2D)      â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ get_item (GetItem)  â”‚ (None, 32, 32,    â”‚          0 â”‚ up_sampling2d_1[â€¦ â”‚
â”‚                     â”‚ 60)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_7 (Conv2D)   â”‚ (None, 64, 64, 4) â”‚      2,308 â”‚ up_sampling2d_2[â€¦ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ get_item_2          â”‚ (None, 32, 32,    â”‚          0 â”‚ up_sampling2d_4[â€¦ â”‚
â”‚ (GetItem)           â”‚ 60)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_15 (Conv2D)  â”‚ (None, 64, 64, 4) â”‚      2,308 â”‚ up_sampling2d_5[â€¦ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_6 (Conv2D)   â”‚ (None, 32, 32, 4) â”‚      2,164 â”‚ get_item[0][0]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ silu (Silu)         â”‚ (None, 64, 64, 4) â”‚          0 â”‚ conv2d_7[0][0]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_14 (Conv2D)  â”‚ (None, 32, 32, 4) â”‚      2,164 â”‚ get_item_2[0][0]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ silu_1 (Silu)       â”‚ (None, 64, 64, 4) â”‚          0 â”‚ conv2d_15[0][0]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ amp                 â”‚ (None, 32, 32, 4) â”‚          0 â”‚ conv2d_6[0][0]    â”‚
â”‚ (ActivationLayer)   â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ center_mask_layer   â”‚ (None, 64, 64, 1) â”‚          0 â”‚ silu[0][0]        â”‚
â”‚ (CenterMaskLayer)   â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ phi                 â”‚ (None, 32, 32, 4) â”‚          0 â”‚ conv2d_14[0][0]   â”‚
â”‚ (ActivationLayer)   â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ center_mask_layer_1 â”‚ (None, 64, 64, 1) â”‚          0 â”‚ silu_1[0][0]      â”‚
â”‚ (CenterMaskLayer)   â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ amp_padded          â”‚ (None, 64, 64, 4) â”‚          0 â”‚ amp[0][0]         â”‚
â”‚ (ZeroPadding2D)     â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ multiply (Multiply) â”‚ (None, 64, 64, 4) â”‚          0 â”‚ silu[0][0],       â”‚
â”‚                     â”‚                   â”‚            â”‚ center_mask_layeâ€¦ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ phase_padded        â”‚ (None, 64, 64, 4) â”‚          0 â”‚ phi[0][0]         â”‚
â”‚ (ZeroPadding2D)     â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ multiply_1          â”‚ (None, 64, 64, 4) â”‚          0 â”‚ silu_1[0][0],     â”‚
â”‚ (Multiply)          â”‚                   â”‚            â”‚ center_mask_layeâ€¦ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ add (Add)           â”‚ (None, 64, 64, 4) â”‚          0 â”‚ amp_padded[0][0], â”‚
â”‚                     â”‚                   â”‚            â”‚ multiply[0][0]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ add_1 (Add)         â”‚ (None, 64, 64, 4) â”‚          0 â”‚ phase_padded[0][â€¦ â”‚
â”‚                     â”‚                   â”‚            â”‚ multiply_1[0][0]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ obj                 â”‚ (None, 64, 64, 4) â”‚          0 â”‚ add[0][0],        â”‚
â”‚ (CombineComplexLayâ€¦ â”‚                   â”‚            â”‚ add_1[0][0]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ input_positions     â”‚ (None, 1, 2, 4)   â”‚          0 â”‚ -                 â”‚
â”‚ (InputLayer)        â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ padded_obj_2        â”‚ (None, 78, 78, 4) â”‚          0 â”‚ obj[0][0],        â”‚
â”‚ (ReassemblePatchesâ€¦ â”‚                   â”‚            â”‚ input_positions[â€¦ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ padded_objs_with_oâ€¦ â”‚ (None, 68, 68, 4) â”‚          0 â”‚ padded_obj_2[0][â€¦ â”‚
â”‚ (ExtractPatchesPosâ€¦ â”‚                   â”‚            â”‚ input_positions[â€¦ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ probe_illumination  â”‚ [(None, 68, 68,   â”‚          0 â”‚ padded_objs_withâ€¦ â”‚
â”‚ (ProbeIllumination) â”‚ 4), (None, 68,    â”‚            â”‚                   â”‚
â”‚                     â”‚ 68, 4)]           â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ pred_amplitude      â”‚ [(None, 64, 64,   â”‚          0 â”‚ probe_illuminatiâ€¦ â”‚
â”‚ (PadAndDiffractLayâ€¦ â”‚ 4), (None, 64,    â”‚            â”‚                   â”‚
â”‚                     â”‚ 64, 4)]           â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ pred_diff_channels  â”‚ (None, 64, 64, 4) â”‚          0 â”‚ pred_amplitude[0â€¦ â”‚
â”‚ (FlatToChannelLayeâ€¦ â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ intensity_scaler_iâ€¦ â”‚ (None, 64, 64, 4) â”‚          0 â”‚ pred_diff_channeâ€¦ â”‚
â”‚ (IntensityScaler_iâ€¦ â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trimmed_obj         â”‚ (None, 64, 64, 4) â”‚          0 â”‚ padded_obj_2[0][â€¦ â”‚
â”‚ (TrimReconstructioâ€¦ â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ pred_intensity      â”‚ (None, 64, 64, 4) â”‚          0 â”‚ intensity_scalerâ€¦ â”‚
â”‚ (SquareLayer)       â”‚                   â”‚            â”‚                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 Total params: 2,340,208 (8.93 MB)
 Trainable params: 2,340,208 (8.93 MB)
 Non-trainable params: 0 (0.00 B)
2025-11-14 07:04:12.093061: I external/local_tsl/tsl/profiler/lib/profiler_session.cc:103] Profiler session initializing.
2025-11-14 07:04:12.093071: I external/local_tsl/tsl/profiler/lib/profiler_session.cc:118] Profiler session started.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1763132652.093086 3044540 cupti_tracer.cc:1026] Profiler found 1 GPUs
W0000 00:00:1763132652.106800 3044540 cupti_tracer.cc:1213] Fail to use per-thread activity buffer, cupti trace overhead may be big. CUPTI ERROR CODE:1
2025-11-14 07:04:12.106873: I external/local_tsl/tsl/profiler/lib/profiler_session.cc:130] Profiler session tear down.
I0000 00:00:1763132652.106984 3044540 cupti_tracer.cc:1249] CUPTI activity buffer flushed
I0000 00:00:1763132652.834312 3044540 service.cc:152] XLA service 0x311867e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
I0000 00:00:1763132652.834333 3044540 service.cc:160]   StreamExecutor device (0): NVIDIA GeForce RTX 3090, Compute Capability 8.6
2025-11-14 07:04:12.848105: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:269] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
I0000 00:00:1763132652.863296 3044540 cuda_dnn.cc:529] Loaded cuDNN version 91002
I0000 00:00:1763132653.080327 3044540 device_compiler.h:188] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
None
Current Parameters:
--------------------
N: 64
amp_activation: sigmoid
backend: tensorflow
batch_size: 4
bigN: 68
big_gridsize: 10
data_source: generic
debug: True
default_probe_scale: 0.7
enable_oversampling: False
gaussian_smoothing_sigma: 0.0
gridsize: 2
h5_path: wts.h5
intensity_scale: 988.2117309570312
intensity_scale.trainable: True
label: 
mae_weight: 0.0
max_position_jitter: 10
model_type: pinn
n_filters_scale: 2
n_groups: 256
neighbor_count: 7
nepochs: 10
nimgs_test: 3
nimgs_train: 9
nll_weight: 1.0
nphotons: 1000000000.0
npseed: 42
object.big: True
offset: 4
outer_offset_test: None
outer_offset_train: None
output_prefix: outputs/tf_forward_parity_baseline
pad_object: True
positions.provided: True
probe:
  shape: (64, 64, 1)
  mean: 0.000-0.005j
  std: 0.654
  min: -1.772+0.357j
  max: 1.781+0.163j
probe.big: True
probe.mask: False
probe.trainable: False
probe_scale: 4.0
realspace_mae_weight: 0.0
realspace_weight: 0.0
sequential_sampling: False
set_phi: False
sim_jitter_scale: 0.0
size: 392
test_data_file_path: datasets/fly001_reconstructed_prepared/fly001_reconstructed_final_downsampled_data_test.npz
torch_loss_mode: poisson
train_data_file_path: datasets/fly64_coord_variants/fly001_64_train_converted_identity.npz
tv_weight: 0.0
use_xla_translate: True
Epoch 1/10
input shape (None, 64, 64, 1)
2025-11-14 07:04:13,788 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
input shape (None, 64, 64, 1)
2025-11-14 07:04:17,142 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2025-11-14 07:04:19.096608: W tensorflow/core/common_runtime/type_inference.cc:340] Type inference failed. This indicates an invalid graph that escaped type checking. Error message: INVALID_ARGUMENT: expected compatible input types, but input 1:
type_id: TFT_OPTIONAL
args {
  type_id: TFT_PRODUCT
  args {
    type_id: TFT_TENSOR
    args {
      type_id: TFT_INT32
    }
  }
}
 is neither a subtype nor a supertype of the combined inputs preceding it:
type_id: TFT_OPTIONAL
args {
  type_id: TFT_PRODUCT
  args {
    type_id: TFT_TENSOR
    args {
      type_id: TFT_FLOAT
    }
  }
}

	for Tuple type infernce function 0
	while inferring type of node 'StatefulPartitionedCall/functional_1/padded_obj_2_1/cond/output/_165'
[1m 1/61[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m10:06[0m 10s/step - intensity_scaler_inv_loss: 279.3640 - loss: -2713773.7500 - pred_intensity_loss: -2713773.7500 - trimmed_obj_loss: 0.0000e+00[1m 5/61[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 16ms/step - intensity_scaler_inv_loss: 659.4018 - loss: -1232486.1250 - pred_intensity_loss: -1232486.1250 - trimmed_obj_loss: 0.0000e+00  [1m 9/61[0m [32mâ”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 15ms/step - intensity_scaler_inv_loss: 582.8077 - loss: -1551533.1250 - pred_intensity_loss: -1551533.1250 - trimmed_obj_loss: 0.0000e+00[1m13/61[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 15ms/step - intensity_scaler_inv_loss: 526.6225 - loss: -1772102.0000 - pred_intensity_loss: -1772102.0000 - trimmed_obj_loss: 0.0000e+00[1m17/61[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 488.1990 - loss: -1923309.2500 - pred_intensity_loss: -1923309.2500 - trimmed_obj_loss: 0.0000e+00[1m21/61[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 457.4673 - loss: -2037574.6250 - pred_intensity_loss: -2037574.6250 - trimmed_obj_loss: 0.0000e+00[1m25/61[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 433.1020 - loss: -2126449.0000 - pred_intensity_loss: -2126449.0000 - trimmed_obj_loss: 0.0000e+00[1m29/61[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 413.6171 - loss: -2198497.0000 - pred_intensity_loss: -2198497.0000 - trimmed_obj_loss: 0.0000e+00[1m33/61[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 397.1822 - loss: -2258007.0000 - pred_intensity_loss: -2258007.0000 - trimmed_obj_loss: 0.0000e+00[1m37/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 383.0277 - loss: -2308389.5000 - pred_intensity_loss: -2308389.5000 - trimmed_obj_loss: 0.0000e+00[1m41/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 370.7599 - loss: -2351361.5000 - pred_intensity_loss: -2351361.5000 - trimmed_obj_loss: 0.0000e+00[1m45/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 359.9875 - loss: -2388462.7500 - pred_intensity_loss: -2388462.7500 - trimmed_obj_loss: 0.0000e+00[1m49/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 350.4464 - loss: -2420875.7500 - pred_intensity_loss: -2420875.7500 - trimmed_obj_loss: 0.0000e+00[1m53/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 341.9479 - loss: -2449684.7500 - pred_intensity_loss: -2449684.7500 - trimmed_obj_loss: 0.0000e+00[1m57/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 334.3067 - loss: -2475487.0000 - pred_intensity_loss: -2475487.0000 - trimmed_obj_loss: 0.0000e+00[1m61/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 31ms/step - intensity_scaler_inv_loss: 327.3875 - loss: -2498505.5000 - pred_intensity_loss: -2498510.5000 - trimmed_obj_loss: 0.0000e+00input shape (None, 64, 64, 1)
2025-11-14 07:04:25,705 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
[1m61/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m13s[0m 54ms/step - intensity_scaler_inv_loss: 227.5184 - loss: -2830294.0000 - pred_intensity_loss: -2830589.5000 - trimmed_obj_loss: 0.0000e+00 - val_intensity_scaler_inv_loss: 163.7108 - val_loss: -2974817.5000 - val_pred_intensity_loss: -3019708.7500 - val_trimmed_obj_loss: 0.0000e+00 - learning_rate: 0.0010
Epoch 2/10
[1m 1/61[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m2s[0m 34ms/step - intensity_scaler_inv_loss: 172.8804 - loss: -2953128.0000 - pred_intensity_loss: -2953128.0000 - trimmed_obj_loss: 0.0000e+00[1m 5/61[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 15ms/step - intensity_scaler_inv_loss: 173.4968 - loss: -2968054.0000 - pred_intensity_loss: -2968054.0000 - trimmed_obj_loss: 0.0000e+00[1m 9/61[0m [32mâ”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 173.8692 - loss: -2978160.7500 - pred_intensity_loss: -2978160.7500 - trimmed_obj_loss: 0.0000e+00[1m13/61[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 174.2006 - loss: -2981804.5000 - pred_intensity_loss: -2981804.5000 - trimmed_obj_loss: 0.0000e+00[1m17/61[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 173.7410 - loss: -2981583.2500 - pred_intensity_loss: -2981583.2500 - trimmed_obj_loss: 0.0000e+00[1m21/61[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 173.0487 - loss: -2981212.5000 - pred_intensity_loss: -2981212.5000 - trimmed_obj_loss: 0.0000e+00[1m25/61[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 172.6672 - loss: -2981455.2500 - pred_intensity_loss: -2981455.2500 - trimmed_obj_loss: 0.0000e+00[1m29/61[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 172.3818 - loss: -2981242.0000 - pred_intensity_loss: -2981242.0000 - trimmed_obj_loss: 0.0000e+00[1m33/61[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 172.0118 - loss: -2980131.5000 - pred_intensity_loss: -2980131.5000 - trimmed_obj_loss: 0.0000e+00[1m37/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 171.8534 - loss: -2980018.0000 - pred_intensity_loss: -2980018.0000 - trimmed_obj_loss: 0.0000e+00[1m41/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 171.7035 - loss: -2979780.5000 - pred_intensity_loss: -2979780.5000 - trimmed_obj_loss: 0.0000e+00[1m45/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 171.5776 - loss: -2979464.2500 - pred_intensity_loss: -2979464.2500 - trimmed_obj_loss: 0.0000e+00[1m49/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 171.4412 - loss: -2979126.2500 - pred_intensity_loss: -2979126.2500 - trimmed_obj_loss: 0.0000e+00[1m53/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 171.3568 - loss: -2979078.5000 - pred_intensity_loss: -2979078.5000 - trimmed_obj_loss: 0.0000e+00[1m57/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 171.2828 - loss: -2979152.2500 - pred_intensity_loss: -2979152.2500 - trimmed_obj_loss: 0.0000e+00[1m61/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 171.1835 - loss: -2978995.0000 - pred_intensity_loss: -2978978.5000 - trimmed_obj_loss: 0.0000e+00[1m61/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 15ms/step - intensity_scaler_inv_loss: 169.4423 - loss: -2973873.7500 - pred_intensity_loss: -2972856.2500 - trimmed_obj_loss: 0.0000e+00 - val_intensity_scaler_inv_loss: 160.3961 - val_loss: -2976171.0000 - val_pred_intensity_loss: -3021133.5000 - val_trimmed_obj_loss: 0.0000e+00 - learning_rate: 0.0010
Epoch 3/10
[1m 1/61[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 33ms/step - intensity_scaler_inv_loss: 175.0152 - loss: -3036976.5000 - pred_intensity_loss: -3036976.5000 - trimmed_obj_loss: 0.0000e+00[1m 5/61[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 15ms/step - intensity_scaler_inv_loss: 169.9591 - loss: -2989816.7500 - pred_intensity_loss: -2989816.7500 - trimmed_obj_loss: 0.0000e+00[1m 9/61[0m [32mâ”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 15ms/step - intensity_scaler_inv_loss: 168.5191 - loss: -2981392.5000 - pred_intensity_loss: -2981392.5000 - trimmed_obj_loss: 0.0000e+00[1m13/61[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 15ms/step - intensity_scaler_inv_loss: 167.6188 - loss: -2975648.7500 - pred_intensity_loss: -2975648.7500 - trimmed_obj_loss: 0.0000e+00[1m17/61[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 15ms/step - intensity_scaler_inv_loss: 167.2296 - loss: -2974979.5000 - pred_intensity_loss: -2974979.5000 - trimmed_obj_loss: 0.0000e+00[1m21/61[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 166.8615 - loss: -2973448.7500 - pred_intensity_loss: -2973448.7500 - trimmed_obj_loss: 0.0000e+00[1m25/61[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 166.8955 - loss: -2973593.0000 - pred_intensity_loss: -2973593.0000 - trimmed_obj_loss: 0.0000e+00[1m29/61[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 166.9231 - loss: -2973548.5000 - pred_intensity_loss: -2973548.5000 - trimmed_obj_loss: 0.0000e+00[1m33/61[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 166.9512 - loss: -2973526.2500 - pred_intensity_loss: -2973526.2500 - trimmed_obj_loss: 0.0000e+00[1m37/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 167.0022 - loss: -2973729.2500 - pred_intensity_loss: -2973729.2500 - trimmed_obj_loss: 0.0000e+00[1m41/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 167.0628 - loss: -2974404.2500 - pred_intensity_loss: -2974404.2500 - trimmed_obj_loss: 0.0000e+00[1m45/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 167.1183 - loss: -2975318.0000 - pred_intensity_loss: -2975318.0000 - trimmed_obj_loss: 0.0000e+00[1m49/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 167.0915 - loss: -2975655.0000 - pred_intensity_loss: -2975655.0000 - trimmed_obj_loss: 0.0000e+00[1m53/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 167.0092 - loss: -2975569.0000 - pred_intensity_loss: -2975569.0000 - trimmed_obj_loss: 0.0000e+00[1m57/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 166.9395 - loss: -2975459.5000 - pred_intensity_loss: -2975459.5000 - trimmed_obj_loss: 0.0000e+00[1m61/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 166.8733 - loss: -2975421.2500 - pred_intensity_loss: -2975432.7500 - trimmed_obj_loss: 0.0000e+00[1m61/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 15ms/step - intensity_scaler_inv_loss: 166.0374 - loss: -2975791.0000 - pred_intensity_loss: -2976487.0000 - trimmed_obj_loss: 0.0000e+00 - val_intensity_scaler_inv_loss: 145.8761 - val_loss: -2980991.7500 - val_pred_intensity_loss: -3026909.5000 - val_trimmed_obj_loss: 0.0000e+00 - learning_rate: 0.0010
Epoch 4/10
[1m 1/61[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 32ms/step - intensity_scaler_inv_loss: 133.2825 - loss: -2914649.0000 - pred_intensity_loss: -2914649.0000 - trimmed_obj_loss: 0.0000e+00[1m 5/61[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 143.0966 - loss: -2886372.0000 - pred_intensity_loss: -2886372.0000 - trimmed_obj_loss: 0.0000e+00[1m 9/61[0m [32mâ”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 149.4097 - loss: -2914545.5000 - pred_intensity_loss: -2914545.5000 - trimmed_obj_loss: 0.0000e+00[1m13/61[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 152.4994 - loss: -2933380.7500 - pred_intensity_loss: -2933380.7500 - trimmed_obj_loss: 0.0000e+00[1m17/61[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 154.1937 - loss: -2943292.5000 - pred_intensity_loss: -2943292.5000 - trimmed_obj_loss: 0.0000e+00[1m21/61[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 155.3526 - loss: -2951803.7500 - pred_intensity_loss: -2951803.7500 - trimmed_obj_loss: 0.0000e+00[1m25/61[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 156.2343 - loss: -2958103.0000 - pred_intensity_loss: -2958103.0000 - trimmed_obj_loss: 0.0000e+00[1m29/61[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 156.8181 - loss: -2961668.5000 - pred_intensity_loss: -2961668.5000 - trimmed_obj_loss: 0.0000e+00[1m33/61[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 157.3506 - loss: -2965497.0000 - pred_intensity_loss: -2965497.0000 - trimmed_obj_loss: 0.0000e+00[1m37/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 157.6187 - loss: -2968535.0000 - pred_intensity_loss: -2968535.0000 - trimmed_obj_loss: 0.0000e+00[1m41/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 157.8367 - loss: -2970576.2500 - pred_intensity_loss: -2970576.2500 - trimmed_obj_loss: 0.0000e+00[1m45/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 158.0217 - loss: -2972471.2500 - pred_intensity_loss: -2972471.2500 - trimmed_obj_loss: 0.0000e+00[1m49/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 158.1297 - loss: -2974291.2500 - pred_intensity_loss: -2974291.2500 - trimmed_obj_loss: 0.0000e+00[1m53/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 158.1474 - loss: -2975385.0000 - pred_intensity_loss: -2975385.0000 - trimmed_obj_loss: 0.0000e+00[1m57/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 158.1166 - loss: -2976125.7500 - pred_intensity_loss: -2976125.7500 - trimmed_obj_loss: 0.0000e+00[1m61/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 158.0574 - loss: -2976730.5000 - pred_intensity_loss: -2976730.5000 - trimmed_obj_loss: 0.0000e+00[1m61/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 15ms/step - intensity_scaler_inv_loss: 157.1815 - loss: -2984845.5000 - pred_intensity_loss: -2984834.0000 - trimmed_obj_loss: 0.0000e+00 - val_intensity_scaler_inv_loss: 144.0736 - val_loss: -2989079.5000 - val_pred_intensity_loss: -3034979.0000 - val_trimmed_obj_loss: 0.0000e+00 - learning_rate: 0.0010
Epoch 5/10
[1m 1/61[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 32ms/step - intensity_scaler_inv_loss: 140.5070 - loss: -2822907.7500 - pred_intensity_loss: -2822907.7500 - trimmed_obj_loss: 0.0000e+00[1m 5/61[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 142.0761 - loss: -2872106.0000 - pred_intensity_loss: -2872106.0000 - trimmed_obj_loss: 0.0000e+00[1m 9/61[0m [32mâ”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 145.0301 - loss: -2907866.2500 - pred_intensity_loss: -2907866.2500 - trimmed_obj_loss: 0.0000e+00[1m13/61[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 146.5929 - loss: -2926917.5000 - pred_intensity_loss: -2926917.5000 - trimmed_obj_loss: 0.0000e+00[1m17/61[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 147.1117 - loss: -2935556.7500 - pred_intensity_loss: -2935556.7500 - trimmed_obj_loss: 0.0000e+00[1m21/61[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 147.5210 - loss: -2942530.0000 - pred_intensity_loss: -2942530.0000 - trimmed_obj_loss: 0.0000e+00[1m25/61[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 148.0042 - loss: -2949639.0000 - pred_intensity_loss: -2949639.0000 - trimmed_obj_loss: 0.0000e+00[1m29/61[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 148.3417 - loss: -2955443.2500 - pred_intensity_loss: -2955443.2500 - trimmed_obj_loss: 0.0000e+00[1m33/61[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 148.5364 - loss: -2959184.2500 - pred_intensity_loss: -2959184.2500 - trimmed_obj_loss: 0.0000e+00[1m37/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 148.6520 - loss: -2961670.2500 - pred_intensity_loss: -2961670.2500 - trimmed_obj_loss: 0.0000e+00[1m41/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 148.6929 - loss: -2963765.7500 - pred_intensity_loss: -2963765.7500 - trimmed_obj_loss: 0.0000e+00[1m45/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 148.7456 - loss: -2965737.5000 - pred_intensity_loss: -2965737.5000 - trimmed_obj_loss: 0.0000e+00[1m49/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 148.8302 - loss: -2967746.0000 - pred_intensity_loss: -2967746.0000 - trimmed_obj_loss: 0.0000e+00[1m53/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 148.9091 - loss: -2969822.5000 - pred_intensity_loss: -2969822.5000 - trimmed_obj_loss: 0.0000e+00[1m57/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 148.9777 - loss: -2971627.2500 - pred_intensity_loss: -2971627.2500 - trimmed_obj_loss: 0.0000e+00[1m61/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 149.0204 - loss: -2973051.2500 - pred_intensity_loss: -2973047.5000 - trimmed_obj_loss: 0.0000e+00[1m61/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 15ms/step - intensity_scaler_inv_loss: 149.4900 - loss: -2992993.5000 - pred_intensity_loss: -2992766.2500 - trimmed_obj_loss: 0.0000e+00 - val_intensity_scaler_inv_loss: 138.5162 - val_loss: -2992666.5000 - val_pred_intensity_loss: -3039008.0000 - val_trimmed_obj_loss: 0.0000e+00 - learning_rate: 0.0010
Epoch 6/10
[1m 1/61[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 33ms/step - intensity_scaler_inv_loss: 155.8286 - loss: -3046741.7500 - pred_intensity_loss: -3046741.7500 - trimmed_obj_loss: 0.0000e+00[1m 5/61[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 15ms/step - intensity_scaler_inv_loss: 146.6120 - loss: -2937919.2500 - pred_intensity_loss: -2937919.2500 - trimmed_obj_loss: 0.0000e+00[1m 9/61[0m [32mâ”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 144.8521 - loss: -2947365.7500 - pred_intensity_loss: -2947365.7500 - trimmed_obj_loss: 0.0000e+00[1m13/61[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 144.2282 - loss: -2949942.0000 - pred_intensity_loss: -2949942.0000 - trimmed_obj_loss: 0.0000e+00[1m17/61[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 143.9092 - loss: -2950798.0000 - pred_intensity_loss: -2950798.0000 - trimmed_obj_loss: 0.0000e+00[1m21/61[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 143.7253 - loss: -2953861.7500 - pred_intensity_loss: -2953861.7500 - trimmed_obj_loss: 0.0000e+00[1m25/61[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 143.6610 - loss: -2956713.5000 - pred_intensity_loss: -2956713.5000 - trimmed_obj_loss: 0.0000e+00[1m29/61[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 143.6706 - loss: -2959340.2500 - pred_intensity_loss: -2959340.2500 - trimmed_obj_loss: 0.0000e+00[1m33/61[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 143.6776 - loss: -2960966.0000 - pred_intensity_loss: -2960966.0000 - trimmed_obj_loss: 0.0000e+00[1m37/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 143.7564 - loss: -2962458.7500 - pred_intensity_loss: -2962458.7500 - trimmed_obj_loss: 0.0000e+00[1m41/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 143.8983 - loss: -2964721.0000 - pred_intensity_loss: -2964721.0000 - trimmed_obj_loss: 0.0000e+00[1m45/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 144.0160 - loss: -2966632.7500 - pred_intensity_loss: -2966632.7500 - trimmed_obj_loss: 0.0000e+00[1m49/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 144.1653 - loss: -2968558.0000 - pred_intensity_loss: -2968558.0000 - trimmed_obj_loss: 0.0000e+00[1m53/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 144.3059 - loss: -2970500.5000 - pred_intensity_loss: -2970500.5000 - trimmed_obj_loss: 0.0000e+00[1m57/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 144.4172 - loss: -2972310.5000 - pred_intensity_loss: -2972310.5000 - trimmed_obj_loss: 0.0000e+00[1m61/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 144.4905 - loss: -2973815.5000 - pred_intensity_loss: -2973824.7500 - trimmed_obj_loss: 0.0000e+00[1m61/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 15ms/step - intensity_scaler_inv_loss: 145.6901 - loss: -2996596.0000 - pred_intensity_loss: -2997153.2500 - trimmed_obj_loss: 0.0000e+00 - val_intensity_scaler_inv_loss: 134.0132 - val_loss: -2990851.5000 - val_pred_intensity_loss: -3036683.0000 - val_trimmed_obj_loss: 0.0000e+00 - learning_rate: 0.0010
Epoch 7/10
[1m 1/61[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 32ms/step - intensity_scaler_inv_loss: 138.6910 - loss: -2999783.0000 - pred_intensity_loss: -2999783.0000 - trimmed_obj_loss: 0.0000e+00[1m 5/61[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 15ms/step - intensity_scaler_inv_loss: 142.5142 - loss: -2975837.5000 - pred_intensity_loss: -2975837.5000 - trimmed_obj_loss: 0.0000e+00[1m 9/61[0m [32mâ”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 141.6057 - loss: -2959188.5000 - pred_intensity_loss: -2959188.5000 - trimmed_obj_loss: 0.0000e+00[1m13/61[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 141.5808 - loss: -2953780.2500 - pred_intensity_loss: -2953780.2500 - trimmed_obj_loss: 0.0000e+00[1m17/61[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 141.7176 - loss: -2954223.2500 - pred_intensity_loss: -2954223.2500 - trimmed_obj_loss: 0.0000e+00[1m21/61[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 141.9441 - loss: -2956358.5000 - pred_intensity_loss: -2956358.5000 - trimmed_obj_loss: 0.0000e+00[1m25/61[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 142.2542 - loss: -2960205.2500 - pred_intensity_loss: -2960205.2500 - trimmed_obj_loss: 0.0000e+00[1m29/61[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 142.5840 - loss: -2965140.7500 - pred_intensity_loss: -2965140.7500 - trimmed_obj_loss: 0.0000e+00[1m33/61[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 142.8291 - loss: -2968620.7500 - pred_intensity_loss: -2968620.7500 - trimmed_obj_loss: 0.0000e+00[1m37/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 143.0059 - loss: -2971387.5000 - pred_intensity_loss: -2971387.5000 - trimmed_obj_loss: 0.0000e+00[1m41/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 143.1633 - loss: -2974039.5000 - pred_intensity_loss: -2974039.5000 - trimmed_obj_loss: 0.0000e+00[1m45/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 143.3224 - loss: -2976625.2500 - pred_intensity_loss: -2976625.2500 - trimmed_obj_loss: 0.0000e+00[1m49/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 143.4013 - loss: -2978410.5000 - pred_intensity_loss: -2978410.5000 - trimmed_obj_loss: 0.0000e+00[1m53/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 143.4619 - loss: -2979954.7500 - pred_intensity_loss: -2979954.7500 - trimmed_obj_loss: 0.0000e+00[1m57/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 143.5054 - loss: -2981206.0000 - pred_intensity_loss: -2981206.0000 - trimmed_obj_loss: 0.0000e+00[1m61/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 143.5513 - loss: -2982269.7500 - pred_intensity_loss: -2982268.7500 - trimmed_obj_loss: 0.0000e+00[1m61/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 15ms/step - intensity_scaler_inv_loss: 144.3027 - loss: -2997795.2500 - pred_intensity_loss: -2997739.2500 - trimmed_obj_loss: 0.0000e+00 - val_intensity_scaler_inv_loss: 135.7704 - val_loss: -2994203.7500 - val_pred_intensity_loss: -3040177.5000 - val_trimmed_obj_loss: 0.0000e+00 - learning_rate: 0.0010
Epoch 8/10
[1m 1/61[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m2s[0m 35ms/step - intensity_scaler_inv_loss: 148.5777 - loss: -3068881.0000 - pred_intensity_loss: -3068881.0000 - trimmed_obj_loss: 0.0000e+00[1m 5/61[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 16ms/step - intensity_scaler_inv_loss: 144.0300 - loss: -2996022.7500 - pred_intensity_loss: -2996022.7500 - trimmed_obj_loss: 0.0000e+00[1m 9/61[0m [32mâ”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 15ms/step - intensity_scaler_inv_loss: 143.0016 - loss: -2992979.7500 - pred_intensity_loss: -2992979.7500 - trimmed_obj_loss: 0.0000e+00[1m13/61[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 15ms/step - intensity_scaler_inv_loss: 142.6230 - loss: -2990527.2500 - pred_intensity_loss: -2990527.2500 - trimmed_obj_loss: 0.0000e+00[1m17/61[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 15ms/step - intensity_scaler_inv_loss: 142.3336 - loss: -2988216.2500 - pred_intensity_loss: -2988216.2500 - trimmed_obj_loss: 0.0000e+00[1m21/61[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 15ms/step - intensity_scaler_inv_loss: 141.9454 - loss: -2984972.5000 - pred_intensity_loss: -2984972.5000 - trimmed_obj_loss: 0.0000e+00[1m25/61[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 141.6473 - loss: -2982549.7500 - pred_intensity_loss: -2982549.7500 - trimmed_obj_loss: 0.0000e+00[1m29/61[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 141.5138 - loss: -2981367.0000 - pred_intensity_loss: -2981367.0000 - trimmed_obj_loss: 0.0000e+00[1m33/61[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 141.4730 - loss: -2980951.0000 - pred_intensity_loss: -2980951.0000 - trimmed_obj_loss: 0.0000e+00[1m37/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 141.4734 - loss: -2981046.7500 - pred_intensity_loss: -2981046.7500 - trimmed_obj_loss: 0.0000e+00[1m41/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 141.4564 - loss: -2981474.7500 - pred_intensity_loss: -2981474.7500 - trimmed_obj_loss: 0.0000e+00[1m45/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 141.4870 - loss: -2982374.2500 - pred_intensity_loss: -2982374.2500 - trimmed_obj_loss: 0.0000e+00[1m49/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 141.4947 - loss: -2983131.0000 - pred_intensity_loss: -2983131.0000 - trimmed_obj_loss: 0.0000e+00[1m53/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 141.5218 - loss: -2984053.2500 - pred_intensity_loss: -2984053.2500 - trimmed_obj_loss: 0.0000e+00[1m57/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 141.5324 - loss: -2985117.7500 - pred_intensity_loss: -2985117.7500 - trimmed_obj_loss: 0.0000e+00[1m61/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 141.5591 - loss: -2986049.2500 - pred_intensity_loss: -2986053.0000 - trimmed_obj_loss: 0.0000e+00[1m61/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 15ms/step - intensity_scaler_inv_loss: 142.0114 - loss: -2999842.0000 - pred_intensity_loss: -3000069.2500 - trimmed_obj_loss: 0.0000e+00 - val_intensity_scaler_inv_loss: 132.4807 - val_loss: -2995221.0000 - val_pred_intensity_loss: -3041181.7500 - val_trimmed_obj_loss: 0.0000e+00 - learning_rate: 0.0010
Epoch 9/10
[1m 1/61[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 32ms/step - intensity_scaler_inv_loss: 131.0364 - loss: -3014332.2500 - pred_intensity_loss: -3014332.2500 - trimmed_obj_loss: 0.0000e+00[1m 5/61[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 135.1256 - loss: -2975728.0000 - pred_intensity_loss: -2975728.0000 - trimmed_obj_loss: 0.0000e+00[1m 9/61[0m [32mâ”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 137.1986 - loss: -2968348.7500 - pred_intensity_loss: -2968348.7500 - trimmed_obj_loss: 0.0000e+00[1m13/61[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 137.7040 - loss: -2968512.7500 - pred_intensity_loss: -2968512.7500 - trimmed_obj_loss: 0.0000e+00[1m17/61[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 138.3545 - loss: -2974306.0000 - pred_intensity_loss: -2974306.0000 - trimmed_obj_loss: 0.0000e+00[1m21/61[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 138.8139 - loss: -2979927.2500 - pred_intensity_loss: -2979927.2500 - trimmed_obj_loss: 0.0000e+00[1m25/61[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 139.1209 - loss: -2983834.7500 - pred_intensity_loss: -2983834.7500 - trimmed_obj_loss: 0.0000e+00[1m29/61[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 139.4564 - loss: -2987727.7500 - pred_intensity_loss: -2987727.7500 - trimmed_obj_loss: 0.0000e+00[1m33/61[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 139.7535 - loss: -2990118.5000 - pred_intensity_loss: -2990118.5000 - trimmed_obj_loss: 0.0000e+00[1m37/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 139.9701 - loss: -2991764.7500 - pred_intensity_loss: -2991764.7500 - trimmed_obj_loss: 0.0000e+00[1m41/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 140.0947 - loss: -2992731.2500 - pred_intensity_loss: -2992731.2500 - trimmed_obj_loss: 0.0000e+00[1m45/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 140.2017 - loss: -2993622.7500 - pred_intensity_loss: -2993622.7500 - trimmed_obj_loss: 0.0000e+00[1m49/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 140.2672 - loss: -2994129.0000 - pred_intensity_loss: -2994129.0000 - trimmed_obj_loss: 0.0000e+00[1m53/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 140.3418 - loss: -2994661.2500 - pred_intensity_loss: -2994661.2500 - trimmed_obj_loss: 0.0000e+00[1m57/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 140.4236 - loss: -2995149.7500 - pred_intensity_loss: -2995149.7500 - trimmed_obj_loss: 0.0000e+00[1m61/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 140.4886 - loss: -2995528.2500 - pred_intensity_loss: -2995521.7500 - trimmed_obj_loss: 0.0000e+00[1m61/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 15ms/step - intensity_scaler_inv_loss: 141.2472 - loss: -3000720.5000 - pred_intensity_loss: -3000321.2500 - trimmed_obj_loss: 0.0000e+00 - val_intensity_scaler_inv_loss: 136.6877 - val_loss: -2995891.7500 - val_pred_intensity_loss: -3041728.2500 - val_trimmed_obj_loss: 0.0000e+00 - learning_rate: 0.0010
Epoch 10/10
[1m 1/61[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 33ms/step - intensity_scaler_inv_loss: 138.4159 - loss: -2995218.7500 - pred_intensity_loss: -2995218.7500 - trimmed_obj_loss: 0.0000e+00[1m 5/61[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 15ms/step - intensity_scaler_inv_loss: 139.1496 - loss: -2945854.5000 - pred_intensity_loss: -2945854.5000 - trimmed_obj_loss: 0.0000e+00[1m 9/61[0m [32mâ”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 139.6833 - loss: -2963356.2500 - pred_intensity_loss: -2963356.2500 - trimmed_obj_loss: 0.0000e+00[1m13/61[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 139.7224 - loss: -2971762.5000 - pred_intensity_loss: -2971762.5000 - trimmed_obj_loss: 0.0000e+00[1m17/61[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 139.6183 - loss: -2976749.0000 - pred_intensity_loss: -2976749.0000 - trimmed_obj_loss: 0.0000e+00[1m21/61[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 139.6403 - loss: -2981702.2500 - pred_intensity_loss: -2981702.2500 - trimmed_obj_loss: 0.0000e+00[1m25/61[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 139.6945 - loss: -2985388.5000 - pred_intensity_loss: -2985388.5000 - trimmed_obj_loss: 0.0000e+00[1m29/61[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 139.6917 - loss: -2987305.7500 - pred_intensity_loss: -2987305.7500 - trimmed_obj_loss: 0.0000e+00[1m33/61[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 139.5849 - loss: -2987942.0000 - pred_intensity_loss: -2987942.0000 - trimmed_obj_loss: 0.0000e+00[1m37/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 139.5261 - loss: -2988985.5000 - pred_intensity_loss: -2988985.5000 - trimmed_obj_loss: 0.0000e+00[1m41/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 139.5024 - loss: -2990015.0000 - pred_intensity_loss: -2990015.0000 - trimmed_obj_loss: 0.0000e+00[1m45/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 139.5040 - loss: -2990733.2500 - pred_intensity_loss: -2990733.2500 - trimmed_obj_loss: 0.0000e+00[1m49/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 139.4957 - loss: -2991266.2500 - pred_intensity_loss: -2991266.2500 - trimmed_obj_loss: 0.0000e+00[1m53/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 139.4992 - loss: -2992009.0000 - pred_intensity_loss: -2992009.0000 - trimmed_obj_loss: 0.0000e+00[1m57/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 139.5178 - loss: -2992632.5000 - pred_intensity_loss: -2992632.5000 - trimmed_obj_loss: 0.0000e+00[1m61/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 14ms/step - intensity_scaler_inv_loss: 139.5509 - loss: -2993212.7500 - pred_intensity_loss: -2993211.7500 - trimmed_obj_loss: 0.0000e+00[1m61/61[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 15ms/step - intensity_scaler_inv_loss: 140.2133 - loss: -3001681.7500 - pred_intensity_loss: -3001617.5000 - trimmed_obj_loss: 0.0000e+00 - val_intensity_scaler_inv_loss: 131.4962 - val_loss: -2996551.7500 - val_pred_intensity_loss: -3042325.5000 - val_trimmed_obj_loss: 0.0000e+00 - learning_rate: 0.0010
W0000 00:00:1763132675.533107 3044540 loop_optimizer.cc:934] Skipping loop optimization for Merge node with control input: functional_1/padded_obj_2_1/cond_3/branch_executed/_39
2025-11-14 07:04:36.105711: W tensorflow/core/framework/op_kernel.cc:1857] OP_REQUIRES failed at xla_ops.cc:591 : INVALID_ARGUMENT: Input to reshape is a tensor with 778752 values, but the requested shape has 24336

Stack trace for op definition: 
File "Documents/PtychoPINN/scripts/training/train.py", line 440, in <module>
File "Documents/PtychoPINN/scripts/training/train.py", line 419, in main
File "Documents/PtychoPINN/ptycho/workflows/backend_selector.py", line 141, in run_cdi_example_with_backend
File "Documents/PtychoPINN/ptycho/workflows/components.py", line 846, in run_cdi_example
File "Documents/PtychoPINN/ptycho/workflows/components.py", line 726, in train_cdi_model
File "Documents/PtychoPINN/ptycho/train_pinn.py", line 90, in train_eval
File "Documents/PtychoPINN/ptycho/train_pinn.py", line 86, in train
File "Documents/PtychoPINN/ptycho/model.py", line 593, in train
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 377, in fit
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 220, in function
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 133, in multi_step_on_iterator
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 114, in one_step_on_data
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 58, in train_step
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/models/functional.py", line 183, in call
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/function.py", line 206, in _run_through_graph
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/models/functional.py", line 644, in call
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "Documents/PtychoPINN/ptycho/custom_layers.py", line 155, in call
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 1070, in reassemble_patches
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 678, in newf
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 1318, in reassemble_patches_position_batched_real
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 1001, in _reassemble_position_batched
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 912, in original_approach
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 834, in call
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 678, in newf
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 798, in translate
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 722, in translate_core
File "Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 294, in translate_xla
File "Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 209, in projective_warp_xla_jit
File "Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 121, in projective_warp_xla
File "Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 145, in projective_warp_xla
File "Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 182, in projective_warp_xla

	 [[{{node Reshape_21}}]]
	tf2xla conversion failed while converting __inference_projective_warp_xla_jit_2335[]. Run with TF_DUMP_GRAPH_PREFIX=/path/to/dump/dir and --vmodule=xla_compiler=2 to obtain a dump of the compiled functions.
2025-11-14 07:04:36.105737: I tensorflow/core/framework/local_rendezvous.cc:407] Local rendezvous is aborting with status: INVALID_ARGUMENT: Input to reshape is a tensor with 778752 values, but the requested shape has 24336

Stack trace for op definition: 
File "Documents/PtychoPINN/scripts/training/train.py", line 440, in <module>
File "Documents/PtychoPINN/scripts/training/train.py", line 419, in main
File "Documents/PtychoPINN/ptycho/workflows/backend_selector.py", line 141, in run_cdi_example_with_backend
File "Documents/PtychoPINN/ptycho/workflows/components.py", line 846, in run_cdi_example
File "Documents/PtychoPINN/ptycho/workflows/components.py", line 726, in train_cdi_model
File "Documents/PtychoPINN/ptycho/train_pinn.py", line 90, in train_eval
File "Documents/PtychoPINN/ptycho/train_pinn.py", line 86, in train
File "Documents/PtychoPINN/ptycho/model.py", line 593, in train
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 377, in fit
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 220, in function
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 133, in multi_step_on_iterator
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 114, in one_step_on_data
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 58, in train_step
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/models/functional.py", line 183, in call
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/function.py", line 206, in _run_through_graph
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/models/functional.py", line 644, in call
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "Documents/PtychoPINN/ptycho/custom_layers.py", line 155, in call
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 1070, in reassemble_patches
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 678, in newf
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 1318, in reassemble_patches_position_batched_real
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 1001, in _reassemble_position_batched
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 912, in original_approach
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 834, in call
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 678, in newf
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 798, in translate
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 722, in translate_core
File "Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 294, in translate_xla
File "Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 209, in projective_warp_xla_jit
File "Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 121, in projective_warp_xla
File "Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 145, in projective_warp_xla
File "Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 182, in projective_warp_xla

	 [[{{node Reshape_21}}]]
	tf2xla conversion failed while converting __inference_projective_warp_xla_jit_2335[]. Run with TF_DUMP_GRAPH_PREFIX=/path/to/dump/dir and --vmodule=xla_compiler=2 to obtain a dump of the compiled functions.
	 [[functional_1/padded_objs_with_offsets_1/translation_36_1/PartitionedCall_1]]
2025-11-14 07:04:36.122281: W tensorflow/core/framework/op_kernel.cc:1857] OP_REQUIRES failed at xla_ops.cc:591 : INVALID_ARGUMENT: Input to reshape is a tensor with 778752 values, but the requested shape has 24336

Stack trace for op definition: 
File "Documents/PtychoPINN/scripts/training/train.py", line 440, in <module>
File "Documents/PtychoPINN/scripts/training/train.py", line 419, in main
File "Documents/PtychoPINN/ptycho/workflows/backend_selector.py", line 141, in run_cdi_example_with_backend
File "Documents/PtychoPINN/ptycho/workflows/components.py", line 846, in run_cdi_example
File "Documents/PtychoPINN/ptycho/workflows/components.py", line 726, in train_cdi_model
File "Documents/PtychoPINN/ptycho/train_pinn.py", line 90, in train_eval
File "Documents/PtychoPINN/ptycho/train_pinn.py", line 86, in train
File "Documents/PtychoPINN/ptycho/model.py", line 593, in train
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 377, in fit
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 220, in function
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 133, in multi_step_on_iterator
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 114, in one_step_on_data
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 58, in train_step
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/models/functional.py", line 183, in call
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/function.py", line 206, in _run_through_graph
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/models/functional.py", line 644, in call
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "Documents/PtychoPINN/ptycho/custom_layers.py", line 155, in call
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 1070, in reassemble_patches
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 678, in newf
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 1318, in reassemble_patches_position_batched_real
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 1001, in _reassemble_position_batched
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 912, in original_approach
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 834, in call
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 678, in newf
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 798, in translate
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 722, in translate_core
File "Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 294, in translate_xla
File "Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 209, in projective_warp_xla_jit
File "Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 121, in projective_warp_xla
File "Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 145, in projective_warp_xla
File "Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 182, in projective_warp_xla

	 [[{{node Reshape_21}}]]
	tf2xla conversion failed while converting __inference_projective_warp_xla_jit_2335[]. Run with TF_DUMP_GRAPH_PREFIX=/path/to/dump/dir and --vmodule=xla_compiler=2 to obtain a dump of the compiled functions.
DEBUG: Setting probe to tf.Tensor(
[[[ 0.13510734-0.08366051j]
  [-0.08103182-0.0294797j ]
  [ 0.0637618 +0.02550233j]
  ...
  [-0.05742923+0.10465012j]
  [ 0.061039  +0.02731375j]
  [-0.07001488-0.0336627j ]]

 [[-0.08103182-0.0294797j ]
  [ 0.11364837-0.04388378j]
  [-0.08643168+0.03117809j]
  ...
  [ 0.02872955+0.03712314j]
  [-0.08476108+0.03176096j]
  [ 0.10533146-0.04452544j]]

 [[ 0.0637618 +0.02550233j]
  [-0.08643168+0.03117809j]
  [ 0.06238977-0.04183936j]
  ...
  [-0.01890127-0.04941669j]
  [ 0.06107059-0.04259919j]
  [-0.07948506+0.03188787j]]

 ...

 [[-0.05742923+0.10465012j]
  [ 0.02872955+0.03712314j]
  [-0.01890127-0.04941669j]
  ...
  [-0.00577373-0.08714116j]
  [-0.01781569-0.0517069j ]
  [ 0.02285527+0.04448525j]]

 [[ 0.061039  +0.02731375j]
  [-0.08476108+0.03176096j]
  [ 0.06107059-0.04259919j]
  ...
  [-0.01781569-0.0517069j ]
  [ 0.05980607-0.0434007j ]
  [-0.07803912+0.03257083j]]

 [[-0.07001488-0.0336627j ]
  [ 0.10533146-0.04452544j]
  [-0.07948506+0.03188787j]
  ...
  [ 0.02285527+0.04448525j]
  [-0.07803912+0.03257083j]
  [ 0.09786177-0.04529788j]]], shape=(64, 64, 1), dtype=complex64) in params
INFO: setting probe from test data container. It MUST be consistent with the training probe
input shape (128, 64, 64, 1)
2025-11-14 07:04:36,151 - ERROR - An error occurred during execution: Graph execution error:

Detected at node Reshape_21 defined at (most recent call last):
<stack traces unavailable>
Input to reshape is a tensor with 778752 values, but the requested shape has 24336

Stack trace for op definition: 
File "Documents/PtychoPINN/scripts/training/train.py", line 440, in <module>
File "Documents/PtychoPINN/scripts/training/train.py", line 419, in main
File "Documents/PtychoPINN/ptycho/workflows/backend_selector.py", line 141, in run_cdi_example_with_backend
File "Documents/PtychoPINN/ptycho/workflows/components.py", line 846, in run_cdi_example
File "Documents/PtychoPINN/ptycho/workflows/components.py", line 726, in train_cdi_model
File "Documents/PtychoPINN/ptycho/train_pinn.py", line 90, in train_eval
File "Documents/PtychoPINN/ptycho/train_pinn.py", line 86, in train
File "Documents/PtychoPINN/ptycho/model.py", line 593, in train
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 377, in fit
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 220, in function
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 133, in multi_step_on_iterator
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 114, in one_step_on_data
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 58, in train_step
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/models/functional.py", line 183, in call
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/function.py", line 206, in _run_through_graph
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/models/functional.py", line 644, in call
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "Documents/PtychoPINN/ptycho/custom_layers.py", line 155, in call
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 1070, in reassemble_patches
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 678, in newf
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 1318, in reassemble_patches_position_batched_real
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 1001, in _reassemble_position_batched
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 912, in original_approach
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 834, in call
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 678, in newf
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 798, in translate
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 722, in translate_core
File "Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 294, in translate_xla
File "Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 209, in projective_warp_xla_jit
File "Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 121, in projective_warp_xla
File "Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 145, in projective_warp_xla
File "Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 182, in projective_warp_xla

	 [[{{node Reshape_21}}]]
	tf2xla conversion failed while converting __inference_projective_warp_xla_jit_2335[]. Run with TF_DUMP_GRAPH_PREFIX=/path/to/dump/dir and --vmodule=xla_compiler=2 to obtain a dump of the compiled functions.
	 [[functional_1/padded_objs_with_offsets_1/translation_36_1/PartitionedCall_1]] [Op:__inference_one_step_on_data_distributed_38575]
Traceback (most recent call last):
  File "/home/ollie/Documents/PtychoPINN/scripts/training/train.py", line 440, in <module>
    main()
  File "/home/ollie/Documents/PtychoPINN/scripts/training/train.py", line 419, in main
    recon_amp, recon_phase, results = run_cdi_example_with_backend(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/workflows/backend_selector.py", line 141, in run_cdi_example_with_backend
    recon_amp, recon_phase, results = tf_components.run_cdi_example(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/workflows/components.py", line 846, in run_cdi_example
    train_results = train_cdi_model(train_data, test_data, config)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/workflows/components.py", line 726, in train_cdi_model
    results = train_pinn.train_eval(PtychoDataset(train_container, test_container))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/train_pinn.py", line 96, in train_eval
    eval_results = eval(ptycho_dataset.test_data, history, trained_model=model_instance)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/train_pinn.py", line 142, in eval
    reconstructed_obj, pred_amp, reconstructed_obj_cdi = trained_model.predict(
                                                         ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/tensorflow/python/eager/execute.py", line 53, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node Reshape_21 defined at (most recent call last):
<stack traces unavailable>
Input to reshape is a tensor with 778752 values, but the requested shape has 24336

Stack trace for op definition: 
File "Documents/PtychoPINN/scripts/training/train.py", line 440, in <module>
File "Documents/PtychoPINN/scripts/training/train.py", line 419, in main
File "Documents/PtychoPINN/ptycho/workflows/backend_selector.py", line 141, in run_cdi_example_with_backend
File "Documents/PtychoPINN/ptycho/workflows/components.py", line 846, in run_cdi_example
File "Documents/PtychoPINN/ptycho/workflows/components.py", line 726, in train_cdi_model
File "Documents/PtychoPINN/ptycho/train_pinn.py", line 90, in train_eval
File "Documents/PtychoPINN/ptycho/train_pinn.py", line 86, in train
File "Documents/PtychoPINN/ptycho/model.py", line 593, in train
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 377, in fit
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 220, in function
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 133, in multi_step_on_iterator
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 114, in one_step_on_data
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 58, in train_step
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/models/functional.py", line 183, in call
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/function.py", line 206, in _run_through_graph
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/models/functional.py", line 644, in call
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "Documents/PtychoPINN/ptycho/custom_layers.py", line 155, in call
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 1070, in reassemble_patches
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 678, in newf
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 1318, in reassemble_patches_position_batched_real
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 1001, in _reassemble_position_batched
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 912, in original_approach
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 834, in call
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 678, in newf
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 798, in translate
File "Documents/PtychoPINN/ptycho/tf_helper.py", line 722, in translate_core
File "Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 294, in translate_xla
File "Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 209, in projective_warp_xla_jit
File "Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 121, in projective_warp_xla
File "Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 145, in projective_warp_xla
File "Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 182, in projective_warp_xla

	 [[{{node Reshape_21}}]]
	tf2xla conversion failed while converting __inference_projective_warp_xla_jit_2335[]. Run with TF_DUMP_GRAPH_PREFIX=/path/to/dump/dir and --vmodule=xla_compiler=2 to obtain a dump of the compiled functions.
	 [[functional_1/padded_objs_with_offsets_1/translation_36_1/PartitionedCall_1]] [Op:__inference_one_step_on_data_distributed_38575]
