2026-01-11 00:27:55,113 - INFO - Starting scenario: gs2_integration
2026-01-11 00:27:55,114 - INFO - Run parameters: N=64 object_size=392 split_fraction=0.5 test_count=1000 total_images=2000
2026-01-11 00:27:55.296437: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1768120075.307773  839794 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1768120075.311642  839794 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1768120075.321463  839794 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1768120075.321475  839794 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1768120075.321477  839794 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1768120075.321478  839794 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2026-01-11 00:27:55.324488: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
I0000 00:00:1768120078.292393  839794 gpu_process_state.cc:208] Using CUDA malloc Async allocator for GPU: 0
I0000 00:00:1768120078.293603  839794 gpu_device.cc:2019] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22259 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:04:00.0, compute capability: 8.6
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1768120079.046597  839794 service.cc:152] XLA service 0x306df8c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
I0000 00:00:1768120079.046615  839794 service.cc:160]   StreamExecutor device (0): NVIDIA GeForce RTX 3090, Compute Capability 8.6
2026-01-11 00:27:59.066712: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:269] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
I0000 00:00:1768120079.085405  839794 cuda_dnn.cc:529] Loaded cuDNN version 91002
I0000 00:00:1768120079.243564  839794 device_compiler.h:188] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
WARNING:tensorflow:From /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/tensorflow_probability/python/distributions/distribution.py:342: calling _Independent.__init__ (from tensorflow_probability.python.distributions.independent) with reinterpreted_batch_ndims=None is deprecated and will be removed after 2022-03-01.
Instructions for updating:
Please pass an integer value for `reinterpreted_batch_ndims`. The current behavior corresponds to `reinterpreted_batch_ndims=tf.size(distribution.batch_shape_tensor()) - 1`.
2026-01-11 00:28:10.655028: I tensorflow/core/framework/local_rendezvous.cc:407] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
DEBUG: Setting data_source to lines in params
DEBUG: Setting data_source to generic in params
DEBUG: Setting N to 64 in params
DEBUG: Setting gridsize to 1 in params
DEBUG: Setting nphotons to 1000000000.0 in params
input shape (None, 64, 64, 1)
diff3d shape: (2000, 64, 64)
probeGuess shape: (64, 64)
scan_index shape: (2000,)
objectGuess shape: (392, 392)
xcoords shape: (2000,)
ycoords shape: (2000,)
xcoords_start shape: (2000,)
ycoords_start shape: (2000,)
DEBUG: Setting N to 64 in params
DEBUG: Setting gridsize to 1 in params
DEBUG: Setting nphotons to 1000000000.0 in params
diff3d shape: (1000, 64, 64)
probeGuess shape: (64, 64)
scan_index shape: (1000,)
objectGuess shape: (392, 392)
xcoords shape: (1000,)
ycoords shape: (1000,)
xcoords_start shape: (1000,)
ycoords_start shape: (1000,)
diff3d shape: (1000, 64, 64)
probeGuess shape: (64, 64)
scan_index shape: (1000,)
objectGuess shape: (392, 392)
xcoords shape: (1000,)
ycoords shape: (1000,)
xcoords_start shape: (1000,)
ycoords_start shape: (1000,)
2026-01-11 00:28:10,850 - INFO - Training config: N=64 gridsize=2 n_groups=1000 nphotons=1000000000.0 nepochs=5
2026-01-11 00:28:10,853 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=1000, n_points=1000, C=4, K=4
2026-01-11 00:28:10,853 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=2, N=64, sequential_sampling=False
2026-01-11 00:28:10,853 - INFO - [OVERSAMPLING DEBUG] Oversampling flags: enable_oversampling=False, neighbor_pool_size=None, effective_K=4
2026-01-11 00:28:10,853 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 1000 > 1000 = False
2026-01-11 00:28:10,853 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 4 > 1 = True
2026-01-11 00:28:10,853 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2026-01-11 00:28:10,853 - INFO - Using efficient random sampling strategy for gridsize=2
2026-01-11 00:28:10,853 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2026-01-11 00:28:10,853 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=1000, K=4, C=4
2026-01-11 00:28:10,853 - INFO - Generating 1000 groups efficiently from 1000 points (K=4, C=4)
2026-01-11 00:28:10,853 - INFO - [OVERSAMPLING DEBUG] Standard case: using 1000 groups from 1000 points
2026-01-11 00:28:10,853 - INFO - [OVERSAMPLING DEBUG] Using all 1000 points as seeds (no sampling needed)
2026-01-11 00:28:10,853 - INFO - Using all 1000 points as seeds
2026-01-11 00:28:10,859 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 1000 groups
2026-01-11 00:28:10,859 - INFO - Successfully generated 1000 groups with shape (1000, 4)
2026-01-11 00:28:10,859 - INFO - [OVERSAMPLING DEBUG] Generated 1000 groups in total
2026-01-11 00:28:10,859 - INFO - Generated 1000 groups efficiently
2026-01-11 00:28:11,196 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=1000, n_points=1000, C=4, K=4
2026-01-11 00:28:11,196 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=2, N=64, sequential_sampling=False
2026-01-11 00:28:11,196 - INFO - [OVERSAMPLING DEBUG] Oversampling flags: enable_oversampling=False, neighbor_pool_size=None, effective_K=4
2026-01-11 00:28:11,196 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 1000 > 1000 = False
2026-01-11 00:28:11,196 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 4 > 1 = True
2026-01-11 00:28:11,196 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2026-01-11 00:28:11,196 - INFO - Using efficient random sampling strategy for gridsize=2
2026-01-11 00:28:11,196 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2026-01-11 00:28:11,196 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=1000, K=4, C=4
2026-01-11 00:28:11,196 - INFO - Generating 1000 groups efficiently from 1000 points (K=4, C=4)
2026-01-11 00:28:11,196 - INFO - [OVERSAMPLING DEBUG] Standard case: using 1000 groups from 1000 points
2026-01-11 00:28:11,196 - INFO - [OVERSAMPLING DEBUG] Using all 1000 points as seeds (no sampling needed)
2026-01-11 00:28:11,196 - INFO - Using all 1000 points as seeds
2026-01-11 00:28:11,202 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 1000 groups
2026-01-11 00:28:11,202 - INFO - Successfully generated 1000 groups with shape (1000, 4)
2026-01-11 00:28:11,202 - INFO - [OVERSAMPLING DEBUG] Generated 1000 groups in total
2026-01-11 00:28:11,202 - INFO - Generated 1000 groups efficiently
DEBUG: nsamples: 1000, gridsize: 2 (using efficient random sample-then-group strategy)
INFO: Using pre-computed 'Y' array from the input file.
neighbor-sampled diffraction shape (1000, 64, 64, 4)
loader: using provided ground truth patches.
INFO: None
<PtychoDataContainer X=(1000, 64, 64, 4) mean=0.375 Y_I=(1000, 64, 64, 4) mean=2.580 Y_phi=(1000, 64, 64, 4) mean=0.000 coords_nominal=(1000, 1, 2, 4) mean=-0.000 coords_true=(1000, 1, 2, 4) mean=-0.000 probe=(64, 64) mean_amplitude=0.322 norm_Y_I=<scalar> nn_indices=(1000, 4) global_offsets=(1000, 1, 2, 1) local_offsets=(1000, 1, 2, 4)>
DEBUG: nsamples: 1000, gridsize: 2 (using efficient random sample-then-group strategy)
INFO: Using pre-computed 'Y' array from the input file.
neighbor-sampled diffraction shape (1000, 64, 64, 4)
loader: using provided ground truth patches.
INFO: None
<PtychoDataContainer X=(1000, 64, 64, 4) mean=0.377 Y_I=(1000, 64, 64, 4) mean=2.745 Y_phi=(1000, 64, 64, 4) mean=0.000 coords_nominal=(1000, 1, 2, 4) mean=0.000 coords_true=(1000, 1, 2, 4) mean=0.000 probe=(64, 64) mean_amplitude=0.322 norm_Y_I=<scalar> nn_indices=(1000, 4) global_offsets=(1000, 1, 2, 1) local_offsets=(1000, 1, 2, 4)>
DEBUG: Setting probe to tf.Tensor(
[[[-0.00399459+8.81725922e-03j]
  [ 0.00787074+1.04518672e-02j]
  [-0.01909852+2.85197329e-03j]
  ...
  [-0.00430549-1.44718047e-02j]
  [ 0.00670903+2.63100304e-02j]
  [-0.01938361-6.67245360e-03j]]

 [[ 0.00921909+5.32836141e-03j]
  [ 0.00422684-1.61591489e-02j]
  [-0.00324812+1.62756350e-02j]
  ...
  [-0.00462818-2.68168072e-03j]
  [ 0.01194528-6.69307355e-03j]
  [ 0.0090712 -3.79238278e-03j]]

 [[ 0.0029482 -1.10371104e-02j]
  [-0.01489174+5.26464824e-03j]
  [-0.00083129+1.31990444e-02j]
  ...
  [ 0.00208769+1.68677475e-02j]
  [ 0.00556216-3.03630810e-02j]
  [ 0.01604221+1.45274084e-02j]]

 ...

 [[ 0.01654117+3.83263193e-02j]
  [-0.01336122+7.02320365e-04j]
  [-0.00380601-8.65837932e-03j]
  ...
  [ 0.01785212+2.66705058e-03j]
  [-0.01791506+7.16461660e-03j]
  [ 0.01052329-2.80616116e-02j]]

 [[-0.02582748-2.17778888e-05j]
  [ 0.0098637 -3.15875164e-03j]
  [-0.0156169 +2.47947779e-02j]
  ...
  [-0.01378679-1.89308310e-03j]
  [ 0.00439025-1.43125653e-02j]
  [ 0.02400579-1.19637549e-02j]]

 [[-0.00013256-1.32157737e-02j]
  [ 0.03951043+1.84629709e-02j]
  [-0.00848375+3.90608120e-03j]
  ...
  [-0.00414446+2.40438167e-04j]
  [ 0.01858319+1.01260375e-02j]
  [ 0.01299333+1.25071155e-02j]]], shape=(64, 64, 1), dtype=complex64) in params
DEBUG: Setting intensity_scale to 988.21173 in params
DEBUG: Setting probe to tf.Tensor(
[[[-0.00399459+8.81725922e-03j]
  [ 0.00787074+1.04518672e-02j]
  [-0.01909852+2.85197329e-03j]
  ...
  [-0.00430549-1.44718047e-02j]
  [ 0.00670903+2.63100304e-02j]
  [-0.01938361-6.67245360e-03j]]

 [[ 0.00921909+5.32836141e-03j]
  [ 0.00422684-1.61591489e-02j]
  [-0.00324812+1.62756350e-02j]
  ...
  [-0.00462818-2.68168072e-03j]
  [ 0.01194528-6.69307355e-03j]
  [ 0.0090712 -3.79238278e-03j]]

 [[ 0.0029482 -1.10371104e-02j]
  [-0.01489174+5.26464824e-03j]
  [-0.00083129+1.31990444e-02j]
  ...
  [ 0.00208769+1.68677475e-02j]
  [ 0.00556216-3.03630810e-02j]
  [ 0.01604221+1.45274084e-02j]]

 ...

 [[ 0.01654117+3.83263193e-02j]
  [-0.01336122+7.02320365e-04j]
  [-0.00380601-8.65837932e-03j]
  ...
  [ 0.01785212+2.66705058e-03j]
  [-0.01791506+7.16461660e-03j]
  [ 0.01052329-2.80616116e-02j]]

 [[-0.02582748-2.17778888e-05j]
  [ 0.0098637 -3.15875164e-03j]
  [-0.0156169 +2.47947779e-02j]
  ...
  [-0.01378679-1.89308310e-03j]
  [ 0.00439025-1.43125653e-02j]
  [ 0.02400579-1.19637549e-02j]]

 [[-0.00013256-1.32157737e-02j]
  [ 0.03951043+1.84629709e-02j]
  [-0.00848375+3.90608120e-03j]
  ...
  [-0.00414446+2.40438167e-04j]
  [ 0.01858319+1.01260375e-02j]
  [ 0.01299333+1.25071155e-02j]]], shape=(64, 64, 1), dtype=complex64) in params
Current Parameters:
--------------------
N: 64
amp_activation: sigmoid
backend: tensorflow
batch_size: 16
bigN: 68
big_gridsize: 10
data_source: generic
debug: True
default_probe_scale: 0.7
enable_oversampling: False
gaussian_smoothing_sigma: 0.0
gridsize: 2
h5_path: wts.h5
intensity_scale: 988.2117309570312
intensity_scale.trainable: True
label: 
mae_weight: 0.0
max_position_jitter: 10
model_type: pinn
n_filters_scale: 2
n_groups: 1000
neighbor_count: 4
nepochs: 5
nimgs_test: 3
nimgs_train: 9
nll_weight: 1.0
nphotons: 1000000000.0
npseed: 42
object.big: True
offset: 4
outer_offset_test: None
outer_offset_train: None
output_prefix: .artifacts/sim_lines_4x/gs2_integration/train_outputs
pad_object: True
positions.provided: True
probe:
  shape: (64, 64, 1)
  mean: -0.016-0.002j
  std: 0.666
  min: -3.769-0.236j
  max: 2.823-0.116j
probe.big: True
probe.mask: False
probe.trainable: False
probe_scale: 4.0
realspace_mae_weight: 0.0
realspace_weight: 0.0
sequential_sampling: False
set_phi: False
sim_jitter_scale: 0.0
size: 392
torch_loss_mode: poisson
tv_weight: 0.0
use_xla_translate: True
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from global params: 64
DEBUG _flat_to_channel: input shape=(4000, 64, 64, 1), reshaping to (-1, 4, 64, 64)
Epoch 1/5
WARNING:tensorflow:You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2026-01-11 00:28:13,534 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
WARNING:tensorflow:You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2026-01-11 00:28:16,947 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2026-01-11 00:28:18.927595: W tensorflow/core/common_runtime/type_inference.cc:340] Type inference failed. This indicates an invalid graph that escaped type checking. Error message: INVALID_ARGUMENT: expected compatible input types, but input 1:
type_id: TFT_OPTIONAL
args {
  type_id: TFT_PRODUCT
  args {
    type_id: TFT_TENSOR
    args {
      type_id: TFT_INT32
    }
  }
}
 is neither a subtype nor a supertype of the combined inputs preceding it:
type_id: TFT_OPTIONAL
args {
  type_id: TFT_PRODUCT
  args {
    type_id: TFT_TENSOR
    args {
      type_id: TFT_FLOAT
    }
  }
}

	for Tuple type infernce function 0
	while inferring type of node 'StatefulPartitionedCall/functional_1/padded_obj_2_1/cond/output/_165'
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(None, 78, 78, 1), reshaping to (-1, 4, 78, 78)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(None, 78, 78, 1), reshaping to (-1, 4, 78, 78)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(None, 78, 78, 1), reshaping to (-1, 4, 78, 78)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(None, 78, 78, 1), reshaping to (-1, 4, 78, 78)
input shape (None, 64, 64, 1)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 64
DEBUG _flat_to_channel: input shape=(None, 64, 64, 1), reshaping to (-1, 4, 64, 64)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(None, 78, 78, 1), reshaping to (-1, 4, 78, 78)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(None, 78, 78, 1), reshaping to (-1, 4, 78, 78)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(None, 78, 78, 1), reshaping to (-1, 4, 78, 78)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(None, 78, 78, 1), reshaping to (-1, 4, 78, 78)
input shape (None, 64, 64, 1)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 64
DEBUG _flat_to_channel: input shape=(None, 64, 64, 1), reshaping to (-1, 4, 64, 64)
[1m 1/60[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m10:57[0m 11s/step - intensity_scaler_inv_loss: 214.2842 - loss: -2007147.7500 - pred_intensity_loss: -2007147.7500 - trimmed_obj_loss: 0.0000e+00[1m 4/60[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 23ms/step - intensity_scaler_inv_loss: 2024.2544 - loss: 15149509.0000 - pred_intensity_loss: 15149509.0000 - trimmed_obj_loss: 0.0000e+00 [1m 7/60[0m [32mâ”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 22ms/step - intensity_scaler_inv_loss: 2055.9285 - loss: 14414550.0000 - pred_intensity_loss: 14414550.0000 - trimmed_obj_loss: 0.0000e+00[1m10/60[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 21ms/step - intensity_scaler_inv_loss: 1903.3032 - loss: 12501400.0000 - pred_intensity_loss: 12501400.0000 - trimmed_obj_loss: 0.0000e+00[1m13/60[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 1744.0303 - loss: 10835849.0000 - pred_intensity_loss: 10835849.0000 - trimmed_obj_loss: 0.0000e+00[1m16/60[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 1607.7953 - loss: 9498247.0000 - pred_intensity_loss: 9498247.0000 - trimmed_obj_loss: 0.0000e+00  [1m19/60[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 1494.9215 - loss: 8416573.0000 - pred_intensity_loss: 8416573.0000 - trimmed_obj_loss: 0.0000e+00[1m22/60[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 1398.7334 - loss: 7519199.5000 - pred_intensity_loss: 7519199.5000 - trimmed_obj_loss: 0.0000e+00[1m25/60[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 1316.3555 - loss: 6761995.5000 - pred_intensity_loss: 6761995.5000 - trimmed_obj_loss: 0.0000e+00[1m28/60[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 1244.6038 - loss: 6118401.0000 - pred_intensity_loss: 6118401.0000 - trimmed_obj_loss: 0.0000e+00[1m31/60[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 1181.5879 - loss: 5564683.0000 - pred_intensity_loss: 5564683.0000 - trimmed_obj_loss: 0.0000e+00[1m34/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 1125.6365 - loss: 5082063.5000 - pred_intensity_loss: 5082063.5000 - trimmed_obj_loss: 0.0000e+00[1m37/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 20ms/step - intensity_scaler_inv_loss: 1075.6838 - loss: 4657990.5000 - pred_intensity_loss: 4657990.5000 - trimmed_obj_loss: 0.0000e+00[1m40/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 20ms/step - intensity_scaler_inv_loss: 1030.8368 - loss: 4282452.5000 - pred_intensity_loss: 4282452.5000 - trimmed_obj_loss: 0.0000e+00[1m43/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 20ms/step - intensity_scaler_inv_loss: 990.2549 - loss: 3947161.5000 - pred_intensity_loss: 3947161.5000 - trimmed_obj_loss: 0.0000e+00 [1m46/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 20ms/step - intensity_scaler_inv_loss: 953.3514 - loss: 3645770.0000 - pred_intensity_loss: 3645770.0000 - trimmed_obj_loss: 0.0000e+00[1m49/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 20ms/step - intensity_scaler_inv_loss: 919.6630 - loss: 3373355.2500 - pred_intensity_loss: 3373355.2500 - trimmed_obj_loss: 0.0000e+00[1m52/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 20ms/step - intensity_scaler_inv_loss: 888.7554 - loss: 3125532.5000 - pred_intensity_loss: 3125532.5000 - trimmed_obj_loss: 0.0000e+00[1m55/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 20ms/step - intensity_scaler_inv_loss: 860.2869 - loss: 2898735.2500 - pred_intensity_loss: 2898735.2500 - trimmed_obj_loss: 0.0000e+00[1m58/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 20ms/step - intensity_scaler_inv_loss: 833.9720 - loss: 2690382.0000 - pred_intensity_loss: 2690382.0000 - trimmed_obj_loss: 0.0000e+00[1m60/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 37ms/step - intensity_scaler_inv_loss: 817.4951 - loss: 2561009.7500 - pred_intensity_loss: 2560775.7500 - trimmed_obj_loss: 0.0000e+00WARNING:tensorflow:You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
2026-01-11 00:28:26,836 - WARNING - You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(None, 78, 78, 1), reshaping to (-1, 4, 78, 78)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(None, 78, 78, 1), reshaping to (-1, 4, 78, 78)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(None, 78, 78, 1), reshaping to (-1, 4, 78, 78)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(None, 78, 78, 1), reshaping to (-1, 4, 78, 78)
input shape (None, 64, 64, 1)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 64
DEBUG _flat_to_channel: input shape=(None, 64, 64, 1), reshaping to (-1, 4, 64, 64)
[1m60/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m15s[0m 66ms/step - intensity_scaler_inv_loss: 337.2543 - loss: -1195066.5000 - pred_intensity_loss: -1209098.1250 - trimmed_obj_loss: 0.0000e+00 - val_intensity_scaler_inv_loss: 104.0067 - val_loss: -4310370.0000 - val_pred_intensity_loss: -4461448.5000 - val_trimmed_obj_loss: 0.0000e+00 - learning_rate: 0.0010
Epoch 2/5
[1m 1/60[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m2s[0m 50ms/step - intensity_scaler_inv_loss: 83.0785 - loss: -2718695.5000 - pred_intensity_loss: -2718695.5000 - trimmed_obj_loss: 0.0000e+00[1m 4/60[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 23ms/step - intensity_scaler_inv_loss: 80.0528 - loss: -2763211.2500 - pred_intensity_loss: -2763211.2500 - trimmed_obj_loss: 0.0000e+00[1m 7/60[0m [32mâ”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 22ms/step - intensity_scaler_inv_loss: 79.2007 - loss: -2806630.0000 - pred_intensity_loss: -2806630.0000 - trimmed_obj_loss: 0.0000e+00[1m10/60[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 22ms/step - intensity_scaler_inv_loss: 78.4900 - loss: -2825542.2500 - pred_intensity_loss: -2825542.2500 - trimmed_obj_loss: 0.0000e+00[1m13/60[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 22ms/step - intensity_scaler_inv_loss: 78.0765 - loss: -2836037.2500 - pred_intensity_loss: -2836037.2500 - trimmed_obj_loss: 0.0000e+00[1m16/60[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 77.6375 - loss: -2844544.5000 - pred_intensity_loss: -2844544.5000 - trimmed_obj_loss: 0.0000e+00[1m19/60[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 77.3088 - loss: -2848280.5000 - pred_intensity_loss: -2848280.5000 - trimmed_obj_loss: 0.0000e+00[1m22/60[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 77.1348 - loss: -2852684.0000 - pred_intensity_loss: -2852684.0000 - trimmed_obj_loss: 0.0000e+00[1m25/60[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 76.9563 - loss: -2855931.2500 - pred_intensity_loss: -2855931.2500 - trimmed_obj_loss: 0.0000e+00[1m28/60[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 76.7459 - loss: -2856023.2500 - pred_intensity_loss: -2856023.2500 - trimmed_obj_loss: 0.0000e+00[1m31/60[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 76.5435 - loss: -2855934.5000 - pred_intensity_loss: -2855934.5000 - trimmed_obj_loss: 0.0000e+00[1m34/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 76.3425 - loss: -2854777.0000 - pred_intensity_loss: -2854777.0000 - trimmed_obj_loss: 0.0000e+00[1m37/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 76.1597 - loss: -2855322.0000 - pred_intensity_loss: -2855322.0000 - trimmed_obj_loss: 0.0000e+00[1m40/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 75.9860 - loss: -2855918.0000 - pred_intensity_loss: -2855918.0000 - trimmed_obj_loss: 0.0000e+00[1m43/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 75.8343 - loss: -2855331.2500 - pred_intensity_loss: -2855331.2500 - trimmed_obj_loss: 0.0000e+00[1m46/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 75.6934 - loss: -2854370.7500 - pred_intensity_loss: -2854370.7500 - trimmed_obj_loss: 0.0000e+00[1m49/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 20ms/step - intensity_scaler_inv_loss: 75.5630 - loss: -2853801.0000 - pred_intensity_loss: -2853801.0000 - trimmed_obj_loss: 0.0000e+00[1m52/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 20ms/step - intensity_scaler_inv_loss: 75.4655 - loss: -2853971.0000 - pred_intensity_loss: -2853971.0000 - trimmed_obj_loss: 0.0000e+00[1m55/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 20ms/step - intensity_scaler_inv_loss: 75.3837 - loss: -2853582.2500 - pred_intensity_loss: -2853582.2500 - trimmed_obj_loss: 0.0000e+00[1m58/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 20ms/step - intensity_scaler_inv_loss: 75.3008 - loss: -2853855.0000 - pred_intensity_loss: -2853855.0000 - trimmed_obj_loss: 0.0000e+00[1m60/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 22ms/step - intensity_scaler_inv_loss: 73.5155 - loss: -2865513.0000 - pred_intensity_loss: -2868237.2500 - trimmed_obj_loss: 0.0000e+00 - val_intensity_scaler_inv_loss: 89.9853 - val_loss: -4322612.0000 - val_pred_intensity_loss: -4474374.0000 - val_trimmed_obj_loss: 0.0000e+00 - learning_rate: 0.0010
Epoch 3/5
[1m 1/60[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m2s[0m 48ms/step - intensity_scaler_inv_loss: 76.7511 - loss: -2934277.2500 - pred_intensity_loss: -2934277.2500 - trimmed_obj_loss: 0.0000e+00[1m 4/60[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 22ms/step - intensity_scaler_inv_loss: 72.3830 - loss: -2790766.0000 - pred_intensity_loss: -2790766.0000 - trimmed_obj_loss: 0.0000e+00[1m 7/60[0m [32mâ”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 22ms/step - intensity_scaler_inv_loss: 71.6049 - loss: -2768981.7500 - pred_intensity_loss: -2768981.7500 - trimmed_obj_loss: 0.0000e+00[1m10/60[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 22ms/step - intensity_scaler_inv_loss: 71.0062 - loss: -2774189.5000 - pred_intensity_loss: -2774189.5000 - trimmed_obj_loss: 0.0000e+00[1m13/60[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 22ms/step - intensity_scaler_inv_loss: 70.9156 - loss: -2779449.0000 - pred_intensity_loss: -2779449.0000 - trimmed_obj_loss: 0.0000e+00[1m16/60[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 22ms/step - intensity_scaler_inv_loss: 70.9531 - loss: -2795510.0000 - pred_intensity_loss: -2795510.0000 - trimmed_obj_loss: 0.0000e+00[1m19/60[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 22ms/step - intensity_scaler_inv_loss: 70.8895 - loss: -2807286.7500 - pred_intensity_loss: -2807286.7500 - trimmed_obj_loss: 0.0000e+00[1m22/60[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 70.9675 - loss: -2820098.5000 - pred_intensity_loss: -2820098.5000 - trimmed_obj_loss: 0.0000e+00[1m25/60[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 71.0134 - loss: -2827670.2500 - pred_intensity_loss: -2827670.2500 - trimmed_obj_loss: 0.0000e+00[1m28/60[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 71.0350 - loss: -2830075.7500 - pred_intensity_loss: -2830075.7500 - trimmed_obj_loss: 0.0000e+00[1m31/60[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 71.0076 - loss: -2831507.7500 - pred_intensity_loss: -2831507.7500 - trimmed_obj_loss: 0.0000e+00[1m34/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 70.9384 - loss: -2831848.7500 - pred_intensity_loss: -2831848.7500 - trimmed_obj_loss: 0.0000e+00[1m37/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 70.9179 - loss: -2830847.0000 - pred_intensity_loss: -2830847.0000 - trimmed_obj_loss: 0.0000e+00[1m40/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 70.8964 - loss: -2829317.5000 - pred_intensity_loss: -2829317.5000 - trimmed_obj_loss: 0.0000e+00[1m43/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 70.8793 - loss: -2829006.5000 - pred_intensity_loss: -2829006.5000 - trimmed_obj_loss: 0.0000e+00[1m46/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 70.8785 - loss: -2829757.0000 - pred_intensity_loss: -2829757.0000 - trimmed_obj_loss: 0.0000e+00[1m49/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 70.9002 - loss: -2831445.5000 - pred_intensity_loss: -2831445.5000 - trimmed_obj_loss: 0.0000e+00[1m52/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 70.9378 - loss: -2832878.0000 - pred_intensity_loss: -2832878.0000 - trimmed_obj_loss: 0.0000e+00[1m55/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 70.9707 - loss: -2833686.0000 - pred_intensity_loss: -2833686.0000 - trimmed_obj_loss: 0.0000e+00[1m58/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 71.0114 - loss: -2834677.7500 - pred_intensity_loss: -2834677.7500 - trimmed_obj_loss: 0.0000e+00[1m60/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 22ms/step - intensity_scaler_inv_loss: 71.8439 - loss: -2866619.0000 - pred_intensity_loss: -2872777.5000 - trimmed_obj_loss: 0.0000e+00 - val_intensity_scaler_inv_loss: 79.7305 - val_loss: -4331798.5000 - val_pred_intensity_loss: -4484601.5000 - val_trimmed_obj_loss: 0.0000e+00 - learning_rate: 0.0010
Epoch 4/5
[1m 1/60[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m2s[0m 49ms/step - intensity_scaler_inv_loss: 88.4750 - loss: -2577492.0000 - pred_intensity_loss: -2577492.0000 - trimmed_obj_loss: 0.0000e+00[1m 4/60[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 23ms/step - intensity_scaler_inv_loss: 83.5231 - loss: -2771801.7500 - pred_intensity_loss: -2771801.7500 - trimmed_obj_loss: 0.0000e+00[1m 7/60[0m [32mâ”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 22ms/step - intensity_scaler_inv_loss: 81.0973 - loss: -2773040.0000 - pred_intensity_loss: -2773040.0000 - trimmed_obj_loss: 0.0000e+00[1m10/60[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 22ms/step - intensity_scaler_inv_loss: 79.3229 - loss: -2769215.7500 - pred_intensity_loss: -2769215.7500 - trimmed_obj_loss: 0.0000e+00[1m13/60[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 22ms/step - intensity_scaler_inv_loss: 77.9024 - loss: -2768842.7500 - pred_intensity_loss: -2768842.7500 - trimmed_obj_loss: 0.0000e+00[1m16/60[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 76.8597 - loss: -2765901.0000 - pred_intensity_loss: -2765901.0000 - trimmed_obj_loss: 0.0000e+00[1m19/60[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 76.2691 - loss: -2765986.7500 - pred_intensity_loss: -2765986.7500 - trimmed_obj_loss: 0.0000e+00[1m22/60[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 75.8716 - loss: -2771313.2500 - pred_intensity_loss: -2771313.2500 - trimmed_obj_loss: 0.0000e+00[1m25/60[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 75.5579 - loss: -2774748.7500 - pred_intensity_loss: -2774748.7500 - trimmed_obj_loss: 0.0000e+00[1m28/60[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 75.2680 - loss: -2776651.5000 - pred_intensity_loss: -2776651.5000 - trimmed_obj_loss: 0.0000e+00[1m31/60[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 75.0286 - loss: -2781508.0000 - pred_intensity_loss: -2781508.0000 - trimmed_obj_loss: 0.0000e+00[1m34/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 74.8146 - loss: -2786293.2500 - pred_intensity_loss: -2786293.2500 - trimmed_obj_loss: 0.0000e+00[1m37/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 74.6146 - loss: -2789969.2500 - pred_intensity_loss: -2789969.2500 - trimmed_obj_loss: 0.0000e+00[1m40/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 74.4209 - loss: -2792247.5000 - pred_intensity_loss: -2792247.5000 - trimmed_obj_loss: 0.0000e+00[1m43/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 74.2221 - loss: -2793851.5000 - pred_intensity_loss: -2793851.5000 - trimmed_obj_loss: 0.0000e+00[1m46/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 74.0744 - loss: -2796964.0000 - pred_intensity_loss: -2796964.0000 - trimmed_obj_loss: 0.0000e+00[1m49/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 73.9708 - loss: -2800988.2500 - pred_intensity_loss: -2800988.2500 - trimmed_obj_loss: 0.0000e+00[1m52/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 20ms/step - intensity_scaler_inv_loss: 73.9111 - loss: -2804950.0000 - pred_intensity_loss: -2804950.0000 - trimmed_obj_loss: 0.0000e+00[1m55/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 20ms/step - intensity_scaler_inv_loss: 73.8678 - loss: -2808830.0000 - pred_intensity_loss: -2808830.0000 - trimmed_obj_loss: 0.0000e+00[1m58/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 20ms/step - intensity_scaler_inv_loss: 73.8199 - loss: -2811944.0000 - pred_intensity_loss: -2811944.0000 - trimmed_obj_loss: 0.0000e+00[1m60/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 22ms/step - intensity_scaler_inv_loss: 72.7992 - loss: -2865875.7500 - pred_intensity_loss: -2862508.2500 - trimmed_obj_loss: 0.0000e+00 - val_intensity_scaler_inv_loss: 108.2552 - val_loss: -4304648.5000 - val_pred_intensity_loss: -4454343.0000 - val_trimmed_obj_loss: 0.0000e+00 - learning_rate: 0.0010
Epoch 5/5
[1m 1/60[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m2s[0m 48ms/step - intensity_scaler_inv_loss: 61.3690 - loss: -2840050.2500 - pred_intensity_loss: -2840050.2500 - trimmed_obj_loss: 0.0000e+00[1m 4/60[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 22ms/step - intensity_scaler_inv_loss: 62.5635 - loss: -2830686.5000 - pred_intensity_loss: -2830686.5000 - trimmed_obj_loss: 0.0000e+00[1m 7/60[0m [32mâ”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 22ms/step - intensity_scaler_inv_loss: 63.8736 - loss: -2797569.0000 - pred_intensity_loss: -2797569.0000 - trimmed_obj_loss: 0.0000e+00[1m10/60[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 22ms/step - intensity_scaler_inv_loss: 65.7164 - loss: -2794276.5000 - pred_intensity_loss: -2794276.5000 - trimmed_obj_loss: 0.0000e+00[1m13/60[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 21ms/step - intensity_scaler_inv_loss: 66.6638 - loss: -2783098.0000 - pred_intensity_loss: -2783098.0000 - trimmed_obj_loss: 0.0000e+00[1m16/60[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 67.0807 - loss: -2779728.5000 - pred_intensity_loss: -2779728.5000 - trimmed_obj_loss: 0.0000e+00[1m19/60[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 67.5900 - loss: -2785996.5000 - pred_intensity_loss: -2785996.5000 - trimmed_obj_loss: 0.0000e+00[1m22/60[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 68.0313 - loss: -2792867.5000 - pred_intensity_loss: -2792867.5000 - trimmed_obj_loss: 0.0000e+00[1m25/60[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 68.4750 - loss: -2798774.0000 - pred_intensity_loss: -2798774.0000 - trimmed_obj_loss: 0.0000e+00[1m28/60[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 68.8241 - loss: -2802334.2500 - pred_intensity_loss: -2802334.2500 - trimmed_obj_loss: 0.0000e+00[1m31/60[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 69.0529 - loss: -2805973.2500 - pred_intensity_loss: -2805973.2500 - trimmed_obj_loss: 0.0000e+00[1m34/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 69.2355 - loss: -2810083.5000 - pred_intensity_loss: -2810083.5000 - trimmed_obj_loss: 0.0000e+00[1m37/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 69.4071 - loss: -2814284.7500 - pred_intensity_loss: -2814284.7500 - trimmed_obj_loss: 0.0000e+00[1m40/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 69.5874 - loss: -2818654.0000 - pred_intensity_loss: -2818654.0000 - trimmed_obj_loss: 0.0000e+00[1m43/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 69.7838 - loss: -2823228.5000 - pred_intensity_loss: -2823228.5000 - trimmed_obj_loss: 0.0000e+00[1m46/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 69.9452 - loss: -2826846.2500 - pred_intensity_loss: -2826846.2500 - trimmed_obj_loss: 0.0000e+00[1m49/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 70.0777 - loss: -2830140.0000 - pred_intensity_loss: -2830140.0000 - trimmed_obj_loss: 0.0000e+00[1m52/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 70.1779 - loss: -2833125.2500 - pred_intensity_loss: -2833125.2500 - trimmed_obj_loss: 0.0000e+00[1m55/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 70.2436 - loss: -2835836.2500 - pred_intensity_loss: -2835836.2500 - trimmed_obj_loss: 0.0000e+00[1m58/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 21ms/step - intensity_scaler_inv_loss: 70.2922 - loss: -2838140.0000 - pred_intensity_loss: -2838140.0000 - trimmed_obj_loss: 0.0000e+00
Epoch 5: ReduceLROnPlateau reducing learning rate to 0.0005000000237487257.
[1m60/60[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 22ms/step - intensity_scaler_inv_loss: 70.8703 - loss: -2867165.2500 - pred_intensity_loss: -2864210.5000 - trimmed_obj_loss: 0.0000e+00 - val_intensity_scaler_inv_loss: 99.2013 - val_loss: -4312846.0000 - val_pred_intensity_loss: -4463140.0000 - val_trimmed_obj_loss: 0.0000e+00 - learning_rate: 0.0010
W0000 00:00:1768120114.076582  839794 loop_optimizer.cc:934] Skipping loop optimization for Merge node with control input: functional_1/padded_obj_2_1/cond_3/branch_executed/_39
DEBUG: Setting probe to tf.Tensor(
[[[-0.00399459+8.81725922e-03j]
  [ 0.00787074+1.04518672e-02j]
  [-0.01909852+2.85197329e-03j]
  ...
  [-0.00430549-1.44718047e-02j]
  [ 0.00670903+2.63100304e-02j]
  [-0.01938361-6.67245360e-03j]]

 [[ 0.00921909+5.32836141e-03j]
  [ 0.00422684-1.61591489e-02j]
  [-0.00324812+1.62756350e-02j]
  ...
  [-0.00462818-2.68168072e-03j]
  [ 0.01194528-6.69307355e-03j]
  [ 0.0090712 -3.79238278e-03j]]

 [[ 0.0029482 -1.10371104e-02j]
  [-0.01489174+5.26464824e-03j]
  [-0.00083129+1.31990444e-02j]
  ...
  [ 0.00208769+1.68677475e-02j]
  [ 0.00556216-3.03630810e-02j]
  [ 0.01604221+1.45274084e-02j]]

 ...

 [[ 0.01654117+3.83263193e-02j]
  [-0.01336122+7.02320365e-04j]
  [-0.00380601-8.65837932e-03j]
  ...
  [ 0.01785212+2.66705058e-03j]
  [-0.01791506+7.16461660e-03j]
  [ 0.01052329-2.80616116e-02j]]

 [[-0.02582748-2.17778888e-05j]
  [ 0.0098637 -3.15875164e-03j]
  [-0.0156169 +2.47947779e-02j]
  ...
  [-0.01378679-1.89308310e-03j]
  [ 0.00439025-1.43125653e-02j]
  [ 0.02400579-1.19637549e-02j]]

 [[-0.00013256-1.32157737e-02j]
  [ 0.03951043+1.84629709e-02j]
  [-0.00848375+3.90608120e-03j]
  ...
  [-0.00414446+2.40438167e-04j]
  [ 0.01858319+1.01260375e-02j]
  [ 0.01299333+1.25071155e-02j]]], shape=(64, 64, 1), dtype=complex64) in params
INFO: setting probe from test data container. It MUST be consistent with the training probe
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(128, 78, 78, 1), reshaping to (-1, 4, 78, 78)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(128, 78, 78, 1), reshaping to (-1, 4, 78, 78)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(128, 78, 78, 1), reshaping to (-1, 4, 78, 78)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(128, 78, 78, 1), reshaping to (-1, 4, 78, 78)
input shape (None, 64, 64, 1)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 64
DEBUG _flat_to_channel: input shape=(None, 64, 64, 1), reshaping to (-1, 4, 64, 64)
[1m 1/32[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m33s[0m 1s/step[1m 6/32[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 10ms/step[1m11/32[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 10ms/step[1m16/32[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 10ms/step[1m22/32[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 10ms/step[1m28/32[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 10ms/stepDEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(None, 78, 78, 1), reshaping to (-1, 4, 78, 78)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(None, 78, 78, 1), reshaping to (-1, 4, 78, 78)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(None, 78, 78, 1), reshaping to (-1, 4, 78, 78)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(None, 78, 78, 1), reshaping to (-1, 4, 78, 78)
input shape (None, 64, 64, 1)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 64
DEBUG _flat_to_channel: input shape=(None, 64, 64, 1), reshaping to (-1, 4, 64, 64)
[1m32/32[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 49ms/step[1m32/32[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m3s[0m 50ms/step
2026-01-11 00:28:36,027 - INFO - Backend dispatcher: training complete (backend=tensorflow)
2026-01-11 00:28:37,481 - INFO - Backend dispatcher: loading TensorFlow model (ptycho.workflows.components)
2026-01-11 00:28:37,481 - INFO - Loading model from: .artifacts/sim_lines_4x/gs2_integration/train_outputs
/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py:421: UserWarning: `build()` was called on layer 'center_mask_layer', however the layer does not have a `build()` method implemented and it looks like it has unbuilt state. This will cause the layer to be marked as built, despite not being actually built, which may cause failures down the line. Make sure to implement a proper `build()` method.
  warnings.warn(
/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py:421: UserWarning: `build()` was called on layer 'center_mask_layer_1', however the layer does not have a `build()` method implemented and it looks like it has unbuilt state. This will cause the layer to be marked as built, despite not being actually built, which may cause failures down the line. Make sure to implement a proper `build()` method.
  warnings.warn(
2026-01-11 00:28:38,887 - INFO - Successfully loaded model from .artifacts/sim_lines_4x/gs2_integration/train_outputs
2026-01-11 00:28:38,889 - INFO - Backend dispatcher: inference bundle loaded (backend=tensorflow)
2026-01-11 00:28:38,889 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=1000, n_points=1000, C=4, K=4
2026-01-11 00:28:38,889 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=2, N=64, sequential_sampling=False
2026-01-11 00:28:38,889 - INFO - [OVERSAMPLING DEBUG] Oversampling flags: enable_oversampling=False, neighbor_pool_size=None, effective_K=4
2026-01-11 00:28:38,889 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 1000 > 1000 = False
2026-01-11 00:28:38,889 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 4 > 1 = True
2026-01-11 00:28:38,889 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2026-01-11 00:28:38,889 - INFO - Using efficient random sampling strategy for gridsize=2
2026-01-11 00:28:38,889 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2026-01-11 00:28:38,889 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=1000, K=4, C=4
2026-01-11 00:28:38,889 - INFO - Generating 1000 groups efficiently from 1000 points (K=4, C=4)
2026-01-11 00:28:38,889 - INFO - [OVERSAMPLING DEBUG] Standard case: using 1000 groups from 1000 points
2026-01-11 00:28:38,889 - INFO - [OVERSAMPLING DEBUG] Using all 1000 points as seeds (no sampling needed)
2026-01-11 00:28:38,889 - INFO - Using all 1000 points as seeds
2026-01-11 00:28:38,895 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 1000 groups
2026-01-11 00:28:38,895 - INFO - Successfully generated 1000 groups with shape (1000, 4)
2026-01-11 00:28:38,895 - INFO - [OVERSAMPLING DEBUG] Generated 1000 groups in total
2026-01-11 00:28:38,895 - INFO - Generated 1000 groups efficiently
2026-01-11 00:28:40.345482: W tensorflow/compiler/tf2xla/kernels/assert_op.cc:39] Ignoring Assert operator functional_1_1/padded_obj_2_1/cond/while/cond/assert_equal_1/Assert/Assert_tfg_inlined_functional_1_1/padded_obj_2_1/cond/while/cond_0
2026-01-11 00:28:40.454947: W tensorflow/compiler/tf2xla/kernels/assert_op.cc:39] Ignoring Assert operator functional_1_1/padded_obj_2_1/cond_1/while/cond/assert_equal_1/Assert/Assert_tfg_inlined_functional_1_1/padded_obj_2_1/cond_1/while/cond_tfg_inlined_functional_1_1/padded_obj_2_1/cond_1/while_1_0
2026-01-11 00:28:40.541583: W tensorflow/compiler/tf2xla/kernels/assert_op.cc:39] Ignoring Assert operator functional_1_1/padded_obj_2_1/cond_2/while/cond/assert_equal_1/Assert/Assert_tfg_inlined_functional_1_1/padded_obj_2_1/cond_2/while/cond_0
2026-01-11 00:28:40.605194: W tensorflow/compiler/tf2xla/kernels/assert_op.cc:39] Ignoring Assert operator functional_1_1/padded_obj_2_1/cond_3/while/cond/assert_equal_1/Assert/Assert_tfg_inlined_functional_1_1/padded_obj_2_1/cond_3/while/cond_0
2026-01-11 00:28:41.738093: E external/local_xla/xla/service/slow_operation_alarm.cc:73] Constant folding an instruction is taking > 1s:

  %pad.2249 = f32[256,64,64,1]{3,2,1,0} pad(f32[128,64,64,1]{3,2,1,0} %constant.2247, f32[] %constant.2248), padding=0_128x0_0x0_0x0_0, metadata={op_type="StridedSlice" op_name="functional_1_1/padded_obj_2_1/cond_1/while/strided_slice_tfg_inlined_functional_1_1/padded_obj_2_1/cond_1/while_1_tfg_cf_sunk_functional_1_1/padded_obj_2_1/cond_1/while/cond_tfg_inlined_functional_1_1/padded_obj_2_1/cond_1/while_1" source_file="dummy_file_name" source_line=10}

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime. XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
2026-01-11 00:28:42.370819: E external/local_xla/xla/service/slow_operation_alarm.cc:140] The operation took 1.632789836s
Constant folding an instruction is taking > 1s:

  %pad.2249 = f32[256,64,64,1]{3,2,1,0} pad(f32[128,64,64,1]{3,2,1,0} %constant.2247, f32[] %constant.2248), padding=0_128x0_0x0_0x0_0, metadata={op_type="StridedSlice" op_name="functional_1_1/padded_obj_2_1/cond_1/while/strided_slice_tfg_inlined_functional_1_1/padded_obj_2_1/cond_1/while_1_tfg_cf_sunk_functional_1_1/padded_obj_2_1/cond_1/while/cond_tfg_inlined_functional_1_1/padded_obj_2_1/cond_1/while_1" source_file="dummy_file_name" source_line=10}

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime. XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
Object stitching failed: cannot reshape array of size 159744 into shape (3,3,64,64,1)
cannot reshape array of size 159744 into shape (3,3,64,64,1)
DEBUG: nsamples: 1000, gridsize: 2 (using efficient random sample-then-group strategy)
INFO: Using pre-computed 'Y' array from the input file.
neighbor-sampled diffraction shape (1000, 64, 64, 4)
loader: using provided ground truth patches.
INFO: None
<PtychoDataContainer X=(1000, 64, 64, 4) mean=0.377 Y_I=(1000, 64, 64, 4) mean=2.745 Y_phi=(1000, 64, 64, 4) mean=0.000 coords_nominal=(1000, 1, 2, 4) mean=0.000 coords_true=(1000, 1, 2, 4) mean=0.000 probe=(64, 64) mean_amplitude=0.322 norm_Y_I=<scalar> nn_indices=(1000, 4) global_offsets=(1000, 1, 2, 1) local_offsets=(1000, 1, 2, 4)>
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(128, 78, 78, 1), reshaping to (-1, 4, 78, 78)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(128, 78, 78, 1), reshaping to (-1, 4, 78, 78)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(128, 78, 78, 1), reshaping to (-1, 4, 78, 78)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(128, 78, 78, 1), reshaping to (-1, 4, 78, 78)
[1m 1/32[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m3:04[0m 6s/step[1m11/32[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 5ms/step [1m21/32[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 5ms/step[1m31/32[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 5ms/step2026-01-11 00:28:46.447010: W tensorflow/compiler/tf2xla/kernels/assert_op.cc:39] Ignoring Assert operator functional_1_1/padded_obj_2_1/cond/while/cond/assert_equal_1/Assert/Assert_tfg_inlined_functional_1_1/padded_obj_2_1/cond/while/cond_0
2026-01-11 00:28:46.486572: W tensorflow/compiler/tf2xla/kernels/assert_op.cc:39] Ignoring Assert operator functional_1_1/padded_obj_2_1/cond_1/while/cond/assert_equal_1/Assert/Assert_tfg_inlined_functional_1_1/padded_obj_2_1/cond_1/while/cond_tfg_inlined_functional_1_1/padded_obj_2_1/cond_1/while_1_0
2026-01-11 00:28:46.526313: W tensorflow/compiler/tf2xla/kernels/assert_op.cc:39] Ignoring Assert operator functional_1_1/padded_obj_2_1/cond_2/while/cond/assert_equal_1/Assert/Assert_tfg_inlined_functional_1_1/padded_obj_2_1/cond_2/while/cond_tfg_inlined_functional_1_1/padded_obj_2_1/cond_2/while_1_0
2026-01-11 00:28:46.565722: W tensorflow/compiler/tf2xla/kernels/assert_op.cc:39] Ignoring Assert operator functional_1_1/padded_obj_2_1/cond_3/while/cond/assert_equal_1/Assert/Assert_tfg_inlined_functional_1_1/padded_obj_2_1/cond_3/while/cond_0
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(None, 78, 78, 1), reshaping to (-1, 4, 78, 78)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(None, 78, 78, 1), reshaping to (-1, 4, 78, 78)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(None, 78, 78, 1), reshaping to (-1, 4, 78, 78)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 78
DEBUG _flat_to_channel: input shape=(None, 78, 78, 1), reshaping to (-1, 4, 78, 78)
[1m32/32[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 67ms/step[1m32/32[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m8s[0m 67ms/step
2026-01-11 00:28:48,414 - INFO - Amplitude array shape: (136, 136, 1)
2026-01-11 00:28:48,414 - INFO - Phase array shape: (136, 136, 1)
2026-01-11 00:28:48,414 - INFO - Squeezed amplitude shape: (136, 136)
2026-01-11 00:28:48,414 - INFO - Squeezed phase shape: (136, 136)
2026-01-11 00:28:48,565 - INFO - Outputs saved to .artifacts/sim_lines_4x/gs2_integration/inference_outputs
2026-01-11 00:28:48,566 - INFO - Completed scenario: gs2_integration
