# Phase G Dense Real-Run Evidence — Supervisor Plan (2025-11-05T111247Z)

## Current Status Snapshot
- The prior hub `2025-11-09T190500Z` still only contains Phase C logs from 2025-11-05; analysis/ is empty and no metrics artifacts were produced.
- `run_phase_g_dense.py` is not currently running (`pgrep -fl run_phase_g_dense.py` and `pgrep -fl studies.fly64_dose_overlap` both return empty), so a new launch is required.
- The pre-flight regression log in the 190500Z hub is empty, indicating the guard test needs to be re-run before attempting the pipeline again.
- Objective: execute the dense Phase C→G pipeline end-to-end in this fresh hub (`2025-11-05T111247Z`) to capture MS-SSIM/MAE deltas, highlights, and digest artifacts for the dose=1000 dense condition.

## Scope for Ralph
1. **Workspace & process sanity check**
   - Export `AUTHORITATIVE_CMDS_DOC=./docs/TESTING_GUIDE.md`.
   - Confirm no lingering orchestrator processes: `pgrep -fl run_phase_g_dense.py` and `pgrep -fl studies.fly64_dose_overlap` should both return empty. If anything remains, terminate it before proceeding.
2. **Pre-flight regression**
   - Set `HUB=plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-05T111247Z/phase_g_dense_full_execution_real_run`.
   - Run `pytest tests/study/test_phase_g_dense_orchestrator.py::test_run_phase_g_dense_exec_runs_analyze_digest -vv` and tee output to `$HUB/green/pytest_orchestrator_dense_exec_recheck.log`.
3. **Dense pipeline execution**
   - From the repo root, launch `python plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/bin/run_phase_g_dense.py --hub "$PWD/$HUB" --dose 1000 --view dense --splits train test --clobber |& tee "$HUB"/cli/run_phase_g_dense.log`.
   - Expect a 2–4 hour runtime covering Phase C (dataset generation), Phase D (baseline inference), Phase E (PINN training), Phase F (PINN inference + digest), and Phase G (reporting helper + digest script).
4. **Evidence capture & verification**
   - After the pipeline exits 0, verify that `$HUB/analysis/` contains:
     - `metrics_summary.json`
     - `metrics_delta_summary.json`
     - `metrics_delta_highlights.txt`
     - `metrics_delta_highlights_preview.txt`
     - `metrics_digest.md`
     - `aggregate_report.md`
     - `aggregate_highlights.txt`
   - Generate `$HUB/analysis/artifact_inventory.txt` via `find "$HUB" -maxdepth 3 -type f | sort`.
   - Confirm highlights text matches the JSON deltas for both Baseline and PtyChi comparisons; capture diffs in summary.md if mismatched.
5. **Documentation updates**
   - Update `$HUB/summary/summary.md` with: pre-flight test status, pipeline runtime, provenance confirmation (CONFIG-001/DATA-001 adherence), MS-SSIM & MAE deltas for PtychoPINN vs Baseline/PtyChi, and artifact links.
   - Mirror the key deltas and artifact link in `docs/fix_plan.md` Attempts History for this initiative.
   - Archive any failure logs under `$HUB/cli/` (or `$HUB/red/` for pytest) and document blockers in summary.md + docs/fix_plan.md before marking blocked if the pipeline fails.

## Required Tests
- `pytest tests/study/test_phase_g_dense_orchestrator.py::test_run_phase_g_dense_exec_runs_analyze_digest -vv`

## Artifacts to Produce
- `$HUB/green/pytest_orchestrator_dense_exec_recheck.log`
- `$HUB/cli/run_phase_g_dense.log` plus per-phase CLI logs generated by the orchestrator
- `$HUB/analysis/{metrics_summary.json,metrics_delta_summary.json,metrics_delta_highlights.txt,metrics_delta_highlights_preview.txt,metrics_digest.md,aggregate_report.md,aggregate_highlights.txt,artifact_inventory.txt}`
- `$HUB/summary/summary.md` documenting runtime, deltas, provenance, and artifact links

## Exit Criteria
- Dense pipeline completes successfully with all orchestrator stages executed and the metrics/digest artifacts present under the new hub.
- MS-SSIM/MAE deltas recorded for both Baseline and PtyChi comparisons, with highlights text matching JSON values.
- Summary.md and docs/fix_plan.md updated with runtime, deltas, provenance confirmations, and artifact references.
- Any failures documented with logs and mitigation steps; no silent gaps.
