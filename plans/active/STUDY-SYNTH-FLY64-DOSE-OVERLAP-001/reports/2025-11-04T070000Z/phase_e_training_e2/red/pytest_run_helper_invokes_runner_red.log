============================= test session starts ==============================
platform linux -- Python 3.11.13, pytest-8.4.1, pluggy-1.6.0 -- /home/ollie/miniconda3/envs/ptycho311/bin/python3.11
cachedir: .pytest_cache
PyTorch: available
PyTorch version: 2.8.0+cu128
rootdir: /home/ollie/Documents/PtychoPINN2
configfile: pyproject.toml
plugins: anyio-4.9.0
collecting ... collected 1 item

tests/study/test_dose_overlap_training.py::test_run_training_job_invokes_runner FAILED [100%]

=================================== FAILURES ===================================
_____________________ test_run_training_job_invokes_runner _____________________

tmp_path = PosixPath('/tmp/pytest-of-ollie/pytest-52/test_run_training_job_invokes_0')

    def test_run_training_job_invokes_runner(tmp_path):
        """
        RED â†’ GREEN TDD test for run_training_job runner invocation.
    
        Validates that run_training_job():
        - Creates artifact and log directories before execution
        - Calls update_legacy_dict(params.cfg, config) with the correct bridge config
        - Invokes the injected runner callable with (config, job, log_path) kwargs
        - Touches/writes to job.log_path to ensure logging infrastructure ready
        - Returns useful metadata (e.g., runner result or summary dict)
    
        Test strategy: Use monkeypatch to spy on update_legacy_dict call and inject
        a stub runner that records its invocation signature. Validate call ordering
        (bridge before runner) and parameter passing.
    
        References:
        - plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/test_strategy.md:84-123
        - docs/DEVELOPER_GUIDE.md:68-104 (CONFIG-001 ordering)
        - input.md:8-11 (task E3 requirements)
        """
>       from studies.fly64_dose_overlap.training import run_training_job
E       ImportError: cannot import name 'run_training_job' from 'studies.fly64_dose_overlap.training' (/home/ollie/Documents/PtychoPINN2/studies/fly64_dose_overlap/training.py)

tests/study/test_dose_overlap_training.py:240: ImportError
=========================== short test summary info ============================
FAILED tests/study/test_dose_overlap_training.py::test_run_training_job_invokes_runner - ImportError: cannot import name 'run_training_job' from 'studies.fly64_dose_overlap.training' (/home/ollie/Documents/PtychoPINN2/studies/fly64_dose_overlap/training.py)
============================== 1 failed in 0.86s ===============================
