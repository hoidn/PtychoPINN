# Phase G Dense Real-Run Evidence — Supervisor Plan (2025-11-09T150500Z)

## Objective
Execute the dense Phase C→G pipeline with `--clobber` to generate real MS-SSIM/MAE deltas while auto-emitting a `metrics_delta_highlights.txt` artifact that summarizes the key deltas for summary.md/doc updates. Ensure provenance metadata remains intact and document the evidence.

## Scope for Ralph
1. **Delta highlights TDD**
   - Extend `tests/study/test_phase_g_dense_orchestrator.py::test_run_phase_g_dense_exec_runs_analyze_digest` to require a new `metrics_delta_highlights.txt` file generated by the orchestrator. Assert it contains four lines (MS-SSIM vs Baseline/PtyChi, MAE vs Baseline/PtyChi) with signed 3-decimal deltas.
   - Confirm RED by running the selector before modifying the orchestrator.
2. **Orchestrator highlight persistence**
   - Update `plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/bin/run_phase_g_dense.py::main` to write `analysis/metrics_delta_highlights.txt` during delta computation. Content should mirror the stdout delta block and preserve TYPE-PATH-001 compliance.
   - Include the highlights file in the success banner and ensure provenance metadata JSON remains unchanged aside from new file emission.
3. **Docs refresh**
   - Amend `docs/TESTING_GUIDE.md` Phase G section to describe the new highlights artifact and how to verify its contents.
4. **Evidence run**
   - Execute `run_phase_g_dense.py --clobber` (dense view) to collect real metrics. Archive CLI log, metrics JSON, highlights text, digest, aggregate report, and inventory under the new hub.
   - Extract MS-SSIM/MAE deltas from the highlights file or JSON and capture them in summary.md plus docs/fix_plan.md Attempts History.

## Required Tests
- `pytest tests/study/test_phase_g_dense_orchestrator.py::test_run_phase_g_dense_exec_runs_analyze_digest -vv`
- `pytest tests/study/test_phase_g_dense_orchestrator.py::test_run_phase_g_dense_collect_only_generates_commands -vv`
- `pytest tests/study/test_phase_g_dense_metrics_report.py::test_analyze_dense_metrics_success_digest -vv`

## Artifacts to Produce
- `$HUB/red/pytest_orchestrator_delta_highlights_red.log` — RED failure showing missing highlights file.
- `$HUB/green/pytest_orchestrator_delta_highlights_green.log` — GREEN success for metadata+highlights selector.
- `$HUB/green/pytest_collect_only.log`, `$HUB/green/pytest_analyze_success.log` — guard selectors.
- `$HUB/cli/run_phase_g_dense.log` — full pipeline execution log.
- `$HUB/analysis/{metrics_summary.json,metrics_delta_summary.json,metrics_delta_highlights.txt,metrics_digest.md,aggregate_report.md,aggregate_highlights.txt}` — refreshed evidence set.
- `$HUB/analysis/artifact_inventory.txt` — sorted inventory for traceability.
- `$HUB/summary/summary.md` — loop summary with MS-SSIM/MAE deltas, metadata confirmation, and artifact links.

## Exit Criteria
- `metrics_delta_highlights.txt` generated automatically with four delta lines and archived under analysis/.
- Provenance metadata in `metrics_delta_summary.json` preserved (generated_at, source_metrics) with JSON unchanged other than potential new deltas.
- All mapped selectors GREEN with logs archived; RED evidence captured.
- Dense pipeline completes successfully with refreshed artifacts, summary.md, and ledger updated with actual MS-SSIM/MAE deltas and highlight references.
