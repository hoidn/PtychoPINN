============================= test session starts ==============================
platform linux -- Python 3.11.13, pytest-8.4.1, pluggy-1.6.0 -- /home/ollie/miniconda3/envs/ptycho311/bin/python3.11
cachedir: .pytest_cache
PyTorch: available
PyTorch version: 2.8.0+cu128
rootdir: /home/ollie/Documents/PtychoPINN2
configfile: pyproject.toml
plugins: anyio-4.9.0
collecting ... collected 460 items / 2 skipped

tests/image/test_cropping.py::TestCroppingAlignment::test_align_for_evaluation_bounding_box PASSED [  0%]
tests/image/test_cropping.py::TestCroppingAlignment::test_align_for_evaluation_coordinates_format PASSED [  0%]
tests/image/test_cropping.py::TestCroppingAlignment::test_align_for_evaluation_shapes PASSED [  0%]
tests/image/test_cropping.py::TestCroppingAlignment::test_align_for_evaluation_with_squeeze PASSED [  0%]
tests/image/test_cropping.py::TestCroppingAlignment::test_center_crop_exact_size PASSED [  1%]
tests/image/test_registration.py::TestRegistration::test_apply_shift_and_crop_basic PASSED [  1%]
tests/image/test_registration.py::TestRegistration::test_apply_shift_and_crop_zero_offset PASSED [  1%]
tests/image/test_registration.py::TestRegistration::test_different_image_content PASSED [  1%]
tests/image/test_registration.py::TestRegistration::test_edge_case_maximum_shift PASSED [  1%]
tests/image/test_registration.py::TestRegistration::test_edge_case_single_pixel_shift PASSED [  2%]
tests/image/test_registration.py::TestRegistration::test_find_offset_known_shift_complex PASSED [  2%]
tests/image/test_registration.py::TestRegistration::test_find_offset_known_shift_real PASSED [  2%]
tests/image/test_registration.py::TestRegistration::test_input_validation_2d_requirement PASSED [  2%]
tests/image/test_registration.py::TestRegistration::test_input_validation_excessive_offset PASSED [  3%]
tests/image/test_registration.py::TestRegistration::test_input_validation_shape_matching PASSED [  3%]
tests/image/test_registration.py::TestRegistration::test_noise_robustness PASSED [  3%]
tests/image/test_registration.py::TestRegistration::test_register_and_align_convenience PASSED [  3%]
tests/image/test_registration.py::TestRegistration::test_registration_sign_verification PASSED [  3%]
tests/image/test_registration.py::TestRegistration::test_round_trip_registration PASSED [  4%]
tests/image/test_registration.py::TestRegistration::test_shift_and_crop_preserves_data_type PASSED [  4%]
tests/io/test_ptychodus_interop_h5.py::test_interop_h5_reader FAILED     [  4%]
tests/io/test_ptychodus_product_io.py::test_export_writes_minimal_hdf5 PASSED [  4%]
tests/io/test_ptychodus_product_io.py::test_import_reads_hdf5_to_rawdata PASSED [  5%]
tests/io/test_ptychodus_product_io.py::test_cli_convert_run1084_smoke PASSED [  5%]
tests/scripts/test_ptychi_reconstruct_tike.py::test_main_uses_cli_arguments PASSED [  5%]
tests/study/test_dose_overlap_comparison.py::test_build_comparison_jobs_creates_all_conditions PASSED [  5%]
tests/study/test_dose_overlap_comparison.py::test_execute_comparison_jobs_invokes_compare_models PASSED [  5%]
tests/study/test_dose_overlap_comparison.py::test_execute_comparison_jobs_records_summary PASSED [  6%]
tests/study/test_dose_overlap_comparison.py::test_build_comparison_jobs_uses_dose_specific_phase_e_paths PASSED [  6%]
tests/study/test_dose_overlap_comparison.py::test_execute_comparison_jobs_appends_tike_recon_path PASSED [  6%]
tests/study/test_dose_overlap_dataset_contract.py::test_validate_dataset_contract_happy_path PASSED [  6%]
tests/study/test_dose_overlap_dataset_contract.py::test_validate_dataset_contract_missing_key PASSED [  6%]
tests/study/test_dose_overlap_dataset_contract.py::test_validate_dataset_contract_wrong_dtype_diffraction PASSED [  7%]
tests/study/test_dose_overlap_dataset_contract.py::test_validate_dataset_contract_wrong_dtype_object PASSED [  7%]
tests/study/test_dose_overlap_dataset_contract.py::test_validate_dataset_contract_shape_mismatch PASSED [  7%]
tests/study/test_dose_overlap_dataset_contract.py::test_validate_dataset_contract_spacing_dense PASSED [  7%]
tests/study/test_dose_overlap_dataset_contract.py::test_validate_dataset_contract_spacing_violation PASSED [  8%]
tests/study/test_dose_overlap_dataset_contract.py::test_validate_dataset_contract_oversampling_precondition_pass PASSED [  8%]
tests/study/test_dose_overlap_dataset_contract.py::test_validate_dataset_contract_oversampling_precondition_fail PASSED [  8%]
tests/study/test_dose_overlap_dataset_contract.py::test_validate_dataset_contract_oversampling_missing_neighbor_count PASSED [  8%]
tests/study/test_dose_overlap_dataset_contract.py::test_validate_dataset_contract_unknown_view PASSED [  8%]
tests/study/test_dose_overlap_design.py::test_study_design_constants PASSED [  9%]
tests/study/test_dose_overlap_design.py::test_study_design_validation PASSED [  9%]
tests/study/test_dose_overlap_design.py::test_study_design_to_dict PASSED [  9%]
tests/study/test_dose_overlap_generation.py::test_build_simulation_plan PASSED [  9%]
tests/study/test_dose_overlap_generation.py::test_generate_dataset_pipeline_orchestration[1000.0] PASSED [ 10%]
tests/study/test_dose_overlap_generation.py::test_generate_dataset_pipeline_orchestration[10000.0] PASSED [ 10%]
tests/study/test_dose_overlap_generation.py::test_generate_dataset_pipeline_orchestration[100000.0] PASSED [ 10%]
tests/study/test_dose_overlap_generation.py::test_generate_dataset_config_construction PASSED [ 10%]
tests/study/test_dose_overlap_generation.py::test_generate_dataset_validates_with_real_contract PASSED [ 10%]
tests/study/test_dose_overlap_generation.py::test_build_simulation_plan_handles_metadata_pickle_guard PASSED [ 11%]
tests/study/test_dose_overlap_generation.py::test_load_data_for_sim_handles_metadata_pickle_guard PASSED [ 11%]
tests/study/test_dose_overlap_generation.py::test_generate_dataset_for_dose_handles_metadata_splits PASSED [ 11%]
tests/study/test_dose_overlap_overlap.py::test_compute_spacing_matrix_basic PASSED [ 11%]
tests/study/test_dose_overlap_overlap.py::test_compute_spacing_matrix_empty PASSED [ 11%]
tests/study/test_dose_overlap_overlap.py::test_compute_spacing_matrix_single PASSED [ 12%]
tests/study/test_dose_overlap_overlap.py::test_spacing_filter_parametrized[sparse-True] PASSED [ 12%]
tests/study/test_dose_overlap_overlap.py::test_spacing_filter_parametrized[dense-False] PASSED [ 12%]
tests/study/test_dose_overlap_overlap.py::test_build_acceptance_mask PASSED [ 12%]
tests/study/test_dose_overlap_overlap.py::test_filter_dataset_by_mask PASSED [ 13%]
tests/study/test_dose_overlap_overlap.py::test_compute_spacing_metrics PASSED [ 13%]
tests/study/test_dose_overlap_overlap.py::test_generate_overlap_views_paths PASSED [ 13%]
tests/study/test_dose_overlap_overlap.py::test_generate_overlap_views_metrics_manifest PASSED [ 13%]
tests/study/test_dose_overlap_overlap.py::test_generate_overlap_views_sparse_downsamples PASSED [ 13%]
tests/study/test_dose_overlap_reconstruction.py::test_build_ptychi_jobs_manifest PASSED [ 14%]
tests/study/test_dose_overlap_reconstruction.py::test_run_ptychi_job_invokes_script PASSED [ 14%]
tests/study/test_dose_overlap_reconstruction.py::test_cli_filters_dry_run PASSED [ 14%]
tests/study/test_dose_overlap_reconstruction.py::test_cli_executes_selected_jobs PASSED [ 14%]
tests/study/test_dose_overlap_reconstruction.py::test_cli_skips_missing_phase_d PASSED [ 15%]
tests/study/test_dose_overlap_training.py::test_build_training_jobs_matrix PASSED [ 15%]
tests/study/test_dose_overlap_training.py::test_run_training_job_invokes_runner PASSED [ 15%]
tests/study/test_dose_overlap_training.py::test_run_training_job_dry_run PASSED [ 15%]
tests/study/test_dose_overlap_training.py::test_execute_training_job_dispatches_tensorflow_by_default PASSED [ 15%]
tests/study/test_dose_overlap_training.py::test_execute_training_job_dispatches_pytorch_when_requested PASSED [ 16%]
tests/study/test_dose_overlap_training.py::test_execute_training_job_tensorflow_persists_bundle PASSED [ 16%]
tests/study/test_dose_overlap_training.py::test_training_cli_filters_jobs PASSED [ 16%]
tests/study/test_dose_overlap_training.py::test_training_cli_manifest_and_bridging PASSED [ 16%]
tests/study/test_dose_overlap_training.py::test_execute_training_job_delegates_to_pytorch_trainer PASSED [ 16%]
tests/study/test_dose_overlap_training.py::test_execute_training_job_persists_bundle PASSED [ 17%]
tests/study/test_dose_overlap_training.py::test_training_cli_invokes_real_runner PASSED [ 17%]
tests/study/test_dose_overlap_training.py::test_build_training_jobs_skips_missing_view PASSED [ 17%]
tests/study/test_dose_overlap_training.py::test_training_cli_records_bundle_path PASSED [ 17%]
tests/study/test_phase_g_dense_artifacts_verifier.py::test_verify_dense_pipeline_artifact_inventory_blocks_missing_entries PASSED [ 18%]
tests/study/test_phase_g_dense_artifacts_verifier.py::test_verify_dense_pipeline_artifact_inventory_passes_with_complete_bundle PASSED [ 18%]
tests/study/test_phase_g_dense_artifacts_verifier.py::test_verify_dense_pipeline_cli_logs_missing PASSED [ 18%]
tests/study/test_phase_g_dense_artifacts_verifier.py::test_verify_dense_pipeline_cli_logs_complete PASSED [ 18%]
tests/study/test_phase_g_dense_artifacts_verifier.py::test_verify_dense_pipeline_cli_phase_logs_missing PASSED [ 18%]
tests/study/test_phase_g_dense_artifacts_verifier.py::test_verify_dense_pipeline_cli_phase_logs_wrong_pattern PASSED [ 19%]
tests/study/test_phase_g_dense_artifacts_verifier.py::test_verify_dense_pipeline_cli_phase_logs_incomplete PASSED [ 19%]
tests/study/test_phase_g_dense_artifacts_verifier.py::test_verify_dense_pipeline_cli_phase_logs_complete PASSED [ 19%]
tests/study/test_phase_g_dense_artifacts_verifier.py::test_verify_dense_pipeline_highlights_missing_model PASSED [ 19%]
tests/study/test_phase_g_dense_artifacts_verifier.py::test_verify_dense_pipeline_highlights_mismatched_value PASSED [ 20%]
tests/study/test_phase_g_dense_artifacts_verifier.py::test_verify_dense_pipeline_highlights_complete PASSED [ 20%]
tests/study/test_phase_g_dense_artifacts_verifier.py::test_verify_dense_pipeline_highlights_missing_preview PASSED [ 20%]
tests/study/test_phase_g_dense_artifacts_verifier.py::test_verify_dense_pipeline_highlights_preview_contains_amplitude PASSED [ 20%]
tests/study/test_phase_g_dense_artifacts_verifier.py::test_verify_dense_pipeline_highlights_preview_mismatch PASSED [ 20%]
tests/study/test_phase_g_dense_artifacts_verifier.py::test_verify_dense_pipeline_highlights_delta_mismatch PASSED [ 21%]
tests/study/test_phase_g_dense_metrics_report.py::test_report_phase_g_dense_metrics PASSED [ 21%]
tests/study/test_phase_g_dense_metrics_report.py::test_report_phase_g_dense_metrics_missing_model_fails PASSED [ 21%]
tests/study/test_phase_g_dense_metrics_report.py::test_analyze_dense_metrics_flags_failures PASSED [ 21%]
tests/study/test_phase_g_dense_metrics_report.py::test_analyze_dense_metrics_success_digest PASSED [ 21%]
tests/study/test_phase_g_dense_orchestrator.py::test_run_phase_g_dense_collect_only_generates_commands PASSED [ 22%]
tests/study/test_phase_g_dense_orchestrator.py::test_summarize_phase_g_outputs PASSED [ 22%]
tests/study/test_phase_g_dense_orchestrator.py::test_summarize_phase_g_outputs_fails_on_missing_manifest PASSED [ 22%]
tests/study/test_phase_g_dense_orchestrator.py::test_summarize_phase_g_outputs_fails_on_execution_failures PASSED [ 22%]
tests/study/test_phase_g_dense_orchestrator.py::test_summarize_phase_g_outputs_fails_on_missing_csv PASSED [ 23%]
tests/study/test_phase_g_dense_orchestrator.py::test_validate_phase_c_metadata_requires_metadata PASSED [ 23%]
tests/study/test_phase_g_dense_orchestrator.py::test_validate_phase_c_metadata_requires_canonical_transform PASSED [ 23%]
tests/study/test_phase_g_dense_orchestrator.py::test_validate_phase_c_metadata_accepts_valid_metadata PASSED [ 23%]
tests/study/test_phase_g_dense_orchestrator.py::test_validate_phase_c_metadata_handles_patched_layout PASSED [ 23%]
tests/study/test_phase_g_dense_orchestrator.py::test_prepare_hub_detects_stale_outputs PASSED [ 24%]
tests/study/test_phase_g_dense_orchestrator.py::test_prepare_hub_clobbers_previous_outputs PASSED [ 24%]
tests/study/test_phase_g_dense_orchestrator.py::test_run_phase_g_dense_exec_invokes_reporting_helper PASSED [ 24%]
tests/study/test_phase_g_dense_orchestrator.py::test_run_phase_g_dense_exec_prints_highlights_preview PASSED [ 24%]
tests/study/test_phase_g_dense_orchestrator.py::test_run_phase_g_dense_exec_runs_analyze_digest PASSED [ 25%]
tests/study/test_phase_g_dense_orchestrator.py::test_persist_delta_highlights_creates_preview PASSED [ 25%]
tests/test_baselines.py::TestBaselines::test_build_model_always_creates_single_channel_output PASSED [ 25%]
tests/test_cli_args.py::TestCliArgs::test_add_logging_arguments PASSED   [ 25%]
tests/test_cli_args.py::TestCliArgs::test_console_level_choices PASSED   [ 25%]
tests/test_cli_args.py::TestCliArgs::test_get_logging_config_custom_level PASSED [ 26%]
tests/test_cli_args.py::TestCliArgs::test_get_logging_config_defaults PASSED [ 26%]
tests/test_cli_args.py::TestCliArgs::test_get_logging_config_quiet PASSED [ 26%]
tests/test_cli_args.py::TestCliArgs::test_get_logging_config_verbose PASSED [ 26%]
tests/test_cli_args.py::TestCliArgs::test_quiet_verbose_mutually_exclusive PASSED [ 26%]
tests/test_coordinate_grouping.py::TestCoordinateGrouping::test_backward_compatibility PASSED [ 27%]
tests/test_coordinate_grouping.py::TestCoordinateGrouping::test_different_seeds_produce_different_results PASSED [ 27%]
tests/test_coordinate_grouping.py::TestCoordinateGrouping::test_edge_case_k_less_than_c PASSED [ 27%]
tests/test_coordinate_grouping.py::TestCoordinateGrouping::test_edge_case_more_samples_than_points PASSED [ 27%]
tests/test_coordinate_grouping.py::TestCoordinateGrouping::test_edge_case_small_dataset PASSED [ 28%]
tests/test_coordinate_grouping.py::TestCoordinateGrouping::test_efficient_grouping_output_shape PASSED [ 28%]
tests/test_coordinate_grouping.py::TestCoordinateGrouping::test_efficient_grouping_spatial_coherence PASSED [ 28%]
tests/test_coordinate_grouping.py::TestCoordinateGrouping::test_efficient_grouping_valid_indices PASSED [ 28%]
tests/test_coordinate_grouping.py::TestCoordinateGrouping::test_generate_grouped_data_gridsize_1 PASSED [ 28%]
tests/test_coordinate_grouping.py::TestCoordinateGrouping::test_generate_grouped_data_integration PASSED [ 29%]
tests/test_coordinate_grouping.py::TestCoordinateGrouping::test_memory_efficiency PASSED [ 29%]
tests/test_coordinate_grouping.py::TestCoordinateGrouping::test_no_cache_files_created PASSED [ 29%]
tests/test_coordinate_grouping.py::TestCoordinateGrouping::test_performance_improvement PASSED [ 29%]
tests/test_coordinate_grouping.py::TestCoordinateGrouping::test_reproducibility_with_seed PASSED [ 30%]
tests/test_coordinate_grouping.py::TestIntegrationWithExistingCode::test_existing_tests_still_pass PASSED [ 30%]
tests/test_generic_loader.py::TestGenericLoader::test_generic_loader_roundtrip SKIPPED [ 30%]
tests/test_generic_loader.py::test_generic_loader PASSED                 [ 30%]
tests/test_integration_baseline_gs2.py::TestBaselineGridsize2Integration::test_baseline_gridsize2_end_to_end SKIPPED [ 30%]
tests/test_integration_workflow.py::TestFullWorkflow::test_train_save_load_infer_cycle PASSED [ 31%]
tests/test_log_config.py::TestLogConfig::test_backward_compatibility PASSED [ 31%]
tests/test_log_config.py::TestLogConfig::test_conflicting_flags_verbose_overrides PASSED [ 31%]
tests/test_log_config.py::TestLogConfig::test_custom_console_level PASSED [ 31%]
tests/test_log_config.py::TestLogConfig::test_default_setup_logging_creates_log_directory_and_file PASSED [ 31%]
tests/test_log_config.py::TestLogConfig::test_quiet_flag_overrides_console_level PASSED [ 32%]
tests/test_log_config.py::TestLogConfig::test_quiet_mode_disables_console PASSED [ 32%]
tests/test_log_config.py::TestLogConfig::test_setup_logging_clears_existing_handlers PASSED [ 32%]
tests/test_log_config.py::TestLogConfig::test_string_path_support PASSED [ 32%]
tests/test_log_config.py::TestLogConfig::test_verbose_mode_enables_debug_console PASSED [ 33%]
tests/test_misc.py::test_memoize_simulated_data SKIPPED (Deprecated:...) [ 33%]
tests/test_nphotons_metadata_integration.py::TestNphotonsMetadataIntegration::test_configuration_mismatch_warnings PASSED [ 33%]
tests/test_nphotons_metadata_integration.py::TestNphotonsMetadataIntegration::test_end_to_end_workflow_consistency 