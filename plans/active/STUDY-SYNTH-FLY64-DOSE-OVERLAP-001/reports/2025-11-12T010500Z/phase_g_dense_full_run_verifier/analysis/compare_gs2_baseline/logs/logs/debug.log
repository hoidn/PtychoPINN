2025-11-12 19:21:18,820 - INFO - Configuration: phase_align_method='plane', frc_sigma=0.0
2025-11-12 19:21:18,820 - INFO - Registration: enabled
2025-11-12 19:21:18,820 - INFO - NPZ output: raw=enabled, aligned=enabled
2025-11-12 19:21:18,820 - INFO - Loading PtychoPINN inference model (diffraction_to_obj) to restore configuration...
2025-11-12 19:21:18,820 - INFO - Loading model from: plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_100000/dense/gs2
2025-11-12 19:21:18,820 - DEBUG - Model archive path: plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_100000/dense/gs2/wts.h5.zip
2025-11-12 19:21:19,893 - INFO - Model: "functional"
2025-11-12 19:21:19,918 - INFO - â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ Layer (type)        â”ƒ Output Shape      â”ƒ    Param # â”ƒ Connected to      â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚ input (InputLayer)  â”‚ (None, 128, 128,  â”‚          0 â”‚ -                 â”‚
â”‚                     â”‚ 4)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ intensity_scaler    â”‚ (None, 128, 128,  â”‚          0 â”‚ input[0][0]       â”‚
â”‚ (IntensityScaler)   â”‚ 4)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d (Conv2D)     â”‚ (None, 128, 128,  â”‚      1,184 â”‚ intensity_scalerâ€¦ â”‚
â”‚                     â”‚ 32)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_1 (Conv2D)   â”‚ (None, 128, 128,  â”‚      9,248 â”‚ conv2d[0][0]      â”‚
â”‚                     â”‚ 32)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ max_pooling2d       â”‚ (None, 64, 64,    â”‚          0 â”‚ conv2d_1[0][0]    â”‚
â”‚ (MaxPooling2D)      â”‚ 32)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_2 (Conv2D)   â”‚ (None, 64, 64,    â”‚     18,496 â”‚ max_pooling2d[0]â€¦ â”‚
â”‚                     â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_3 (Conv2D)   â”‚ (None, 64, 64,    â”‚     36,928 â”‚ conv2d_2[0][0]    â”‚
â”‚                     â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ max_pooling2d_1     â”‚ (None, 32, 32,    â”‚          0 â”‚ conv2d_3[0][0]    â”‚
â”‚ (MaxPooling2D)      â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_4 (Conv2D)   â”‚ (None, 32, 32,    â”‚     73,856 â”‚ max_pooling2d_1[â€¦ â”‚
â”‚                     â”‚ 128)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_5 (Conv2D)   â”‚ (None, 32, 32,    â”‚    147,584 â”‚ conv2d_4[0][0]    â”‚
â”‚                     â”‚ 128)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ max_pooling2d_2     â”‚ (None, 16, 16,    â”‚          0 â”‚ conv2d_5[0][0]    â”‚
â”‚ (MaxPooling2D)      â”‚ 128)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_6 (Conv2D)   â”‚ (None, 16, 16,    â”‚    295,168 â”‚ max_pooling2d_2[â€¦ â”‚
â”‚                     â”‚ 256)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_7 (Conv2D)   â”‚ (None, 16, 16,    â”‚    590,080 â”‚ conv2d_6[0][0]    â”‚
â”‚                     â”‚ 256)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ max_pooling2d_3     â”‚ (None, 8, 8, 256) â”‚          0 â”‚ conv2d_7[0][0]    â”‚
â”‚ (MaxPooling2D)      â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_10 (Conv2D)  â”‚ (None, 8, 8, 256) â”‚    590,080 â”‚ max_pooling2d_3[â€¦ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_20 (Conv2D)  â”‚ (None, 8, 8, 256) â”‚    590,080 â”‚ max_pooling2d_3[â€¦ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_11 (Conv2D)  â”‚ (None, 8, 8, 256) â”‚    590,080 â”‚ conv2d_10[0][0]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_21 (Conv2D)  â”‚ (None, 8, 8, 256) â”‚    590,080 â”‚ conv2d_20[0][0]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ up_sampling2d       â”‚ (None, 16, 16,    â”‚          0 â”‚ conv2d_11[0][0]   â”‚
â”‚ (UpSampling2D)      â”‚ 256)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ up_sampling2d_4     â”‚ (None, 16, 16,    â”‚          0 â”‚ conv2d_21[0][0]   â”‚
â”‚ (UpSampling2D)      â”‚ 256)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_12 (Conv2D)  â”‚ (None, 16, 16,    â”‚    295,040 â”‚ up_sampling2d[0]â€¦ â”‚
â”‚                     â”‚ 128)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_22 (Conv2D)  â”‚ (None, 16, 16,    â”‚    295,040 â”‚ up_sampling2d_4[â€¦ â”‚
â”‚                     â”‚ 128)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_13 (Conv2D)  â”‚ (None, 16, 16,    â”‚    147,584 â”‚ conv2d_12[0][0]   â”‚
â”‚                     â”‚ 128)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_23 (Conv2D)  â”‚ (None, 16, 16,    â”‚    147,584 â”‚ conv2d_22[0][0]   â”‚
â”‚                     â”‚ 128)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ up_sampling2d_1     â”‚ (None, 32, 32,    â”‚          0 â”‚ conv2d_13[0][0]   â”‚
â”‚ (UpSampling2D)      â”‚ 128)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ up_sampling2d_5     â”‚ (None, 32, 32,    â”‚          0 â”‚ conv2d_23[0][0]   â”‚
â”‚ (UpSampling2D)      â”‚ 128)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_14 (Conv2D)  â”‚ (None, 32, 32,    â”‚     73,792 â”‚ up_sampling2d_1[â€¦ â”‚
â”‚                     â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_24 (Conv2D)  â”‚ (None, 32, 32,    â”‚     73,792 â”‚ up_sampling2d_5[â€¦ â”‚
â”‚                     â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_15 (Conv2D)  â”‚ (None, 32, 32,    â”‚     36,928 â”‚ conv2d_14[0][0]   â”‚
â”‚                     â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_25 (Conv2D)  â”‚ (None, 32, 32,    â”‚     36,928 â”‚ conv2d_24[0][0]   â”‚
â”‚                     â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ up_sampling2d_2     â”‚ (None, 64, 64,    â”‚          0 â”‚ conv2d_15[0][0]   â”‚
â”‚ (UpSampling2D)      â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ up_sampling2d_6     â”‚ (None, 64, 64,    â”‚          0 â”‚ conv2d_25[0][0]   â”‚
â”‚ (UpSampling2D)      â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ get_item_1          â”‚ (None, 64, 64, 4) â”‚          0 â”‚ up_sampling2d_2[â€¦ â”‚
â”‚ (GetItem)           â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ get_item_3          â”‚ (None, 64, 64, 4) â”‚          0 â”‚ up_sampling2d_6[â€¦ â”‚
â”‚ (GetItem)           â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_16 (Conv2D)  â”‚ (None, 64, 64,    â”‚      1,184 â”‚ get_item_1[0][0]  â”‚
â”‚                     â”‚ 32)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_26 (Conv2D)  â”‚ (None, 64, 64,    â”‚      1,184 â”‚ get_item_3[0][0]  â”‚
â”‚                     â”‚ 32)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_17 (Conv2D)  â”‚ (None, 64, 64,    â”‚      9,248 â”‚ conv2d_16[0][0]   â”‚
â”‚                     â”‚ 32)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_27 (Conv2D)  â”‚ (None, 64, 64,    â”‚      9,248 â”‚ conv2d_26[0][0]   â”‚
â”‚                     â”‚ 32)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ up_sampling2d_3     â”‚ (None, 128, 128,  â”‚          0 â”‚ conv2d_17[0][0]   â”‚
â”‚ (UpSampling2D)      â”‚ 32)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ up_sampling2d_7     â”‚ (None, 128, 128,  â”‚          0 â”‚ conv2d_27[0][0]   â”‚
â”‚ (UpSampling2D)      â”‚ 32)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ get_item (GetItem)  â”‚ (None, 64, 64,    â”‚          0 â”‚ up_sampling2d_2[â€¦ â”‚
â”‚                     â”‚ 60)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_9 (Conv2D)   â”‚ (None, 128, 128,  â”‚      1,156 â”‚ up_sampling2d_3[â€¦ â”‚
â”‚                     â”‚ 4)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ get_item_2          â”‚ (None, 64, 64,    â”‚          0 â”‚ up_sampling2d_6[â€¦ â”‚
â”‚ (GetItem)           â”‚ 60)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_19 (Conv2D)  â”‚ (None, 128, 128,  â”‚      1,156 â”‚ up_sampling2d_7[â€¦ â”‚
â”‚                     â”‚ 4)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_8 (Conv2D)   â”‚ (None, 64, 64, 4) â”‚      2,164 â”‚ get_item[0][0]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ silu (Silu)         â”‚ (None, 128, 128,  â”‚          0 â”‚ conv2d_9[0][0]    â”‚
â”‚                     â”‚ 4)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_18 (Conv2D)  â”‚ (None, 64, 64, 4) â”‚      2,164 â”‚ get_item_2[0][0]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ silu_1 (Silu)       â”‚ (None, 128, 128,  â”‚          0 â”‚ conv2d_19[0][0]   â”‚
â”‚                     â”‚ 4)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ amp                 â”‚ (None, 64, 64, 4) â”‚          0 â”‚ conv2d_8[0][0]    â”‚
â”‚ (ActivationLayer)   â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ center_mask_layer   â”‚ (None, 128, 128,  â”‚          0 â”‚ silu[0][0]        â”‚
â”‚ (CenterMaskLayer)   â”‚ 1)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ phi                 â”‚ (None, 64, 64, 4) â”‚          0 â”‚ conv2d_18[0][0]   â”‚
â”‚ (ActivationLayer)   â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ center_mask_layer_1 â”‚ (None, 128, 128,  â”‚          0 â”‚ silu_1[0][0]      â”‚
â”‚ (CenterMaskLayer)   â”‚ 1)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ amp_padded          â”‚ (None, 128, 128,  â”‚          0 â”‚ amp[0][0]         â”‚
â”‚ (ZeroPadding2D)     â”‚ 4)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ multiply (Multiply) â”‚ (None, 128, 128,  â”‚          0 â”‚ silu[0][0],       â”‚
â”‚                     â”‚ 4)                â”‚            â”‚ center_mask_layeâ€¦ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ phase_padded        â”‚ (None, 128, 128,  â”‚          0 â”‚ phi[0][0]         â”‚
â”‚ (ZeroPadding2D)     â”‚ 4)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ multiply_1          â”‚ (None, 128, 128,  â”‚          0 â”‚ silu_1[0][0],     â”‚
â”‚ (Multiply)          â”‚ 4)                â”‚            â”‚ center_mask_layeâ€¦ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ add (Add)           â”‚ (None, 128, 128,  â”‚          0 â”‚ amp_padded[0][0], â”‚
â”‚                     â”‚ 4)                â”‚            â”‚ multiply[0][0]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ add_1 (Add)         â”‚ (None, 128, 128,  â”‚          0 â”‚ phase_padded[0][â€¦ â”‚
â”‚                     â”‚ 4)                â”‚            â”‚ multiply_1[0][0]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ obj                 â”‚ (None, 128, 128,  â”‚          0 â”‚ add[0][0],        â”‚
â”‚ (CombineComplexLayâ€¦ â”‚ 4)                â”‚            â”‚ add_1[0][0]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ input_positions     â”‚ (None, 1, 2, 4)   â”‚          0 â”‚ -                 â”‚
â”‚ (InputLayer)        â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ padded_obj_2        â”‚ (None, 142, 142,  â”‚          0 â”‚ obj[0][0],        â”‚
â”‚ (ReassemblePatchesâ€¦ â”‚ 4)                â”‚            â”‚ input_positions[â€¦ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ padded_objs_with_oâ€¦ â”‚ (None, 132, 132,  â”‚          0 â”‚ padded_obj_2[0][â€¦ â”‚
â”‚ (ExtractPatchesPosâ€¦ â”‚ 4)                â”‚            â”‚ input_positions[â€¦ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ probe_illumination  â”‚ [(None, 132, 132, â”‚          0 â”‚ padded_objs_withâ€¦ â”‚
â”‚ (ProbeIllumination) â”‚ 4), (None, 132,   â”‚            â”‚                   â”‚
â”‚                     â”‚ 132, 4)]          â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ pred_amplitude      â”‚ [(None, 128, 128, â”‚          0 â”‚ probe_illuminatiâ€¦ â”‚
â”‚ (PadAndDiffractLayâ€¦ â”‚ 4), (None, 128,   â”‚            â”‚                   â”‚
â”‚                     â”‚ 128, 4)]          â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ pred_diff_channels  â”‚ (None, 128, 128,  â”‚          0 â”‚ pred_amplitude[0â€¦ â”‚
â”‚ (FlatToChannelLayeâ€¦ â”‚ 4)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ intensity_scaler_iâ€¦ â”‚ (None, 128, 128,  â”‚          0 â”‚ pred_diff_channeâ€¦ â”‚
â”‚ (IntensityScaler_iâ€¦ â”‚ 4)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trimmed_obj         â”‚ (None, 128, 128,  â”‚          0 â”‚ padded_obj_2[0][â€¦ â”‚
â”‚ (TrimReconstructioâ€¦ â”‚ 4)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ pred_intensity      â”‚ (None, 128, 128,  â”‚          0 â”‚ intensity_scalerâ€¦ â”‚
â”‚ (SquareLayer)       â”‚ 4)                â”‚            â”‚                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
2025-11-12 19:21:19,918 - INFO - Total params: 4,667,056 (17.80 MB)
2025-11-12 19:21:19,919 - INFO - Trainable params: 4,667,056 (17.80 MB)
2025-11-12 19:21:19,919 - INFO - Non-trainable params: 0 (0.00 B)
2025-11-12 19:21:19,919 - INFO - None
2025-11-12 19:21:20,109 - ERROR - /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py:421: UserWarning: `build()` was called on layer 'center_mask_layer', however the layer does not have a `build()` method implemented and it looks like it has unbuilt state. This will cause the layer to be marked as built, despite not being actually built, which may cause failures down the line. Make sure to implement a proper `build()` method.
  warnings.warn(
2025-11-12 19:21:20,110 - ERROR - /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py:421: UserWarning: `build()` was called on layer 'center_mask_layer_1', however the layer does not have a `build()` method implemented and it looks like it has unbuilt state. This will cause the layer to be marked as built, despite not being actually built, which may cause failures down the line. Make sure to implement a proper `build()` method.
  warnings.warn(
2025-11-12 19:21:20,761 - INFO - Successfully loaded model from plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_100000/dense/gs2
2025-11-12 19:21:20,762 - DEBUG - Model configuration: {'N': 128, 'offset': 4, 'gridsize': 2, 'outer_offset_train': None, 'outer_offset_test': None, 'batch_size': 16, 'nepochs': 50, 'n_filters_scale': 2, 'output_prefix': '/home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_100000/dense/gs2', 'big_gridsize': 10, 'max_position_jitter': 10, 'sim_jitter_scale': 0.0, 'default_probe_scale': 0.7, 'mae_weight': 0.0, 'nll_weight': 1.0, 'tv_weight': 0.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 100000.0, 'nimgs_train': 9, 'nimgs_test': 3, 'data_source': 'generic', 'probe.trainable': False, 'intensity_scale.trainable': True, 'positions.provided': True, 'object.big': True, 'probe.big': True, 'probe_scale': 4.0, 'set_phi': False, 'probe.mask': False, 'pad_object': True, 'model_type': 'pinn', 'label': '', 'size': 392, 'amp_activation': 'sigmoid', 'h5_path': 'wts.h5', 'npseed': 42, 'debug': True, 'gaussian_smoothing_sigma': 0.0, 'use_xla_translate': True, 'n_groups': 512, 'neighbor_count': 4, 'enable_oversampling': False, 'sequential_sampling': False, 'backend': 'tensorflow', 'train_data_file_path': '/home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_d/dose_100000/dense/train.npz', 'test_data_file_path': '/home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_d/dose_100000/dense/test.npz', 'probe': <tf.Tensor: shape=(128, 128, 1), dtype=complex64, numpy=
array([[[ 0.28498438-0.09745132j],
        [ 0.07898823-0.06898231j],
        [-0.1776128 -0.02413889j],
        ...,
        [ 0.10659252+0.00086214j],
        [-0.0585174 -0.0181606j ],
        [-0.17915702-0.02362471j]],

       [[ 0.07898823-0.06898231j],
        [ 0.038569  -0.06275462j],
        [-0.0141969 -0.04730332j],
        ...,
        [ 0.01960954+0.00739213j],
        [ 0.00271502-0.0311804j ],
        [-0.0145774 -0.04700996j]],

       [[-0.1776128 -0.02413889j],
        [-0.0141969 -0.04730332j],
        [ 0.18258305-0.06964147j],
        ...,
        [-0.09195265+0.01901859j],
        [ 0.07156007-0.03915591j],
        [ 0.18359068-0.06960618j]],

       ...,

       [[ 0.10659252+0.00086214j],
        [ 0.01960954+0.00739213j],
        [-0.09195265+0.01901859j],
        ...,
        [ 0.03286983+0.00071724j],
        [-0.04599212+0.01944371j],
        [-0.09270766+0.01917951j]],

       [[-0.0585174 -0.0181606j ],
        [ 0.00271502-0.0311804j ],
        [ 0.07156007-0.03915591j],
        ...,
        [-0.04599212+0.01944371j],
        [ 0.02061781-0.01389362j],
        [ 0.07178088-0.03898923j]],

       [[-0.17915702-0.02362471j],
        [-0.0145774 -0.04700996j],
        [ 0.18359068-0.06960618j],
        ...,
        [-0.09270766+0.01917951j],
        [ 0.07178088-0.03898923j],
        [ 0.18460508-0.06957199j]]], dtype=complex64)>, 'intensity_scale': np.float32(4.9410586)}
2025-11-12 19:21:20,762 - INFO - Restored configuration from model: gridsize=2, N=128
2025-11-12 19:21:20,762 - INFO - Loading test data from plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_c/dose_100000/patched_train.npz with restored gridsize=2...
2025-11-12 19:21:20,762 - INFO - Using all test data (no subsampling or grouping limit)
2025-11-12 19:21:20,762 - INFO - Loading data from plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_c/dose_100000/patched_train.npz with n_images=None, n_subsample=None
2025-11-12 19:21:21,250 - WARNING - Ignoring NPZ 'Y' with incompatible shape (1, 128, 128, 1) (expected first axis 5088)
2025-11-12 19:21:21,250 - INFO - Using full dataset of 5088 images
2025-11-12 19:21:21,289 - INFO - diff3d shape: (5088, 128, 128)
2025-11-12 19:21:21,289 - INFO - probeGuess shape: (128, 128)
2025-11-12 19:21:21,289 - INFO - scan_index shape: (5088,)
2025-11-12 19:21:21,289 - INFO - objectGuess shape: (464, 464)
2025-11-12 19:21:21,289 - INFO - xcoords shape: (5088,)
2025-11-12 19:21:21,289 - INFO - ycoords shape: (5088,)
2025-11-12 19:21:21,289 - INFO - xcoords_start shape: (5088,)
2025-11-12 19:21:21,289 - INFO - ycoords_start shape: (5088,)
2025-11-12 19:21:21,291 - INFO - Final configuration: gridsize=2, N=128, n_images=5088
2025-11-12 19:21:21,291 - INFO - Using stitch_crop_size M=20 (N=128)
2025-11-12 19:21:21,291 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=5088, n_points=5088, C=4, K=7
2025-11-12 19:21:21,291 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=2, N=128, sequential_sampling=False
2025-11-12 19:21:21,291 - INFO - [OVERSAMPLING DEBUG] Oversampling flags: enable_oversampling=False, neighbor_pool_size=None, effective_K=7
2025-11-12 19:21:21,291 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 5088 > 5088 = False
2025-11-12 19:21:21,291 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 4 > 1 = True
2025-11-12 19:21:21,291 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-12 19:21:21,291 - INFO - DEBUG:
2025-11-12 19:21:21,291 - INFO - nsamples: 5088, gridsize: 2 (using efficient random sample-then-group strategy)
2025-11-12 19:21:21,291 - INFO - Using efficient random sampling strategy for gridsize=2
2025-11-12 19:21:21,291 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-12 19:21:21,291 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=5088, K=7, C=4
2025-11-12 19:21:21,291 - INFO - Generating 5088 groups efficiently from 5088 points (K=7, C=4)
2025-11-12 19:21:21,291 - INFO - [OVERSAMPLING DEBUG] Standard case: using 5088 groups from 5088 points
2025-11-12 19:21:21,291 - INFO - [OVERSAMPLING DEBUG] Using all 5088 points as seeds (no sampling needed)
2025-11-12 19:21:21,291 - INFO - Using all 5088 points as seeds
2025-11-12 19:21:21,324 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 5088 groups
2025-11-12 19:21:21,325 - INFO - Successfully generated 5088 groups with shape (5088, 4)
2025-11-12 19:21:21,325 - INFO - [OVERSAMPLING DEBUG] Generated 5088 groups in total
2025-11-12 19:21:21,325 - INFO - Generated 5088 groups efficiently
2025-11-12 19:21:21,479 - INFO - INFO: 'Y' array not found. Generating ground truth patches from 'objectGuess' as a fallback.
2025-11-12 19:22:49,072 - INFO - neighbor-sampled diffraction shape
2025-11-12 19:22:49,072 - INFO - (5088, 128, 128, 4)
2025-11-12 19:22:51,084 - INFO - loader: using provided ground truth patches.
2025-11-12 19:22:51,503 - INFO - INFO:
2025-11-12 19:22:51,503 - INFO - None
2025-11-12 19:22:51,503 - INFO - <PtychoDataContainer X=(5088, 128, 128, 4) Y_I=(5088, 128, 128, 4) Y_phi=(5088, 128, 128, 4) norm_Y_I=() coords_nominal=(5088, 1, 2, 4) coords_true=(5088, 1, 2, 4) nn_indices=(5088, 4) mean=2550.773 global_offsets=(5088, 1, 2, 1) mean=188.719 local_offsets=(5088, 1, 2, 4) mean=0.000 probe=(128, 128) mean_amplitude=0.007>
2025-11-12 19:22:51,511 - INFO - Loading Baseline model from plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_100000/baseline/gs1...
2025-11-12 19:22:51,511 - INFO - baseline_model.h5 not found; attempting to load TF bundle (wts.h5.zip)
2025-11-12 19:22:51,511 - INFO - Loading model from: plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_100000/baseline/gs1
2025-11-12 19:22:51,511 - DEBUG - Model archive path: plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_100000/baseline/gs1/wts.h5.zip
2025-11-12 19:22:52,531 - INFO - Successfully loaded model from plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_100000/baseline/gs1
2025-11-12 19:22:52,532 - DEBUG - Model configuration: {'N': 128, 'offset': 4, 'gridsize': 1, 'outer_offset_train': None, 'outer_offset_test': None, 'batch_size': 16, 'nepochs': 50, 'n_filters_scale': 2, 'output_prefix': '/home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_100000/baseline/gs1', 'big_gridsize': 10, 'max_position_jitter': 10, 'sim_jitter_scale': 0.0, 'default_probe_scale': 0.7, 'mae_weight': 0.0, 'nll_weight': 1.0, 'tv_weight': 0.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 100000.0, 'nimgs_train': 9, 'nimgs_test': 3, 'data_source': 'generic', 'probe.trainable': False, 'intensity_scale.trainable': True, 'positions.provided': True, 'object.big': True, 'probe.big': True, 'probe_scale': 4.0, 'set_phi': False, 'probe.mask': False, 'pad_object': True, 'model_type': 'pinn', 'label': '', 'size': 392, 'amp_activation': 'sigmoid', 'h5_path': 'wts.h5', 'npseed': 42, 'debug': True, 'gaussian_smoothing_sigma': 0.0, 'use_xla_translate': True, 'n_groups': 512, 'neighbor_count': 4, 'enable_oversampling': False, 'sequential_sampling': False, 'backend': 'tensorflow', 'train_data_file_path': '/home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_c/dose_100000/patched_train.npz', 'test_data_file_path': '/home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_c/dose_100000/patched_test.npz', 'probe': <tf.Tensor: shape=(128, 128, 1), dtype=complex64, numpy=
array([[[ 0.28498438-0.09745132j],
        [ 0.07898823-0.06898231j],
        [-0.1776128 -0.02413889j],
        ...,
        [ 0.10659252+0.00086214j],
        [-0.0585174 -0.0181606j ],
        [-0.17915702-0.02362471j]],

       [[ 0.07898823-0.06898231j],
        [ 0.038569  -0.06275462j],
        [-0.0141969 -0.04730332j],
        ...,
        [ 0.01960954+0.00739213j],
        [ 0.00271502-0.0311804j ],
        [-0.0145774 -0.04700996j]],

       [[-0.1776128 -0.02413889j],
        [-0.0141969 -0.04730332j],
        [ 0.18258305-0.06964147j],
        ...,
        [-0.09195265+0.01901859j],
        [ 0.07156007-0.03915591j],
        [ 0.18359068-0.06960618j]],

       ...,

       [[ 0.10659252+0.00086214j],
        [ 0.01960954+0.00739213j],
        [-0.09195265+0.01901859j],
        ...,
        [ 0.03286983+0.00071724j],
        [-0.04599212+0.01944371j],
        [-0.09270766+0.01917951j]],

       [[-0.0585174 -0.0181606j ],
        [ 0.00271502-0.0311804j ],
        [ 0.07156007-0.03915591j],
        ...,
        [-0.04599212+0.01944371j],
        [ 0.02061781-0.01389362j],
        [ 0.07178088-0.03898923j]],

       [[-0.17915702-0.02362471j],
        [-0.0145774 -0.04700996j],
        [ 0.18359068-0.06960618j],
        ...,
        [-0.09270766+0.01917951j],
        [ 0.07178088-0.03898923j],
        [ 0.18460508-0.06957199j]]], dtype=complex64)>, 'intensity_scale': np.float32(4.9410586)}
2025-11-12 19:22:52,532 - INFO - Running two-way comparison (PtychoPINN vs. Baseline)
2025-11-12 19:22:52,532 - INFO - Running inference with PtychoPINN (diffraction_to_obj)...
2025-11-12 19:22:53,603 - CRITICAL - Uncaught exception
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 1290, in <module>
    main()
  File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 967, in main
    pinn_recon = pinn_model.predict(
                 ^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home/ollie/Documents/PtychoPINN/ptycho/custom_layers.py", line 148, in call
    return hh.reassemble_patches(patches,
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 1043, in reassemble_patches
    assembled_real = fn_reassemble_real(real, average = average, **kwargs) / mk_norm(real,
                                                                             ^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 1020, in mk_norm
    assembled_ones = fn_reassemble_real(ones, average = False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 1267, in reassemble_patches_position_real
    return _reassemble_patches_position_real(imgs, input_positions,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 865, in _reassemble_patches_position_real
    imgs_flat_bigN_translated = Translation(jitter_stddev=0.0, use_xla=should_use_xla())([imgs_flat_bigN, -offsets_flat])
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 836, in call
    return translate(imgs, offsets + jitter, interpolation='bilinear', use_xla_workaround=self.use_xla)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 678, in newf
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 798, in translate
    return translate_core(imgs, offsets, interpolation=interpolation, use_xla_workaround=use_xla_workaround)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 722, in translate_core
    return translate_xla(images, translations, interpolation=interpolation, use_jit=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 279, in translate_xla
    return projective_warp_xla_jit(images, M,
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp/__autograph_generated_fileq613qcis.py", line 19, in tf__projective_warp_xla_jit
    raise
  File "/tmp/__autograph_generated_filemvd0q9tn.py", line 131, in tf__projective_warp_xla
    src = ag__.converted_call(ag__.ld(tf).einsum, ('bij,bhwj->bhwi', ag__.ld(M), ag__.ld(grid)), None, fscope)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Exception encountered when calling Translation.call().

[1min user code:

    File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 194, in projective_warp_xla_jit  *
        return projective_warp_xla(images, transforms,
    File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 97, in projective_warp_xla  *
        src = tf.einsum("bij,bhwj->bhwi", M, grid)  # [B,H,W,3]

    ValueError: Dimensions must be equal, but are 128 and 32 for '{{node einsum/Einsum}} = Einsum[N=2, T=DT_FLOAT, equation="bij,bhwj->bhwi"](transforms, Tile)' with input shapes: [128,3,3], [32,138,138,3].
[0m

Arguments received by Translation.call():
  â€¢ inputs=['tf.Tensor(shape=(32, 138, 138, 1), dtype=float32)', 'tf.Tensor(shape=(128, 2), dtype=float32)']
2025-11-12 19:22:53,604 - ERROR - Traceback (most recent call last):
2025-11-12 19:22:53,604 - ERROR - File "<frozen runpy>", line 198, in _run_module_as_main
2025-11-12 19:22:53,604 - ERROR - File "<frozen runpy>", line 88, in _run_code
2025-11-12 19:22:53,604 - ERROR - File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 1290, in <module>
2025-11-12 19:22:53,604 - ERROR - main()
2025-11-12 19:22:53,604 - ERROR - File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 967, in main
2025-11-12 19:22:53,604 - ERROR - pinn_recon = pinn_model.predict(
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
2025-11-12 19:22:53,605 - ERROR - raise e.with_traceback(filtered_tb) from None
2025-11-12 19:22:53,605 - ERROR - File "/home/ollie/Documents/PtychoPINN/ptycho/custom_layers.py", line 148, in call
2025-11-12 19:22:53,605 - ERROR - return hh.reassemble_patches(patches,
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,605 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 1043, in reassemble_patches
2025-11-12 19:22:53,606 - ERROR - assembled_real = fn_reassemble_real(real, average = average, **kwargs) / mk_norm(real,
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 1020, in mk_norm
2025-11-12 19:22:53,606 - ERROR - assembled_ones = fn_reassemble_real(ones, average = False)
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,606 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 1267, in reassemble_patches_position_real
2025-11-12 19:22:53,607 - ERROR - return _reassemble_patches_position_real(imgs, input_positions,
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,607 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 865, in _reassemble_patches_position_real
2025-11-12 19:22:53,608 - ERROR - imgs_flat_bigN_translated = Translation(jitter_stddev=0.0, use_xla=should_use_xla())([imgs_flat_bigN, -offsets_flat])
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,608 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,609 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 836, in call
2025-11-12 19:22:53,610 - ERROR - return translate(imgs, offsets + jitter, interpolation='bilinear', use_xla_workaround=self.use_xla)
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,610 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,611 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 678, in newf
2025-11-12 19:22:53,612 - ERROR - return fn(*args, **kwargs)
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,612 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 798, in translate
2025-11-12 19:22:53,613 - ERROR - return translate_core(imgs, offsets, interpolation=interpolation, use_xla_workaround=use_xla_workaround)
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,613 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,614 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 722, in translate_core
2025-11-12 19:22:53,615 - ERROR - return translate_xla(images, translations, interpolation=interpolation, use_jit=True)
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,615 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,616 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 279, in translate_xla
2025-11-12 19:22:53,617 - ERROR - return projective_warp_xla_jit(images, M,
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,617 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - File "/tmp/__autograph_generated_fileq613qcis.py", line 16, in tf__projective_warp_xla_jit
2025-11-12 19:22:53,618 - ERROR - retval_ = ag__.converted_call(ag__.ld(projective_warp_xla), (ag__.ld(images), ag__.ld(transforms)), dict(interpolation=ag__.ld(interpolation), fill_mode=ag__.ld(fill_mode)), fscope)
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - File "/tmp/__autograph_generated_filemvd0q9tn.py", line 131, in tf__projective_warp_xla
2025-11-12 19:22:53,618 - ERROR - src = ag__.converted_call(ag__.ld(tf).einsum, ('bij,bhwj->bhwi', ag__.ld(M), ag__.ld(grid)), None, fscope)
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,618 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,619 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ^
2025-11-12 19:22:53,620 - ERROR - ValueError
2025-11-12 19:22:53,620 - ERROR - :
2025-11-12 19:22:53,620 - ERROR - Exception encountered when calling Translation.call().

[1min user code:

    File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 194, in projective_warp_xla_jit  *
        return projective_warp_xla(images, transforms,
    File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 97, in projective_warp_xla  *
        src = tf.einsum("bij,bhwj->bhwi", M, grid)  # [B,H,W,3]

    ValueError: Dimensions must be equal, but are 128 and 32 for '{{node einsum/Einsum}} = Einsum[N=2, T=DT_FLOAT, equation="bij,bhwj->bhwi"](transforms, Tile)' with input shapes: [128,3,3], [32,138,138,3].
[0m

Arguments received by Translation.call():
  â€¢ inputs=['tf.Tensor(shape=(32, 138, 138, 1), dtype=float32)', 'tf.Tensor(shape=(128, 2), dtype=float32)']
