2025-11-13 16:22:02,369 - INFO - Configuration: phase_align_method='plane', frc_sigma=0.0
2025-11-13 16:22:02,369 - INFO - Registration: enabled
2025-11-13 16:22:02,370 - INFO - NPZ output: raw=enabled, aligned=enabled
2025-11-13 16:22:02,370 - INFO - Loading PtychoPINN inference model (diffraction_to_obj) to restore configuration...
2025-11-13 16:22:02,370 - INFO - Loading model from: plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_1000/dense/gs2
2025-11-13 16:22:02,370 - DEBUG - Model archive path: plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_1000/dense/gs2/wts.h5.zip
2025-11-13 16:22:03,441 - INFO - Model: "functional"
2025-11-13 16:22:03,466 - INFO - â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ Layer (type)        â”ƒ Output Shape      â”ƒ    Param # â”ƒ Connected to      â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚ input (InputLayer)  â”‚ (None, 128, 128,  â”‚          0 â”‚ -                 â”‚
â”‚                     â”‚ 4)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ intensity_scaler    â”‚ (None, 128, 128,  â”‚          0 â”‚ input[0][0]       â”‚
â”‚ (IntensityScaler)   â”‚ 4)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d (Conv2D)     â”‚ (None, 128, 128,  â”‚      1,184 â”‚ intensity_scalerâ€¦ â”‚
â”‚                     â”‚ 32)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_1 (Conv2D)   â”‚ (None, 128, 128,  â”‚      9,248 â”‚ conv2d[0][0]      â”‚
â”‚                     â”‚ 32)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ max_pooling2d       â”‚ (None, 64, 64,    â”‚          0 â”‚ conv2d_1[0][0]    â”‚
â”‚ (MaxPooling2D)      â”‚ 32)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_2 (Conv2D)   â”‚ (None, 64, 64,    â”‚     18,496 â”‚ max_pooling2d[0]â€¦ â”‚
â”‚                     â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_3 (Conv2D)   â”‚ (None, 64, 64,    â”‚     36,928 â”‚ conv2d_2[0][0]    â”‚
â”‚                     â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ max_pooling2d_1     â”‚ (None, 32, 32,    â”‚          0 â”‚ conv2d_3[0][0]    â”‚
â”‚ (MaxPooling2D)      â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_4 (Conv2D)   â”‚ (None, 32, 32,    â”‚     73,856 â”‚ max_pooling2d_1[â€¦ â”‚
â”‚                     â”‚ 128)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_5 (Conv2D)   â”‚ (None, 32, 32,    â”‚    147,584 â”‚ conv2d_4[0][0]    â”‚
â”‚                     â”‚ 128)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ max_pooling2d_2     â”‚ (None, 16, 16,    â”‚          0 â”‚ conv2d_5[0][0]    â”‚
â”‚ (MaxPooling2D)      â”‚ 128)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_6 (Conv2D)   â”‚ (None, 16, 16,    â”‚    295,168 â”‚ max_pooling2d_2[â€¦ â”‚
â”‚                     â”‚ 256)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_7 (Conv2D)   â”‚ (None, 16, 16,    â”‚    590,080 â”‚ conv2d_6[0][0]    â”‚
â”‚                     â”‚ 256)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ max_pooling2d_3     â”‚ (None, 8, 8, 256) â”‚          0 â”‚ conv2d_7[0][0]    â”‚
â”‚ (MaxPooling2D)      â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_10 (Conv2D)  â”‚ (None, 8, 8, 256) â”‚    590,080 â”‚ max_pooling2d_3[â€¦ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_20 (Conv2D)  â”‚ (None, 8, 8, 256) â”‚    590,080 â”‚ max_pooling2d_3[â€¦ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_11 (Conv2D)  â”‚ (None, 8, 8, 256) â”‚    590,080 â”‚ conv2d_10[0][0]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_21 (Conv2D)  â”‚ (None, 8, 8, 256) â”‚    590,080 â”‚ conv2d_20[0][0]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ up_sampling2d       â”‚ (None, 16, 16,    â”‚          0 â”‚ conv2d_11[0][0]   â”‚
â”‚ (UpSampling2D)      â”‚ 256)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ up_sampling2d_4     â”‚ (None, 16, 16,    â”‚          0 â”‚ conv2d_21[0][0]   â”‚
â”‚ (UpSampling2D)      â”‚ 256)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_12 (Conv2D)  â”‚ (None, 16, 16,    â”‚    295,040 â”‚ up_sampling2d[0]â€¦ â”‚
â”‚                     â”‚ 128)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_22 (Conv2D)  â”‚ (None, 16, 16,    â”‚    295,040 â”‚ up_sampling2d_4[â€¦ â”‚
â”‚                     â”‚ 128)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_13 (Conv2D)  â”‚ (None, 16, 16,    â”‚    147,584 â”‚ conv2d_12[0][0]   â”‚
â”‚                     â”‚ 128)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_23 (Conv2D)  â”‚ (None, 16, 16,    â”‚    147,584 â”‚ conv2d_22[0][0]   â”‚
â”‚                     â”‚ 128)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ up_sampling2d_1     â”‚ (None, 32, 32,    â”‚          0 â”‚ conv2d_13[0][0]   â”‚
â”‚ (UpSampling2D)      â”‚ 128)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ up_sampling2d_5     â”‚ (None, 32, 32,    â”‚          0 â”‚ conv2d_23[0][0]   â”‚
â”‚ (UpSampling2D)      â”‚ 128)              â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_14 (Conv2D)  â”‚ (None, 32, 32,    â”‚     73,792 â”‚ up_sampling2d_1[â€¦ â”‚
â”‚                     â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_24 (Conv2D)  â”‚ (None, 32, 32,    â”‚     73,792 â”‚ up_sampling2d_5[â€¦ â”‚
â”‚                     â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_15 (Conv2D)  â”‚ (None, 32, 32,    â”‚     36,928 â”‚ conv2d_14[0][0]   â”‚
â”‚                     â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_25 (Conv2D)  â”‚ (None, 32, 32,    â”‚     36,928 â”‚ conv2d_24[0][0]   â”‚
â”‚                     â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ up_sampling2d_2     â”‚ (None, 64, 64,    â”‚          0 â”‚ conv2d_15[0][0]   â”‚
â”‚ (UpSampling2D)      â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ up_sampling2d_6     â”‚ (None, 64, 64,    â”‚          0 â”‚ conv2d_25[0][0]   â”‚
â”‚ (UpSampling2D)      â”‚ 64)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ get_item_1          â”‚ (None, 64, 64, 4) â”‚          0 â”‚ up_sampling2d_2[â€¦ â”‚
â”‚ (GetItem)           â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ get_item_3          â”‚ (None, 64, 64, 4) â”‚          0 â”‚ up_sampling2d_6[â€¦ â”‚
â”‚ (GetItem)           â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_16 (Conv2D)  â”‚ (None, 64, 64,    â”‚      1,184 â”‚ get_item_1[0][0]  â”‚
â”‚                     â”‚ 32)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_26 (Conv2D)  â”‚ (None, 64, 64,    â”‚      1,184 â”‚ get_item_3[0][0]  â”‚
â”‚                     â”‚ 32)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_17 (Conv2D)  â”‚ (None, 64, 64,    â”‚      9,248 â”‚ conv2d_16[0][0]   â”‚
â”‚                     â”‚ 32)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_27 (Conv2D)  â”‚ (None, 64, 64,    â”‚      9,248 â”‚ conv2d_26[0][0]   â”‚
â”‚                     â”‚ 32)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ up_sampling2d_3     â”‚ (None, 128, 128,  â”‚          0 â”‚ conv2d_17[0][0]   â”‚
â”‚ (UpSampling2D)      â”‚ 32)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ up_sampling2d_7     â”‚ (None, 128, 128,  â”‚          0 â”‚ conv2d_27[0][0]   â”‚
â”‚ (UpSampling2D)      â”‚ 32)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ get_item (GetItem)  â”‚ (None, 64, 64,    â”‚          0 â”‚ up_sampling2d_2[â€¦ â”‚
â”‚                     â”‚ 60)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_9 (Conv2D)   â”‚ (None, 128, 128,  â”‚      1,156 â”‚ up_sampling2d_3[â€¦ â”‚
â”‚                     â”‚ 4)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ get_item_2          â”‚ (None, 64, 64,    â”‚          0 â”‚ up_sampling2d_6[â€¦ â”‚
â”‚ (GetItem)           â”‚ 60)               â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_19 (Conv2D)  â”‚ (None, 128, 128,  â”‚      1,156 â”‚ up_sampling2d_7[â€¦ â”‚
â”‚                     â”‚ 4)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_8 (Conv2D)   â”‚ (None, 64, 64, 4) â”‚      2,164 â”‚ get_item[0][0]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ silu (Silu)         â”‚ (None, 128, 128,  â”‚          0 â”‚ conv2d_9[0][0]    â”‚
â”‚                     â”‚ 4)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2d_18 (Conv2D)  â”‚ (None, 64, 64, 4) â”‚      2,164 â”‚ get_item_2[0][0]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ silu_1 (Silu)       â”‚ (None, 128, 128,  â”‚          0 â”‚ conv2d_19[0][0]   â”‚
â”‚                     â”‚ 4)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ amp                 â”‚ (None, 64, 64, 4) â”‚          0 â”‚ conv2d_8[0][0]    â”‚
â”‚ (ActivationLayer)   â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ center_mask_layer   â”‚ (None, 128, 128,  â”‚          0 â”‚ silu[0][0]        â”‚
â”‚ (CenterMaskLayer)   â”‚ 1)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ phi                 â”‚ (None, 64, 64, 4) â”‚          0 â”‚ conv2d_18[0][0]   â”‚
â”‚ (ActivationLayer)   â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ center_mask_layer_1 â”‚ (None, 128, 128,  â”‚          0 â”‚ silu_1[0][0]      â”‚
â”‚ (CenterMaskLayer)   â”‚ 1)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ amp_padded          â”‚ (None, 128, 128,  â”‚          0 â”‚ amp[0][0]         â”‚
â”‚ (ZeroPadding2D)     â”‚ 4)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ multiply (Multiply) â”‚ (None, 128, 128,  â”‚          0 â”‚ silu[0][0],       â”‚
â”‚                     â”‚ 4)                â”‚            â”‚ center_mask_layeâ€¦ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ phase_padded        â”‚ (None, 128, 128,  â”‚          0 â”‚ phi[0][0]         â”‚
â”‚ (ZeroPadding2D)     â”‚ 4)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ multiply_1          â”‚ (None, 128, 128,  â”‚          0 â”‚ silu_1[0][0],     â”‚
â”‚ (Multiply)          â”‚ 4)                â”‚            â”‚ center_mask_layeâ€¦ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ add (Add)           â”‚ (None, 128, 128,  â”‚          0 â”‚ amp_padded[0][0], â”‚
â”‚                     â”‚ 4)                â”‚            â”‚ multiply[0][0]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ add_1 (Add)         â”‚ (None, 128, 128,  â”‚          0 â”‚ phase_padded[0][â€¦ â”‚
â”‚                     â”‚ 4)                â”‚            â”‚ multiply_1[0][0]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ obj                 â”‚ (None, 128, 128,  â”‚          0 â”‚ add[0][0],        â”‚
â”‚ (CombineComplexLayâ€¦ â”‚ 4)                â”‚            â”‚ add_1[0][0]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ input_positions     â”‚ (None, 1, 2, 4)   â”‚          0 â”‚ -                 â”‚
â”‚ (InputLayer)        â”‚                   â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ padded_obj_2        â”‚ (None, 142, 142,  â”‚          0 â”‚ obj[0][0],        â”‚
â”‚ (ReassemblePatchesâ€¦ â”‚ 4)                â”‚            â”‚ input_positions[â€¦ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ padded_objs_with_oâ€¦ â”‚ (None, 132, 132,  â”‚          0 â”‚ padded_obj_2[0][â€¦ â”‚
â”‚ (ExtractPatchesPosâ€¦ â”‚ 4)                â”‚            â”‚ input_positions[â€¦ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ probe_illumination  â”‚ [(None, 132, 132, â”‚          0 â”‚ padded_objs_withâ€¦ â”‚
â”‚ (ProbeIllumination) â”‚ 4), (None, 132,   â”‚            â”‚                   â”‚
â”‚                     â”‚ 132, 4)]          â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ pred_amplitude      â”‚ [(None, 128, 128, â”‚          0 â”‚ probe_illuminatiâ€¦ â”‚
â”‚ (PadAndDiffractLayâ€¦ â”‚ 4), (None, 128,   â”‚            â”‚                   â”‚
â”‚                     â”‚ 128, 4)]          â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ pred_diff_channels  â”‚ (None, 128, 128,  â”‚          0 â”‚ pred_amplitude[0â€¦ â”‚
â”‚ (FlatToChannelLayeâ€¦ â”‚ 4)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ intensity_scaler_iâ€¦ â”‚ (None, 128, 128,  â”‚          0 â”‚ pred_diff_channeâ€¦ â”‚
â”‚ (IntensityScaler_iâ€¦ â”‚ 4)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trimmed_obj         â”‚ (None, 128, 128,  â”‚          0 â”‚ padded_obj_2[0][â€¦ â”‚
â”‚ (TrimReconstructioâ€¦ â”‚ 4)                â”‚            â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ pred_intensity      â”‚ (None, 128, 128,  â”‚          0 â”‚ intensity_scalerâ€¦ â”‚
â”‚ (SquareLayer)       â”‚ 4)                â”‚            â”‚                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
2025-11-13 16:22:03,466 - INFO - Total params: 4,667,056 (17.80 MB)
2025-11-13 16:22:03,466 - INFO - Trainable params: 4,667,056 (17.80 MB)
2025-11-13 16:22:03,466 - INFO - Non-trainable params: 0 (0.00 B)
2025-11-13 16:22:03,466 - INFO - None
2025-11-13 16:22:03,660 - ERROR - /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py:421: UserWarning: `build()` was called on layer 'center_mask_layer', however the layer does not have a `build()` method implemented and it looks like it has unbuilt state. This will cause the layer to be marked as built, despite not being actually built, which may cause failures down the line. Make sure to implement a proper `build()` method.
  warnings.warn(
2025-11-13 16:22:03,661 - ERROR - /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py:421: UserWarning: `build()` was called on layer 'center_mask_layer_1', however the layer does not have a `build()` method implemented and it looks like it has unbuilt state. This will cause the layer to be marked as built, despite not being actually built, which may cause failures down the line. Make sure to implement a proper `build()` method.
  warnings.warn(
2025-11-13 16:22:04,300 - INFO - Successfully loaded model from plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_1000/dense/gs2
2025-11-13 16:22:04,301 - DEBUG - Model configuration: {'N': 128, 'offset': 4, 'gridsize': 2, 'outer_offset_train': None, 'outer_offset_test': None, 'batch_size': 16, 'nepochs': 50, 'n_filters_scale': 2, 'output_prefix': '/home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_1000/dense/gs2', 'big_gridsize': 10, 'max_position_jitter': 10, 'sim_jitter_scale': 0.0, 'default_probe_scale': 0.7, 'mae_weight': 0.0, 'nll_weight': 1.0, 'tv_weight': 0.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000.0, 'nimgs_train': 9, 'nimgs_test': 3, 'data_source': 'generic', 'probe.trainable': False, 'intensity_scale.trainable': True, 'positions.provided': True, 'object.big': True, 'probe.big': True, 'probe_scale': 4.0, 'set_phi': False, 'probe.mask': False, 'pad_object': True, 'model_type': 'pinn', 'label': '', 'size': 392, 'amp_activation': 'sigmoid', 'h5_path': 'wts.h5', 'npseed': 42, 'debug': True, 'gaussian_smoothing_sigma': 0.0, 'use_xla_translate': True, 'n_groups': 512, 'neighbor_count': 4, 'enable_oversampling': False, 'sequential_sampling': False, 'backend': 'tensorflow', 'train_data_file_path': '/home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_d/dose_1000/dense/train.npz', 'test_data_file_path': '/home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_d/dose_1000/dense/test.npz', 'probe': <tf.Tensor: shape=(128, 128, 1), dtype=complex64, numpy=
array([[[ 0.28498438-0.09745132j],
        [ 0.07898823-0.06898231j],
        [-0.1776128 -0.02413889j],
        ...,
        [ 0.10659252+0.00086214j],
        [-0.0585174 -0.0181606j ],
        [-0.17915702-0.02362471j]],

       [[ 0.07898823-0.06898231j],
        [ 0.038569  -0.06275462j],
        [-0.0141969 -0.04730332j],
        ...,
        [ 0.01960954+0.00739213j],
        [ 0.00271502-0.0311804j ],
        [-0.0145774 -0.04700996j]],

       [[-0.1776128 -0.02413889j],
        [-0.0141969 -0.04730332j],
        [ 0.18258305-0.06964147j],
        ...,
        [-0.09195265+0.01901859j],
        [ 0.07156007-0.03915591j],
        [ 0.18359068-0.06960618j]],

       ...,

       [[ 0.10659252+0.00086214j],
        [ 0.01960954+0.00739213j],
        [-0.09195265+0.01901859j],
        ...,
        [ 0.03286983+0.00071724j],
        [-0.04599212+0.01944371j],
        [-0.09270766+0.01917951j]],

       [[-0.0585174 -0.0181606j ],
        [ 0.00271502-0.0311804j ],
        [ 0.07156007-0.03915591j],
        ...,
        [-0.04599212+0.01944371j],
        [ 0.02061781-0.01389362j],
        [ 0.07178088-0.03898923j]],

       [[-0.17915702-0.02362471j],
        [-0.0145774 -0.04700996j],
        [ 0.18359068-0.06960618j],
        ...,
        [-0.09270766+0.01917951j],
        [ 0.07178088-0.03898923j],
        [ 0.18460508-0.06957199j]]], dtype=complex64)>, 'intensity_scale': np.float32(0.49410588)}
2025-11-13 16:22:04,301 - INFO - Restored configuration from model: gridsize=2, N=128
2025-11-13 16:22:04,301 - INFO - Loading test data from plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_c/dose_1000/patched_test.npz with restored gridsize=2...
2025-11-13 16:22:04,301 - INFO - Using all test data (no subsampling or grouping limit)
2025-11-13 16:22:04,301 - INFO - Loading data from plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_c/dose_1000/patched_test.npz with n_images=None, n_subsample=None
2025-11-13 16:22:04,755 - WARNING - Ignoring NPZ 'Y' with incompatible shape (1, 128, 128, 1) (expected first axis 5216)
2025-11-13 16:22:04,755 - INFO - Using full dataset of 5216 images
2025-11-13 16:22:04,795 - INFO - diff3d shape: (5216, 128, 128)
2025-11-13 16:22:04,795 - INFO - probeGuess shape: (128, 128)
2025-11-13 16:22:04,795 - INFO - scan_index shape: (5216,)
2025-11-13 16:22:04,795 - INFO - objectGuess shape: (464, 464)
2025-11-13 16:22:04,795 - INFO - xcoords shape: (5216,)
2025-11-13 16:22:04,795 - INFO - ycoords shape: (5216,)
2025-11-13 16:22:04,795 - INFO - xcoords_start shape: (5216,)
2025-11-13 16:22:04,795 - INFO - ycoords_start shape: (5216,)
2025-11-13 16:22:04,796 - INFO - Final configuration: gridsize=2, N=128, n_images=5216
2025-11-13 16:22:04,796 - INFO - Using stitch_crop_size M=20 (N=128)
2025-11-13 16:22:04,796 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=5216, n_points=5216, C=4, K=7
2025-11-13 16:22:04,796 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=2, N=128, sequential_sampling=False
2025-11-13 16:22:04,796 - INFO - [OVERSAMPLING DEBUG] Oversampling flags: enable_oversampling=False, neighbor_pool_size=None, effective_K=7
2025-11-13 16:22:04,796 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 5216 > 5216 = False
2025-11-13 16:22:04,796 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 4 > 1 = True
2025-11-13 16:22:04,796 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2025-11-13 16:22:04,796 - INFO - DEBUG:
2025-11-13 16:22:04,796 - INFO - nsamples: 5216, gridsize: 2 (using efficient random sample-then-group strategy)
2025-11-13 16:22:04,796 - INFO - Using efficient random sampling strategy for gridsize=2
2025-11-13 16:22:04,796 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-13 16:22:04,796 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=5216, K=7, C=4
2025-11-13 16:22:04,796 - INFO - Generating 5216 groups efficiently from 5216 points (K=7, C=4)
2025-11-13 16:22:04,796 - INFO - [OVERSAMPLING DEBUG] Standard case: using 5216 groups from 5216 points
2025-11-13 16:22:04,796 - INFO - [OVERSAMPLING DEBUG] Using all 5216 points as seeds (no sampling needed)
2025-11-13 16:22:04,796 - INFO - Using all 5216 points as seeds
2025-11-13 16:22:04,830 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 5216 groups
2025-11-13 16:22:04,830 - INFO - Successfully generated 5216 groups with shape (5216, 4)
2025-11-13 16:22:04,830 - INFO - [OVERSAMPLING DEBUG] Generated 5216 groups in total
2025-11-13 16:22:04,830 - INFO - Generated 5216 groups efficiently
2025-11-13 16:22:04,984 - INFO - INFO: 'Y' array not found. Generating ground truth patches from 'objectGuess' as a fallback.
2025-11-13 16:23:33,471 - INFO - neighbor-sampled diffraction shape
2025-11-13 16:23:33,471 - INFO - (5216, 128, 128, 4)
2025-11-13 16:23:35,464 - INFO - loader: using provided ground truth patches.
2025-11-13 16:23:35,864 - INFO - INFO:
2025-11-13 16:23:35,864 - INFO - None
2025-11-13 16:23:35,864 - INFO - <PtychoDataContainer X=(5216, 128, 128, 4) Y_I=(5216, 128, 128, 4) Y_phi=(5216, 128, 128, 4) norm_Y_I=() coords_nominal=(5216, 1, 2, 4) coords_true=(5216, 1, 2, 4) nn_indices=(5216, 4) mean=2619.745 global_offsets=(5216, 1, 2, 1) mean=273.808 local_offsets=(5216, 1, 2, 4) mean=0.000 probe=(128, 128) mean_amplitude=0.007>
2025-11-13 16:23:35,872 - INFO - Loading Baseline model from plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_1000/baseline/gs1...
2025-11-13 16:23:35,872 - INFO - baseline_model.h5 not found; attempting to load TF bundle (wts.h5.zip)
2025-11-13 16:23:35,872 - INFO - Loading model from: plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_1000/baseline/gs1
2025-11-13 16:23:35,872 - DEBUG - Model archive path: plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_1000/baseline/gs1/wts.h5.zip
2025-11-13 16:23:36,902 - INFO - Successfully loaded model from plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_1000/baseline/gs1
2025-11-13 16:23:36,903 - DEBUG - Model configuration: {'N': 128, 'offset': 4, 'gridsize': 1, 'outer_offset_train': None, 'outer_offset_test': None, 'batch_size': 16, 'nepochs': 50, 'n_filters_scale': 2, 'output_prefix': '/home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_1000/baseline/gs1', 'big_gridsize': 10, 'max_position_jitter': 10, 'sim_jitter_scale': 0.0, 'default_probe_scale': 0.7, 'mae_weight': 0.0, 'nll_weight': 1.0, 'tv_weight': 0.0, 'realspace_mae_weight': 0.0, 'realspace_weight': 0.0, 'nphotons': 1000.0, 'nimgs_train': 9, 'nimgs_test': 3, 'data_source': 'generic', 'probe.trainable': False, 'intensity_scale.trainable': True, 'positions.provided': True, 'object.big': True, 'probe.big': True, 'probe_scale': 4.0, 'set_phi': False, 'probe.mask': False, 'pad_object': True, 'model_type': 'pinn', 'label': '', 'size': 392, 'amp_activation': 'sigmoid', 'h5_path': 'wts.h5', 'npseed': 42, 'debug': True, 'gaussian_smoothing_sigma': 0.0, 'use_xla_translate': True, 'n_groups': 512, 'neighbor_count': 4, 'enable_oversampling': False, 'sequential_sampling': False, 'backend': 'tensorflow', 'train_data_file_path': '/home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_c/dose_1000/patched_train.npz', 'test_data_file_path': '/home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_c/dose_1000/patched_test.npz', 'probe': <tf.Tensor: shape=(128, 128, 1), dtype=complex64, numpy=
array([[[ 0.28498438-0.09745132j],
        [ 0.07898823-0.06898231j],
        [-0.1776128 -0.02413889j],
        ...,
        [ 0.10659252+0.00086214j],
        [-0.0585174 -0.0181606j ],
        [-0.17915702-0.02362471j]],

       [[ 0.07898823-0.06898231j],
        [ 0.038569  -0.06275462j],
        [-0.0141969 -0.04730332j],
        ...,
        [ 0.01960954+0.00739213j],
        [ 0.00271502-0.0311804j ],
        [-0.0145774 -0.04700996j]],

       [[-0.1776128 -0.02413889j],
        [-0.0141969 -0.04730332j],
        [ 0.18258305-0.06964147j],
        ...,
        [-0.09195265+0.01901859j],
        [ 0.07156007-0.03915591j],
        [ 0.18359068-0.06960618j]],

       ...,

       [[ 0.10659252+0.00086214j],
        [ 0.01960954+0.00739213j],
        [-0.09195265+0.01901859j],
        ...,
        [ 0.03286983+0.00071724j],
        [-0.04599212+0.01944371j],
        [-0.09270766+0.01917951j]],

       [[-0.0585174 -0.0181606j ],
        [ 0.00271502-0.0311804j ],
        [ 0.07156007-0.03915591j],
        ...,
        [-0.04599212+0.01944371j],
        [ 0.02061781-0.01389362j],
        [ 0.07178088-0.03898923j]],

       [[-0.17915702-0.02362471j],
        [-0.0145774 -0.04700996j],
        [ 0.18359068-0.06960618j],
        ...,
        [-0.09270766+0.01917951j],
        [ 0.07178088-0.03898923j],
        [ 0.18460508-0.06957199j]]], dtype=complex64)>, 'intensity_scale': np.float32(0.49410588), 'torch_loss_mode': 'poisson'}
2025-11-13 16:23:36,903 - INFO - Loading iterative reconstruction from plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_f/dose_1000/dense/test/ptychi_reconstruction.npz...
2025-11-13 16:23:36,908 - DEBUG - Detected algorithm from 'algorithm' field: Pty-chi (pty-chi)
2025-11-13 16:23:36,908 - INFO - Loaded Pty-chi (pty-chi) reconstruction: (346, 514) (complex64)
2025-11-13 16:23:36,908 - INFO - Pty-chi (pty-chi) reconstruction loaded for three-way comparison
2025-11-13 16:23:36,908 - INFO - Running inference with PtychoPINN (diffraction_to_obj)...
2025-11-13 16:23:36,908 - WARNING - GRIDSIZE MISMATCH: params.cfg['gridsize']=1 but diffraction has 4 channels (requires gridsize=2)
2025-11-13 16:23:36,908 - WARNING - Forcing params.cfg['gridsize']=2 before inference to prevent Translation layer crash
2025-11-13 16:23:55,165 - INFO - [1m  1/163[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m47:29[0m 18s/step
2025-11-13 16:23:55,217 - INFO - [1m  5/163[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m2s[0m 13ms/step
2025-11-13 16:23:55,278 - INFO - [1m 10/163[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 13ms/step
2025-11-13 16:23:55,338 - INFO - [1m 15/163[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 12ms/step
2025-11-13 16:23:55,399 - INFO - [1m 20/163[0m [32mâ”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 12ms/step
2025-11-13 16:23:55,459 - INFO - [1m 25/163[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 12ms/step
2025-11-13 16:23:55,520 - INFO - [1m 30/163[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 12ms/step
2025-11-13 16:23:55,581 - INFO - [1m 35/163[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 12ms/step
2025-11-13 16:23:55,642 - INFO - [1m 40/163[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 12ms/step
2025-11-13 16:23:55,703 - INFO - [1m 45/163[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 12ms/step
2025-11-13 16:23:55,764 - INFO - [1m 50/163[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 12ms/step
2025-11-13 16:23:55,824 - INFO - [1m 55/163[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 12ms/step
2025-11-13 16:23:55,884 - INFO - [1m 60/163[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 12ms/step
2025-11-13 16:23:55,944 - INFO - [1m 65/163[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 12ms/step
2025-11-13 16:23:56,006 - INFO - [1m 70/163[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 12ms/step
2025-11-13 16:23:56,068 - INFO - [1m 75/163[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 12ms/step
2025-11-13 16:23:56,130 - INFO - [1m 80/163[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 12ms/step
2025-11-13 16:23:56,192 - INFO - [1m 85/163[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 12ms/step
2025-11-13 16:23:56,245 - INFO - [1m 89/163[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 12ms/step
2025-11-13 16:23:56,307 - INFO - [1m 94/163[0m [32mâ”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”[0m [1m0s[0m 12ms/step
2025-11-13 16:23:56,368 - INFO - [1m 99/163[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 12ms/step
2025-11-13 16:23:56,430 - INFO - [1m104/163[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 12ms/step
2025-11-13 16:23:56,491 - INFO - [1m109/163[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 12ms/step
2025-11-13 16:23:56,553 - INFO - [1m114/163[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 12ms/step
2025-11-13 16:23:56,616 - INFO - [1m119/163[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 12ms/step
2025-11-13 16:23:56,677 - INFO - [1m124/163[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 12ms/step
2025-11-13 16:23:56,738 - INFO - [1m129/163[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 12ms/step
2025-11-13 16:23:56,800 - INFO - [1m134/163[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 12ms/step
2025-11-13 16:23:56,850 - INFO - [1m138/163[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 12ms/step
2025-11-13 16:23:56,909 - INFO - [1m143/163[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 12ms/step
2025-11-13 16:23:56,968 - INFO - [1m148/163[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 12ms/step
2025-11-13 16:23:57,027 - INFO - [1m153/163[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 12ms/step
2025-11-13 16:23:57,086 - INFO - [1m158/163[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 12ms/step
2025-11-13 16:23:57,143 - INFO - [1m162/163[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 12ms/step
2025-11-13 16:23:57,168 - INFO - [1m163/163[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m20s[0m 12ms/step
2025-11-13 16:23:57,326 - INFO - PtychoPINN inference completed in 20.42s
2025-11-13 16:23:57,326 - INFO - PINN patches shape before reassembly: (163, 128, 128, 1), dtype: complex64
2025-11-13 16:23:57,326 - INFO - Reassembling PINN patches...
2025-11-13 16:23:57,326 - INFO - PINN offsets shape before reassembly: (5216, 1, 2, 1), dtype: float64
2025-11-13 16:23:58,111 - CRITICAL - Uncaught exception
Traceback (most recent call last):
  File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 1379, in <module>
    main()
  File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 1032, in main
    pinn_recon = reassemble_position(pinn_patches, pinn_offsets, M=args.stitch_crop_size)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 1287, in reassemble_position
    return shift_and_sum(obj_tensor, global_offsets, M = M) /\
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 153, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_fileocx386kp.py", line 106, in tf__shift_and_sum
    result = ag__.converted_call(ag__.ld(tf).cond, (ag__.ld(total_texels) < ag__.ld(mem_cap_texels), ag__.ld(_vectorised), ag__.ld(_streaming)), None, fscope)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp/__autograph_generated_fileocx386kp.py", line 49, in _vectorised
    translated = ag__.converted_call(ag__.ld(translate), (ag__.ld(imgs_padded), ag__.ld(offsets_flat)), dict(interpolation='bilinear'), fscope_1)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp/__autograph_generated_file5oj22v1u.py", line 46, in tf__newf
    ag__.if_stmt(ag__.converted_call(ag__.ld(is_complex_tensor), (ag__.ld(channels),), None, fscope), if_body, else_body, get_state, set_state, ('do_return', 'retval_'), 2)
  File "/tmp/__autograph_generated_file5oj22v1u.py", line 25, in if_body
    assembled_part1 = ag__.converted_call(ag__.ld(fn), (ag__.ld(part1),) + tuple(ag__.ld(args)[1:]), dict(**ag__.ld(kwargs)), fscope)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp/__autograph_generated_filesqzyrn68.py", line 17, in tf__translate
    raise
  File "/tmp/__autograph_generated_file_ceaijo2.py", line 137, in tf__translate_core
    ag__.if_stmt(ag__.ld(use_xla), if_body_3, else_body_3, get_state_3, set_state_3, ('do_return', 'retval_', 'translations'), 2)
  File "/tmp/__autograph_generated_file_ceaijo2.py", line 40, in if_body_3
    raise
  File "/tmp/__autograph_generated_filem7mqc0mp.py", line 100, in tf__translate_xla
    ag__.if_stmt(ag__.ld(images).dtype in [ag__.ld(tf).complex64, ag__.ld(tf).complex128], if_body_1, else_body_1, get_state_1, set_state_1, ('do_return', 'retval_', 'translations'), 2)
  File "/tmp/__autograph_generated_filem7mqc0mp.py", line 84, in else_body_1
    ag__.if_stmt(ag__.ld(use_jit), if_body, else_body, get_state, set_state, ('do_return', 'retval_'), 2)
  File "/tmp/__autograph_generated_filem7mqc0mp.py", line 74, in if_body
    raise
  File "/tmp/__autograph_generated_filefn33chv1.py", line 19, in tf__projective_warp_xla_jit
    raise
  File "/tmp/__autograph_generated_filef6rqgig6.py", line 328, in tf__projective_warp_xla
    ag__.if_stmt(ag__.ld(interpolation) == 'nearest', if_body_10, else_body_10, get_state_10, set_state_10, ('out',), 1)
  File "/tmp/__autograph_generated_filef6rqgig6.py", line 298, in else_body_10
    ag__.if_stmt(ag__.ld(fill_mode) == 'edge', if_body_9, else_body_9, get_state_9, set_state_9, ('out',), 1)
  File "/tmp/__autograph_generated_filef6rqgig6.py", line 278, in else_body_9
    out = ag__.ld(wa) * ag__.ld(Ia) + ag__.ld(wb) * ag__.ld(Ib) + ag__.ld(wc) * ag__.ld(Ic) + ag__.ld(wd) * ag__.ld(Id)
          ~~~~~~~~~~~~^~~~~~~~~~~~~
ValueError: in user code:

    File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 1187, in _vectorised  *
        translated   = translate(imgs_padded, offsets_flat, interpolation='bilinear')
    File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 674, in newf  *
        assembled_part1 = fn(part1, *args[1:], **kwargs)
    File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 798, in translate  *
        return translate_core(imgs, offsets, interpolation=interpolation, use_xla_workaround=use_xla_workaround)
    File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 722, in translate_core  *
        return translate_xla(images, translations, interpolation=interpolation, use_jit=True)
    File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 294, in translate_xla  *
        return projective_warp_xla_jit(images, M,
    File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 209, in projective_warp_xla_jit  *
        return projective_warp_xla(images, transforms,
    File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 196, in projective_warp_xla  *
        out = wa * Ia + wb * Ib + wc * Ic + wd * Id

    ValueError: Dimensions must be equal, but are 5216 and 163 for '{{node mul_21}} = Mul[T=DT_FLOAT](mul_17, mul_13)' with input shapes: [5216,?,?,1], [163,?,?,1].

2025-11-13 16:23:58,112 - ERROR - Traceback (most recent call last):
2025-11-13 16:23:58,112 - ERROR - File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 1379, in <module>
2025-11-13 16:23:58,113 - ERROR - main()
2025-11-13 16:23:58,113 - ERROR - File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 1032, in main
2025-11-13 16:23:58,113 - ERROR - pinn_recon = reassemble_position(pinn_patches, pinn_offsets, M=args.stitch_crop_size)
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,113 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 1287, in reassemble_position
2025-11-13 16:23:58,114 - ERROR - return shift_and_sum(obj_tensor, global_offsets, M = M) /\
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,114 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 153, in error_handler
2025-11-13 16:23:58,115 - ERROR - raise e.with_traceback(filtered_tb) from None
2025-11-13 16:23:58,115 - ERROR - File "/tmp/__autograph_generated_fileocx386kp.py", line 106, in tf__shift_and_sum
2025-11-13 16:23:58,115 - ERROR - result = ag__.converted_call(ag__.ld(tf).cond, (ag__.ld(total_texels) < ag__.ld(mem_cap_texels), ag__.ld(_vectorised), ag__.ld(_streaming)), None, fscope)
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,115 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,116 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,117 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - File "/tmp/__autograph_generated_fileocx386kp.py", line 49, in _vectorised
2025-11-13 16:23:58,118 - ERROR - translated = ag__.converted_call(ag__.ld(translate), (ag__.ld(imgs_padded), ag__.ld(offsets_flat)), dict(interpolation='bilinear'), fscope_1)
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,118 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,119 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - File "/tmp/__autograph_generated_file5oj22v1u.py", line 46, in tf__newf
2025-11-13 16:23:58,120 - ERROR - ag__.if_stmt(ag__.converted_call(ag__.ld(is_complex_tensor), (ag__.ld(channels),), None, fscope), if_body, else_body, get_state, set_state, ('do_return', 'retval_'), 2)
2025-11-13 16:23:58,120 - ERROR - File "/tmp/__autograph_generated_file5oj22v1u.py", line 25, in if_body
2025-11-13 16:23:58,120 - ERROR - assembled_part1 = ag__.converted_call(ag__.ld(fn), (ag__.ld(part1),) + tuple(ag__.ld(args)[1:]), dict(**ag__.ld(kwargs)), fscope)
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,120 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,121 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - File "/tmp/__autograph_generated_filesqzyrn68.py", line 14, in tf__translate
2025-11-13 16:23:58,122 - ERROR - retval_ = ag__.converted_call(ag__.ld(translate_core), (ag__.ld(imgs), ag__.ld(offsets)), dict(interpolation=ag__.ld(interpolation), use_xla_workaround=ag__.ld(use_xla_workaround)), fscope)
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - File "/tmp/__autograph_generated_file_ceaijo2.py", line 137, in tf__translate_core
2025-11-13 16:23:58,122 - ERROR - ag__.if_stmt(ag__.ld(use_xla), if_body_3, else_body_3, get_state_3, set_state_3, ('do_return', 'retval_', 'translations'), 2)
2025-11-13 16:23:58,122 - ERROR - File "/tmp/__autograph_generated_file_ceaijo2.py", line 37, in if_body_3
2025-11-13 16:23:58,122 - ERROR - retval_ = ag__.converted_call(ag__.ld(translate_xla), (ag__.ld(images), ag__.ld(translations)), dict(interpolation=ag__.ld(interpolation), use_jit=True), fscope)
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - File "/tmp/__autograph_generated_filem7mqc0mp.py", line 100, in tf__translate_xla
2025-11-13 16:23:58,122 - ERROR - ag__.if_stmt(ag__.ld(images).dtype in [ag__.ld(tf).complex64, ag__.ld(tf).complex128], if_body_1, else_body_1, get_state_1, set_state_1, ('do_return', 'retval_', 'translations'), 2)
2025-11-13 16:23:58,122 - ERROR - File "/tmp/__autograph_generated_filem7mqc0mp.py", line 84, in else_body_1
2025-11-13 16:23:58,122 - ERROR - ag__.if_stmt(ag__.ld(use_jit), if_body, else_body, get_state, set_state, ('do_return', 'retval_'), 2)
2025-11-13 16:23:58,122 - ERROR - File "/tmp/__autograph_generated_filem7mqc0mp.py", line 71, in if_body
2025-11-13 16:23:58,122 - ERROR - retval_ = ag__.converted_call(ag__.ld(projective_warp_xla_jit), (ag__.ld(images), ag__.ld(M)), dict(interpolation=ag__.ld(interpolation), fill_mode='zeros'), fscope)
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - ^
2025-11-13 16:23:58,122 - ERROR - File "/tmp/__autograph_generated_filefn33chv1.py", line 16, in tf__projective_warp_xla_jit
2025-11-13 16:23:58,123 - ERROR - retval_ = ag__.converted_call(ag__.ld(projective_warp_xla), (ag__.ld(images), ag__.ld(transforms)), dict(interpolation=ag__.ld(interpolation), fill_mode=ag__.ld(fill_mode)), fscope)
2025-11-13 16:23:58,123 - ERROR - ^
2025-11-13 16:23:58,123 - ERROR - ^
2025-11-13 16:23:58,123 - ERROR - ^
2025-11-13 16:23:58,123 - ERROR - ^
2025-11-13 16:23:58,123 - ERROR - ^
2025-11-13 16:23:58,123 - ERROR - File "/tmp/__autograph_generated_filef6rqgig6.py", line 328, in tf__projective_warp_xla
2025-11-13 16:23:58,123 - ERROR - ag__.if_stmt(ag__.ld(interpolation) == 'nearest', if_body_10, else_body_10, get_state_10, set_state_10, ('out',), 1)
2025-11-13 16:23:58,123 - ERROR - File "/tmp/__autograph_generated_filef6rqgig6.py", line 298, in else_body_10
2025-11-13 16:23:58,123 - ERROR - ag__.if_stmt(ag__.ld(fill_mode) == 'edge', if_body_9, else_body_9, get_state_9, set_state_9, ('out',), 1)
2025-11-13 16:23:58,123 - ERROR - File "/tmp/__autograph_generated_filef6rqgig6.py", line 278, in else_body_9
2025-11-13 16:23:58,123 - ERROR - out = ag__.ld(wa) * ag__.ld(Ia) + ag__.ld(wb) * ag__.ld(Ib) + ag__.ld(wc) * ag__.ld(Ic) + ag__.ld(wd) * ag__.ld(Id)
2025-11-13 16:23:58,123 - ERROR - ~
2025-11-13 16:23:58,123 - ERROR - ~
2025-11-13 16:23:58,123 - ERROR - ~
2025-11-13 16:23:58,123 - ERROR - ~
2025-11-13 16:23:58,123 - ERROR - ~
2025-11-13 16:23:58,123 - ERROR - ~
2025-11-13 16:23:58,123 - ERROR - ~
2025-11-13 16:23:58,123 - ERROR - ~
2025-11-13 16:23:58,123 - ERROR - ~
2025-11-13 16:23:58,123 - ERROR - ~
2025-11-13 16:23:58,123 - ERROR - ~
2025-11-13 16:23:58,123 - ERROR - ~
2025-11-13 16:23:58,123 - ERROR - ^
2025-11-13 16:23:58,123 - ERROR - ~
2025-11-13 16:23:58,123 - ERROR - ~
2025-11-13 16:23:58,123 - ERROR - ~
2025-11-13 16:23:58,123 - ERROR - ~
2025-11-13 16:23:58,123 - ERROR - ~
2025-11-13 16:23:58,123 - ERROR - ~
2025-11-13 16:23:58,123 - ERROR - ~
2025-11-13 16:23:58,123 - ERROR - ~
2025-11-13 16:23:58,123 - ERROR - ~
2025-11-13 16:23:58,123 - ERROR - ~
2025-11-13 16:23:58,123 - ERROR - ~
2025-11-13 16:23:58,123 - ERROR - ~
2025-11-13 16:23:58,123 - ERROR - ValueError
2025-11-13 16:23:58,123 - ERROR - :
2025-11-13 16:23:58,123 - ERROR - in user code:

    File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 1187, in _vectorised  *
        translated   = translate(imgs_padded, offsets_flat, interpolation='bilinear')
    File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 674, in newf  *
        assembled_part1 = fn(part1, *args[1:], **kwargs)
    File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 798, in translate  *
        return translate_core(imgs, offsets, interpolation=interpolation, use_xla_workaround=use_xla_workaround)
    File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 722, in translate_core  *
        return translate_xla(images, translations, interpolation=interpolation, use_jit=True)
    File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 294, in translate_xla  *
        return projective_warp_xla_jit(images, M,
    File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 209, in projective_warp_xla_jit  *
        return projective_warp_xla(images, transforms,
    File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 196, in projective_warp_xla  *
        out = wa * Ia + wb * Ib + wc * Ic + wd * Id

    ValueError: Dimensions must be equal, but are 5216 and 163 for '{{node mul_21}} = Mul[T=DT_FLOAT](mul_17, mul_13)' with input shapes: [5216,?,?,1], [163,?,?,1].
