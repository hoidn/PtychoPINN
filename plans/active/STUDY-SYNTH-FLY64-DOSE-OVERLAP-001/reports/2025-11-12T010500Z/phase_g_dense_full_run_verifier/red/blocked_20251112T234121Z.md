# Phase G Comparison Blocker

**Timestamp:** $(date -Iseconds)
**Phase:** Phase G: Comparison dense/train
**Exit Code:** 1

## Error Summary

The comparison script failed during baseline model inference with the following error:

```
ValueError: Layer "functional_10" expects 2 input(s), but it received 1 input tensors.
Inputs received: [<tf.Tensor 'data:0' shape=(32, 128, 128, 1) dtype=float32>]
```

## Stack Trace

```
File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 985, in main
  baseline_output = baseline_model.predict(baseline_input, batch_size=32, verbose=1)
File "/home/ollie/Documents/PtychoPINN/ptycho/workflows/components.py", line 163, in predict
  return self._model.predict(*args, **kwargs)
```

## Command

```bash
/home/ollie/miniconda3/envs/ptycho311/bin/python -m studies.fly64_dose_overlap.comparison \
  --phase-c-root /home/ollie/Documents/PtychoPINN/data/phase_c \
  --phase-e-root /home/ollie/Documents/PtychoPINN/data/phase_e \
  --phase-f-root /home/ollie/Documents/PtychoPINN/data/phase_f \
  --artifact-root /home/ollie/Documents/PtychoPINN/analysis \
  --dose 1000 --view dense --split train
```

## Log Location

- Main log: `/home/ollie/Documents/PtychoPINN/cli/phase_g_dense_train.log`
- Comparison log: `/home/ollie/Documents/PtychoPINN/analysis/dose_1000/dense/train/comparison.log`

## Analysis

This is a baseline model compatibility issue. The baseline model (gs1, gridsize=1) was trained expecting single-channel input, but the comparison script is providing it with grouped data or incompatible input format.

This differs from the Translation error (`ValueError: Dimensions must be equal, but are 128 and 32`) documented in previous attempts.

## Successfully Completed Phases

- ✓ Phase C: Dataset Generation
- ✓ Phase D: Overlap View Generation  
- ✓ Phase E: Training Baseline (gs1)
- ✓ Phase E: Training Dense (gs2)
- ✓ Phase F: Reconstruction dense/train
- ✓ Phase F: Reconstruction dense/test
- ✗ Phase G: Comparison dense/train (FAILED HERE)
- Phase G: Comparison dense/test (NOT RUN)
- Post-verification helpers (NOT RUN)

## Artifacts Created

- `/home/ollie/Documents/PtychoPINN/data/phase_c/dose_1000/patched_train.npz` (470M)
- `/home/ollie/Documents/PtychoPINN/data/phase_c/dose_1000/patched_test.npz` (481M)
- `/home/ollie/Documents/PtychoPINN/data/phase_d/dose_1000/dense/train.npz` (470M)
- `/home/ollie/Documents/PtychoPINN/data/phase_d/dose_1000/dense/test.npz` (481M)
- `/home/ollie/Documents/PtychoPINN/data/phase_e/dose_1000/baseline/gs1/wts.h5.zip` (65M)
- `/home/ollie/Documents/PtychoPINN/data/phase_e/dose_1000/dense/gs2/wts.h5.zip` (66M)

## Next Actions

1. Investigate why baseline model expects 2 inputs vs 1
2. Check if comparison script needs to handle gs1 models differently
3. Consider if this is related to the probe input requirement
4. Review `scripts/compare_models.py:985` and `ptycho/workflows/components.py:163`
