DRY RUN: dense dose=1000.0 gridsize=2
Train: plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_d/dose_1000/dense/train.npz
Test: plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_d/dose_1000/dense/test.npz

================================================================================
Phase E5 Training Execution — dense (dose=1e+03, gridsize=2, backend=tensorflow)
================================================================================
Train dataset: /home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_d/dose_1000/dense/train.npz
Test dataset: /home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_d/dose_1000/dense/test.npz
Output directory: /home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_1000/dense/gs2
Gridsize: 2
nphotons: 1000.0
Backend: tensorflow

Loading datasets via TensorFlow loader...
Invoking TensorFlow train_cdi_model...
Persisting model bundle via TensorFlow ModelManager...
Bundle saved: /home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_1000/dense/gs2/wts.h5.zip
Bundle SHA256: e1457b44115f57dda5b0a051e6b3dd17bb73be9b742c5344140d76c176cf16fc
Bundle size: 68806704 bytes
Training completed successfully
Final loss: 0.14170365035533905
Epochs completed: 50
Checkpoint path: None
Bundle path: /home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_1000/dense/gs2/wts.h5.zip
Bundle SHA256: e1457b44115f57dda5b0a051e6b3dd17bb73be9b742c5344140d76c176cf16fc
Bundle size: 68806704 bytes

================================================================================
Phase E5 Training Execution — dense (dose=1e+03, gridsize=2, backend=tensorflow)
================================================================================
Train dataset: /home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_d/dose_1000/dense/train.npz
Test dataset: /home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_d/dose_1000/dense/test.npz
Output directory: /home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_1000/dense/gs2
Gridsize: 2
nphotons: 1000.0
Backend: tensorflow

Loading datasets via TensorFlow loader...
Invoking TensorFlow train_cdi_model...
Persisting model bundle via TensorFlow ModelManager...
Bundle saved: /home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_1000/dense/gs2/wts.h5.zip
Bundle SHA256: 786a15efe50b01e218e833a1903b641dc9e11441980a8e6f211c33e40ce96b6c
Bundle size: 68371031 bytes
Training completed successfully
Final loss: 0.14433692395687103
Epochs completed: 50
Checkpoint path: None
Bundle path: /home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_1000/dense/gs2/wts.h5.zip
Bundle SHA256: 786a15efe50b01e218e833a1903b641dc9e11441980a8e6f211c33e40ce96b6c
Bundle size: 68371031 bytes

================================================================================
Phase E5 Training Execution — dense (dose=1e+03, gridsize=2, backend=tensorflow)
================================================================================
Train dataset: /home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_d/dose_1000/dense/train.npz
Test dataset: /home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_d/dose_1000/dense/test.npz
Output directory: /home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_1000/dense/gs2
Gridsize: 2
nphotons: 1000.0
Backend: tensorflow

Loading datasets via TensorFlow loader...
Invoking TensorFlow train_cdi_model...
Training failed: InvalidArgumentError: Graph execution error:

Detected at node Reshape_21 defined at (most recent call last):
<stack traces unavailable>
Input to reshape is a tensor with 1290496 values, but the requested shape has 80656

Stack trace for op definition: 
File "<frozen runpy>", line 198, in _run_module_as_main
File "<frozen runpy>", line 88, in _run_code
File "/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py", line 1105, in <module>
File "/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py", line 978, in main
File "/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py", line 389, in run_training_job
File "/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py", line 422, in execute_training_job
File "/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py", line 494, in _execute_training_job_tensorflow
File "/home/ollie/Documents/PtychoPINN/ptycho/workflows/components.py", line 726, in train_cdi_model
File "/home/ollie/Documents/PtychoPINN/ptycho/train_pinn.py", line 90, in train_eval
File "/home/ollie/Documents/PtychoPINN/ptycho/train_pinn.py", line 86, in train
File "/home/ollie/Documents/PtychoPINN/ptycho/model.py", line 593, in train
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 377, in fit
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 220, in function
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 133, in multi_step_on_iterator
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 114, in one_step_on_data
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 58, in train_step
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/models/functional.py", line 183, in call
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/function.py", line 206, in _run_through_graph
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/models/functional.py", line 644, in call
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "/home/ollie/Documents/PtychoPINN/ptycho/custom_layers.py", line 155, in call
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 1070, in reassemble_patches
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 678, in newf
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 1318, in reassemble_patches_position_batched_real
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 1001, in _reassemble_position_batched
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 912, in original_approach
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 834, in call
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 678, in newf
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 798, in translate
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 722, in translate_core
File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 294, in translate_xla
File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 209, in projective_warp_xla_jit
File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 121, in projective_warp_xla
File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 145, in projective_warp_xla
File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 182, in projective_warp_xla

	 [[{{node Reshape_21}}]]
	tf2xla conversion failed while converting __forward_projective_warp_xla_jit_259523[]. Run with TF_DUMP_GRAPH_PREFIX=/path/to/dump/dir and --vmodule=xla_compiler=2 to obtain a dump of the compiled functions.
	 [[StatefulPartitionedCall/functional_1/padded_objs_with_offsets_1/translation_18_1/PartitionedCall_1]] [Op:__inference_multi_step_on_iterator_282197]
Traceback (most recent call last):
  File "/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py", line 494, in _execute_training_job_tensorflow
    training_results = tf_components.train_cdi_model(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/workflows/components.py", line 726, in train_cdi_model
    results = train_pinn.train_eval(PtychoDataset(train_container, test_container))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/train_pinn.py", line 90, in train_eval
    model_instance, history = train(ptycho_dataset.train_data)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/train_pinn.py", line 86, in train
    return model_instance, model.train(nepochs, train_data)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/model.py", line 593, in train
    history=autoencoder.fit(
            ^^^^^^^^^^^^^^^^
  File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/tensorflow/python/eager/execute.py", line 59, in quick_execute
    except TypeError as e:
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node Reshape_21 defined at (most recent call last):
<stack traces unavailable>
Input to reshape is a tensor with 1290496 values, but the requested shape has 80656

Stack trace for op definition: 
File "<frozen runpy>", line 198, in _run_module_as_main
File "<frozen runpy>", line 88, in _run_code
File "/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py", line 1105, in <module>
File "/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py", line 978, in main
File "/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py", line 389, in run_training_job
File "/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py", line 422, in execute_training_job
File "/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py", line 494, in _execute_training_job_tensorflow
File "/home/ollie/Documents/PtychoPINN/ptycho/workflows/components.py", line 726, in train_cdi_model
File "/home/ollie/Documents/PtychoPINN/ptycho/train_pinn.py", line 90, in train_eval
File "/home/ollie/Documents/PtychoPINN/ptycho/train_pinn.py", line 86, in train
File "/home/ollie/Documents/PtychoPINN/ptycho/model.py", line 593, in train
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 377, in fit
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 220, in function
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 133, in multi_step_on_iterator
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 114, in one_step_on_data
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 58, in train_step
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/models/functional.py", line 183, in call
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/function.py", line 206, in _run_through_graph
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/models/functional.py", line 644, in call
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "/home/ollie/Documents/PtychoPINN/ptycho/custom_layers.py", line 155, in call
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 1070, in reassemble_patches
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 678, in newf
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 1318, in reassemble_patches_position_batched_real
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 1001, in _reassemble_position_batched
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 912, in original_approach
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 834, in call
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 678, in newf
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 798, in translate
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 722, in translate_core
File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 294, in translate_xla
File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 209, in projective_warp_xla_jit
File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 121, in projective_warp_xla
File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 145, in projective_warp_xla
File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 182, in projective_warp_xla

	 [[{{node Reshape_21}}]]
	tf2xla conversion failed while converting __forward_projective_warp_xla_jit_259523[]. Run with TF_DUMP_GRAPH_PREFIX=/path/to/dump/dir and --vmodule=xla_compiler=2 to obtain a dump of the compiled functions.
	 [[StatefulPartitionedCall/functional_1/padded_objs_with_offsets_1/translation_18_1/PartitionedCall_1]] [Op:__inference_multi_step_on_iterator_282197]

================================================================================
Phase E5 Training Execution — dense (dose=1e+03, gridsize=2, backend=tensorflow)
================================================================================
Train dataset: /home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_d/dose_1000/dense/train.npz
Test dataset: /home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_d/dose_1000/dense/test.npz
Output directory: /home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_1000/dense/gs2
Gridsize: 2
nphotons: 1000.0
Backend: tensorflow

Loading datasets via TensorFlow loader...
Invoking TensorFlow train_cdi_model...
Training failed: InvalidArgumentError: Graph execution error:

Detected at node Reshape_21 defined at (most recent call last):
<stack traces unavailable>
Input to reshape is a tensor with 1290496 values, but the requested shape has 80656

Stack trace for op definition: 
File "<frozen runpy>", line 198, in _run_module_as_main
File "<frozen runpy>", line 88, in _run_code
File "/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py", line 1105, in <module>
File "/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py", line 978, in main
File "/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py", line 389, in run_training_job
File "/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py", line 422, in execute_training_job
File "/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py", line 494, in _execute_training_job_tensorflow
File "/home/ollie/Documents/PtychoPINN/ptycho/workflows/components.py", line 726, in train_cdi_model
File "/home/ollie/Documents/PtychoPINN/ptycho/train_pinn.py", line 90, in train_eval
File "/home/ollie/Documents/PtychoPINN/ptycho/train_pinn.py", line 86, in train
File "/home/ollie/Documents/PtychoPINN/ptycho/model.py", line 593, in train
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 377, in fit
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 220, in function
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 133, in multi_step_on_iterator
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 114, in one_step_on_data
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 58, in train_step
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/models/functional.py", line 183, in call
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/function.py", line 206, in _run_through_graph
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/models/functional.py", line 644, in call
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "/home/ollie/Documents/PtychoPINN/ptycho/custom_layers.py", line 155, in call
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 1070, in reassemble_patches
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 678, in newf
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 1318, in reassemble_patches_position_batched_real
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 1001, in _reassemble_position_batched
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 912, in original_approach
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 834, in call
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 678, in newf
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 798, in translate
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 722, in translate_core
File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 294, in translate_xla
File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 209, in projective_warp_xla_jit
File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 121, in projective_warp_xla
File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 145, in projective_warp_xla
File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 182, in projective_warp_xla

	 [[{{node Reshape_21}}]]
	tf2xla conversion failed while converting __forward_projective_warp_xla_jit_259523[]. Run with TF_DUMP_GRAPH_PREFIX=/path/to/dump/dir and --vmodule=xla_compiler=2 to obtain a dump of the compiled functions.
	 [[StatefulPartitionedCall/functional_1/padded_objs_with_offsets_1/translation_18_1/PartitionedCall_1]] [Op:__inference_multi_step_on_iterator_282197]
Traceback (most recent call last):
  File "/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py", line 494, in _execute_training_job_tensorflow
    training_results = tf_components.train_cdi_model(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/workflows/components.py", line 726, in train_cdi_model
    results = train_pinn.train_eval(PtychoDataset(train_container, test_container))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/train_pinn.py", line 90, in train_eval
    model_instance, history = train(ptycho_dataset.train_data)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/train_pinn.py", line 86, in train
    return model_instance, model.train(nepochs, train_data)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/model.py", line 593, in train
    history=autoencoder.fit(
            ^^^^^^^^^^^^^^^^
  File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/tensorflow/python/eager/execute.py", line 59, in quick_execute
    except TypeError as e:
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node Reshape_21 defined at (most recent call last):
<stack traces unavailable>
Input to reshape is a tensor with 1290496 values, but the requested shape has 80656

Stack trace for op definition: 
File "<frozen runpy>", line 198, in _run_module_as_main
File "<frozen runpy>", line 88, in _run_code
File "/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py", line 1105, in <module>
File "/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py", line 978, in main
File "/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py", line 389, in run_training_job
File "/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py", line 422, in execute_training_job
File "/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py", line 494, in _execute_training_job_tensorflow
File "/home/ollie/Documents/PtychoPINN/ptycho/workflows/components.py", line 726, in train_cdi_model
File "/home/ollie/Documents/PtychoPINN/ptycho/train_pinn.py", line 90, in train_eval
File "/home/ollie/Documents/PtychoPINN/ptycho/train_pinn.py", line 86, in train
File "/home/ollie/Documents/PtychoPINN/ptycho/model.py", line 593, in train
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 377, in fit
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 220, in function
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 133, in multi_step_on_iterator
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 114, in one_step_on_data
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py", line 58, in train_step
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/models/functional.py", line 183, in call
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/function.py", line 206, in _run_through_graph
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/models/functional.py", line 644, in call
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "/home/ollie/Documents/PtychoPINN/ptycho/custom_layers.py", line 155, in call
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 1070, in reassemble_patches
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 678, in newf
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 1318, in reassemble_patches_position_batched_real
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 1001, in _reassemble_position_batched
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 912, in original_approach
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 941, in __call__
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py", line 59, in __call__
File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 156, in error_handler
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 834, in call
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 678, in newf
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 798, in translate
File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 722, in translate_core
File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 294, in translate_xla
File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 209, in projective_warp_xla_jit
File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 121, in projective_warp_xla
File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 145, in projective_warp_xla
File "/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py", line 182, in projective_warp_xla

	 [[{{node Reshape_21}}]]
	tf2xla conversion failed while converting __forward_projective_warp_xla_jit_259523[]. Run with TF_DUMP_GRAPH_PREFIX=/path/to/dump/dir and --vmodule=xla_compiler=2 to obtain a dump of the compiled functions.
	 [[StatefulPartitionedCall/functional_1/padded_objs_with_offsets_1/translation_18_1/PartitionedCall_1]] [Op:__inference_multi_step_on_iterator_282197]
