{
  "timestamp": "2025-11-14T02:18:40.759005Z",
  "phase_c_root": "/home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_c",
  "phase_d_root": "/home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_d",
  "artifact_root": "/home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e",
  "filters": {
    "dose": 1000.0,
    "view": "dense",
    "gridsize": 2
  },
  "dry_run": false,
  "jobs": [
    {
      "dose": 1000.0,
      "view": "dense",
      "gridsize": 2,
      "train_data_path": "/home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_d/dose_1000/dense/train.npz",
      "test_data_path": "/home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_d/dose_1000/dense/test.npz",
      "log_path": "/home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_1000/dense/gs2/train.log",
      "artifact_dir": "/home/ollie/Documents/PtychoPINN/plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_1000/dense/gs2",
      "backend": "tensorflow",
      "result": {
        "status": "failed",
        "error": "Training failed: InvalidArgumentError: Graph execution error:\n\nDetected at node Reshape_21 defined at (most recent call last):\n<stack traces unavailable>\nInput to reshape is a tensor with 1290496 values, but the requested shape has 80656\n\nStack trace for op definition: \nFile \"<frozen runpy>\", line 198, in _run_module_as_main\nFile \"<frozen runpy>\", line 88, in _run_code\nFile \"/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py\", line 1105, in <module>\nFile \"/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py\", line 978, in main\nFile \"/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py\", line 389, in run_training_job\nFile \"/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py\", line 422, in execute_training_job\nFile \"/home/ollie/Documents/PtychoPINN/studies/fly64_dose_overlap/training.py\", line 494, in _execute_training_job_tensorflow\nFile \"/home/ollie/Documents/PtychoPINN/ptycho/workflows/components.py\", line 726, in train_cdi_model\nFile \"/home/ollie/Documents/PtychoPINN/ptycho/train_pinn.py\", line 90, in train_eval\nFile \"/home/ollie/Documents/PtychoPINN/ptycho/train_pinn.py\", line 86, in train\nFile \"/home/ollie/Documents/PtychoPINN/ptycho/model.py\", line 593, in train\nFile \"/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py\", line 117, in error_handler\nFile \"/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py\", line 377, in fit\nFile \"/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py\", line 220, in function\nFile \"/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py\", line 133, in multi_step_on_iterator\nFile \"/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py\", line 114, in one_step_on_data\nFile \"/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/backend/tensorflow/trainer.py\", line 58, in train_step\nFile \"/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py\", line 117, in error_handler\nFile \"/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py\", line 941, in __call__\nFile \"/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py\", line 117, in error_handler\nFile \"/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py\", line 59, in __call__\nFile \"/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py\", line 156, in error_handler\nFile \"/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/models/functional.py\", line 183, in call\nFile \"/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/function.py\", line 206, in _run_through_graph\nFile \"/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/models/functional.py\", line 644, in call\nFile \"/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py\", line 117, in error_handler\nFile \"/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py\", line 941, in __call__\nFile \"/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py\", line 117, in error_handler\nFile \"/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py\", line 59, in __call__\nFile \"/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py\", line 156, in error_handler\nFile \"/home/ollie/Documents/PtychoPINN/ptycho/custom_layers.py\", line 155, in call\nFile \"/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py\", line 1070, in reassemble_patches\nFile \"/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py\", line 678, in newf\nFile \"/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py\", line 1318, in reassemble_patches_position_batched_real\nFile \"/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py\", line 1001, in _reassemble_position_batched\nFile \"/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py\", line 912, in original_approach\nFile \"/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py\", line 117, in error_handler\nFile \"/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py\", line 941, in __call__\nFile \"/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py\", line 117, in error_handler\nFile \"/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/ops/operation.py\", line 59, in __call__\nFile \"/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py\", line 156, in error_handler\nFile \"/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py\", line 834, in call\nFile \"/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py\", line 678, in newf\nFile \"/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py\", line 798, in translate\nFile \"/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py\", line 722, in translate_core\nFile \"/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py\", line 294, in translate_xla\nFile \"/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py\", line 209, in projective_warp_xla_jit\nFile \"/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py\", line 121, in projective_warp_xla\nFile \"/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py\", line 145, in projective_warp_xla\nFile \"/home/ollie/Documents/PtychoPINN/ptycho/projective_warp_xla.py\", line 182, in projective_warp_xla\n\n\t [[{{node Reshape_21}}]]\n\ttf2xla conversion failed while converting __forward_projective_warp_xla_jit_259523[]. Run with TF_DUMP_GRAPH_PREFIX=/path/to/dump/dir and --vmodule=xla_compiler=2 to obtain a dump of the compiled functions.\n\t [[StatefulPartitionedCall/functional_1/padded_objs_with_offsets_1/translation_18_1/PartitionedCall_1]] [Op:__inference_multi_step_on_iterator_282197]"
      }
    }
  ],
  "skipped_views": [
    {
      "dose": 1000.0,
      "view": "sparse",
      "reason": "NPZ files not found (train=False, test=False). Checked primary (sparse_train.npz/sparse_test.npz) and fallback (train.npz/test.npz)."
    }
  ],
  "skipped_count": 1,
  "skip_summary_path": "skip_summary.json"
}