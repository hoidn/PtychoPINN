============================= test session starts ==============================
platform linux -- Python 3.11.13, pytest-8.4.1, pluggy-1.6.0 -- /home/ollie/miniconda3/envs/ptycho311/bin/python3.11
cachedir: .pytest_cache
PyTorch: available
PyTorch version: 2.8.0+cu128
rootdir: /home/ollie/Documents/PtychoPINN2
configfile: pyproject.toml
plugins: anyio-4.9.0
collecting ... collected 3 items

<Dir PtychoPINN2>
  <Package tests>
    <Package study>
      <Module test_check_dense_highlights_match.py>
        Tests for check_dense_highlights_match.py highlights checker (STUDY-SYNTH-FLY64-DOSE-OVERLAP-001)
        
        Validates that the checker correctly enforces:
        - PREVIEW-PHASE-001: Preview metadata contains phase-only indicator
        - STUDY-001: MS-SSIM ±0.000 / MAE ±0.000000 precision in ssim_grid_summary.md table
        - Highlights/preview text values match metrics_delta_summary.json
        
        Coverage:
        - test_summary_mismatch_fails: RED test with tampered ssim_grid table value
        - test_summary_matches_json: GREEN test with aligned artifacts
        <Function test_summary_mismatch_fails>
          RED test: Checker fails when ssim_grid table values mismatch JSON.
          
          Validates STUDY-001 precision enforcement by tampering with ssim_grid_summary.md table.
        <Function test_summary_matches_json>
          GREEN test: Checker passes when all artifacts are aligned.
          
          Validates that checker correctly accepts well-formed artifacts matching STUDY-001 and PREVIEW-PHASE-001.
        <Function test_missing_phase_only_metadata_fails>
          RED test: Checker fails when ssim_grid_summary.md is missing phase-only metadata.
          
          Validates PREVIEW-PHASE-001 enforcement.

========================== 3 tests collected in 0.84s ==========================
