2025-11-13 21:21:09.314619: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1763097669.326717 2611189 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1763097669.330663 2611189 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1763097669.340723 2611189 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1763097669.340738 2611189 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1763097669.340740 2611189 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1763097669.340742 2611189 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-11-13 21:21:09.343501: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-13 21:21:11,733 - INFO - Configuration: phase_align_method='plane', frc_sigma=0.5
2025-11-13 21:21:11,734 - INFO - Registration: enabled
2025-11-13 21:21:11,734 - INFO - NPZ output: raw=enabled, aligned=enabled
2025-11-13 21:21:11,734 - INFO - Loading PtychoPINN inference model (diffraction_to_obj) to restore configuration...
2025-11-13 21:21:11,734 - INFO - Loading model from: plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_1000/dense/gs2
I0000 00:00:1763097672.131046 2611189 gpu_process_state.cc:208] Using CUDA malloc Async allocator for GPU: 0
I0000 00:00:1763097672.132370 2611189 gpu_device.cc:2019] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 21832 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:04:00.0, compute capability: 8.6
Model: "functional"
2025-11-13 21:21:12,876 - INFO - Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ input (InputLayer)  │ (None, 128, 128,  │          0 │ -                 │
│                     │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ intensity_scaler    │ (None, 128, 128,  │          0 │ input[0][0]       │
│ (IntensityScaler)   │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d (Conv2D)     │ (None, 128, 128,  │      1,184 │ intensity_scaler… │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_1 (Conv2D)   │ (None, 128, 128,  │      9,248 │ conv2d[0][0]      │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d       │ (None, 64, 64,    │          0 │ conv2d_1[0][0]    │
│ (MaxPooling2D)      │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_2 (Conv2D)   │ (None, 64, 64,    │     18,496 │ max_pooling2d[0]… │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_3 (Conv2D)   │ (None, 64, 64,    │     36,928 │ conv2d_2[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d_1     │ (None, 32, 32,    │          0 │ conv2d_3[0][0]    │
│ (MaxPooling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_4 (Conv2D)   │ (None, 32, 32,    │     73,856 │ max_pooling2d_1[… │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_5 (Conv2D)   │ (None, 32, 32,    │    147,584 │ conv2d_4[0][0]    │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d_2     │ (None, 16, 16,    │          0 │ conv2d_5[0][0]    │
│ (MaxPooling2D)      │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_6 (Conv2D)   │ (None, 16, 16,    │    295,168 │ max_pooling2d_2[… │
│                     │ 256)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_7 (Conv2D)   │ (None, 16, 16,    │    590,080 │ conv2d_6[0][0]    │
│                     │ 256)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d_3     │ (None, 8, 8, 256) │          0 │ conv2d_7[0][0]    │
│ (MaxPooling2D)      │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_10 (Conv2D)  │ (None, 8, 8, 256) │    590,080 │ max_pooling2d_3[… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_20 (Conv2D)  │ (None, 8, 8, 256) │    590,080 │ max_pooling2d_3[… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_11 (Conv2D)  │ (None, 8, 8, 256) │    590,080 │ conv2d_10[0][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_21 (Conv2D)  │ (None, 8, 8, 256) │    590,080 │ conv2d_20[0][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d       │ (None, 16, 16,    │          0 │ conv2d_11[0][0]   │
│ (UpSampling2D)      │ 256)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_4     │ (None, 16, 16,    │          0 │ conv2d_21[0][0]   │
│ (UpSampling2D)      │ 256)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_12 (Conv2D)  │ (None, 16, 16,    │    295,040 │ up_sampling2d[0]… │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_22 (Conv2D)  │ (None, 16, 16,    │    295,040 │ up_sampling2d_4[… │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_13 (Conv2D)  │ (None, 16, 16,    │    147,584 │ conv2d_12[0][0]   │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_23 (Conv2D)  │ (None, 16, 16,    │    147,584 │ conv2d_22[0][0]   │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_1     │ (None, 32, 32,    │          0 │ conv2d_13[0][0]   │
│ (UpSampling2D)      │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_5     │ (None, 32, 32,    │          0 │ conv2d_23[0][0]   │
│ (UpSampling2D)      │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_14 (Conv2D)  │ (None, 32, 32,    │     73,792 │ up_sampling2d_1[… │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_24 (Conv2D)  │ (None, 32, 32,    │     73,792 │ up_sampling2d_5[… │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_15 (Conv2D)  │ (None, 32, 32,    │     36,928 │ conv2d_14[0][0]   │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_25 (Conv2D)  │ (None, 32, 32,    │     36,928 │ conv2d_24[0][0]   │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_2     │ (None, 64, 64,    │          0 │ conv2d_15[0][0]   │
│ (UpSampling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_6     │ (None, 64, 64,    │          0 │ conv2d_25[0][0]   │
│ (UpSampling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ get_item_1          │ (None, 64, 64, 4) │          0 │ up_sampling2d_2[… │
│ (GetItem)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ get_item_3          │ (None, 64, 64, 4) │          0 │ up_sampling2d_6[… │
│ (GetItem)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_16 (Conv2D)  │ (None, 64, 64,    │      1,184 │ get_item_1[0][0]  │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_26 (Conv2D)  │ (None, 64, 64,    │      1,184 │ get_item_3[0][0]  │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_17 (Conv2D)  │ (None, 64, 64,    │      9,248 │ conv2d_16[0][0]   │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_27 (Conv2D)  │ (None, 64, 64,    │      9,248 │ conv2d_26[0][0]   │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_3     │ (None, 128, 128,  │          0 │ conv2d_17[0][0]   │
│ (UpSampling2D)      │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_7     │ (None, 128, 128,  │          0 │ conv2d_27[0][0]   │
│ (UpSampling2D)      │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ get_item (GetItem)  │ (None, 64, 64,    │          0 │ up_sampling2d_2[… │
│                     │ 60)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_9 (Conv2D)   │ (None, 128, 128,  │      1,156 │ up_sampling2d_3[… │
│                     │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ get_item_2          │ (None, 64, 64,    │          0 │ up_sampling2d_6[… │
│ (GetItem)           │ 60)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_19 (Conv2D)  │ (None, 128, 128,  │      1,156 │ up_sampling2d_7[… │
│                     │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_8 (Conv2D)   │ (None, 64, 64, 4) │      2,164 │ get_item[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ silu (Silu)         │ (None, 128, 128,  │          0 │ conv2d_9[0][0]    │
│                     │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_18 (Conv2D)  │ (None, 64, 64, 4) │      2,164 │ get_item_2[0][0]  │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ silu_1 (Silu)       │ (None, 128, 128,  │          0 │ conv2d_19[0][0]   │
│                     │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ amp                 │ (None, 64, 64, 4) │          0 │ conv2d_8[0][0]    │
│ (ActivationLayer)   │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ center_mask_layer   │ (None, 128, 128,  │          0 │ silu[0][0]        │
│ (CenterMaskLayer)   │ 1)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ phi                 │ (None, 64, 64, 4) │          0 │ conv2d_18[0][0]   │
│ (ActivationLayer)   │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ center_mask_layer_1 │ (None, 128, 128,  │          0 │ silu_1[0][0]      │
│ (CenterMaskLayer)   │ 1)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ amp_padded          │ (None, 128, 128,  │          0 │ amp[0][0]         │
│ (ZeroPadding2D)     │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ multiply (Multiply) │ (None, 128, 128,  │          0 │ silu[0][0],       │
│                     │ 4)                │            │ center_mask_laye… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ phase_padded        │ (None, 128, 128,  │          0 │ phi[0][0]         │
│ (ZeroPadding2D)     │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ multiply_1          │ (None, 128, 128,  │          0 │ silu_1[0][0],     │
│ (Multiply)          │ 4)                │            │ center_mask_laye… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ add (Add)           │ (None, 128, 128,  │          0 │ amp_padded[0][0], │
│                     │ 4)                │            │ multiply[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ add_1 (Add)         │ (None, 128, 128,  │          0 │ phase_padded[0][… │
│                     │ 4)                │            │ multiply_1[0][0]  │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ obj                 │ (None, 128, 128,  │          0 │ add[0][0],        │
│ (CombineComplexLay… │ 4)                │            │ add_1[0][0]       │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ input_positions     │ (None, 1, 2, 4)   │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ padded_obj_2        │ (None, 142, 142,  │          0 │ obj[0][0],        │
│ (ReassemblePatches… │ 4)                │            │ input_positions[… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ padded_objs_with_o… │ (None, 132, 132,  │          0 │ padded_obj_2[0][… │
│ (ExtractPatchesPos… │ 4)                │            │ input_positions[… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ probe_illumination  │ [(None, 132, 132, │          0 │ padded_objs_with… │
│ (ProbeIllumination) │ 4), (None, 132,   │            │                   │
│                     │ 132, 4)]          │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ pred_amplitude      │ [(None, 128, 128, │          0 │ probe_illuminati… │
│ (PadAndDiffractLay… │ 4), (None, 128,   │            │                   │
│                     │ 128, 4)]          │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ pred_diff_channels  │ (None, 128, 128,  │          0 │ pred_amplitude[0… │
│ (FlatToChannelLaye… │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ intensity_scaler_i… │ (None, 128, 128,  │          0 │ pred_diff_channe… │
│ (IntensityScaler_i… │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ trimmed_obj         │ (None, 128, 128,  │          0 │ padded_obj_2[0][… │
│ (TrimReconstructio… │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ pred_intensity      │ (None, 128, 128,  │          0 │ intensity_scaler… │
│ (SquareLayer)       │ 4)                │            │                   │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
2025-11-13 21:21:12,902 - INFO - ┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ input (InputLayer)  │ (None, 128, 128,  │          0 │ -                 │
│                     │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ intensity_scaler    │ (None, 128, 128,  │          0 │ input[0][0]       │
│ (IntensityScaler)   │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d (Conv2D)     │ (None, 128, 128,  │      1,184 │ intensity_scaler… │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_1 (Conv2D)   │ (None, 128, 128,  │      9,248 │ conv2d[0][0]      │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d       │ (None, 64, 64,    │          0 │ conv2d_1[0][0]    │
│ (MaxPooling2D)      │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_2 (Conv2D)   │ (None, 64, 64,    │     18,496 │ max_pooling2d[0]… │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_3 (Conv2D)   │ (None, 64, 64,    │     36,928 │ conv2d_2[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d_1     │ (None, 32, 32,    │          0 │ conv2d_3[0][0]    │
│ (MaxPooling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_4 (Conv2D)   │ (None, 32, 32,    │     73,856 │ max_pooling2d_1[… │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_5 (Conv2D)   │ (None, 32, 32,    │    147,584 │ conv2d_4[0][0]    │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d_2     │ (None, 16, 16,    │          0 │ conv2d_5[0][0]    │
│ (MaxPooling2D)      │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_6 (Conv2D)   │ (None, 16, 16,    │    295,168 │ max_pooling2d_2[… │
│                     │ 256)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_7 (Conv2D)   │ (None, 16, 16,    │    590,080 │ conv2d_6[0][0]    │
│                     │ 256)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d_3     │ (None, 8, 8, 256) │          0 │ conv2d_7[0][0]    │
│ (MaxPooling2D)      │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_10 (Conv2D)  │ (None, 8, 8, 256) │    590,080 │ max_pooling2d_3[… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_20 (Conv2D)  │ (None, 8, 8, 256) │    590,080 │ max_pooling2d_3[… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_11 (Conv2D)  │ (None, 8, 8, 256) │    590,080 │ conv2d_10[0][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_21 (Conv2D)  │ (None, 8, 8, 256) │    590,080 │ conv2d_20[0][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d       │ (None, 16, 16,    │          0 │ conv2d_11[0][0]   │
│ (UpSampling2D)      │ 256)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_4     │ (None, 16, 16,    │          0 │ conv2d_21[0][0]   │
│ (UpSampling2D)      │ 256)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_12 (Conv2D)  │ (None, 16, 16,    │    295,040 │ up_sampling2d[0]… │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_22 (Conv2D)  │ (None, 16, 16,    │    295,040 │ up_sampling2d_4[… │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_13 (Conv2D)  │ (None, 16, 16,    │    147,584 │ conv2d_12[0][0]   │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_23 (Conv2D)  │ (None, 16, 16,    │    147,584 │ conv2d_22[0][0]   │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_1     │ (None, 32, 32,    │          0 │ conv2d_13[0][0]   │
│ (UpSampling2D)      │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_5     │ (None, 32, 32,    │          0 │ conv2d_23[0][0]   │
│ (UpSampling2D)      │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_14 (Conv2D)  │ (None, 32, 32,    │     73,792 │ up_sampling2d_1[… │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_24 (Conv2D)  │ (None, 32, 32,    │     73,792 │ up_sampling2d_5[… │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_15 (Conv2D)  │ (None, 32, 32,    │     36,928 │ conv2d_14[0][0]   │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_25 (Conv2D)  │ (None, 32, 32,    │     36,928 │ conv2d_24[0][0]   │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_2     │ (None, 64, 64,    │          0 │ conv2d_15[0][0]   │
│ (UpSampling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_6     │ (None, 64, 64,    │          0 │ conv2d_25[0][0]   │
│ (UpSampling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ get_item_1          │ (None, 64, 64, 4) │          0 │ up_sampling2d_2[… │
│ (GetItem)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ get_item_3          │ (None, 64, 64, 4) │          0 │ up_sampling2d_6[… │
│ (GetItem)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_16 (Conv2D)  │ (None, 64, 64,    │      1,184 │ get_item_1[0][0]  │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_26 (Conv2D)  │ (None, 64, 64,    │      1,184 │ get_item_3[0][0]  │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_17 (Conv2D)  │ (None, 64, 64,    │      9,248 │ conv2d_16[0][0]   │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_27 (Conv2D)  │ (None, 64, 64,    │      9,248 │ conv2d_26[0][0]   │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_3     │ (None, 128, 128,  │          0 │ conv2d_17[0][0]   │
│ (UpSampling2D)      │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_7     │ (None, 128, 128,  │          0 │ conv2d_27[0][0]   │
│ (UpSampling2D)      │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ get_item (GetItem)  │ (None, 64, 64,    │          0 │ up_sampling2d_2[… │
│                     │ 60)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_9 (Conv2D)   │ (None, 128, 128,  │      1,156 │ up_sampling2d_3[… │
│                     │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ get_item_2          │ (None, 64, 64,    │          0 │ up_sampling2d_6[… │
│ (GetItem)           │ 60)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_19 (Conv2D)  │ (None, 128, 128,  │      1,156 │ up_sampling2d_7[… │
│                     │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_8 (Conv2D)   │ (None, 64, 64, 4) │      2,164 │ get_item[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ silu (Silu)         │ (None, 128, 128,  │          0 │ conv2d_9[0][0]    │
│                     │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_18 (Conv2D)  │ (None, 64, 64, 4) │      2,164 │ get_item_2[0][0]  │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ silu_1 (Silu)       │ (None, 128, 128,  │          0 │ conv2d_19[0][0]   │
│                     │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ amp                 │ (None, 64, 64, 4) │          0 │ conv2d_8[0][0]    │
│ (ActivationLayer)   │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ center_mask_layer   │ (None, 128, 128,  │          0 │ silu[0][0]        │
│ (CenterMaskLayer)   │ 1)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ phi                 │ (None, 64, 64, 4) │          0 │ conv2d_18[0][0]   │
│ (ActivationLayer)   │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ center_mask_layer_1 │ (None, 128, 128,  │          0 │ silu_1[0][0]      │
│ (CenterMaskLayer)   │ 1)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ amp_padded          │ (None, 128, 128,  │          0 │ amp[0][0]         │
│ (ZeroPadding2D)     │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ multiply (Multiply) │ (None, 128, 128,  │          0 │ silu[0][0],       │
│                     │ 4)                │            │ center_mask_laye… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ phase_padded        │ (None, 128, 128,  │          0 │ phi[0][0]         │
│ (ZeroPadding2D)     │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ multiply_1          │ (None, 128, 128,  │          0 │ silu_1[0][0],     │
│ (Multiply)          │ 4)                │            │ center_mask_laye… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ add (Add)           │ (None, 128, 128,  │          0 │ amp_padded[0][0], │
│                     │ 4)                │            │ multiply[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ add_1 (Add)         │ (None, 128, 128,  │          0 │ phase_padded[0][… │
│                     │ 4)                │            │ multiply_1[0][0]  │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ obj                 │ (None, 128, 128,  │          0 │ add[0][0],        │
│ (CombineComplexLay… │ 4)                │            │ add_1[0][0]       │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ input_positions     │ (None, 1, 2, 4)   │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ padded_obj_2        │ (None, 142, 142,  │          0 │ obj[0][0],        │
│ (ReassemblePatches… │ 4)                │            │ input_positions[… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ padded_objs_with_o… │ (None, 132, 132,  │          0 │ padded_obj_2[0][… │
│ (ExtractPatchesPos… │ 4)                │            │ input_positions[… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ probe_illumination  │ [(None, 132, 132, │          0 │ padded_objs_with… │
│ (ProbeIllumination) │ 4), (None, 132,   │            │                   │
│                     │ 132, 4)]          │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ pred_amplitude      │ [(None, 128, 128, │          0 │ probe_illuminati… │
│ (PadAndDiffractLay… │ 4), (None, 128,   │            │                   │
│                     │ 128, 4)]          │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ pred_diff_channels  │ (None, 128, 128,  │          0 │ pred_amplitude[0… │
│ (FlatToChannelLaye… │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ intensity_scaler_i… │ (None, 128, 128,  │          0 │ pred_diff_channe… │
│ (IntensityScaler_i… │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ trimmed_obj         │ (None, 128, 128,  │          0 │ padded_obj_2[0][… │
│ (TrimReconstructio… │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ pred_intensity      │ (None, 128, 128,  │          0 │ intensity_scaler… │
│ (SquareLayer)       │ 4)                │            │                   │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
 Total params: 4,667,056 (17.80 MB)
2025-11-13 21:21:12,902 - INFO - Total params: 4,667,056 (17.80 MB)
 Trainable params: 4,667,056 (17.80 MB)
2025-11-13 21:21:12,902 - INFO - Trainable params: 4,667,056 (17.80 MB)
 Non-trainable params: 0 (0.00 B)
2025-11-13 21:21:12,902 - INFO - Non-trainable params: 0 (0.00 B)
None2025-11-13 21:21:12,903 - INFO - None

2025-11-13 21:21:12.903123: I external/local_tsl/tsl/profiler/lib/profiler_session.cc:103] Profiler session initializing.
2025-11-13 21:21:12.903141: I external/local_tsl/tsl/profiler/lib/profiler_session.cc:118] Profiler session started.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1763097672.903164 2611189 cupti_tracer.cc:1026] Profiler found 1 GPUs
W0000 00:00:1763097672.921149 2611189 cupti_tracer.cc:1213] Fail to use per-thread activity buffer, cupti trace overhead may be big. CUPTI ERROR CODE:1
2025-11-13 21:21:12.921247: I external/local_tsl/tsl/profiler/lib/profiler_session.cc:130] Profiler session tear down.
I0000 00:00:1763097672.921326 2611189 cupti_tracer.cc:1249] CUPTI activity buffer flushed
/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py:421: UserWarning: `build()` was called on layer 'center_mask_layer', however the layer does not have a `build()` method implemented and it looks like it has unbuilt state. This will cause the layer to be marked as built, despite not being actually built, which may cause failures down the line. Make sure to implement a proper `build()` method.
  warnings.warn(
2025-11-13 21:21:13,116 - ERROR - /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py:421: UserWarning: `build()` was called on layer 'center_mask_layer', however the layer does not have a `build()` method implemented and it looks like it has unbuilt state. This will cause the layer to be marked as built, despite not being actually built, which may cause failures down the line. Make sure to implement a proper `build()` method.
  warnings.warn(
/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py:421: UserWarning: `build()` was called on layer 'center_mask_layer_1', however the layer does not have a `build()` method implemented and it looks like it has unbuilt state. This will cause the layer to be marked as built, despite not being actually built, which may cause failures down the line. Make sure to implement a proper `build()` method.
  warnings.warn(
2025-11-13 21:21:13,117 - ERROR - /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py:421: UserWarning: `build()` was called on layer 'center_mask_layer_1', however the layer does not have a `build()` method implemented and it looks like it has unbuilt state. This will cause the layer to be marked as built, despite not being actually built, which may cause failures down the line. Make sure to implement a proper `build()` method.
  warnings.warn(
2025-11-13 21:21:13,837 - INFO - Successfully loaded model from plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_e/dose_1000/dense/gs2
2025-11-13 21:21:13,838 - INFO - Restored configuration from model: gridsize=2, N=128
2025-11-13 21:21:13,838 - INFO - Loading test data from plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_c/dose_1000/patched_test.npz with restored gridsize=2...
2025-11-13 21:21:13,838 - INFO - Using all test data (no subsampling or grouping limit)
2025-11-13 21:21:13,838 - INFO - Loading data from plans/active/STUDY-SYNTH-FLY64-DOSE-OVERLAP-001/reports/2025-11-12T010500Z/phase_g_dense_full_run_verifier/data/phase_c/dose_1000/patched_test.npz with n_images=None, n_subsample=None
2025-11-13 21:21:14,306 - WARNING - Ignoring NPZ 'Y' with incompatible shape (1, 128, 128, 1) (expected first axis 5216)
2025-11-13 21:21:14,307 - INFO - Using full dataset of 5216 images
diff3d shape: (5216, 128, 128)2025-11-13 21:21:14,351 - INFO - diff3d shape: (5216, 128, 128)

probeGuess shape: (128, 128)2025-11-13 21:21:14,351 - INFO - probeGuess shape: (128, 128)

scan_index shape: (5216,)2025-11-13 21:21:14,351 - INFO - scan_index shape: (5216,)

objectGuess shape: (464, 464)2025-11-13 21:21:14,351 - INFO - objectGuess shape: (464, 464)

xcoords shape: (5216,)2025-11-13 21:21:14,351 - INFO - xcoords shape: (5216,)

ycoords shape: (5216,)2025-11-13 21:21:14,351 - INFO - ycoords shape: (5216,)

xcoords_start shape: (5216,)2025-11-13 21:21:14,351 - INFO - xcoords_start shape: (5216,)

ycoords_start shape: (5216,)2025-11-13 21:21:14,351 - INFO - ycoords_start shape: (5216,)

2025-11-13 21:21:14,352 - INFO - Final configuration: gridsize=2, N=128, n_images=5216
2025-11-13 21:21:14,352 - INFO - Using stitch_crop_size M=20 (N=128)
2025-11-13 21:21:14,352 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=5216, n_points=5216, C=4, K=7
2025-11-13 21:21:14,352 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=2, N=128, sequential_sampling=False
2025-11-13 21:21:14,352 - INFO - [OVERSAMPLING DEBUG] Oversampling flags: enable_oversampling=False, neighbor_pool_size=None, effective_K=7
2025-11-13 21:21:14,352 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 5216 > 5216 = False
2025-11-13 21:21:14,352 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 4 > 1 = True
2025-11-13 21:21:14,352 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
DEBUG:2025-11-13 21:21:14,352 - INFO - DEBUG:
 nsamples: 5216, gridsize: 2 (using efficient random sample-then-group strategy)2025-11-13 21:21:14,352 - INFO - nsamples: 5216, gridsize: 2 (using efficient random sample-then-group strategy)

2025-11-13 21:21:14,352 - INFO - Using efficient random sampling strategy for gridsize=2
2025-11-13 21:21:14,352 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2025-11-13 21:21:14,352 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=5216, K=7, C=4
2025-11-13 21:21:14,352 - INFO - Generating 5216 groups efficiently from 5216 points (K=7, C=4)
2025-11-13 21:21:14,352 - INFO - [OVERSAMPLING DEBUG] Standard case: using 5216 groups from 5216 points
2025-11-13 21:21:14,352 - INFO - [OVERSAMPLING DEBUG] Using all 5216 points as seeds (no sampling needed)
2025-11-13 21:21:14,352 - INFO - Using all 5216 points as seeds
2025-11-13 21:21:14,387 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 5216 groups
2025-11-13 21:21:14,387 - INFO - Successfully generated 5216 groups with shape (5216, 4)
2025-11-13 21:21:14,387 - INFO - [OVERSAMPLING DEBUG] Generated 5216 groups in total
2025-11-13 21:21:14,387 - INFO - Generated 5216 groups efficiently
INFO: 'Y' array not found. Generating ground truth patches from 'objectGuess' as a fallback.2025-11-13 21:21:14,562 - INFO - INFO: 'Y' array not found. Generating ground truth patches from 'objectGuess' as a fallback.

I0000 00:00:1763097675.354588 2611189 service.cc:152] XLA service 0x27c0c9a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
I0000 00:00:1763097675.354605 2611189 service.cc:160]   StreamExecutor device (0): NVIDIA GeForce RTX 3090, Compute Capability 8.6
2025-11-13 21:21:15.377420: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:269] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
I0000 00:00:1763097675.399293 2611189 cuda_dnn.cc:529] Loaded cuDNN version 91002
I0000 00:00:1763097675.560746 2611189 device_compiler.h:188] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2025-11-13 21:22:41.856082: W external/local_xla/xla/tsl/framework/cpu_allocator_impl.cc:83] Allocation of 2734686208 exceeds 10% of free system memory.
neighbor-sampled diffraction shape2025-11-13 21:22:47,837 - INFO - neighbor-sampled diffraction shape
 (5216, 128, 128, 4)2025-11-13 21:22:47,837 - INFO - (5216, 128, 128, 4)

loader: using provided ground truth patches.2025-11-13 21:22:50,012 - INFO - loader: using provided ground truth patches.

2025-11-13 21:22:50.351829: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:359] gpu_async_0 cuMemAllocAsync failed to allocate 2734686208 bytes: RESOURCE_EXHAUSTED: : CUDA_ERROR_OUT_OF_MEMORY: out of memory
 Reported by CUDA: Free memory/Total memory: 31784960/25298927616
2025-11-13 21:22:50.351846: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:364] Stats: Limit:                     22892838912
InUse:                      6893448392
MaxInUse:                   8260874944
NumAllocs:                      607103
MaxAllocSize:               2734686208
Reserved:                            0
PeakReserved:                        0
LargestFreeBlock:                    0

2025-11-13 21:22:50.351854: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:68] Histogram of current allocation: (allocation_size_in_bytes, nb_allocation_of_that_sizes), ...;
2025-11-13 21:22:50.351856: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:71] 4, 29
2025-11-13 21:22:50.351858: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:71] 8, 2
2025-11-13 21:22:50.351859: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:71] 16, 12
2025-11-13 21:22:50.351860: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:71] 128, 18
2025-11-13 21:22:50.351862: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:71] 256, 18
2025-11-13 21:22:50.351863: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:71] 512, 18
2025-11-13 21:22:50.351865: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:71] 1024, 18
2025-11-13 21:22:50.351866: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:71] 1028, 1
2025-11-13 21:22:50.351867: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:71] 4608, 15
2025-11-13 21:22:50.351869: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:71] 8640, 6
2025-11-13 21:22:50.351870: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:71] 36864, 9
2025-11-13 21:22:50.351872: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:71] 73728, 3
2025-11-13 21:22:50.351873: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:71] 131072, 3
2025-11-13 21:22:50.351874: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:71] 147456, 9
2025-11-13 21:22:50.351876: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:71] 166912, 2
2025-11-13 21:22:50.351877: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:71] 294912, 9
2025-11-13 21:22:50.351879: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:71] 589824, 9
2025-11-13 21:22:50.351880: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:71] 1179648, 9
2025-11-13 21:22:50.351881: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:71] 2359296, 15
2025-11-13 21:22:50.351883: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:71] 1367343104, 3
2025-11-13 21:22:50.351884: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:71] 2734686208, 1
2025-11-13 21:22:50.351887: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:104] CU_MEMPOOL_ATTR_RESERVED_MEM_CURRENT: 8455716864
2025-11-13 21:22:50.351889: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:106] CU_MEMPOOL_ATTR_USED_MEM_CURRENT: 6893448392
2025-11-13 21:22:50.351890: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:107] CU_MEMPOOL_ATTR_RESERVED_MEM_HIGH: 8455716864
2025-11-13 21:22:50.351892: E external/local_xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc:108] CU_MEMPOOL_ATTR_USED_MEM_HIGH: 8260874944
2025-11-13 21:22:50.351903: W tensorflow/core/framework/op_kernel.cc:1844] RESOURCE_EXHAUSTED: failed to allocate memory
2025-11-13 21:22:50.351912: I tensorflow/core/framework/local_rendezvous.cc:407] Local rendezvous is aborting with status: RESOURCE_EXHAUSTED: failed to allocate memory
2025-11-13 21:22:50,352 - CRITICAL - Uncaught exception
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 1481, in <module>
    main()
  File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 984, in main
    test_container = create_ptycho_data_container(test_data_raw, final_config)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/workflows/components.py", line 691, in create_ptycho_data_container
    return loader.load(lambda: dataset, data.probeGuess, which=None, create_split=False)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/loader.py", line 341, in load
    container = PtychoDataContainer(X, Y_I, Y_phi, norm_Y_I, YY_full, coords_nominal, coords_true,
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/loader.py", line 141, in __init__
    self.Y = combine_complex(Y_I, Y_phi)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 336, in combine_complex
    output = tf.cast(amp, tf.complex64) * tf.exp(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 153, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/tensorflow/python/framework/ops.py", line 6006, in raise_from_not_ok_status
    raise core._status_to_exception(e) from None  # pylint: disable=protected-access
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.ResourceExhaustedError: {{function_node __wrapped__Cast_device_/job:localhost/replica:0/task:0/device:GPU:0}} failed to allocate memory [Op:Cast] name: 
Traceback (most recent call last):
2025-11-13 21:22:50,353 - ERROR - Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
2025-11-13 21:22:50,353 - ERROR - File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
2025-11-13 21:22:50,353 - ERROR - File "<frozen runpy>", line 88, in _run_code
  File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 1481, in <module>
2025-11-13 21:22:50,353 - ERROR - File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 1481, in <module>
    main()2025-11-13 21:22:50,353 - ERROR - main()

  File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 984, in main
2025-11-13 21:22:50,353 - ERROR - File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 984, in main
    test_container = create_ptycho_data_container(test_data_raw, final_config)2025-11-13 21:22:50,353 - ERROR - test_container = create_ptycho_data_container(test_data_raw, final_config)

                     ^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^
^2025-11-13 21:22:50,354 - ERROR - ^

  File "/home/ollie/Documents/PtychoPINN/ptycho/workflows/components.py", line 691, in create_ptycho_data_container
2025-11-13 21:22:50,355 - ERROR - File "/home/ollie/Documents/PtychoPINN/ptycho/workflows/components.py", line 691, in create_ptycho_data_container
    return loader.load(lambda: dataset, data.probeGuess, which=None, create_split=False)2025-11-13 21:22:50,355 - ERROR - return loader.load(lambda: dataset, data.probeGuess, which=None, create_split=False)

           ^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,355 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^

  File "/home/ollie/Documents/PtychoPINN/ptycho/loader.py", line 341, in load
2025-11-13 21:22:50,356 - ERROR - File "/home/ollie/Documents/PtychoPINN/ptycho/loader.py", line 341, in load
    container = PtychoDataContainer(X, Y_I, Y_phi, norm_Y_I, YY_full, coords_nominal, coords_true, 2025-11-13 21:22:50,356 - ERROR - container = PtychoDataContainer(X, Y_I, Y_phi, norm_Y_I, YY_full, coords_nominal, coords_true,

                ^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,356 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,357 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^

  File "/home/ollie/Documents/PtychoPINN/ptycho/loader.py", line 141, in __init__
2025-11-13 21:22:50,358 - ERROR - File "/home/ollie/Documents/PtychoPINN/ptycho/loader.py", line 141, in __init__
    self.Y = combine_complex(Y_I, Y_phi)2025-11-13 21:22:50,358 - ERROR - self.Y = combine_complex(Y_I, Y_phi)

             ^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^

  File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 336, in combine_complex
2025-11-13 21:22:50,358 - ERROR - File "/home/ollie/Documents/PtychoPINN/ptycho/tf_helper.py", line 336, in combine_complex
    output = tf.cast(amp, tf.complex64) * tf.exp(2025-11-13 21:22:50,358 - ERROR - output = tf.cast(amp, tf.complex64) * tf.exp(

             ^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,358 - ERROR - ^
^2025-11-13 21:22:50,359 - ERROR - ^
^2025-11-13 21:22:50,359 - ERROR - ^
^2025-11-13 21:22:50,359 - ERROR - ^
^2025-11-13 21:22:50,359 - ERROR - ^
^2025-11-13 21:22:50,359 - ERROR - ^
^2025-11-13 21:22:50,359 - ERROR - ^
^2025-11-13 21:22:50,359 - ERROR - ^
^2025-11-13 21:22:50,359 - ERROR - ^
^2025-11-13 21:22:50,359 - ERROR - ^
^2025-11-13 21:22:50,359 - ERROR - ^
^2025-11-13 21:22:50,359 - ERROR - ^
^2025-11-13 21:22:50,359 - ERROR - ^
^2025-11-13 21:22:50,359 - ERROR - ^
^2025-11-13 21:22:50,359 - ERROR - ^
^2025-11-13 21:22:50,359 - ERROR - ^
^2025-11-13 21:22:50,359 - ERROR - ^
^2025-11-13 21:22:50,359 - ERROR - ^
^2025-11-13 21:22:50,359 - ERROR - ^
^2025-11-13 21:22:50,359 - ERROR - ^
^2025-11-13 21:22:50,359 - ERROR - ^
^2025-11-13 21:22:50,359 - ERROR - ^

  File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 153, in error_handler
2025-11-13 21:22:50,359 - ERROR - File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 153, in error_handler
    raise e.with_traceback(filtered_tb) from None2025-11-13 21:22:50,359 - ERROR - raise e.with_traceback(filtered_tb) from None

  File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/tensorflow/python/framework/ops.py", line 6006, in raise_from_not_ok_status
2025-11-13 21:22:50,359 - ERROR - File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/tensorflow/python/framework/ops.py", line 6006, in raise_from_not_ok_status
    raise core._status_to_exception(e) from None  # pylint: disable=protected-access2025-11-13 21:22:50,360 - ERROR - raise core._status_to_exception(e) from None  # pylint: disable=protected-access

    ^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,360 - ERROR - ^
^2025-11-13 21:22:50,361 - ERROR - ^

tensorflow.python.framework.errors_impl2025-11-13 21:22:50,361 - ERROR - tensorflow.python.framework.errors_impl
.2025-11-13 21:22:50,361 - ERROR - .
ResourceExhaustedError2025-11-13 21:22:50,361 - ERROR - ResourceExhaustedError
: 2025-11-13 21:22:50,361 - ERROR - :
{{function_node __wrapped__Cast_device_/job:localhost/replica:0/task:0/device:GPU:0}} failed to allocate memory [Op:Cast] name: 2025-11-13 21:22:50,361 - ERROR - {{function_node __wrapped__Cast_device_/job:localhost/replica:0/task:0/device:GPU:0}} failed to allocate memory [Op:Cast] name:

