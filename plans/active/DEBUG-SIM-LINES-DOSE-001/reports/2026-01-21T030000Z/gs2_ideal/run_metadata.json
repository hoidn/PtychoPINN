{
  "amp_png_range": {
    "vmax": 1e-09,
    "vmin": 0.0
  },
  "artifacts": {
    "amplitude_diff_npy": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/amplitude_diff.npy",
    "amplitude_diff_png": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/amplitude_diff.png",
    "amplitude_npy": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/inference_outputs/amplitude.npy",
    "amplitude_png": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/inference_outputs/amplitude.png",
    "amplitude_unscaled_npy": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/inference_outputs/amplitude_unscaled.npy",
    "comparison_metrics": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/comparison_metrics.json",
    "comparison_summary": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/gs2_ideal_comparison_summary.md",
    "ground_truth_amplitude_npy": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/ground_truth_amp.npy",
    "ground_truth_amplitude_png": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/ground_truth_amp.png",
    "ground_truth_phase_npy": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/ground_truth_phase.npy",
    "ground_truth_phase_png": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/ground_truth_phase.png",
    "inference_dir": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/inference_outputs",
    "intensity_stats_json": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/intensity_stats.json",
    "intensity_stats_markdown": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/intensity_stats.md",
    "phase_diff_npy": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/phase_diff.npy",
    "phase_diff_png": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/phase_diff.png",
    "phase_npy": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/inference_outputs/phase.npy",
    "phase_png": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/inference_outputs/phase.png",
    "prediction_scale_json": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/inference_outputs/prediction_scale.txt",
    "stats_json": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/inference_outputs/stats.json",
    "train_dir": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/train_outputs"
  },
  "buffer": 10.0,
  "cli_args": {
    "amp_vmax": null,
    "base_total_images": null,
    "batch_size": null,
    "buffer": null,
    "gridsize": null,
    "group_count": null,
    "group_limit": 64,
    "group_multiplier": 1,
    "image_multiplier": 1,
    "neighbor_count": null,
    "nepochs": 5,
    "nphotons": null,
    "object_seed": null,
    "output_dir": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal",
    "prediction_scale_source": "least_squares",
    "probe_big": null,
    "probe_mask": null,
    "probe_mode": null,
    "probe_scale": null,
    "scenario": "gs2_ideal",
    "sim_seed": null,
    "snapshot": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-16T000353Z/sim_lines_4x_params_snapshot.json",
    "split_fraction": null
  },
  "comparison": {
    "diff_pngs": {
      "amplitude_diff_npy": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/amplitude_diff.npy",
      "amplitude_diff_png": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/amplitude_diff.png",
      "phase_diff_npy": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/phase_diff.npy",
      "phase_diff_png": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/phase_diff.png"
    },
    "metrics": {
      "amplitude": {
        "bias_summary": {
          "mean": -2.6731222054138,
          "median": -2.6665332317352295,
          "p05": -3.741888236999512,
          "p95": -1.6187850475311278
        },
        "color_range": [
          -4.85612678527832,
          4.85612678527832
        ],
        "count": 131927,
        "mae": 2.6731222054138,
        "max_abs": 4.7676825523376465,
        "pearson_r": null,
        "pred_stats": {
          "max": 0.0,
          "mean": 0.0,
          "min": 0.0,
          "nan_count": 21737,
          "std": 0.0
        },
        "rmse": 2.7493273817519617,
        "truth_stats": {
          "max": 4.85612678527832,
          "mean": 2.708247423171997,
          "min": 0.6128976941108704,
          "nan_count": 0,
          "std": 0.6410303115844727
        }
      },
      "phase": {
        "bias_summary": {
          "mean": 0.0,
          "median": 0.0,
          "p05": 0.0,
          "p95": 0.0
        },
        "color_range": [
          -3.141592653589793,
          3.141592653589793
        ],
        "count": 131927,
        "mae": 0.0,
        "max_abs": 0.0,
        "pearson_r": null,
        "pred_stats": {
          "max": 0.0,
          "mean": 0.0,
          "min": 0.0,
          "nan_count": 21737,
          "std": 0.0
        },
        "rmse": 0.0,
        "truth_stats": {
          "max": 0.0,
          "mean": 0.0,
          "min": 0.0,
          "nan_count": 0,
          "std": 0.0
        }
      }
    },
    "metrics_json": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/comparison_metrics.json",
    "metrics_summary": {
      "amplitude": {
        "mae": 2.6731222054138,
        "max_abs": 4.7676825523376465,
        "pearson_r": null,
        "rmse": 2.7493273817519617
      },
      "phase": {
        "mae": 0.0,
        "max_abs": 0.0,
        "pearson_r": null,
        "rmse": 0.0
      }
    },
    "summary_markdown": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/gs2_ideal_comparison_summary.md"
  },
  "comparison_metrics_path": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/comparison_metrics.json",
  "comparison_metrics_summary": {
    "amplitude": {
      "mae": 2.6731222054138,
      "max_abs": 4.7676825523376465,
      "pearson_r": null,
      "rmse": 2.7493273817519617
    },
    "phase": {
      "mae": 0.0,
      "max_abs": 0.0,
      "pearson_r": null,
      "rmse": 0.0
    }
  },
  "crop_metadata": {
    "end": [
      396,
      396
    ],
    "input_shape": [
      400,
      400,
      1
    ],
    "parity_warning": false,
    "start": [
      4,
      4
    ],
    "target_size": 392
  },
  "dataset_scale_info": {
    "N": 64,
    "batch_mean_sum_intensity": 2995.974122765142,
    "dataset_scale": 577.7380497400686,
    "delta": -410.4737190625499,
    "fallback_scale": 988.2117688026185,
    "nphotons": 1000000000.0,
    "ratio": 0.5846298009991254,
    "spec_reference": "specs/spec-ptycho-core.md \u00a7Normalization Invariants"
  },
  "elapsed_seconds": 28.44,
  "forward_pass_diagnostics": {
    "amplification_ratio": NaN,
    "external_intensity_scale": 273.35028076171875,
    "ground_truth_mean": 2.708247423171997,
    "input_mean": 0.08508697152137756,
    "model_exp_log_scale": 273.35026999353613,
    "output_mean": NaN,
    "output_vs_truth_ratio": NaN,
    "scale_discrepancy_flag": false,
    "scale_match_pct": 99.99999606066524,
    "spec_reference": "specs/spec-ptycho-core.md \u00a7Normalization Invariants"
  },
  "ground_truth": {
    "amplitude_npy": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/ground_truth_amp.npy",
    "amplitude_png": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/ground_truth_amp.png",
    "phase_npy": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/ground_truth_phase.npy",
    "phase_png": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/ground_truth_phase.png"
  },
  "ground_truth_amp_path": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/ground_truth_amp.npy",
  "ground_truth_phase_path": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/ground_truth_phase.npy",
  "group_count": 128,
  "group_limit": 64,
  "intensity_scaler_state": {
    "delta": 4.510580561145616e-05,
    "exp_log_scale": 273.35026999353613,
    "log_scale_value": 5.610754013061523,
    "params_cfg_intensity_scale": 273.3502248877305,
    "params_cfg_trainable": true,
    "ratio": 1.0000001650110426,
    "spec_reference": "specs/spec-ptycho-core.md \u00a7Normalization Invariants",
    "trainable": true
  },
  "intensity_stats": {
    "bundle_intensity_scale": 273.35028076171875,
    "dataset_scale_info": {
      "N": 64,
      "batch_mean_sum_intensity": 2995.974122765142,
      "dataset_scale": 577.7380497400686,
      "delta": -410.4737190625499,
      "fallback_scale": 988.2117688026185,
      "nphotons": 1000000000.0,
      "ratio": 0.5846298009991254,
      "spec_reference": "specs/spec-ptycho-core.md \u00a7Normalization Invariants"
    },
    "intensity_scale": 273.35028076171875,
    "intensity_scaler_state": {
      "delta": 4.510580561145616e-05,
      "exp_log_scale": 273.35026999353613,
      "log_scale_value": 5.610754013061523,
      "params_cfg_intensity_scale": 273.3502248877305,
      "params_cfg_trainable": true,
      "ratio": 1.0000001650110426,
      "spec_reference": "specs/spec-ptycho-core.md \u00a7Normalization Invariants",
      "trainable": true
    },
    "json_path": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/intensity_stats.json",
    "largest_drop": {
      "from_mean": 0.14735829830169678,
      "from_stage": "grouped_diffraction",
      "key": "grouped_to_normalized",
      "ratio": 0.5774155409094991,
      "to_mean": 0.08508697152137756,
      "to_stage": "grouped_X_full"
    },
    "legacy_params_intensity_scale": 273.35028076171875,
    "markdown_path": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/intensity_stats.md",
    "normalize_gain": 0.5774155409094991,
    "prediction_scale": {
      "applied": false,
      "least_squares": {
        "denominator": 0.0,
        "finite_count": 131927,
        "numerator": 0.0
      },
      "mode": "least_squares",
      "reason": "least_squares_undefined",
      "recorded_scale": 273.35028076171875,
      "source": null,
      "value": null
    },
    "ratios": {
      "grouped_to_normalized": 0.5774155409094991,
      "normalized_to_container": 1.0,
      "raw_to_grouped": 1.0104741797460226
    },
    "scale_delta": 0.0,
    "stage_means": {
      "container_X": 0.08508697152137756,
      "grouped_X_full": 0.08508697152137756,
      "grouped_diffraction": 0.14735829830169678,
      "raw_diffraction": 0.14583083987236023
    },
    "stages": [
      {
        "metadata": {
          "count": 512,
          "source": "RawData"
        },
        "name": "raw_diffraction",
        "stats": {
          "dtype": "float32",
          "finite_count": 2097152,
          "max": 27.523099899291992,
          "mean": 0.14583083987236023,
          "min": 0.0,
          "nan_count": 0,
          "shape": [
            512,
            64,
            64
          ],
          "std": 0.8427172899246216,
          "total_count": 2097152
        }
      },
      {
        "metadata": {
          "count": 64,
          "gridsize": 2,
          "source": "RawData.generate_grouped_data"
        },
        "name": "grouped_diffraction",
        "stats": {
          "dtype": "float32",
          "finite_count": 1048576,
          "max": 27.523099899291992,
          "mean": 0.14735829830169678,
          "min": 0.0,
          "nan_count": 0,
          "shape": [
            64,
            64,
            64,
            4
          ],
          "std": 0.8532971739768982,
          "total_count": 1048576
        }
      },
      {
        "metadata": {
          "count": 64,
          "source": "normalize_data"
        },
        "name": "grouped_X_full",
        "stats": {
          "dtype": "float32",
          "finite_count": 1048576,
          "max": 15.892265319824219,
          "mean": 0.08508697152137756,
          "min": 0.0,
          "nan_count": 0,
          "shape": [
            64,
            64,
            64,
            4
          ],
          "std": 0.4927070438861847,
          "total_count": 1048576
        }
      },
      {
        "metadata": {
          "group_limit": 64,
          "source": "PtychoDataContainer"
        },
        "name": "container_X",
        "stats": {
          "dtype": "float32",
          "finite_count": 1048576,
          "max": 15.892265319824219,
          "mean": 0.08508697152137756,
          "min": 0.0,
          "nan_count": 0,
          "shape": [
            64,
            64,
            64,
            4
          ],
          "std": 0.4927070438861847,
          "total_count": 1048576
        }
      }
    ],
    "training_container_stats": {
      "dtype": "float32",
      "finite_count": 1048576,
      "max": 15.892265319824219,
      "mean": 0.08508697152137756,
      "min": 0.0,
      "nan_count": 0,
      "shape": [
        64,
        64,
        64,
        4
      ],
      "std": 0.4927070438861847,
      "total_count": 1048576
    }
  },
  "intensity_stats_markdown": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/intensity_stats.md",
  "intensity_stats_path": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/intensity_stats.json",
  "neighbor_count": 4,
  "nepochs": 5,
  "nphotons": 1000000000.0,
  "object_seed": 42,
  "prediction_scale": {
    "applied": false,
    "least_squares": {
      "denominator": 0.0,
      "finite_count": 131927,
      "numerator": 0.0
    },
    "mode": "least_squares",
    "reason": "least_squares_undefined",
    "recorded_scale": 273.35028076171875,
    "source": null,
    "value": null
  },
  "probe_big": null,
  "probe_mask": null,
  "probe_mode": "idealized",
  "probe_scale": 10.0,
  "profile": {
    "active": true,
    "applied": {
      "base_total_images": 256,
      "batch_size": 4,
      "group_count": 128,
      "neighbor_count": 4
    },
    "defaults": {
      "base_total_images": 256,
      "batch_size": 4,
      "group_count": 128,
      "neighbor_count": 4
    },
    "effective_batch_size": 4,
    "effective_group_count": 128,
    "label": "stable_profile_gs2_ideal",
    "name": "gs2_ideal",
    "skipped": {}
  },
  "scenario": "gs2_ideal",
  "sim_seed": 42,
  "split_fraction": 0.5,
  "split_intensity_stats": {
    "deviation_exceeds_5pct": true,
    "nphotons": 1000000000.0,
    "spec_reference": "specs/spec-ptycho-core.md \u00a7Normalization Invariants",
    "test": {
      "batch_mean_sum_intensity": 2995.974122765142,
      "dataset_scale": 577.7380497400686,
      "n_samples": 512
    },
    "train": {
      "batch_mean_sum_intensity": 3388.0241783336346,
      "dataset_scale": 543.2837929569899,
      "n_samples": 512
    },
    "train_vs_test_deviation_pct": 5.9636468116614605,
    "train_vs_test_scale_delta": -34.45425678307868,
    "train_vs_test_scale_ratio": 0.9403635318833854
  },
  "test_count": 512,
  "timestamp": "2026-01-21T20:47:12.591559+00:00",
  "total_images": 1024,
  "train_count": 512,
  "training_history": {
    "history_json": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/train_outputs/history.json",
    "nan_overview": {
      "has_nan": true,
      "metrics": {
        "intensity_scaler_inv_loss": {
          "first_nan_epoch": 1.0,
          "first_nan_step": 1
        },
        "loss": {
          "first_nan_epoch": 1.0,
          "first_nan_step": 1
        },
        "pred_intensity_loss": {
          "first_nan_epoch": 1.0,
          "first_nan_step": 1
        },
        "train_loss": {
          "first_nan_epoch": 1.0,
          "first_nan_step": 1
        },
        "val_intensity_scaler_inv_loss": {
          "first_nan_epoch": 1.0,
          "first_nan_step": 1
        },
        "val_loss": {
          "first_nan_epoch": 1.0,
          "first_nan_step": 1
        },
        "val_pred_intensity_loss": {
          "first_nan_epoch": 1.0,
          "first_nan_step": 1
        }
      }
    },
    "summary_json": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/train_outputs/history_summary.json",
    "summary_markdown": "plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-21T030000Z/gs2_ideal/gs2_ideal_training_summary.md"
  },
  "training_history_path": "train_outputs/history.json",
  "training_nan_overview": {
    "has_nan": true,
    "metrics": {
      "intensity_scaler_inv_loss": {
        "first_nan_epoch": 1.0,
        "first_nan_step": 1
      },
      "loss": {
        "first_nan_epoch": 1.0,
        "first_nan_step": 1
      },
      "pred_intensity_loss": {
        "first_nan_epoch": 1.0,
        "first_nan_step": 1
      },
      "train_loss": {
        "first_nan_epoch": 1.0,
        "first_nan_step": 1
      },
      "val_intensity_scaler_inv_loss": {
        "first_nan_epoch": 1.0,
        "first_nan_step": 1
      },
      "val_loss": {
        "first_nan_epoch": 1.0,
        "first_nan_step": 1
      },
      "val_pred_intensity_loss": {
        "first_nan_epoch": 1.0,
        "first_nan_step": 1
      }
    }
  },
  "training_summary_markdown_path": "gs2_ideal_training_summary.md",
  "training_summary_path": "train_outputs/history_summary.json"
}