2026-01-19 22:21:00.875096: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1768890060.886466 1090751 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1768890060.890126 1090751 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1768890060.900241 1090751 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1768890060.900251 1090751 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1768890060.900252 1090751 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1768890060.900254 1090751 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2026-01-19 22:21:00.903279: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2026-01-19 22:21:03,768 - INFO - Loading cached nongrid_sim: .artifacts/synthetic_helpers/cache/nongrid_sim_ce679cf9585e5391528fd19df96bb01fe962d74a52b64239845ec3728653fb06.npz
2026-01-19 22:21:03,788 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=1000, n_points=1000, C=1, K=4
2026-01-19 22:21:03,788 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2026-01-19 22:21:03,789 - INFO - [OVERSAMPLING DEBUG] Oversampling flags: enable_oversampling=False, neighbor_pool_size=None, effective_K=4
2026-01-19 22:21:03,789 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 1000 > 1000 = False
2026-01-19 22:21:03,789 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2026-01-19 22:21:03,789 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2026-01-19 22:21:03,789 - INFO - Using efficient random sampling strategy for gridsize=1
2026-01-19 22:21:03,789 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2026-01-19 22:21:03,789 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=1000, K=4, C=1
2026-01-19 22:21:03,789 - INFO - Generating 1000 groups efficiently from 1000 points (K=4, C=1)
2026-01-19 22:21:03,789 - INFO - [OVERSAMPLING DEBUG] Standard case: using 1000 groups from 1000 points
2026-01-19 22:21:03,789 - INFO - [OVERSAMPLING DEBUG] Using all 1000 points as seeds (no sampling needed)
2026-01-19 22:21:03,789 - INFO - Using all 1000 points as seeds
2026-01-19 22:21:03,789 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2026-01-19 22:21:03,789 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 1000 groups
2026-01-19 22:21:03,789 - INFO - Successfully generated 1000 groups with shape (1000, 1)
2026-01-19 22:21:03,789 - INFO - [OVERSAMPLING DEBUG] Generated 1000 groups in total
2026-01-19 22:21:03,789 - INFO - Generated 1000 groups efficiently
I0000 00:00:1768890063.907070 1090751 gpu_process_state.cc:208] Using CUDA malloc Async allocator for GPU: 0
I0000 00:00:1768890063.908300 1090751 gpu_device.cc:2019] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22259 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:04:00.0, compute capability: 8.6
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1768890064.648010 1090751 service.cc:152] XLA service 0x4523b6b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
I0000 00:00:1768890064.648031 1090751 service.cc:160]   StreamExecutor device (0): NVIDIA GeForce RTX 3090, Compute Capability 8.6
2026-01-19 22:21:04.667657: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:269] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
I0000 00:00:1768890064.686290 1090751 cuda_dnn.cc:529] Loaded cuDNN version 91002
I0000 00:00:1768890064.842473 1090751 device_compiler.h:188] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2026-01-19 22:21:09,507 - INFO - Updated max_position_jitter from 10 to 764 based on coords_offsets max_abs=381.782 (required_canvas=828, old_padded=74, new_padded=828).
2026-01-19 22:21:09,941 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=1000, n_points=1000, C=1, K=4
2026-01-19 22:21:09,941 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=1, N=64, sequential_sampling=False
2026-01-19 22:21:09,941 - INFO - [OVERSAMPLING DEBUG] Oversampling flags: enable_oversampling=False, neighbor_pool_size=None, effective_K=4
2026-01-19 22:21:09,941 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 1000 > 1000 = False
2026-01-19 22:21:09,941 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 1 > 1 = False
2026-01-19 22:21:09,941 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2026-01-19 22:21:09,941 - INFO - Using efficient random sampling strategy for gridsize=1
2026-01-19 22:21:09,941 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2026-01-19 22:21:09,941 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=1000, K=4, C=1
2026-01-19 22:21:09,941 - INFO - Generating 1000 groups efficiently from 1000 points (K=4, C=1)
2026-01-19 22:21:09,941 - INFO - [OVERSAMPLING DEBUG] Standard case: using 1000 groups from 1000 points
2026-01-19 22:21:09,941 - INFO - [OVERSAMPLING DEBUG] Using all 1000 points as seeds (no sampling needed)
2026-01-19 22:21:09,941 - INFO - Using all 1000 points as seeds
2026-01-19 22:21:09,941 - INFO - Using seed indices directly for C=1 (gridsize=1) - no neighbor search needed
2026-01-19 22:21:09,941 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 1000 groups
2026-01-19 22:21:09,941 - INFO - Successfully generated 1000 groups with shape (1000, 1)
2026-01-19 22:21:09,941 - INFO - [OVERSAMPLING DEBUG] Generated 1000 groups in total
2026-01-19 22:21:09,941 - INFO - Generated 1000 groups efficiently
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(64, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(64, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(64, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(64, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(64, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(64, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(64, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(64, 828, 828, 1), reshaping to (-1, 1, 828, 828)
[train] required_canvas=828 padded_size=828 fits=True loss_fraction=0.0
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(64, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(64, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(64, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(64, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(64, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(64, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(64, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(64, 828, 828, 1), reshaping to (-1, 1, 828, 828)
[test] required_canvas=828 padded_size=828 fits=True loss_fraction=0.0
2026-01-19 22:21:18.676025: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1768890078.687220 1091171 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1768890078.691129 1091171 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1768890078.701799 1091171 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1768890078.701808 1091171 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1768890078.701810 1091171 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1768890078.701811 1091171 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2026-01-19 22:21:18.705058: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2026-01-19 22:21:21,552 - INFO - Loading cached nongrid_sim: .artifacts/synthetic_helpers/cache/nongrid_sim_5d647f9b17f00a8010f80133bfde6b1c36d5b9b934336f4b6e399f1ddd4a2c51.npz
2026-01-19 22:21:21,620 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=1000, n_points=4000, C=4, K=4
2026-01-19 22:21:21,620 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=2, N=64, sequential_sampling=False
2026-01-19 22:21:21,620 - INFO - [OVERSAMPLING DEBUG] Oversampling flags: enable_oversampling=False, neighbor_pool_size=None, effective_K=4
2026-01-19 22:21:21,620 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 1000 > 4000 = False
2026-01-19 22:21:21,620 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 4 > 1 = True
2026-01-19 22:21:21,620 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2026-01-19 22:21:21,620 - INFO - Using efficient random sampling strategy for gridsize=2
2026-01-19 22:21:21,620 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2026-01-19 22:21:21,620 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=1000, K=4, C=4
2026-01-19 22:21:21,620 - INFO - Generating 1000 groups efficiently from 4000 points (K=4, C=4)
2026-01-19 22:21:21,620 - INFO - [OVERSAMPLING DEBUG] Standard case: using 1000 groups from 4000 points
2026-01-19 22:21:21,621 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 1000 seed points
2026-01-19 22:21:21,621 - INFO - Sampled 1000 seed points from 4000 total points
2026-01-19 22:21:21,629 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 1000 groups
2026-01-19 22:21:21,629 - INFO - Successfully generated 1000 groups with shape (1000, 4)
2026-01-19 22:21:21,629 - INFO - [OVERSAMPLING DEBUG] Generated 1000 groups in total
2026-01-19 22:21:21,629 - INFO - Generated 1000 groups efficiently
I0000 00:00:1768890081.748485 1091171 gpu_process_state.cc:208] Using CUDA malloc Async allocator for GPU: 0
I0000 00:00:1768890081.749711 1091171 gpu_device.cc:2019] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22259 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:04:00.0, compute capability: 8.6
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1768890082.503021 1091171 service.cc:152] XLA service 0x4066d170 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
I0000 00:00:1768890082.503042 1091171 service.cc:160]   StreamExecutor device (0): NVIDIA GeForce RTX 3090, Compute Capability 8.6
2026-01-19 22:21:22.522787: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:269] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
I0000 00:00:1768890082.541254 1091171 cuda_dnn.cc:529] Loaded cuDNN version 91002
I0000 00:00:1768890082.703488 1091171 device_compiler.h:188] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2026-01-19 22:21:41,408 - INFO - Updated max_position_jitter from 10 to 756 based on coords_offsets max_abs=379.854 (required_canvas=824, old_padded=78, new_padded=824).
2026-01-19 22:21:41,987 - INFO - [OVERSAMPLING DEBUG] generate_grouped_data called with: nsamples=1000, n_points=4000, C=4, K=4
2026-01-19 22:21:41,987 - INFO - [OVERSAMPLING DEBUG] Parameters: gridsize=2, N=64, sequential_sampling=False
2026-01-19 22:21:41,987 - INFO - [OVERSAMPLING DEBUG] Oversampling flags: enable_oversampling=False, neighbor_pool_size=None, effective_K=4
2026-01-19 22:21:41,987 - INFO - [OVERSAMPLING DEBUG] Oversampling check: nsamples > n_points = 1000 > 4000 = False
2026-01-19 22:21:41,987 - INFO - [OVERSAMPLING DEBUG] Oversampling check: C > 1 = 4 > 1 = True
2026-01-19 22:21:41,987 - INFO - [OVERSAMPLING DEBUG] needs_oversampling = False
2026-01-19 22:21:41,987 - INFO - Using efficient random sampling strategy for gridsize=2
2026-01-19 22:21:41,987 - INFO - [OVERSAMPLING DEBUG] Taking efficient branch: standard sample-then-group
2026-01-19 22:21:41,987 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently called with: nsamples=1000, K=4, C=4
2026-01-19 22:21:41,987 - INFO - Generating 1000 groups efficiently from 4000 points (K=4, C=4)
2026-01-19 22:21:41,987 - INFO - [OVERSAMPLING DEBUG] Standard case: using 1000 groups from 4000 points
2026-01-19 22:21:41,987 - INFO - [OVERSAMPLING DEBUG] Randomly sampled 1000 seed points
2026-01-19 22:21:41,987 - INFO - Sampled 1000 seed points from 4000 total points
2026-01-19 22:21:41,995 - INFO - [OVERSAMPLING DEBUG] _generate_groups_efficiently completed: generated 1000 groups
2026-01-19 22:21:41,995 - INFO - Successfully generated 1000 groups with shape (1000, 4)
2026-01-19 22:21:41,995 - INFO - [OVERSAMPLING DEBUG] Generated 1000 groups in total
2026-01-19 22:21:41,995 - INFO - Generated 1000 groups efficiently
2026-01-19 22:22:00,769 - INFO - Updated max_position_jitter from 756 to 758 based on coords_offsets max_abs=380.981 (required_canvas=826, old_padded=824, new_padded=826).
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 824
DEBUG _flat_to_channel: input shape=(256, 824, 824, 1), reshaping to (-1, 4, 824, 824)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 824
DEBUG _flat_to_channel: input shape=(256, 824, 824, 1), reshaping to (-1, 4, 824, 824)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 824
DEBUG _flat_to_channel: input shape=(256, 824, 824, 1), reshaping to (-1, 4, 824, 824)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 824
DEBUG _flat_to_channel: input shape=(256, 824, 824, 1), reshaping to (-1, 4, 824, 824)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 824
DEBUG _flat_to_channel: input shape=(256, 824, 824, 1), reshaping to (-1, 4, 824, 824)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 824
DEBUG _flat_to_channel: input shape=(256, 824, 824, 1), reshaping to (-1, 4, 824, 824)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 824
DEBUG _flat_to_channel: input shape=(256, 824, 824, 1), reshaping to (-1, 4, 824, 824)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 824
DEBUG _flat_to_channel: input shape=(256, 824, 824, 1), reshaping to (-1, 4, 824, 824)
[train] required_canvas=824 padded_size=824 fits=True loss_fraction=0.0
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 826
DEBUG _flat_to_channel: input shape=(256, 826, 826, 1), reshaping to (-1, 4, 826, 826)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 826
DEBUG _flat_to_channel: input shape=(256, 826, 826, 1), reshaping to (-1, 4, 826, 826)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 826
DEBUG _flat_to_channel: input shape=(256, 826, 826, 1), reshaping to (-1, 4, 826, 826)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 826
DEBUG _flat_to_channel: input shape=(256, 826, 826, 1), reshaping to (-1, 4, 826, 826)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 826
DEBUG _flat_to_channel: input shape=(256, 826, 826, 1), reshaping to (-1, 4, 826, 826)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 826
DEBUG _flat_to_channel: input shape=(256, 826, 826, 1), reshaping to (-1, 4, 826, 826)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 826
DEBUG _flat_to_channel: input shape=(256, 826, 826, 1), reshaping to (-1, 4, 826, 826)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 826
DEBUG _flat_to_channel: input shape=(256, 826, 826, 1), reshaping to (-1, 4, 826, 826)
[test] required_canvas=826 padded_size=826 fits=True loss_fraction=0.0
