[runner] Scenario=gs1_ideal gridsize=1 probe_mode=idealized probe_scale=10.0
[runner] total_images=512 train_count=256 test_count=256 group_count=256 nepochs=5
DEBUG: Setting data_source to lines in params
DEBUG: Setting data_source to generic in params
DEBUG: Setting N to 64 in params
DEBUG: Setting gridsize to 1 in params
DEBUG: Setting nphotons to 1000000000.0 in params
input shape (None, 64, 64, 1)
diff3d shape: (512, 64, 64)
probeGuess shape: (64, 64)
scan_index shape: (512,)
objectGuess shape: (392, 392)
xcoords shape: (512,)
ycoords shape: (512,)
xcoords_start shape: (512,)
ycoords_start shape: (512,)
DEBUG: Setting N to 64 in params
DEBUG: Setting gridsize to 1 in params
DEBUG: Setting nphotons to 1000000000.0 in params
diff3d shape: (256, 64, 64)
probeGuess shape: (64, 64)
scan_index shape: (256,)
objectGuess shape: (392, 392)
xcoords shape: (256,)
ycoords shape: (256,)
xcoords_start shape: (256,)
ycoords_start shape: (256,)
diff3d shape: (256, 64, 64)
probeGuess shape: (64, 64)
scan_index shape: (256,)
objectGuess shape: (392, 392)
xcoords shape: (256,)
ycoords shape: (256,)
xcoords_start shape: (256,)
ycoords_start shape: (256,)
DEBUG: nsamples: 256, gridsize: 1 (using efficient random sample-then-group strategy)
INFO: Using pre-computed 'Y' array from the input file.
neighbor-sampled diffraction shape (256, 64, 64, 1)
loader: using provided ground truth patches.
INFO: None
<PtychoDataContainer X=(256, 64, 64, 1) mean=0.086 Y_I=(256, 64, 64, 1) mean=2.707 Y_phi=(256, 64, 64, 1) mean=0.000 coords_nominal=(256, 1, 2, 1) mean=0.000 coords_true=(256, 1, 2, 1) mean=0.000 probe=(64, 64) mean_amplitude=0.100 norm_Y_I=<scalar> nn_indices=(256, 1) global_offsets=(256, 1, 2, 1) local_offsets=(256, 1, 2, 1)>
DEBUG: nsamples: 256, gridsize: 1 (using efficient random sample-then-group strategy)
INFO: Using pre-computed 'Y' array from the input file.
neighbor-sampled diffraction shape (256, 64, 64, 1)
loader: using provided ground truth patches.
INFO: None
<PtychoDataContainer X=(256, 64, 64, 1) mean=0.086 Y_I=(256, 64, 64, 1) mean=2.590 Y_phi=(256, 64, 64, 1) mean=0.000 coords_nominal=(256, 1, 2, 1) mean=0.000 coords_true=(256, 1, 2, 1) mean=0.000 probe=(64, 64) mean_amplitude=0.100 norm_Y_I=<scalar> nn_indices=(256, 1) global_offsets=(256, 1, 2, 1) local_offsets=(256, 1, 2, 1)>
DEBUG: Setting probe to tf.Tensor(
[[[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 ...

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]], shape=(64, 64, 1), dtype=complex64) in params
DEBUG: Setting intensity_scale to 988.21173 in params
DEBUG: Setting probe to tf.Tensor(
[[[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 ...

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]], shape=(64, 64, 1), dtype=complex64) in params
Current Parameters:
--------------------
N: 64
amp_activation: sigmoid
backend: tensorflow
batch_size: 8
bigN: 64
big_gridsize: 10
data_source: generic
debug: True
default_probe_scale: 0.7
enable_oversampling: False
gaussian_smoothing_sigma: 0.0
gridsize: 1
h5_path: wts.h5
intensity_scale: 988.2117309570312
intensity_scale.trainable: True
label: 
mae_weight: 0.0
max_position_jitter: 764
model_type: pinn
n_filters_scale: 2
n_groups: 256
neighbor_count: 4
nepochs: 5
nimgs_test: 3
nimgs_train: 9
nll_weight: 1.0
nphotons: 1000000000.0
npseed: 42
object.big: True
offset: 4
outer_offset_test: None
outer_offset_train: None
output_prefix: plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-20T061530Z/gs1_ideal/train_outputs
pad_object: True
positions.provided: True
probe:
  shape: (64, 64, 1)
  mean: 0.100+0.000j
  std: 0.296
  min: 0.000+0.000j
  max: 1.089+0.000j
probe.big: True
probe.mask: False
probe.trainable: False
probe_scale: 10.0
realspace_mae_weight: 0.0
realspace_weight: 0.0
sequential_sampling: False
set_phi: False
sim_jitter_scale: 0.0
size: 392
torch_loss_mode: poisson
tv_weight: 0.0
use_xla_translate: True
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from global params: 64
DEBUG _flat_to_channel: input shape=(256, 64, 64, 1), reshaping to (-1, 1, 64, 64)
Epoch 1/5
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(None, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(None, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(None, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(None, 828, 828, 1), reshaping to (-1, 1, 828, 828)
input shape (None, 64, 64, 1)
DEBUG _flat_to_channel: gridsize from parameter: 1
DEBUG _flat_to_channel: N from parameter: 64
DEBUG _flat_to_channel: input shape=(None, 64, 64, 1), reshaping to (-1, 1, 64, 64)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(None, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(None, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(None, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(None, 828, 828, 1), reshaping to (-1, 1, 828, 828)
input shape (None, 64, 64, 1)
DEBUG _flat_to_channel: gridsize from parameter: 1
DEBUG _flat_to_channel: N from parameter: 64
DEBUG _flat_to_channel: input shape=(None, 64, 64, 1), reshaping to (-1, 1, 64, 64)
[1m 1/31[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m3:01[0m 6s/step - intensity_scaler_inv_loss: 52.2083 - loss: -3090708.0000 - pred_intensity_loss: -3090708.0000 - trimmed_obj_loss: 0.0000e+00[1m 3/31[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 31ms/step - intensity_scaler_inv_loss: 50.0684 - loss: -3372217.0000 - pred_intensity_loss: -3372217.0000 - trimmed_obj_loss: 0.0000e+00[1m 5/31[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 31ms/step - intensity_scaler_inv_loss: 51.3743 - loss: -3519220.2500 - pred_intensity_loss: -3519220.2500 - trimmed_obj_loss: 0.0000e+00[1m 7/31[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 31ms/step - intensity_scaler_inv_loss: 50.8136 - loss: -3636019.0000 - pred_intensity_loss: -3636019.0000 - trimmed_obj_loss: 0.0000e+00[1m 9/31[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 50.4504 - loss: -3671725.5000 - pred_intensity_loss: -3671725.5000 - trimmed_obj_loss: 0.0000e+00[1m11/31[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 49.5644 - loss: -3687366.2500 - pred_intensity_loss: -3687366.2500 - trimmed_obj_loss: 0.0000e+00[1m13/31[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 48.6430 - loss: -3704734.7500 - pred_intensity_loss: -3704734.7500 - trimmed_obj_loss: 0.0000e+00[1m15/31[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 47.7653 - loss: -3717073.5000 - pred_intensity_loss: -3717073.5000 - trimmed_obj_loss: 0.0000e+00[1m17/31[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 47.0096 - loss: -3733032.2500 - pred_intensity_loss: -3733032.2500 - trimmed_obj_loss: 0.0000e+00[1m19/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 46.3076 - loss: -3746211.0000 - pred_intensity_loss: -3746211.0000 - trimmed_obj_loss: 0.0000e+00[1m21/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 45.6162 - loss: -3754978.7500 - pred_intensity_loss: -3754978.7500 - trimmed_obj_loss: 0.0000e+00[1m23/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 44.9000 - loss: -3760345.2500 - pred_intensity_loss: -3760345.2500 - trimmed_obj_loss: 0.0000e+00[1m25/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 44.1998 - loss: -3766330.7500 - pred_intensity_loss: -3766330.7500 - trimmed_obj_loss: 0.0000e+00[1m27/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 43.5121 - loss: -3773248.7500 - pred_intensity_loss: -3773248.7500 - trimmed_obj_loss: 0.0000e+00[1m29/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 42.8541 - loss: -3780499.0000 - pred_intensity_loss: -3780499.0000 - trimmed_obj_loss: 0.0000e+00[1m31/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 66ms/step - intensity_scaler_inv_loss: 42.2038 - loss: -3785347.0000 - pred_intensity_loss: -3785263.5000 - trimmed_obj_loss: 0.0000e+00DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(None, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(None, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(None, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(None, 828, 828, 1), reshaping to (-1, 1, 828, 828)
input shape (None, 64, 64, 1)
DEBUG _flat_to_channel: gridsize from parameter: 1
DEBUG _flat_to_channel: N from parameter: 64
DEBUG _flat_to_channel: input shape=(None, 64, 64, 1), reshaping to (-1, 1, 64, 64)
[1m31/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m9s[0m 105ms/step - intensity_scaler_inv_loss: 32.4680 - loss: -3854842.5000 - pred_intensity_loss: -3852251.7500 - trimmed_obj_loss: 0.0000e+00 - val_intensity_scaler_inv_loss: 16.6132 - val_loss: -4113893.7500 - val_pred_intensity_loss: -4043572.0000 - val_trimmed_obj_loss: 0.0000e+00 - learning_rate: 0.0010
Epoch 2/5
[1m 1/31[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 47ms/step - intensity_scaler_inv_loss: 17.9807 - loss: -2831625.0000 - pred_intensity_loss: -2831625.0000 - trimmed_obj_loss: 0.0000e+00[1m 3/31[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 18.0095 - loss: -3414391.0000 - pred_intensity_loss: -3414391.0000 - trimmed_obj_loss: 0.0000e+00[1m 5/31[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 18.2342 - loss: -3677042.5000 - pred_intensity_loss: -3677042.5000 - trimmed_obj_loss: 0.0000e+00[1m 7/31[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 18.2652 - loss: -3789742.0000 - pred_intensity_loss: -3789742.0000 - trimmed_obj_loss: 0.0000e+00[1m 9/31[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 18.2202 - loss: -3834712.0000 - pred_intensity_loss: -3834712.0000 - trimmed_obj_loss: 0.0000e+00[1m11/31[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 18.1705 - loss: -3852577.0000 - pred_intensity_loss: -3852577.0000 - trimmed_obj_loss: 0.0000e+00[1m13/31[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 18.1512 - loss: -3871136.0000 - pred_intensity_loss: -3871136.0000 - trimmed_obj_loss: 0.0000e+00[1m15/31[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 18.0921 - loss: -3882699.2500 - pred_intensity_loss: -3882699.2500 - trimmed_obj_loss: 0.0000e+00[1m17/31[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 18.0342 - loss: -3893832.0000 - pred_intensity_loss: -3893832.0000 - trimmed_obj_loss: 0.0000e+00[1m19/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 17.9666 - loss: -3900201.0000 - pred_intensity_loss: -3900201.0000 - trimmed_obj_loss: 0.0000e+00[1m21/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 17.8915 - loss: -3900193.5000 - pred_intensity_loss: -3900193.5000 - trimmed_obj_loss: 0.0000e+00[1m23/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 17.8223 - loss: -3896900.0000 - pred_intensity_loss: -3896900.0000 - trimmed_obj_loss: 0.0000e+00[1m25/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 17.7663 - loss: -3896807.7500 - pred_intensity_loss: -3896807.7500 - trimmed_obj_loss: 0.0000e+00[1m27/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 17.7155 - loss: -3899669.0000 - pred_intensity_loss: -3899669.0000 - trimmed_obj_loss: 0.0000e+00[1m29/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 17.6660 - loss: -3902735.5000 - pred_intensity_loss: -3902735.5000 - trimmed_obj_loss: 0.0000e+00[1m31/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 31ms/step - intensity_scaler_inv_loss: 17.0864 - loss: -3938925.5000 - pred_intensity_loss: -3951219.7500 - trimmed_obj_loss: 0.0000e+00 - val_intensity_scaler_inv_loss: 16.4874 - val_loss: -4109277.5000 - val_pred_intensity_loss: -4039831.7500 - val_trimmed_obj_loss: 0.0000e+00 - learning_rate: 0.0010
Epoch 3/5
[1m 1/31[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 48ms/step - intensity_scaler_inv_loss: 16.5621 - loss: -3080595.0000 - pred_intensity_loss: -3080595.0000 - trimmed_obj_loss: 0.0000e+00[1m 3/31[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 31ms/step - intensity_scaler_inv_loss: 15.6396 - loss: -3228003.0000 - pred_intensity_loss: -3228003.0000 - trimmed_obj_loss: 0.0000e+00[1m 5/31[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 31ms/step - intensity_scaler_inv_loss: 15.4105 - loss: -3359565.5000 - pred_intensity_loss: -3359565.5000 - trimmed_obj_loss: 0.0000e+00[1m 7/31[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 15.2713 - loss: -3448035.7500 - pred_intensity_loss: -3448035.7500 - trimmed_obj_loss: 0.0000e+00[1m 9/31[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 15.2127 - loss: -3505054.7500 - pred_intensity_loss: -3505054.7500 - trimmed_obj_loss: 0.0000e+00[1m11/31[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 15.1956 - loss: -3529032.0000 - pred_intensity_loss: -3529032.0000 - trimmed_obj_loss: 0.0000e+00[1m13/31[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 15.2175 - loss: -3549355.5000 - pred_intensity_loss: -3549355.5000 - trimmed_obj_loss: 0.0000e+00[1m15/31[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 15.2560 - loss: -3580513.7500 - pred_intensity_loss: -3580513.7500 - trimmed_obj_loss: 0.0000e+00[1m17/31[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 15.3117 - loss: -3606393.7500 - pred_intensity_loss: -3606393.7500 - trimmed_obj_loss: 0.0000e+00[1m19/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 15.3690 - loss: -3625354.0000 - pred_intensity_loss: -3625354.0000 - trimmed_obj_loss: 0.0000e+00[1m21/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 15.4559 - loss: -3649086.5000 - pred_intensity_loss: -3649086.5000 - trimmed_obj_loss: 0.0000e+00[1m23/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 15.5243 - loss: -3670668.5000 - pred_intensity_loss: -3670668.5000 - trimmed_obj_loss: 0.0000e+00[1m25/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 15.5812 - loss: -3691485.7500 - pred_intensity_loss: -3691485.7500 - trimmed_obj_loss: 0.0000e+00[1m27/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 15.6317 - loss: -3711198.7500 - pred_intensity_loss: -3711198.7500 - trimmed_obj_loss: 0.0000e+00[1m29/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 15.6715 - loss: -3728660.7500 - pred_intensity_loss: -3728660.7500 - trimmed_obj_loss: 0.0000e+00[1m31/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 32ms/step - intensity_scaler_inv_loss: 16.0440 - loss: -3940190.7500 - pred_intensity_loss: -3949191.0000 - trimmed_obj_loss: 0.0000e+00 - val_intensity_scaler_inv_loss: 13.6028 - val_loss: -4117803.7500 - val_pred_intensity_loss: -4047538.5000 - val_trimmed_obj_loss: 0.0000e+00 - learning_rate: 0.0010
Epoch 4/5
[1m 1/31[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 46ms/step - intensity_scaler_inv_loss: 14.4934 - loss: -4458657.0000 - pred_intensity_loss: -4458657.0000 - trimmed_obj_loss: 0.0000e+00[1m 3/31[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.2627 - loss: -4162752.5000 - pred_intensity_loss: -4162752.5000 - trimmed_obj_loss: 0.0000e+00[1m 5/31[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.1845 - loss: -4047957.2500 - pred_intensity_loss: -4047957.2500 - trimmed_obj_loss: 0.0000e+00[1m 7/31[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.3350 - loss: -4053976.7500 - pred_intensity_loss: -4053976.7500 - trimmed_obj_loss: 0.0000e+00[1m 9/31[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.4315 - loss: -4062172.0000 - pred_intensity_loss: -4062172.0000 - trimmed_obj_loss: 0.0000e+00[1m11/31[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.4954 - loss: -4066411.7500 - pred_intensity_loss: -4066411.7500 - trimmed_obj_loss: 0.0000e+00[1m13/31[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.5735 - loss: -4068379.2500 - pred_intensity_loss: -4068379.2500 - trimmed_obj_loss: 0.0000e+00[1m15/31[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.6522 - loss: -4073143.7500 - pred_intensity_loss: -4073143.7500 - trimmed_obj_loss: 0.0000e+00[1m17/31[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.7266 - loss: -4073468.7500 - pred_intensity_loss: -4073468.7500 - trimmed_obj_loss: 0.0000e+00[1m19/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.7914 - loss: -4069349.5000 - pred_intensity_loss: -4069349.5000 - trimmed_obj_loss: 0.0000e+00[1m21/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.8460 - loss: -4060335.0000 - pred_intensity_loss: -4060335.0000 - trimmed_obj_loss: 0.0000e+00[1m23/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.8815 - loss: -4052772.5000 - pred_intensity_loss: -4052772.5000 - trimmed_obj_loss: 0.0000e+00[1m25/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.9081 - loss: -4047803.5000 - pred_intensity_loss: -4047803.5000 - trimmed_obj_loss: 0.0000e+00[1m27/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.9223 - loss: -4042811.0000 - pred_intensity_loss: -4042811.0000 - trimmed_obj_loss: 0.0000e+00[1m29/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.9402 - loss: -4036226.5000 - pred_intensity_loss: -4036226.5000 - trimmed_obj_loss: 0.0000e+00[1m31/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 31ms/step - intensity_scaler_inv_loss: 15.1684 - loss: -3942622.5000 - pred_intensity_loss: -3931869.0000 - trimmed_obj_loss: 0.0000e+00 - val_intensity_scaler_inv_loss: 14.6407 - val_loss: -4116149.5000 - val_pred_intensity_loss: -4045766.5000 - val_trimmed_obj_loss: 0.0000e+00 - learning_rate: 0.0010
Epoch 5/5
[1m 1/31[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 46ms/step - intensity_scaler_inv_loss: 15.2757 - loss: -4329397.0000 - pred_intensity_loss: -4329397.0000 - trimmed_obj_loss: 0.0000e+00[1m 3/31[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.9043 - loss: -4390527.5000 - pred_intensity_loss: -4390527.5000 - trimmed_obj_loss: 0.0000e+00[1m 5/31[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.5119 - loss: -4277375.0000 - pred_intensity_loss: -4277375.0000 - trimmed_obj_loss: 0.0000e+00[1m 7/31[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.4729 - loss: -4197494.5000 - pred_intensity_loss: -4197494.5000 - trimmed_obj_loss: 0.0000e+00[1m 9/31[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.4642 - loss: -4170861.2500 - pred_intensity_loss: -4170861.2500 - trimmed_obj_loss: 0.0000e+00[1m11/31[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.4921 - loss: -4165219.7500 - pred_intensity_loss: -4165219.7500 - trimmed_obj_loss: 0.0000e+00[1m13/31[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.5090 - loss: -4155735.0000 - pred_intensity_loss: -4155735.0000 - trimmed_obj_loss: 0.0000e+00[1m15/31[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.5421 - loss: -4148389.5000 - pred_intensity_loss: -4148389.5000 - trimmed_obj_loss: 0.0000e+00[1m17/31[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.5696 - loss: -4144042.7500 - pred_intensity_loss: -4144042.7500 - trimmed_obj_loss: 0.0000e+00[1m19/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.5797 - loss: -4141280.7500 - pred_intensity_loss: -4141280.7500 - trimmed_obj_loss: 0.0000e+00[1m21/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.5810 - loss: -4133785.5000 - pred_intensity_loss: -4133785.5000 - trimmed_obj_loss: 0.0000e+00[1m23/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.5792 - loss: -4124526.0000 - pred_intensity_loss: -4124526.0000 - trimmed_obj_loss: 0.0000e+00[1m25/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.5768 - loss: -4115392.0000 - pred_intensity_loss: -4115392.0000 - trimmed_obj_loss: 0.0000e+00[1m27/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.5667 - loss: -4105017.5000 - pred_intensity_loss: -4105017.5000 - trimmed_obj_loss: 0.0000e+00[1m29/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 30ms/step - intensity_scaler_inv_loss: 14.5614 - loss: -4095340.0000 - pred_intensity_loss: -4095340.0000 - trimmed_obj_loss: 0.0000e+00[1m31/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 32ms/step - intensity_scaler_inv_loss: 14.5108 - loss: -3944759.2500 - pred_intensity_loss: -3924991.5000 - trimmed_obj_loss: 0.0000e+00 - val_intensity_scaler_inv_loss: 12.3980 - val_loss: -4120090.5000 - val_pred_intensity_loss: -4049937.5000 - val_trimmed_obj_loss: 0.0000e+00 - learning_rate: 0.0010
DEBUG: Setting probe to tf.Tensor(
[[[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 ...

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]], shape=(64, 64, 1), dtype=complex64) in params
INFO: setting probe from test data container. It MUST be consistent with the training probe
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(32, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(32, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(32, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(32, 828, 828, 1), reshaping to (-1, 1, 828, 828)
input shape (32, 64, 64, 1)
DEBUG _flat_to_channel: gridsize from parameter: 1
DEBUG _flat_to_channel: N from parameter: 64
DEBUG _flat_to_channel: input shape=(32, 64, 64, 1), reshaping to (-1, 1, 64, 64)
[1m1/8[0m [32mâ”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m8s[0m 1s/step[1m6/8[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 11ms/step[1m8/8[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 14ms/step
Object stitching failed: Grid-based stitching is not supported for gridsize=1 (non-grid mode). Individual patches cannot be arranged in a regular grid.
cannot reshape array of size 1048576 into shape (9,9,64,64,1)
[runner] Training complete in 16.77s; bundle saved to plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-20T061530Z/gs1_ideal/train_outputs
DEBUG: nsamples: 64, gridsize: 1 (using efficient random sample-then-group strategy)
INFO: Using pre-computed 'Y' array from the input file.
neighbor-sampled diffraction shape (64, 64, 64, 1)
loader: using provided ground truth patches.
INFO: None
<PtychoDataContainer X=(64, 64, 64, 1) mean=0.086 Y_I=(64, 64, 64, 1) mean=2.567 Y_phi=(64, 64, 64, 1) mean=0.000 coords_nominal=(64, 1, 2, 1) mean=0.000 coords_true=(64, 1, 2, 1) mean=0.000 probe=(64, 64) mean_amplitude=0.100 norm_Y_I=<scalar> nn_indices=(64, 1) global_offsets=(64, 1, 2, 1) local_offsets=(64, 1, 2, 1)>
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(32, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(32, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(32, 828, 828, 1), reshaping to (-1, 1, 828, 828)
DEBUG _flat_to_channel: gridsize from global params: 1
DEBUG _flat_to_channel: N from parameter: 828
DEBUG _flat_to_channel: input shape=(32, 828, 828, 1), reshaping to (-1, 1, 828, 828)
[1m1/2[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m1:11[0m 72s/step[1m2/2[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m72s[0m 17ms/step
[runner] Inference complete; stats saved to plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-20T061530Z/gs1_ideal/inference_outputs/stats.json
[runner] Outputs written to plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-20T061530Z/gs1_ideal
