[runner] Scenario=gs2_ideal gridsize=2 probe_mode=idealized probe_scale=10.0
[runner] total_images=1024 train_count=512 test_count=512 group_count=128 nepochs=5
DEBUG: Setting data_source to lines in params
DEBUG: Setting data_source to generic in params
diff3d shape: (1024, 64, 64)
probeGuess shape: (64, 64)
scan_index shape: (1024,)
objectGuess shape: (392, 392)
xcoords shape: (1024,)
ycoords shape: (1024,)
xcoords_start shape: (1024,)
ycoords_start shape: (1024,)
diff3d shape: (512, 64, 64)
probeGuess shape: (64, 64)
scan_index shape: (512,)
objectGuess shape: (392, 392)
xcoords shape: (512,)
ycoords shape: (512,)
xcoords_start shape: (512,)
ycoords_start shape: (512,)
diff3d shape: (512, 64, 64)
probeGuess shape: (64, 64)
scan_index shape: (512,)
objectGuess shape: (392, 392)
xcoords shape: (512,)
ycoords shape: (512,)
xcoords_start shape: (512,)
ycoords_start shape: (512,)
DEBUG: nsamples: 128, gridsize: 2 (using efficient random sample-then-group strategy)
INFO: 'Y' array not found. Generating ground truth patches from 'objectGuess' as a fallback.
neighbor-sampled diffraction shape (128, 64, 64, 4)
loader: using provided ground truth patches.
INFO: None
<PtychoDataContainer X=(128, 64, 64, 4) mean=0.085 Y_I=(128, 64, 64, 4) mean=2.672 Y_phi=(128, 64, 64, 4) mean=0.000 coords_nominal=(128, 1, 2, 4) mean=-0.000 coords_true=(128, 1, 2, 4) mean=-0.000 probe=(64, 64) mean_amplitude=0.100 norm_Y_I=<scalar> nn_indices=(128, 4) global_offsets=(128, 1, 2, 1) local_offsets=(128, 1, 2, 4)>
DEBUG: nsamples: 128, gridsize: 2 (using efficient random sample-then-group strategy)
INFO: 'Y' array not found. Generating ground truth patches from 'objectGuess' as a fallback.
neighbor-sampled diffraction shape (128, 64, 64, 4)
loader: using provided ground truth patches.
INFO: None
<PtychoDataContainer X=(128, 64, 64, 4) mean=0.085 Y_I=(128, 64, 64, 4) mean=2.588 Y_phi=(128, 64, 64, 4) mean=0.000 coords_nominal=(128, 1, 2, 4) mean=0.000 coords_true=(128, 1, 2, 4) mean=0.000 probe=(64, 64) mean_amplitude=0.100 norm_Y_I=<scalar> nn_indices=(128, 4) global_offsets=(128, 1, 2, 1) local_offsets=(128, 1, 2, 4)>
DEBUG: Setting probe to tf.Tensor(
[[[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 ...

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]], shape=(64, 64, 1), dtype=complex64) in params
DEBUG: Setting intensity_scale to 988.21173 in params
DEBUG: Setting probe to tf.Tensor(
[[[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 ...

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]], shape=(64, 64, 1), dtype=complex64) in params
Current Parameters:
--------------------
N: 64
amp_activation: sigmoid
backend: tensorflow
batch_size: 4
bigN: 68
big_gridsize: 10
data_source: generic
debug: True
default_probe_scale: 0.7
enable_oversampling: False
gaussian_smoothing_sigma: 0.0
gridsize: 2
h5_path: wts.h5
intensity_scale: 988.2117309570312
intensity_scale.trainable: True
label: 
mae_weight: 0.0
max_position_jitter: 754
model_type: pinn
n_filters_scale: 2
n_groups: 128
neighbor_count: 4
nepochs: 5
nimgs_test: 3
nimgs_train: 9
nll_weight: 1.0
nphotons: 1000000000.0
npseed: 42
object.big: True
offset: 4
outer_offset_test: None
outer_offset_train: None
output_prefix: plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-20T061530Z/gs2_ideal/train_outputs
pad_object: True
positions.provided: True
probe:
  shape: (64, 64, 1)
  mean: 0.100+0.000j
  std: 0.296
  min: 0.000+0.000j
  max: 1.089+0.000j
probe.big: False
probe.mask: True
probe.trainable: False
probe_scale: 10.0
realspace_mae_weight: 0.0
realspace_weight: 0.0
sequential_sampling: False
set_phi: False
sim_jitter_scale: 0.0
size: 392
torch_loss_mode: poisson
tv_weight: 0.0
use_xla_translate: True
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from global params: 64
DEBUG _flat_to_channel: input shape=(512, 64, 64, 1), reshaping to (-1, 4, 64, 64)
Epoch 1/5
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 822
DEBUG _flat_to_channel: input shape=(None, 822, 822, 1), reshaping to (-1, 4, 822, 822)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 822
DEBUG _flat_to_channel: input shape=(None, 822, 822, 1), reshaping to (-1, 4, 822, 822)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 822
DEBUG _flat_to_channel: input shape=(None, 822, 822, 1), reshaping to (-1, 4, 822, 822)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 822
DEBUG _flat_to_channel: input shape=(None, 822, 822, 1), reshaping to (-1, 4, 822, 822)
input shape (None, 64, 64, 1)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 64
DEBUG _flat_to_channel: input shape=(None, 64, 64, 1), reshaping to (-1, 4, 64, 64)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 822
DEBUG _flat_to_channel: input shape=(None, 822, 822, 1), reshaping to (-1, 4, 822, 822)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 822
DEBUG _flat_to_channel: input shape=(None, 822, 822, 1), reshaping to (-1, 4, 822, 822)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 822
DEBUG _flat_to_channel: input shape=(None, 822, 822, 1), reshaping to (-1, 4, 822, 822)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 822
DEBUG _flat_to_channel: input shape=(None, 822, 822, 1), reshaping to (-1, 4, 822, 822)
input shape (None, 64, 64, 1)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 64
DEBUG _flat_to_channel: input shape=(None, 64, 64, 1), reshaping to (-1, 4, 64, 64)
[1m 1/31[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m2:34[0m 5s/step - intensity_scaler_inv_loss: 54.5690 - loss: -3267504.5000 - pred_intensity_loss: -3267504.5000 - trimmed_obj_loss: 0.0000e+00[1m 3/31[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 47ms/step - intensity_scaler_inv_loss: 49.0861 - loss: -3359732.5000 - pred_intensity_loss: -3359732.5000 - trimmed_obj_loss: 0.0000e+00[1m 5/31[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 47ms/step - intensity_scaler_inv_loss: 53.1674 - loss: -3491431.7500 - pred_intensity_loss: -3491431.7500 - trimmed_obj_loss: 0.0000e+00[1m 7/31[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 47ms/step - intensity_scaler_inv_loss: 53.2245 - loss: -3651399.0000 - pred_intensity_loss: -3651399.0000 - trimmed_obj_loss: 0.0000e+00[1m 9/31[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 46ms/step - intensity_scaler_inv_loss: 52.2403 - loss: -3745862.7500 - pred_intensity_loss: -3745862.7500 - trimmed_obj_loss: 0.0000e+00[1m11/31[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 51.0258 - loss: -3784116.2500 - pred_intensity_loss: -3784116.2500 - trimmed_obj_loss: 0.0000e+00[1m13/31[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 49.8469 - loss: -3805493.0000 - pred_intensity_loss: -3805493.0000 - trimmed_obj_loss: 0.0000e+00[1m15/31[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 48.7330 - loss: -3816589.7500 - pred_intensity_loss: -3816589.7500 - trimmed_obj_loss: 0.0000e+00[1m17/31[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 47.7292 - loss: -3826244.7500 - pred_intensity_loss: -3826244.7500 - trimmed_obj_loss: 0.0000e+00[1m19/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 46.7866 - loss: -3836026.2500 - pred_intensity_loss: -3836026.2500 - trimmed_obj_loss: 0.0000e+00[1m21/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 45.9119 - loss: -3849097.2500 - pred_intensity_loss: -3849097.2500 - trimmed_obj_loss: 0.0000e+00[1m23/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 45.0856 - loss: -3857917.0000 - pred_intensity_loss: -3857917.0000 - trimmed_obj_loss: 0.0000e+00[1m25/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 44.3046 - loss: -3862602.2500 - pred_intensity_loss: -3862602.2500 - trimmed_obj_loss: 0.0000e+00[1m27/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 43.5725 - loss: -3864129.5000 - pred_intensity_loss: -3864129.5000 - trimmed_obj_loss: 0.0000e+00[1m29/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 42.8858 - loss: -3863815.5000 - pred_intensity_loss: -3863815.5000 - trimmed_obj_loss: 0.0000e+00[1m31/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 79ms/step - intensity_scaler_inv_loss: 42.2426 - loss: -3863808.7500 - pred_intensity_loss: -3864694.0000 - trimmed_obj_loss: 0.0000e+00DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 822
DEBUG _flat_to_channel: input shape=(None, 822, 822, 1), reshaping to (-1, 4, 822, 822)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 822
DEBUG _flat_to_channel: input shape=(None, 822, 822, 1), reshaping to (-1, 4, 822, 822)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 822
DEBUG _flat_to_channel: input shape=(None, 822, 822, 1), reshaping to (-1, 4, 822, 822)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 822
DEBUG _flat_to_channel: input shape=(None, 822, 822, 1), reshaping to (-1, 4, 822, 822)
input shape (None, 64, 64, 1)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 64
DEBUG _flat_to_channel: input shape=(None, 64, 64, 1), reshaping to (-1, 4, 64, 64)
[1m31/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m9s[0m 114ms/step - intensity_scaler_inv_loss: 32.7421 - loss: -3868438.5000 - pred_intensity_loss: -3895874.2500 - trimmed_obj_loss: 0.0000e+00 - val_intensity_scaler_inv_loss: 20.6514 - val_loss: -4433526.5000 - val_pred_intensity_loss: -4321139.5000 - val_trimmed_obj_loss: 0.0000e+00 - learning_rate: 0.0010
Epoch 2/5
[1m 1/31[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 63ms/step - intensity_scaler_inv_loss: 19.1849 - loss: -4075941.0000 - pred_intensity_loss: -4075941.0000 - trimmed_obj_loss: 0.0000e+00[1m 3/31[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 46ms/step - intensity_scaler_inv_loss: 18.7580 - loss: -4205023.0000 - pred_intensity_loss: -4205023.0000 - trimmed_obj_loss: 0.0000e+00[1m 5/31[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 46ms/step - intensity_scaler_inv_loss: 18.6769 - loss: -4181822.2500 - pred_intensity_loss: -4181822.2500 - trimmed_obj_loss: 0.0000e+00[1m 7/31[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 46ms/step - intensity_scaler_inv_loss: 18.8352 - loss: -4164718.0000 - pred_intensity_loss: -4164718.0000 - trimmed_obj_loss: 0.0000e+00[1m 9/31[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 46ms/step - intensity_scaler_inv_loss: 18.8047 - loss: -4121504.0000 - pred_intensity_loss: -4121504.0000 - trimmed_obj_loss: 0.0000e+00[1m11/31[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 18.8164 - loss: -4083703.5000 - pred_intensity_loss: -4083703.5000 - trimmed_obj_loss: 0.0000e+00[1m13/31[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 18.8022 - loss: -4061383.2500 - pred_intensity_loss: -4061383.2500 - trimmed_obj_loss: 0.0000e+00[1m15/31[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 18.7751 - loss: -4040481.5000 - pred_intensity_loss: -4040481.5000 - trimmed_obj_loss: 0.0000e+00[1m17/31[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 18.7641 - loss: -4025037.7500 - pred_intensity_loss: -4025037.7500 - trimmed_obj_loss: 0.0000e+00[1m19/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 18.7853 - loss: -4008514.2500 - pred_intensity_loss: -4008514.2500 - trimmed_obj_loss: 0.0000e+00[1m21/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 18.8085 - loss: -4001846.7500 - pred_intensity_loss: -4001846.7500 - trimmed_obj_loss: 0.0000e+00[1m23/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 18.8196 - loss: -3998874.7500 - pred_intensity_loss: -3998874.7500 - trimmed_obj_loss: 0.0000e+00[1m25/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 18.8190 - loss: -3994576.0000 - pred_intensity_loss: -3994576.0000 - trimmed_obj_loss: 0.0000e+00[1m27/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 18.8035 - loss: -3988720.0000 - pred_intensity_loss: -3988720.0000 - trimmed_obj_loss: 0.0000e+00[1m29/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 18.7878 - loss: -3983572.5000 - pred_intensity_loss: -3983572.5000 - trimmed_obj_loss: 0.0000e+00[1m31/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 45ms/step - intensity_scaler_inv_loss: 18.7718 - loss: -3979455.0000 - pred_intensity_loss: -3979827.0000 - trimmed_obj_loss: 0.0000e+00[1m31/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 47ms/step - intensity_scaler_inv_loss: 18.5447 - loss: -3921737.5000 - pred_intensity_loss: -3933268.5000 - trimmed_obj_loss: 0.0000e+00 - val_intensity_scaler_inv_loss: 17.3731 - val_loss: -4436859.5000 - val_pred_intensity_loss: -4324194.0000 - val_trimmed_obj_loss: 0.0000e+00 - learning_rate: 0.0010
Epoch 3/5
[1m 1/31[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 62ms/step - intensity_scaler_inv_loss: 18.6041 - loss: -4751600.5000 - pred_intensity_loss: -4751600.5000 - trimmed_obj_loss: 0.0000e+00[1m 3/31[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 46ms/step - intensity_scaler_inv_loss: 19.1631 - loss: -4723821.0000 - pred_intensity_loss: -4723821.0000 - trimmed_obj_loss: 0.0000e+00[1m 5/31[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 46ms/step - intensity_scaler_inv_loss: 19.1687 - loss: -4501818.0000 - pred_intensity_loss: -4501818.0000 - trimmed_obj_loss: 0.0000e+00[1m 7/31[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 46ms/step - intensity_scaler_inv_loss: 18.9692 - loss: -4333459.0000 - pred_intensity_loss: -4333459.0000 - trimmed_obj_loss: 0.0000e+00[1m 9/31[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 46ms/step - intensity_scaler_inv_loss: 18.8634 - loss: -4242969.5000 - pred_intensity_loss: -4242969.5000 - trimmed_obj_loss: 0.0000e+00[1m11/31[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 18.8081 - loss: -4176025.7500 - pred_intensity_loss: -4176025.7500 - trimmed_obj_loss: 0.0000e+00[1m13/31[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 18.7512 - loss: -4123263.7500 - pred_intensity_loss: -4123263.7500 - trimmed_obj_loss: 0.0000e+00[1m15/31[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 18.7249 - loss: -4088586.2500 - pred_intensity_loss: -4088586.2500 - trimmed_obj_loss: 0.0000e+00[1m17/31[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 18.7170 - loss: -4069310.0000 - pred_intensity_loss: -4069310.0000 - trimmed_obj_loss: 0.0000e+00[1m19/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 18.6895 - loss: -4045496.2500 - pred_intensity_loss: -4045496.2500 - trimmed_obj_loss: 0.0000e+00[1m21/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 18.6618 - loss: -4023345.7500 - pred_intensity_loss: -4023345.7500 - trimmed_obj_loss: 0.0000e+00[1m23/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 18.6590 - loss: -4005553.5000 - pred_intensity_loss: -4005553.5000 - trimmed_obj_loss: 0.0000e+00[1m25/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 18.6445 - loss: -3991842.0000 - pred_intensity_loss: -3991842.0000 - trimmed_obj_loss: 0.0000e+00[1m27/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 18.6362 - loss: -3979503.5000 - pred_intensity_loss: -3979503.5000 - trimmed_obj_loss: 0.0000e+00[1m29/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 18.6369 - loss: -3973437.0000 - pred_intensity_loss: -3973437.0000 - trimmed_obj_loss: 0.0000e+00[1m31/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 45ms/step - intensity_scaler_inv_loss: 18.6558 - loss: -3970172.7500 - pred_intensity_loss: -3969509.0000 - trimmed_obj_loss: 0.0000e+00[1m31/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 47ms/step - intensity_scaler_inv_loss: 18.9397 - loss: -3919295.7500 - pred_intensity_loss: -3898720.5000 - trimmed_obj_loss: 0.0000e+00 - val_intensity_scaler_inv_loss: 21.6183 - val_loss: -4416647.0000 - val_pred_intensity_loss: -4305780.0000 - val_trimmed_obj_loss: 0.0000e+00 - learning_rate: 0.0010
Epoch 4/5
[1m 1/31[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 62ms/step - intensity_scaler_inv_loss: 19.7352 - loss: -4239644.0000 - pred_intensity_loss: -4239644.0000 - trimmed_obj_loss: 0.0000e+00[1m 3/31[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 47ms/step - intensity_scaler_inv_loss: 21.2612 - loss: -4286125.0000 - pred_intensity_loss: -4286125.0000 - trimmed_obj_loss: 0.0000e+00[1m 5/31[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 46ms/step - intensity_scaler_inv_loss: 21.4474 - loss: -4229651.0000 - pred_intensity_loss: -4229651.0000 - trimmed_obj_loss: 0.0000e+00[1m 7/31[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 46ms/step - intensity_scaler_inv_loss: 21.6853 - loss: -4172408.2500 - pred_intensity_loss: -4172408.2500 - trimmed_obj_loss: 0.0000e+00[1m 9/31[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 46ms/step - intensity_scaler_inv_loss: 21.6242 - loss: -4146378.2500 - pred_intensity_loss: -4146378.2500 - trimmed_obj_loss: 0.0000e+00[1m11/31[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 21.5326 - loss: -4140389.2500 - pred_intensity_loss: -4140389.2500 - trimmed_obj_loss: 0.0000e+00[1m13/31[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 21.4085 - loss: -4128209.0000 - pred_intensity_loss: -4128209.0000 - trimmed_obj_loss: 0.0000e+00[1m15/31[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 21.3095 - loss: -4111343.0000 - pred_intensity_loss: -4111343.0000 - trimmed_obj_loss: 0.0000e+00[1m17/31[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 21.2103 - loss: -4095526.5000 - pred_intensity_loss: -4095526.5000 - trimmed_obj_loss: 0.0000e+00[1m19/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 21.1031 - loss: -4082243.7500 - pred_intensity_loss: -4082243.7500 - trimmed_obj_loss: 0.0000e+00[1m21/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 21.0030 - loss: -4071386.7500 - pred_intensity_loss: -4071386.7500 - trimmed_obj_loss: 0.0000e+00[1m23/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 20.9157 - loss: -4062539.7500 - pred_intensity_loss: -4062539.7500 - trimmed_obj_loss: 0.0000e+00[1m25/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 20.8208 - loss: -4052857.2500 - pred_intensity_loss: -4052857.2500 - trimmed_obj_loss: 0.0000e+00[1m27/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 20.7363 - loss: -4042793.2500 - pred_intensity_loss: -4042793.2500 - trimmed_obj_loss: 0.0000e+00[1m29/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 20.6483 - loss: -4032852.5000 - pred_intensity_loss: -4032852.5000 - trimmed_obj_loss: 0.0000e+00[1m31/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 45ms/step - intensity_scaler_inv_loss: 20.5585 - loss: -4025266.2500 - pred_intensity_loss: -4025544.7500 - trimmed_obj_loss: 0.0000e+00[1m31/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 47ms/step - intensity_scaler_inv_loss: 19.1889 - loss: -3916753.0000 - pred_intensity_loss: -3925384.7500 - trimmed_obj_loss: 0.0000e+00 - val_intensity_scaler_inv_loss: 17.2716 - val_loss: -4436899.0000 - val_pred_intensity_loss: -4324189.0000 - val_trimmed_obj_loss: 0.0000e+00 - learning_rate: 0.0010
Epoch 5/5
[1m 1/31[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 65ms/step - intensity_scaler_inv_loss: 17.2277 - loss: -3827312.5000 - pred_intensity_loss: -3827312.5000 - trimmed_obj_loss: 0.0000e+00[1m 3/31[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 47ms/step - intensity_scaler_inv_loss: 16.7095 - loss: -3824161.2500 - pred_intensity_loss: -3824161.2500 - trimmed_obj_loss: 0.0000e+00[1m 5/31[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 47ms/step - intensity_scaler_inv_loss: 16.5291 - loss: -3834260.2500 - pred_intensity_loss: -3834260.2500 - trimmed_obj_loss: 0.0000e+00[1m 7/31[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 47ms/step - intensity_scaler_inv_loss: 16.5059 - loss: -3819454.2500 - pred_intensity_loss: -3819454.2500 - trimmed_obj_loss: 0.0000e+00[1m 9/31[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 47ms/step - intensity_scaler_inv_loss: 16.4937 - loss: -3796566.0000 - pred_intensity_loss: -3796566.0000 - trimmed_obj_loss: 0.0000e+00[1m11/31[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 16.4997 - loss: -3782772.2500 - pred_intensity_loss: -3782772.2500 - trimmed_obj_loss: 0.0000e+00[1m13/31[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 16.5034 - loss: -3773008.0000 - pred_intensity_loss: -3773008.0000 - trimmed_obj_loss: 0.0000e+00[1m15/31[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 16.4950 - loss: -3767843.2500 - pred_intensity_loss: -3767843.2500 - trimmed_obj_loss: 0.0000e+00[1m17/31[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 16.4823 - loss: -3766793.2500 - pred_intensity_loss: -3766793.2500 - trimmed_obj_loss: 0.0000e+00[1m19/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 16.4693 - loss: -3767790.7500 - pred_intensity_loss: -3767790.7500 - trimmed_obj_loss: 0.0000e+00[1m21/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 16.4547 - loss: -3773982.0000 - pred_intensity_loss: -3773982.0000 - trimmed_obj_loss: 0.0000e+00[1m23/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 16.4425 - loss: -3776641.7500 - pred_intensity_loss: -3776641.7500 - trimmed_obj_loss: 0.0000e+00[1m25/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 16.4393 - loss: -3780139.7500 - pred_intensity_loss: -3780139.7500 - trimmed_obj_loss: 0.0000e+00[1m27/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 16.4396 - loss: -3786152.2500 - pred_intensity_loss: -3786152.2500 - trimmed_obj_loss: 0.0000e+00[1m29/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 46ms/step - intensity_scaler_inv_loss: 16.4457 - loss: -3792651.5000 - pred_intensity_loss: -3792651.5000 - trimmed_obj_loss: 0.0000e+00[1m31/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 45ms/step - intensity_scaler_inv_loss: 16.4548 - loss: -3801278.2500 - pred_intensity_loss: -3800941.7500 - trimmed_obj_loss: 0.0000e+00[1m31/31[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 47ms/step - intensity_scaler_inv_loss: 16.5345 - loss: -3924568.5000 - pred_intensity_loss: -3914135.0000 - trimmed_obj_loss: 0.0000e+00 - val_intensity_scaler_inv_loss: 15.9663 - val_loss: -4438500.5000 - val_pred_intensity_loss: -4325934.5000 - val_trimmed_obj_loss: 0.0000e+00 - learning_rate: 0.0010
DEBUG: Setting probe to tf.Tensor(
[[[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 ...

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]

 [[1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  ...
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]
  [1.0893617e-09+0.j]]], shape=(64, 64, 1), dtype=complex64) in params
INFO: setting probe from test data container. It MUST be consistent with the training probe
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 822
DEBUG _flat_to_channel: input shape=(128, 822, 822, 1), reshaping to (-1, 4, 822, 822)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 822
DEBUG _flat_to_channel: input shape=(128, 822, 822, 1), reshaping to (-1, 4, 822, 822)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 822
DEBUG _flat_to_channel: input shape=(128, 822, 822, 1), reshaping to (-1, 4, 822, 822)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 822
DEBUG _flat_to_channel: input shape=(128, 822, 822, 1), reshaping to (-1, 4, 822, 822)
input shape (128, 64, 64, 1)
DEBUG _flat_to_channel: gridsize from parameter: 2
DEBUG _flat_to_channel: N from parameter: 64
DEBUG _flat_to_channel: input shape=(128, 64, 64, 1), reshaping to (-1, 4, 64, 64)
[1m1/4[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m3s[0m 1s/step[1m3/4[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 30ms/step[1m4/4[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 39ms/step[1m4/4[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 43ms/step
Object stitching failed: cannot reshape array of size 524288 into shape (6,6,64,64,1)
cannot reshape array of size 524288 into shape (6,6,64,64,1)
[runner] Training complete in 24.43s; bundle saved to plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-20T061530Z/gs2_ideal/train_outputs
DEBUG: nsamples: 64, gridsize: 2 (using efficient random sample-then-group strategy)
INFO: 'Y' array not found. Generating ground truth patches from 'objectGuess' as a fallback.
neighbor-sampled diffraction shape (64, 64, 64, 4)
loader: using provided ground truth patches.
INFO: None
<PtychoDataContainer X=(64, 64, 64, 4) mean=0.085 Y_I=(64, 64, 64, 4) mean=2.587 Y_phi=(64, 64, 64, 4) mean=0.000 coords_nominal=(64, 1, 2, 4) mean=-0.000 coords_true=(64, 1, 2, 4) mean=-0.000 probe=(64, 64) mean_amplitude=0.100 norm_Y_I=<scalar> nn_indices=(64, 4) global_offsets=(64, 1, 2, 1) local_offsets=(64, 1, 2, 4)>
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 822
DEBUG _flat_to_channel: input shape=(128, 822, 822, 1), reshaping to (-1, 4, 822, 822)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 822
DEBUG _flat_to_channel: input shape=(128, 822, 822, 1), reshaping to (-1, 4, 822, 822)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 822
DEBUG _flat_to_channel: input shape=(128, 822, 822, 1), reshaping to (-1, 4, 822, 822)
DEBUG _flat_to_channel: gridsize from global params: 2
DEBUG _flat_to_channel: N from parameter: 822
DEBUG _flat_to_channel: input shape=(128, 822, 822, 1), reshaping to (-1, 4, 822, 822)
[1m1/2[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 2s/step[1m2/2[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m2s[0m 17ms/step
[runner] Inference complete; stats saved to plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-20T061530Z/gs2_ideal/inference_outputs/stats.json
[runner] Outputs written to plans/active/DEBUG-SIM-LINES-DOSE-001/reports/2026-01-20T061530Z/gs2_ideal
