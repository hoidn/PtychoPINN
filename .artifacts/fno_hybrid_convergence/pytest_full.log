============================= test session starts ==============================
platform linux -- Python 3.11.13, pytest-8.4.1, pluggy-1.6.0
PyTorch: available
PyTorch version: 2.9.1+cu128
rootdir: /home/ollie/Documents/tmp/PtychoPINN
configfile: pyproject.toml
testpaths: tests
plugins: typeguard-2.13.3, anyio-4.9.0
collected 639 items / 2 skipped

tests/image/test_cropping.py .....                                       [  0%]
tests/image/test_registration.py ...............                         [  3%]
tests/io/test_ptychodus_interop_h5.py F                                  [  3%]
tests/io/test_ptychodus_product_io.py ...                                [  3%]
tests/scripts/test_inference_backend_selector.py .........               [  5%]
tests/scripts/test_ptychi_reconstruct_tike.py .                          [  5%]
tests/scripts/test_tf_inference_helper.py .......                        [  6%]
tests/scripts/test_training_backend_selector.py ......                   [  7%]
tests/study/test_check_dense_highlights_match.py ...                     [  7%]
tests/study/test_dose_overlap_comparison.py .........F                   [  9%]
tests/study/test_dose_overlap_dataset_contract.py ...........            [ 11%]
tests/study/test_dose_overlap_design.py ...                              [ 11%]
tests/study/test_dose_overlap_generation.py .........                    [ 12%]
tests/study/test_dose_overlap_overlap.py ....................            [ 16%]
tests/study/test_dose_overlap_reconstruction.py .....                    [ 16%]
tests/study/test_dose_overlap_training.py F.............                 [ 19%]
tests/study/test_phase_g_dense_artifacts_verifier.py .................   [ 21%]
tests/study/test_phase_g_dense_metrics_report.py ....                    [ 22%]
tests/study/test_phase_g_dense_orchestrator.py FF..........FFF...        [ 25%]
tests/study/test_ssim_grid.py .                                          [ 25%]
tests/test_baselines.py .                                                [ 25%]
tests/test_cli_args.py .......                                           [ 26%]
tests/test_coordinate_grouping.py ...............                        [ 28%]
tests/test_generator_registry.py ..                                      [ 29%]
tests/test_generic_loader.py s.                                          [ 29%]
tests/test_grid_lines_compare_wrapper.py ....                            [ 30%]
tests/test_grid_lines_workflow.py ........                               [ 31%]
tests/test_integration_baseline_gs2.py s                                 [ 31%]
tests/test_integration_workflow.py F                                     [ 31%]
tests/test_lazy_loading.py ...s...........                               [ 34%]
tests/test_log_config.py .........                                       [ 35%]
tests/test_misc.py s                                                     [ 35%]
tests/test_model_channel_consistency.py ..                               [ 35%]
tests/test_model_config_architecture.py ..                               [ 36%]
tests/test_model_factory.py ...                                          [ 36%]
tests/test_nphotons_metadata_integration.py .F.F.F                       [ 37%]
tests/test_oversampling.py .......                                       [ 38%]
tests/test_projective_warp_xla.py ............                           [ 40%]
tests/test_raw_data_grouping.py .........                                [ 42%]
tests/test_scaling_regression.py .......                                 [ 43%]
tests/test_sequential_sampling.py ..........                             [ 44%]
tests/test_subsampling.py ...........                                    [ 46%]
tests/test_tf_helper.py FFFF.....s.                                      [ 48%]
tests/test_tf_helper_edge_aware.py .ssssss                               [ 49%]
tests/test_workflow_components.py .F.....                                [ 50%]
tests/test_workflow_generator_integration.py .s                          [ 50%]
tests/tf_helper/test_translation_shape_guard.py .....                    [ 51%]
tests/tools/test_generate_patches_tool.py ..                             [ 51%]
tests/tools/test_generate_test_index.py ...                              [ 52%]
tests/tools/test_tail_interleave_logs.py .                               [ 52%]
tests/tools/test_transpose_rename_convert_tool.py ..                     [ 52%]
tests/tools/test_update_tool.py ..                                       [ 53%]
tests/torch/test_api_deprecation.py ..                                   [ 53%]
tests/torch/test_backend_selection.py ......                             [ 54%]
tests/torch/test_cli_inference_torch.py F........                        [ 55%]
tests/torch/test_cli_shared.py ........................                  [ 59%]
tests/torch/test_cli_train_torch.py ..................F                  [ 62%]
tests/torch/test_config_bridge.py ...................................... [ 68%]
..............                                                           [ 70%]
tests/torch/test_config_factory.py .........FF.....................      [ 75%]
tests/torch/test_data_pipeline.py ...