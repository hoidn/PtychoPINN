2026-01-26 20:48:18.948797: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1769489298.960387 3969089 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1769489298.964174 3969089 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1769489298.974429 3969089 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1769489298.974440 3969089 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1769489298.974442 3969089 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1769489298.974443 3969089 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2026-01-26 20:48:18.977271: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2026-01-26 20:48:21,490 - INFO - Starting ptychography inference script...
2026-01-26 20:48:21,490 - INFO - Final inference config - gridsize: 1
2026-01-26 20:48:21,490 - INFO - Legacy mode: using 250 individual images (gridsize=1)
2026-01-26 20:48:21,490 - INFO - Loading model...
2026-01-26 20:48:21,490 - INFO - Backend dispatcher: loading TensorFlow model (ptycho.workflows.components)
2026-01-26 20:48:21,491 - INFO - Loading model from: artifacts/dose_response_study/2026-01-13T070124Z/low_mae
I0000 00:00:1769489301.750742 3969089 gpu_process_state.cc:208] Using CUDA malloc Async allocator for GPU: 0
I0000 00:00:1769489301.752083 3969089 gpu_device.cc:2019] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22259 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:04:00.0, compute capability: 8.6
/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py:421: UserWarning: `build()` was called on layer 'center_mask_layer', however the layer does not have a `build()` method implemented and it looks like it has unbuilt state. This will cause the layer to be marked as built, despite not being actually built, which may cause failures down the line. Make sure to implement a proper `build()` method.
  warnings.warn(
/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py:421: UserWarning: `build()` was called on layer 'center_mask_layer_1', however the layer does not have a `build()` method implemented and it looks like it has unbuilt state. This will cause the layer to be marked as built, despite not being actually built, which may cause failures down the line. Make sure to implement a proper `build()` method.
  warnings.warn(
2026-01-26 20:48:22,468 - ERROR - Failed to load model from artifacts/dose_response_study/2026-01-13T070124Z/low_mae: <class 'keras.src.models.functional.Functional'> could not be deserialized properly. Please ensure that components that are Python object instances (layers, models, etc.) returned by `get_config()` are explicitly deserialized in the model's `from_config()` method.

config={'module': 'keras.src.models.functional', 'class_name': 'Functional', 'config': {}, 'registered_name': 'Functional', 'build_config': {'input_shape': None}, 'compile_config': None}.

Exception encountered: Could not locate class 'ProbeIllumination'. Make sure custom classes are decorated with `@keras.saving.register_keras_serializable()`. Full object config: {'module': 'ptycho.model', 'class_name': 'ProbeIllumination', 'config': {'name': 'probe_illumination', 'trainable': True, 'dtype': {'module': 'keras', 'class_name': 'DTypePolicy', 'config': {'name': 'float32'}, 'registered_name': None, 'shared_object_id': 130438766171728}, 'N': 64}, 'registered_name': 'ProbeIllumination', 'build_config': {'input_shape': [[None, 64, 64, 1]]}, 'name': 'probe_illumination', 'inbound_nodes': [{'args': [[{'class_name': '__keras_tensor__', 'config': {'shape': [None, 64, 64, 1], 'dtype': 'complex64', 'keras_history': ['padded_objs_with_offsets', 0, 0]}}]], 'kwargs': {}}]}
2026-01-26 20:48:22,468 - INFO - Script execution failed: <class 'keras.src.models.functional.Functional'> could not be deserialized properly. Please ensure that components that are Python object instances (layers, models, etc.) returned by `get_config()` are explicitly deserialized in the model's `from_config()` method.

config={'module': 'keras.src.models.functional', 'class_name': 'Functional', 'config': {}, 'registered_name': 'Functional', 'build_config': {'input_shape': None}, 'compile_config': None}.

Exception encountered: Could not locate class 'ProbeIllumination'. Make sure custom classes are decorated with `@keras.saving.register_keras_serializable()`. Full object config: {'module': 'ptycho.model', 'class_name': 'ProbeIllumination', 'config': {'name': 'probe_illumination', 'trainable': True, 'dtype': {'module': 'keras', 'class_name': 'DTypePolicy', 'config': {'name': 'float32'}, 'registered_name': None, 'shared_object_id': 130438766171728}, 'N': 64}, 'registered_name': 'ProbeIllumination', 'build_config': {'input_shape': [[None, 64, 64, 1]]}, 'name': 'probe_illumination', 'inbound_nodes': [{'args': [[{'class_name': '__keras_tensor__', 'config': {'shape': [None, 64, 64, 1], 'dtype': 'complex64', 'keras_history': ['padded_objs_with_offsets', 0, 0]}}]], 'kwargs': {}}]}
2026-01-26 20:48:22,468 - INFO - Cleaning up resources...
Error loading model from /tmp/tmpja0bgvc9/autoencoder: <class 'keras.src.models.functional.Functional'> could not be deserialized properly. Please ensure that components that are Python object instances (layers, models, etc.) returned by `get_config()` are explicitly deserialized in the model's `from_config()` method.

config={'module': 'keras.src.models.functional', 'class_name': 'Functional', 'config': {}, 'registered_name': 'Functional', 'build_config': {'input_shape': None}, 'compile_config': None}.

Exception encountered: Could not locate class 'ProbeIllumination'. Make sure custom classes are decorated with `@keras.saving.register_keras_serializable()`. Full object config: {'module': 'ptycho.model', 'class_name': 'ProbeIllumination', 'config': {'name': 'probe_illumination', 'trainable': True, 'dtype': {'module': 'keras', 'class_name': 'DTypePolicy', 'config': {'name': 'float32'}, 'registered_name': None, 'shared_object_id': 130438766171728}, 'N': 64}, 'registered_name': 'ProbeIllumination', 'build_config': {'input_shape': [[None, 64, 64, 1]]}, 'name': 'probe_illumination', 'inbound_nodes': [{'args': [[{'class_name': '__keras_tensor__', 'config': {'shape': [None, 64, 64, 1], 'dtype': 'complex64', 'keras_history': ['padded_objs_with_offsets', 0, 0]}}]], 'kwargs': {}}]}
real 4.80
user 9.10
sys 1.01
