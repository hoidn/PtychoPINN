2026-01-11 02:16:02,332 - INFO - Configuration: phase_align_method='plane', frc_sigma=0.0
2026-01-11 02:16:02,333 - INFO - Registration: disabled
2026-01-11 02:16:02,333 - INFO - NPZ output: raw=enabled, aligned=enabled
2026-01-11 02:16:02,333 - INFO - Loading PtychoPINN inference model (diffraction_to_obj) to restore configuration...
2026-01-11 02:16:02,333 - INFO - Loading model from: 3way_synthetic_ptychi_1e4_64_gs2/train_64/trial_1/pinn_run
2026-01-11 02:16:02,333 - DEBUG - Model archive path: 3way_synthetic_ptychi_1e4_64_gs2/train_64/trial_1/pinn_run/wts.h5.zip
2026-01-11 02:16:03,294 - ERROR - /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py:421: UserWarning: `build()` was called on layer 'center_mask_layer', however the layer does not have a `build()` method implemented and it looks like it has unbuilt state. This will cause the layer to be marked as built, despite not being actually built, which may cause failures down the line. Make sure to implement a proper `build()` method.
  warnings.warn(
2026-01-11 02:16:03,295 - ERROR - /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py:421: UserWarning: `build()` was called on layer 'center_mask_layer_1', however the layer does not have a `build()` method implemented and it looks like it has unbuilt state. This will cause the layer to be marked as built, despite not being actually built, which may cause failures down the line. Make sure to implement a proper `build()` method.
  warnings.warn(
2026-01-11 02:16:03,539 - INFO - Error loading model from /tmp/tmpfuyo1yha/autoencoder: Layer functional weight shape (3, 3, 64, 4) is not compatible with provided weight shape (3, 3, 64, 1).
2026-01-11 02:16:03,545 - ERROR - Failed to load model from 3way_synthetic_ptychi_1e4_64_gs2/train_64/trial_1/pinn_run: Layer functional weight shape (3, 3, 64, 4) is not compatible with provided weight shape (3, 3, 64, 1).
2026-01-11 02:16:03,545 - CRITICAL - Uncaught exception
Traceback (most recent call last):
  File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 1774, in <module>
    main()
  File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 994, in main
    pinn_model = load_pinn_model(args.pinn_dir)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 201, in load_pinn_model
    model, _ = load_inference_bundle(model_dir)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/workflows/components.py", line 228, in load_inference_bundle
    models_dict = ModelManager.load_multiple_models(str(model_zip))
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/model_manager.py", line 421, in load_multiple_models
    loaded_models[model_name] = ModelManager.load_model(model_subdir)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/model_manager.py", line 204, in load_model
    model.set_weights(loaded_model.get_weights())
  File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 738, in set_weights
    raise ValueError(
ValueError: Layer functional weight shape (3, 3, 64, 4) is not compatible with provided weight shape (3, 3, 64, 1).
2026-01-11 02:16:03,546 - ERROR - Traceback (most recent call last):
2026-01-11 02:16:03,546 - ERROR - File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 1774, in <module>
2026-01-11 02:16:03,546 - ERROR - main()
2026-01-11 02:16:03,546 - ERROR - File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 994, in main
2026-01-11 02:16:03,546 - ERROR - pinn_model = load_pinn_model(args.pinn_dir)
2026-01-11 02:16:03,546 - ERROR - ^
2026-01-11 02:16:03,546 - ERROR - ^
2026-01-11 02:16:03,546 - ERROR - ^
2026-01-11 02:16:03,546 - ERROR - ^
2026-01-11 02:16:03,546 - ERROR - ^
2026-01-11 02:16:03,546 - ERROR - ^
2026-01-11 02:16:03,546 - ERROR - ^
2026-01-11 02:16:03,546 - ERROR - ^
2026-01-11 02:16:03,546 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 201, in load_pinn_model
2026-01-11 02:16:03,547 - ERROR - model, _ = load_inference_bundle(model_dir)
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - ^
2026-01-11 02:16:03,547 - ERROR - File "/home/ollie/Documents/PtychoPINN/ptycho/workflows/components.py", line 228, in load_inference_bundle
2026-01-11 02:16:03,548 - ERROR - models_dict = ModelManager.load_multiple_models(str(model_zip))
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - ^
2026-01-11 02:16:03,548 - ERROR - File "/home/ollie/Documents/PtychoPINN/ptycho/model_manager.py", line 421, in load_multiple_models
2026-01-11 02:16:03,549 - ERROR - loaded_models[model_name] = ModelManager.load_model(model_subdir)
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - ^
2026-01-11 02:16:03,549 - ERROR - File "/home/ollie/Documents/PtychoPINN/ptycho/model_manager.py", line 204, in load_model
2026-01-11 02:16:03,549 - ERROR - model.set_weights(loaded_model.get_weights())
2026-01-11 02:16:03,549 - ERROR - File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 738, in set_weights
2026-01-11 02:16:03,549 - ERROR - raise ValueError(
2026-01-11 02:16:03,549 - ERROR - ValueError
2026-01-11 02:16:03,549 - ERROR - :
2026-01-11 02:16:03,549 - ERROR - Layer functional weight shape (3, 3, 64, 4) is not compatible with provided weight shape (3, 3, 64, 1).
