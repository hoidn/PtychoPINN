2025-11-12 18:44:33,723 - INFO - Configuration: phase_align_method='plane', frc_sigma=0.0
2025-11-12 18:44:33,723 - INFO - Registration: enabled
2025-11-12 18:44:33,723 - INFO - NPZ output: raw=enabled, aligned=enabled
2025-11-12 18:44:33,723 - INFO - Loading PtychoPINN inference model (diffraction_to_obj) to restore configuration...
2025-11-12 18:44:33,723 - INFO - Loading model from: outputs/dense_exec_100k_2025-11-12T224540Z/data/phase_e/dose_100000/dense/gs2
2025-11-12 18:44:33,723 - DEBUG - Model archive path: outputs/dense_exec_100k_2025-11-12T224540Z/data/phase_e/dose_100000/dense/gs2/wts.h5.zip
2025-11-12 18:44:34,832 - INFO - Model: "functional"
2025-11-12 18:44:34,857 - INFO - ┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ input (InputLayer)  │ (None, 128, 128,  │          0 │ -                 │
│                     │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ intensity_scaler    │ (None, 128, 128,  │          0 │ input[0][0]       │
│ (IntensityScaler)   │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d (Conv2D)     │ (None, 128, 128,  │      1,184 │ intensity_scaler… │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_1 (Conv2D)   │ (None, 128, 128,  │      9,248 │ conv2d[0][0]      │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d       │ (None, 64, 64,    │          0 │ conv2d_1[0][0]    │
│ (MaxPooling2D)      │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_2 (Conv2D)   │ (None, 64, 64,    │     18,496 │ max_pooling2d[0]… │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_3 (Conv2D)   │ (None, 64, 64,    │     36,928 │ conv2d_2[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d_1     │ (None, 32, 32,    │          0 │ conv2d_3[0][0]    │
│ (MaxPooling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_4 (Conv2D)   │ (None, 32, 32,    │     73,856 │ max_pooling2d_1[… │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_5 (Conv2D)   │ (None, 32, 32,    │    147,584 │ conv2d_4[0][0]    │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d_2     │ (None, 16, 16,    │          0 │ conv2d_5[0][0]    │
│ (MaxPooling2D)      │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_6 (Conv2D)   │ (None, 16, 16,    │    295,168 │ max_pooling2d_2[… │
│                     │ 256)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_7 (Conv2D)   │ (None, 16, 16,    │    590,080 │ conv2d_6[0][0]    │
│                     │ 256)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d_3     │ (None, 8, 8, 256) │          0 │ conv2d_7[0][0]    │
│ (MaxPooling2D)      │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_10 (Conv2D)  │ (None, 8, 8, 256) │    590,080 │ max_pooling2d_3[… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_20 (Conv2D)  │ (None, 8, 8, 256) │    590,080 │ max_pooling2d_3[… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_11 (Conv2D)  │ (None, 8, 8, 256) │    590,080 │ conv2d_10[0][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_21 (Conv2D)  │ (None, 8, 8, 256) │    590,080 │ conv2d_20[0][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d       │ (None, 16, 16,    │          0 │ conv2d_11[0][0]   │
│ (UpSampling2D)      │ 256)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_4     │ (None, 16, 16,    │          0 │ conv2d_21[0][0]   │
│ (UpSampling2D)      │ 256)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_12 (Conv2D)  │ (None, 16, 16,    │    295,040 │ up_sampling2d[0]… │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_22 (Conv2D)  │ (None, 16, 16,    │    295,040 │ up_sampling2d_4[… │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_13 (Conv2D)  │ (None, 16, 16,    │    147,584 │ conv2d_12[0][0]   │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_23 (Conv2D)  │ (None, 16, 16,    │    147,584 │ conv2d_22[0][0]   │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_1     │ (None, 32, 32,    │          0 │ conv2d_13[0][0]   │
│ (UpSampling2D)      │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_5     │ (None, 32, 32,    │          0 │ conv2d_23[0][0]   │
│ (UpSampling2D)      │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_14 (Conv2D)  │ (None, 32, 32,    │     73,792 │ up_sampling2d_1[… │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_24 (Conv2D)  │ (None, 32, 32,    │     73,792 │ up_sampling2d_5[… │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_15 (Conv2D)  │ (None, 32, 32,    │     36,928 │ conv2d_14[0][0]   │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_25 (Conv2D)  │ (None, 32, 32,    │     36,928 │ conv2d_24[0][0]   │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_2     │ (None, 64, 64,    │          0 │ conv2d_15[0][0]   │
│ (UpSampling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_6     │ (None, 64, 64,    │          0 │ conv2d_25[0][0]   │
│ (UpSampling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ get_item_1          │ (None, 64, 64, 4) │          0 │ up_sampling2d_2[… │
│ (GetItem)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ get_item_3          │ (None, 64, 64, 4) │          0 │ up_sampling2d_6[… │
│ (GetItem)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_16 (Conv2D)  │ (None, 64, 64,    │      1,184 │ get_item_1[0][0]  │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_26 (Conv2D)  │ (None, 64, 64,    │      1,184 │ get_item_3[0][0]  │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_17 (Conv2D)  │ (None, 64, 64,    │      9,248 │ conv2d_16[0][0]   │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_27 (Conv2D)  │ (None, 64, 64,    │      9,248 │ conv2d_26[0][0]   │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_3     │ (None, 128, 128,  │          0 │ conv2d_17[0][0]   │
│ (UpSampling2D)      │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_7     │ (None, 128, 128,  │          0 │ conv2d_27[0][0]   │
│ (UpSampling2D)      │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ get_item (GetItem)  │ (None, 64, 64,    │          0 │ up_sampling2d_2[… │
│                     │ 60)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_9 (Conv2D)   │ (None, 128, 128,  │      1,156 │ up_sampling2d_3[… │
│                     │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ get_item_2          │ (None, 64, 64,    │          0 │ up_sampling2d_6[… │
│ (GetItem)           │ 60)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_19 (Conv2D)  │ (None, 128, 128,  │      1,156 │ up_sampling2d_7[… │
│                     │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_8 (Conv2D)   │ (None, 64, 64, 4) │      2,164 │ get_item[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ silu (Silu)         │ (None, 128, 128,  │          0 │ conv2d_9[0][0]    │
│                     │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_18 (Conv2D)  │ (None, 64, 64, 4) │      2,164 │ get_item_2[0][0]  │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ silu_1 (Silu)       │ (None, 128, 128,  │          0 │ conv2d_19[0][0]   │
│                     │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ amp                 │ (None, 64, 64, 4) │          0 │ conv2d_8[0][0]    │
│ (ActivationLayer)   │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ center_mask_layer   │ (None, 128, 128,  │          0 │ silu[0][0]        │
│ (CenterMaskLayer)   │ 1)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ phi                 │ (None, 64, 64, 4) │          0 │ conv2d_18[0][0]   │
│ (ActivationLayer)   │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ center_mask_layer_1 │ (None, 128, 128,  │          0 │ silu_1[0][0]      │
│ (CenterMaskLayer)   │ 1)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ amp_padded          │ (None, 128, 128,  │          0 │ amp[0][0]         │
│ (ZeroPadding2D)     │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ multiply (Multiply) │ (None, 128, 128,  │          0 │ silu[0][0],       │
│                     │ 4)                │            │ center_mask_laye… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ phase_padded        │ (None, 128, 128,  │          0 │ phi[0][0]         │
│ (ZeroPadding2D)     │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ multiply_1          │ (None, 128, 128,  │          0 │ silu_1[0][0],     │
│ (Multiply)          │ 4)                │            │ center_mask_laye… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ add (Add)           │ (None, 128, 128,  │          0 │ amp_padded[0][0], │
│                     │ 4)                │            │ multiply[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ add_1 (Add)         │ (None, 128, 128,  │          0 │ phase_padded[0][… │
│                     │ 4)                │            │ multiply_1[0][0]  │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ obj                 │ (None, 128, 128,  │          0 │ add[0][0],        │
│ (CombineComplexLay… │ 4)                │            │ add_1[0][0]       │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ input_positions     │ (None, 1, 2, 4)   │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ padded_obj_2        │ (None, 142, 142,  │          0 │ obj[0][0],        │
│ (ReassemblePatches… │ 4)                │            │ input_positions[… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ padded_objs_with_o… │ (None, 132, 132,  │          0 │ padded_obj_2[0][… │
│ (ExtractPatchesPos… │ 4)                │            │ input_positions[… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ probe_illumination  │ [(None, 132, 132, │          0 │ padded_objs_with… │
│ (ProbeIllumination) │ 4), (None, 132,   │            │                   │
│                     │ 132, 4)]          │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ pred_amplitude      │ [(None, 128, 128, │          0 │ probe_illuminati… │
│ (PadAndDiffractLay… │ 4), (None, 128,   │            │                   │
│                     │ 128, 4)]          │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ pred_diff_channels  │ (None, 128, 128,  │          0 │ pred_amplitude[0… │
│ (FlatToChannelLaye… │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ intensity_scaler_i… │ (None, 128, 128,  │          0 │ pred_diff_channe… │
│ (IntensityScaler_i… │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ trimmed_obj         │ (None, 128, 128,  │          0 │ padded_obj_2[0][… │
│ (TrimReconstructio… │ 4)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ pred_intensity      │ (None, 128, 128,  │          0 │ intensity_scaler… │
│ (SquareLayer)       │ 4)                │            │                   │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
2025-11-12 18:44:34,857 - INFO - Total params: 4,667,056 (17.80 MB)
2025-11-12 18:44:34,857 - INFO - Trainable params: 4,667,056 (17.80 MB)
2025-11-12 18:44:34,858 - INFO - Non-trainable params: 0 (0.00 B)
2025-11-12 18:44:34,858 - INFO - None
2025-11-12 18:44:35,054 - ERROR - /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py:421: UserWarning: `build()` was called on layer 'center_mask_layer', however the layer does not have a `build()` method implemented and it looks like it has unbuilt state. This will cause the layer to be marked as built, despite not being actually built, which may cause failures down the line. Make sure to implement a proper `build()` method.
  warnings.warn(
2025-11-12 18:44:35,055 - ERROR - /home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py:421: UserWarning: `build()` was called on layer 'center_mask_layer_1', however the layer does not have a `build()` method implemented and it looks like it has unbuilt state. This will cause the layer to be marked as built, despite not being actually built, which may cause failures down the line. Make sure to implement a proper `build()` method.
  warnings.warn(
2025-11-12 18:44:35,391 - INFO - Error loading model from /tmp/tmpkmi_vpof/autoencoder: Layer functional_3 weight shape (3, 3, 32, 4) is not compatible with provided weight shape (3, 3, 32, 1).
2025-11-12 18:44:35,404 - ERROR - Failed to load model from outputs/dense_exec_100k_2025-11-12T224540Z/data/phase_e/dose_100000/dense/gs2: Layer functional_3 weight shape (3, 3, 32, 4) is not compatible with provided weight shape (3, 3, 32, 1).
2025-11-12 18:44:35,404 - CRITICAL - Uncaught exception
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 1290, in <module>
    main()
  File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 882, in main
    pinn_model = load_pinn_model(args.pinn_dir)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 142, in load_pinn_model
    model, _ = load_inference_bundle(model_dir)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/workflows/components.py", line 160, in load_inference_bundle
    models_dict = ModelManager.load_multiple_models(str(model_zip))
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/model_manager.py", line 420, in load_multiple_models
    loaded_models[model_name] = ModelManager.load_model(model_subdir)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ollie/Documents/PtychoPINN/ptycho/model_manager.py", line 203, in load_model
    model.set_weights(loaded_model.get_weights())
  File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 738, in set_weights
    raise ValueError(
ValueError: Layer functional_3 weight shape (3, 3, 32, 4) is not compatible with provided weight shape (3, 3, 32, 1).
2025-11-12 18:44:35,405 - ERROR - Traceback (most recent call last):
2025-11-12 18:44:35,405 - ERROR - File "<frozen runpy>", line 198, in _run_module_as_main
2025-11-12 18:44:35,405 - ERROR - File "<frozen runpy>", line 88, in _run_code
2025-11-12 18:44:35,405 - ERROR - File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 1290, in <module>
2025-11-12 18:44:35,406 - ERROR - main()
2025-11-12 18:44:35,406 - ERROR - File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 882, in main
2025-11-12 18:44:35,406 - ERROR - pinn_model = load_pinn_model(args.pinn_dir)
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - File "/home/ollie/Documents/PtychoPINN/scripts/compare_models.py", line 142, in load_pinn_model
2025-11-12 18:44:35,406 - ERROR - model, _ = load_inference_bundle(model_dir)
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,406 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - File "/home/ollie/Documents/PtychoPINN/ptycho/workflows/components.py", line 160, in load_inference_bundle
2025-11-12 18:44:35,407 - ERROR - models_dict = ModelManager.load_multiple_models(str(model_zip))
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,407 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - File "/home/ollie/Documents/PtychoPINN/ptycho/model_manager.py", line 420, in load_multiple_models
2025-11-12 18:44:35,408 - ERROR - loaded_models[model_name] = ModelManager.load_model(model_subdir)
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,408 - ERROR - ^
2025-11-12 18:44:35,409 - ERROR - ^
2025-11-12 18:44:35,409 - ERROR - ^
2025-11-12 18:44:35,409 - ERROR - ^
2025-11-12 18:44:35,409 - ERROR - ^
2025-11-12 18:44:35,409 - ERROR - ^
2025-11-12 18:44:35,409 - ERROR - ^
2025-11-12 18:44:35,409 - ERROR - File "/home/ollie/Documents/PtychoPINN/ptycho/model_manager.py", line 203, in load_model
2025-11-12 18:44:35,409 - ERROR - model.set_weights(loaded_model.get_weights())
2025-11-12 18:44:35,409 - ERROR - File "/home/ollie/miniconda3/envs/ptycho311/lib/python3.11/site-packages/keras/src/layers/layer.py", line 738, in set_weights
2025-11-12 18:44:35,409 - ERROR - raise ValueError(
2025-11-12 18:44:35,409 - ERROR - ValueError
2025-11-12 18:44:35,409 - ERROR - :
2025-11-12 18:44:35,409 - ERROR - Layer functional_3 weight shape (3, 3, 32, 4) is not compatible with provided weight shape (3, 3, 32, 1).
